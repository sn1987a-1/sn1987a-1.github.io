{"meta":{"title":"SN1987A","subtitle":"LAYã®BLOG","description":"Learn not and know not.","author":"SN1987A","url":"http://sn1987a-1.github.io","root":"/"},"pages":[{"title":"å…³äºæœ¬ç«™","date":"2020-04-19T04:58:56.000Z","updated":"2022-03-01T07:45:21.165Z","comments":false,"path":"about/index.html","permalink":"http://sn1987a-1.github.io/about/index.html","excerpt":"","text":"SN1987ALearn not and know not. USTC cser 2020. =^= è”ç³»æˆ‘QQï¼š945093063phone:18306552190mail:lay_sn1987a@mail.ustc.edu.cn"},{"title":"åˆ†ç±»","date":"2020-11-24T07:12:19.000Z","updated":"2022-03-01T07:46:03.375Z","comments":false,"path":"categories/index.html","permalink":"http://sn1987a-1.github.io/categories/index.html","excerpt":"","text":""},{"title":"archives","date":"2019-10-24T16:00:00.000Z","updated":"2022-03-01T07:45:35.465Z","comments":true,"path":"archives/index.html","permalink":"http://sn1987a-1.github.io/archives/index.html","excerpt":"","text":""},{"title":"ç•™è¨€æ¿","date":"2020-10-31T02:11:28.000Z","updated":"2022-03-01T07:46:33.435Z","comments":false,"path":"comments/index.html","permalink":"http://sn1987a-1.github.io/comments/index.html","excerpt":"","text":"new Artitalk({ appId: 'o2lydQokojD1IP8EGhex24WU-MdYXbMMI', appKey: '8ykSyPm9CwzCDdR5dbid1AWT' })"},{"title":"å‹æƒ…é“¾æ¥","date":"2018-06-07T14:17:49.000Z","updated":"2022-03-01T07:48:07.885Z","comments":true,"path":"link/index.html","permalink":"http://sn1987a-1.github.io/link/index.html","excerpt":"","text":""},{"title":"æˆ‘çš„æ­Œå•","date":"2019-05-17T08:14:00.000Z","updated":"2022-02-07T02:33:38.000Z","comments":true,"path":"music/index.html","permalink":"http://sn1987a-1.github.io/music/index.html","excerpt":"","text":""},{"title":"æ ‡ç­¾","date":"2020-11-24T07:14:39.000Z","updated":"2022-03-01T07:49:18.985Z","comments":false,"path":"tags/index.html","permalink":"http://sn1987a-1.github.io/tags/index.html","excerpt":"","text":""},{"title":"ç›¸å†Œ","date":"2022-02-09T00:58:41.100Z","updated":"2022-01-27T13:30:37.000Z","comments":false,"path":"List/gallery/index.html","permalink":"http://sn1987a-1.github.io/List/gallery/index.html","excerpt":"","text":"å£çº¸ æ”¶è—çš„ä¸€äº›å£çº¸ OH MY GIRL å…³äºOH MY GIRLçš„å›¾ç‰‡"},{"title":"Music-BBOX","date":"2020-04-23T04:58:56.000Z","updated":"2022-02-06T09:31:49.000Z","comments":false,"path":"List/music/index.html","permalink":"http://sn1987a-1.github.io/List/music/index.html","excerpt":"","text":""},{"title":"","date":"2019-08-10T08:41:10.000Z","updated":"2022-01-27T13:30:37.000Z","comments":false,"path":"List/movies/index.html","permalink":"http://sn1987a-1.github.io/List/movies/index.html","excerpt":"","text":"åŠ±å¿—è§†é¢‘"},{"title":"","date":"2020-11-24T08:05:01.000Z","updated":"2022-01-27T13:30:37.000Z","comments":false,"path":"List/gallery/ohmygirl/index.html","permalink":"http://sn1987a-1.github.io/List/gallery/ohmygirl/index.html","excerpt":"","text":""},{"title":"","date":"2022-02-09T00:58:41.100Z","updated":"2022-01-27T13:30:37.000Z","comments":false,"path":"List/gallery/wallpaper/index.html","permalink":"http://sn1987a-1.github.io/List/gallery/wallpaper/index.html","excerpt":"","text":""}],"posts":[{"title":"MLç®—æ³•ï¼šXGBoost","slug":"XGBOOST","date":"2023-11-28T12:48:34.000Z","updated":"2023-09-24T03:47:34.736Z","comments":true,"path":"posts/f54e13d4.html","link":"","permalink":"http://sn1987a-1.github.io/posts/f54e13d4.html","excerpt":"","text":"XGBoostå®éªŒç›®çš„æœ¬å®éªŒè¦æ±‚å­¦ä¹ XGBoostæ¨¡å‹çš„åŸç†ï¼Œå¹¶å®ç°è¯¥æ¨¡å‹ï¼Œä»¥åŠåœ¨æ•°æ®é›†ä¸Šå®Œæˆè®­ç»ƒå’Œæµ‹è¯•ã€‚ å®éªŒåŸç†XGBoostçš„åŸºæœ¬åŸç†å°±æ˜¯ä»¥å†³ç­–æ ‘ä½œä¸ºåŸºå­¦ä¹ å™¨çš„åŠ æ³•æ¨¡å‹ï¼Œæ¯æ£µæ ‘æ ¹æ®å‰tä¸ªæ¨¡å‹çš„è¾“å‡ºè®¡ç®—èŠ‚ç‚¹çš„æƒé‡ï¼Œæœ€ç»ˆçš„è¾“å‡ºä¸ºï¼š y_i^{(t)}=âˆ‘^t_{k=1}f_k (x_i )=y _i^{(t-1)}+f_t (x_i )æœ¬å®éªŒçš„é—®é¢˜æ¨¡å‹ä¸ºå›å½’é—®é¢˜ï¼Œå³$ğ‘™ğ‘œğ‘ ğ‘ (ğ‘¦_ğ‘–,ğ‘¦ _ğ‘–^{(ğ‘¡)} )=(ğ‘¦_ğ‘–âˆ’\\hat y _ğ‘–^{(ğ‘¡)} )^2$ã€‚ å¯¹äºæŸå¤±lossï¼Œè®° $g_i$ ä¸ºä¸€é˜¶å¯¼æ•°ï¼Œ$h_i$ ä¸ºäºŒé˜¶å¯¼æ•°ï¼Œå³$g_i=\\frac{\\partial\\ loss(y_i,y _i^{(t-1)})}{\\partial\\ y _i^{(t-1) } }=2(\\hat y^{t-1}-y)$, $h_i=\\frac{\\partial^2 loss(y_i,y _i^{(t-1)} )}{\\partial \\ (y _i^{(t-1)} )^2 }=2\\\\ $ã€‚ åœ¨è®­ç»ƒç¬¬tæ£µå†³ç­–æ ‘æ—¶,ç›®æ ‡å‡½æ•°ä¸º$Obj^{(t)}=âˆ‘_{i=1}^n[g_i f_t (x_i )+\\frac12 h_i f_t^2 (x_i)]+penalty(f_t )$ å¯¹äºä¸€æ£µå†³ç­–æ ‘ï¼Œå…¶æƒ©ç½šä¸ºï¼š penalty(f)=\\gamma\\cdot T+\\frac12\\lambda\\cdot\\|w\\|^2å°†åˆ†é…åˆ°ç¬¬ $j$ ä¸ªå¶å­èŠ‚ç‚¹çš„æ ·æœ¬ç”¨ $I_j$ è¡¨ç¤ºï¼Œå³ $I_j=\\{i|q(x_i )=j\\} (1â‰¤jâ‰¤T)$ï¼Œåœ¨æ ‘ç»“æ„ç¡®å®šæ—¶å¯ä»¥è¿›è¡Œå¦‚ä¸‹ä¼˜åŒ–ï¼š \\begin{split} ğ‘‚ğ‘ğ‘—^{(ğ‘¡)} &=âˆ‘_{ğ‘—=1}^ğ‘‡[(âˆ‘_{iâˆˆğ¼_ğ‘—}ğ‘”_ğ‘– )w_j+\\frac12(\\sum_{i\\in I_j}h_i+\\lambda)w^2_j]+\\gamma T \\end{split}\\\\ è®° G_j=âˆ‘_{iâˆˆğ¼_ğ‘—}ğ‘”_ğ‘– , H_j=âˆ‘_{iâˆˆğ¼_ğ‘—}h_ğ‘– \\\\ Obj^{(t)}=\\sum_{j=1}^T[G_jw_j+\\frac12(H_j+\\lambda)w_j^2]+\\gamma Tæ±‚è§£$w$ :$w_j^*=-\\frac{G_j}{H_j+\\lambda}$ï¼Œæ­¤æ—¶å†³ç­–æ ‘çš„å¾—åˆ†ï¼š$Obj^{(t)}=-\\frac12\\sum^{T}_{j=1}\\frac{G_j^2}{H_j+\\lambda}+\\gamma T$ å®éªŒæ­¥éª¤è¯»å–æ•°æ®å’Œæ•°æ®å¤„ç†æ•°æ®æ–‡ä»¶ä¸­çš„å„é¡¹æ•°æ®å‡ä¸å«æœ‰NULLé¡¹ï¼Œæ— éœ€è¿›è¡Œç‰¹æ®Šå¤„ç†ã€‚ df = pd.read_csv('train.data') df.shape[1] df = pd.read_csv('train.data',names=[i for i in range(df.shape[1])]) #é‡æ–°è¯»å–æ•°æ®ï¼Œé˜²æ­¢å°†ç¬¬ä¸€è¡Œçš„æ•°æ®è¯†åˆ«ä¸ºç´¢å¼• Data=np.array(df) a=int(0.3*Data.shape[0]) Data=np.c_[Data,np.zeros(Data.shape[0]).T] num=np.random.permutation(Data.shape[0]) Data=Data[num] test_data=Data[0:a-1,:] train_data=Data[a:,:] #æŒ‰ç…§7ï¼š3çš„æ¯”ä¾‹åˆ’åˆ†è®­ç»ƒé›†å’Œæµ‹è¯•é›† åœ¨æ•°æ®é›†çš„åŸºç¡€ä¸Šæ·»åŠ ä¸€åˆ—0ï¼Œç”¨æ¥å­˜å‚¨æ¯è½®è®­ç»ƒç»“æŸåçš„é¢„æµ‹å€¼ï¼Œå³data=[:,-2]ä»£è¡¨çœŸå®å€¼,data[:,-1]ä»£è¡¨é¢„æµ‹å€¼ã€‚ å›å½’æ ‘æ¨¡å‹è¶…å‚æ•°: maxdepth=4,minscore=0,minindex=3,lambda=800,gamma=1e-7 class RegressionTree: def __init__(self) : ...åˆå§‹åŒ– def Leaf(self,data):#å¶èŠ‚ç‚¹ G=(2*np.sum(data[:,-1]-data[:,-2])) H=2*data.shape[0] return -G/(H+self.lam) def Obj(self,data):#è®¡ç®—å¾—åˆ† G=(2*np.sum(data[:,-1]-data[:,-2])) H=2*data.shape[0] obj=-G**2*0.5/(H+self.lam)+self.gamma return obj def split(self,data,num,val):#æ ¹æ®numå’Œvalæ‰¾åˆ°æœ€ä½³åˆ’åˆ† lchild=data[np.nonzero(data[:,num]&lt;=val)[0],:] rchild=data[np.nonzero(data[:,num]&gt;val)[0],:] return lchild,rchild def ChooseSplit(self,data,depth): \"\"\" å¯¹æ ·æœ¬é›†è¿›è¡Œåˆ’åˆ†ï¼Œæ‰¾åˆ°æœ€ä½³åˆ’åˆ† \"\"\" if data.shape[0]&lt;self.minindex or depth&gt;self.maxdepth: return -1,self.Leaf(data) if len(set(data[:,-2].T.tolist()))==1: return -1,self.Leaf(data) pobj=self.Obj(data) maxscore=-1 maxnum=0 maxval=0 n,m=data.shape for i in range(m-2): n=data[:,i].T.tolist() for j in set(n): lchild,rchild=self.split(data,i,j) if len(lchild)==0 or len(rchild)==0: continue score=-self.Obj(lchild)+self.Obj(rchild)+pobj if score&gt;maxscore: maxscore=score maxnum=i maxval=j if maxscore&lt;=self.minscore: return -1,self.Leaf(data) return maxnum,maxval def CreateTree(self,data,depth): num,val=self.ChooseSplit(data,depth) if num==-1: return val lchild,rchild=self.split(data,num,val) Tree={} \"\"\" å¦‚æœä¸æ˜¯å¶èŠ‚ç‚¹ï¼Œåˆ™ä»¥å­—å…¸å½¢å¼å»ºæ ‘ï¼Œå¦åˆ™èŠ‚ç‚¹åªå­˜å‚¨å¶å­çš„å€¼ \"\"\" Tree['num']=num Tree['val']=val Tree['lchild']=self.CreateTree(lchild,depth+1) Tree['rchild']=self.CreateTree(rchild,depth+1) return Tree å…¶ä¸­ï¼Œå†³ç­–æ ‘çš„éå¶å­èŠ‚ç‚¹æœ‰å±æ€§ï¼š numï¼Œvalï¼šåœ¨è¯¥ç»“ç‚¹å¤„é€‰å–ç¬¬numä¸ªå±æ€§å€¼è¿›è¡Œåˆ’åˆ†ï¼Œæœ€ä½³åˆ’åˆ†ç‚¹ä¸ºval lchildï¼Œrchildï¼šåˆ†åˆ«æŒ‡å‘ç¬¬numä¸ªå±æ€§å°äºç­‰äºvalå’Œå¤§äºvalçš„å­æ ‘ å¯¹äºå•æ£µå†³ç­–æ ‘çš„åœæ­¢ç­–ç•¥ï¼š maxdepthï¼šæ¯æ¬¡åˆ’åˆ†è®°å½•æ ‘çš„é«˜åº¦ï¼Œæ·±åº¦ä¸ºmaxdepthæ—¶ç›´æ¥å½“ä½œå¶å­èŠ‚ç‚¹ minindexï¼šæ¯æ¬¡åˆ’åˆ†æ—¶ï¼Œå¦‚æœå½“å‰èŠ‚ç‚¹çš„æ ·æœ¬æ•°å°äºminindexï¼Œåˆ™ç›´æ¥ä½œä¸ºå¶å­èŠ‚ç‚¹ minscoreï¼šè‹¥æ¯æ¬¡åˆ’åˆ†çš„æœ€ä½³åˆ’åˆ†çš„å¾—åˆ†å°äºç­‰äºminscoreæ—¶ï¼Œç›´æ¥ä½œä¸ºå¶å­èŠ‚ç‚¹ ä¼˜åŒ–ChooseSpiltå‡½æ•°ã€‚ä¸ºäº†å‡å°‘æ¯æ¬¡å¯¹å¾—åˆ†Objçš„è®¡ç®—æ—¶å­˜åœ¨çš„é‡å¤è®¡ç®—ï¼Œå°†å‡½æ•°çš„æ ¸å¿ƒéƒ¨åˆ†åšä»¥ä¸‹ä¿®æ”¹ï¼šï¼ˆå°†æ•°æ®æŒ‰ç…§å½“å‰å±æ€§è¿›è¡Œæ’åºï¼Œæ¯æ¬¡é€‰å–çš„å±æ€§å€¼ä¾æ¬¡å¢å¤§ï¼Œå› æ­¤å·¦å³ä¸¤å­©å­çš„gï¼Œhçº¿æ€§å¢/å‡ï¼Œå¯¹äºå·¦å­©å­ï¼š$\\Delta g=\\sum _{data[j,i]=val}(data1[j,-1]-data1[j,-2])2.0$,$\\Delta h=2\\sum_{data[j,i]=val}$ï¼‰ gl=0 hl=0 gr=(2*np.sum(data[:,-1]-data[:,-2])) hr=2*n data1=data[data[:,i].argsort()] for j in range(n-1): gl+=(data1[j,-1]-data1[j,-2])*2.0 gr-=(data1[j,-1]-data1[j,-2])*2.0 hl+=2 hr-=2 if data1[j,i]==data1[j+1,i]: continue obj1=-gl**2*0.5/(hl+self.lam)+self.gamma obj2=-gr**2*0.5/(hr+self.lam)+self.gamma score=pobj-obj1-obj2 if score&gt;maxscore: maxscore=score maxnum=i maxval=data1[j,i] XGBoostæ¨¡å‹è¶…å‚æ•°ï¼štreenum=30 class XGBoost: def __init__(self,data,treenum=30): ... def isTree(self,tree):#åˆ¤æ–­èŠ‚ç‚¹çš„ç±»å‹ï¼Œéå¶å­èŠ‚ç‚¹ä¸ºå­—å…¸ç±»å‹ï¼Œå¶å­èŠ‚ç‚¹ä¸ºfloatç±»å‹ return type(tree).__name__=='dict' def find(self,data,i,tree):#å¯¹äºå•ä¸ªæ ·æœ¬ï¼Œæ‰¾åˆ°æ‰€åœ¨å†³ç­–æ ‘çš„ä½ç½® if self.isTree(tree): if data[i,tree[\"num\"]]&lt;=tree['val']: return self.find(data,i,tree['lchild']) else: return self.find(data,i,tree['rchild']) else: return tree def fit(self): \"\"\" è®­ç»ƒå‡½æ•°ï¼Œå…¶ä¸­å…±è®­ç»ƒäº†treenumæ£µæ ‘ï¼Œè°ƒç”¨RegressionTreeï¼Œå¹¶è®¡ç®—æŸå¤±å’Œç›¸å…³ç³»æ•° \"\"\" loss=[] r2=[] va=(np.var(self.data[:,-2])) for i in range(self.treenum): print(i) tree=Rtree.CreateTree(self.data,1) for j in range(self.length): self.data[j,-1]+=self.find(self.data,j,tree) r=np.sqrt(np.sum((self.data[:,-2]-self.data[:,-1])**2/self.length)) r2.append(1-r**2/va) lo=np.sum((self.data[:,-2]-self.data[:,-1])**2) loss.append(lo) self.forest.append(tree) return loss,r2 def predict(self,data): m,n=data.shape for i in range(self.treenum): for j in range(m): test_data[j,-1]+=self.find(data,j,self.forest[i]) è®­ç»ƒæ¨¡å‹å¹¶å®ç°æŸå¤±å‡½æ•°å¯è§†åŒ–Rtree=RegressionTree() boost=XGBoost(train_data) loss,r2=boost.fit() boost.predict(test_data) x = np.arange(1,len(loss)+1) plt.plot(x,loss) plt.xlabel(u\"times\") plt.ylabel(u\"loss-value\") plt.show() æ¨¡å‹é¢„æµ‹å¹¶è¯„ä¼°ç»“æœç»“æœè¯„ä¼°æŒ‡æ ‡ï¼š $RMSE=\\sqrt{\\frac1n\\sum_{i=1}^n{(y-\\hat y)^2}}$ $R2=1-\\frac{RMSE}{var(y)}$ è¯¯å·®åˆ†å¸ƒç›´æ–¹å›¾ r=np.sqrt(np.sum((test_data[:,-2]-test_data[:,-1])**2/test_data.shape[0])) r2=(1-r**2/np.var(test_data[:,-2])) res=test_data[:,-1]-test_data[:,-2] res=np.sort(res) plt.hist(res, bins=30, rwidth=0.9, density=True) plt.xlabel(u\"data\") plt.ylabel(u\"num\") plt.show() print(test_data[:,-1]-test_data[:,-2]) print(r,r2) å®éªŒç»“æœä¸åˆ†æï¼ˆè°ƒå‚è¿‡ç¨‹ç•¥ï¼‰","categories":[{"name":"æœºå™¨å­¦ä¹ ","slug":"æœºå™¨å­¦ä¹ ","permalink":"http://sn1987a-1.github.io/categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/"}],"tags":[{"name":"ä¸“ä¸šè¯¾","slug":"ä¸“ä¸šè¯¾","permalink":"http://sn1987a-1.github.io/tags/%E4%B8%93%E4%B8%9A%E8%AF%BE/"}]},{"title":"MLç®—æ³•ï¼šSVM","slug":"SVM","date":"2023-11-10T12:48:34.000Z","updated":"2023-09-24T03:45:05.647Z","comments":true,"path":"posts/7ab554ae.html","link":"","permalink":"http://sn1987a-1.github.io/posts/7ab554ae.html","excerpt":"","text":"SVMå®éªŒç›®æ ‡å­¦ä¹ æ”¯æŒå‘é‡æœºçš„åŸç†ï¼Œç”¨ä¸¤ç§ä¸åŒçš„ç®—æ³•å¯»æ‰¾æ”¯æŒå‘é‡æœºçš„è§£ï¼Œå¹¶å®Œæˆæ¯”è¾ƒã€‚ å®éªŒåŸç†å¯¹äºç»™å®šæ ·æœ¬é›†ï¼ŒSVMçš„ä»»åŠ¡å°±æ˜¯åŸºäºæ ·æœ¬é›†åœ¨æ ·æœ¬ç©ºé—´ä¸­ç¡®å®šä¸€ä¸ªåˆ’åˆ†è¶…å¹³é¢ï¼Œå°†ä¸åŒç±»åˆ«çš„æ ·æœ¬åˆ†å¼€ï¼Œå³æ‰¾åˆ°w,bä½¿å¾—$y(w^T+b)\\ge1$æˆç«‹ï¼Œå¹¶å®ç°æœ€å¤§åŒ–é—´éš”ï¼Œå³æœ€å¤§åŒ–$||w||^{-1}$ã€‚ä¸ºæ±‚è§£wçš„æœ€ä¼˜è§£ï¼Œï¼Œç”±äºå®éªŒä¸­çš„æ•°æ®å¹¶ä¸å®Œå…¨æ˜¯çº¿æ€§å¯åˆ†çš„ï¼Œå› æ­¤é‡‡ç”¨ç¡¬é—´éš”çš„æ–¹æ³•æ±‚è§£å­˜åœ¨å›°éš¾ï¼Œæœ¬æ¬¡å®éªŒåˆ†åˆ«é‡‡ç”¨æ¢¯åº¦ä¸‹é™æ³•å’ŒSMOï¼ˆåºåˆ—æœ€å°ä¼˜åŒ–ç®—æ³•ï¼‰æ¥æ±‚è§£ã€‚ SVMçš„ä»»åŠ¡ï¼š min_W||w||^2/2\\\\ s.t. y_i(w^T)\\phi(x_i)+b)\\ge 1,i=1,2,...m æ¢¯åº¦ä¸‹é™æ³• SVMä¸­çš„æ¢¯åº¦ä¸‹é™æ–¹æ³•ä¹Ÿç±»ä¼¼äºé€»è¾‘å›å½’ä¸­çš„æ¢¯åº¦ä¸‹é™åŸç†ï¼Œæ ¹æ®è¿­ä»£çš„å€¼è®¡ç®—æŸå¤±å’Œæ¢¯åº¦æ›´æ–°å‚æ•°ï¼Œæ¯æ¬¡è¿­ä»£è¿‡ç¨‹ä¸­ï¼Œè®¡ç®—å½“å‰çš„$y*(w^T+b)$çš„å€¼ï¼Œå°†å€¼å°äºä¸€çš„æ ·æœ¬è¿›è¡Œç´¯åŠ è®¡ç®—æ¢¯åº¦ï¼Œæ ¹æ®æ¢¯åº¦å’Œå­¦ä¹ ç‡æ›´æ–°wå’Œbã€‚ SMO SMOç®—æ³•æ˜¯John Plattåœ¨ã€ŠSequential Minimal Optimization: A Fast Algorithm for Training Support Vector Machinesã€‹ä¸€æ–‡ä¸­æå‡ºçš„ç®—æ³•ï¼Œå¯¹äºè§£å†³ç¨€ç–æ•°æ®é›†ä¸Šçš„é—®é¢˜æœ‰ç€å¾ˆé«˜çš„æ•ˆç‡ã€‚å·²çŸ¥SVMçš„å¯¹å¶é—®é¢˜ä¸ºï¼š argmax\\sum _\\alpha ^N \\alpha _i-1/2*\\sum_{i=1}^N\\sum_{j=1}^Ny_iy_j\\alpha_i\\alpha_jx_i^Tx_j \\\\ s.t.\\alpha_i\\ge0,\\sum_{i=1}^T\\alpha_iy_i=0å…¶ä¸­ï¼Œæˆ‘ä»¬è¦å¯¹$ï¼ˆ\\alpha_1,\\alpha_2,â€¦,\\alpha_N)$è¿›è¡Œä¼˜åŒ–ï¼Œä½†æ•°æ®é›†è¾ƒå¤§æ—¶ï¼Œç›´æ¥å¯¹Nä¸ªå‚æ•°è¿›è¡Œä¼˜åŒ–çš„æ•ˆç‡å°†å¾ˆä½ï¼Œå› æ­¤é‡‡ç”¨SMOç®—æ³•æ±‚è§£ï¼ŒSMOçš„åŸç†æ˜¯å°†Nä¸ªå‚æ•°çš„ä¼˜åŒ–é—®é¢˜è½¬åŒ–ä¸ºå¤šä¸ªå­é—®é¢˜ï¼Œå…¶ä¸­æ¯ä¸ªå­é—®é¢˜åªå¯¹ä¸¤ä¸ªå‚æ•°è¿›è¡Œä¼˜åŒ–ï¼Œæ¯æ¬¡è®¡ç®—å¹¶é€‰å–ä¸€å¯¹æœ€ä¼˜çš„$(\\alpha_i,\\alpha_j)$æ›´æ–°å¯¹åº”çš„$\\alpha$å€¼ã€‚ å®éªŒæ­¥éª¤æ¢¯åº¦ä¸‹é™æ³• æŸå¤±å‡½æ•°$loss=1/2*w^tw+\\sum_{i=1}^mmax{0,1-y_i(wx_i-b)}$ mar=y*(np.dot(X,self.w)+self.b) lo=0.5*np.sum(np.square(self.w))+np.maximum(0, 1 - mar).sum() if lo&lt;tol : break æŸå¤±å‡½æ•°çš„æ¢¯åº¦$\\Delta=\\lambda w-\\sum{i=1}^mI|wx_i+b&lt;1|*x_iy_i$ï¼Œæ ¹æ®æ¢¯åº¦æ›´æ–°wå’Œb for i in range(len(y)): if y[i]*(X[i].dot(self.w)+self.b) &lt;= 1: self.w -= lr * (-y[i]*X[i].reshape((len(X[i]),1))) self.b -= lr * -y[i] SMO é¢„å…ˆå­˜å‚¨éƒ¨åˆ†æ•°æ®ï¼Œæé«˜è¿ç®—æ•ˆç‡ self.m=X.shape[0] self.alpha=np.zeros((self.m,1))#æ¯æ¬¡è¿­ä»£æ›´æ–° self.err=-self.y.flatten()#æ¯æ¬¡è¿­ä»£æ›´æ–° #ä»¥ä¸‹æ˜¯ä¸ºäº†æ–¹ä¾¿è®¡ç®—lossçš„å€¼ï¼Œä¸éœ€è¦è®¡ç®—losså€¼æ—¶æ— éœ€è®¡ç®—ï¼Œæ›´èŠ‚çœæ—¶é—´å’Œå†…å­˜ self.kappa_x=self.kappa(self.X,self.X) self.mulyx=np.outer(self.y,self.y)*self.kappa_x self.outer_a=np.zeros((self.m,self.m))#æ¯æ¬¡è¿­ä»£æ›´æ–° æŸå¤±å‡½æ•°$\\sum _\\alpha ^N \\alpha _i-1/2*\\sum_{i=1}^N\\sum_{j=1}^Ny_iy_j\\alpha_i\\alpha_jx_i^Tx_j$ 0.5*(np.sum(self.mulyx*self.outer_a)-np.sum(self.alpha)) é€‰å–åˆé€‚çš„$(\\alpha _i,\\alpha_j)$ ç»Ÿè®¡è¯¯å·®ä¸ä¸º0çš„ç´¢å¼•å€¼ï¼Œæœ‰ä¸ä¸ºé›¶çš„è¯¯å·®æ—¶ç»Ÿè®¡è¯¯å·® æ²¡æœ‰ä¸ºé›¶è¯¯å·®æ—¶ï¼Œéšæœºé€‰å–$\\alpha$ if arrlen&gt; 1: t=np.argmax(np.abs(self.err-ei)) if t!=i and self.step(t,i)==1: return 1 arr=np.where((self.alpha!=0 )&amp; (self.alpha!=self.c))[0] ra=np.roll(arr,np.random.choice(np.arange(self.m))) for j in ra: if j!=i and self.step(j,i)==1: return 1 ra=np.roll(np.arange(self.m), np.random.choice(np.arange(self.m))) for j in ra: if j!=i and self.step(j,i)==1: return 1 æ¯æ¬¡è¿­ä»£æ›´æ–°æ•°æ® if y1 !=y2:#å–Lï¼ŒH t1=max(0,a2-a1) t2=min(0,a2-a1)+self.c else: t1=max(self.c,a1+a2)-self.c t2=min(self.c,a1+a2) if t1==t2: return 0 t3=k11+k22-2*k12 if t3&gt;0:#æ±‚è§£\\alphaæ–°å€¼ al2 = a2+y2*(e1-e2)/t3 if al2&lt;t1: al2=t1 elif al2&gt;t2: al2=t2 else: #æ„å¤–æƒ…å†µ,å¾ˆå°‘å‡ºç° self.alpha[i2]=t1 loss1=self.calloss() self.alpha[i2]=t2 loss2=self.calloss() self.alpha[i2]=a2 if loss1-loss2&gt;self.eps: al2=t2 elif loss2-loss1&gt;self.eps: al2=t1 else: al2=a2 if al2&lt;=0: al2=0.0 #æˆªæ–­å¤„ç† al2=max(al2,0.0) al2=min(al2,self.c) if np.abs(al2-a2)&lt;self.eps*(al2 + a2 + self.eps): return 0 al1=a1+(a2-al2)*y1*y2 b1 = e1 + y1*(al1 - a1)*k11 + y2*(al2 - a2)*k12 + self.b b2 = e2 + y1*(al1 - a1)*k12 + y2*(al2 - a2)*k22 + self.b #æ ¹æ®ä»¥ä¸Šçš„al1ï¼Œal2ï¼Œb1ï¼Œb2æ›´æ–°å‚æ•°çš„å€¼ï¼šb,alpha,err è¿­ä»£ changeï¼šä¸Šä¸€è½®è¿­ä»£ä¸­å‘ç”Ÿæ”¹å˜çš„æ•°ç›® entireï¼šæ˜¯å¦å¯¹å…¨éƒ¨çš„å‚æ•°è¿›è¡Œæ£€æŸ¥ ep:è®°å½•è¿­ä»£æ¬¡æ•°ï¼Œè¿­ä»£æ¬¡æ•°åˆ°æœ€å¤§æ—¶é€€å‡ºå¾ªç¯ while change&gt;0 or entire: change=0 if entire : for i in range(self.m): if self.examine(i): change+=1 else: ra=np.where((self.alpha!=0) &amp; (self.alpha!=self.c))[0] for i in ra: if self.examine(i): change+=1 if(ep&gt;self.max_iters): break if entire==1: entire=0 elif change==0: entire=1 æ•°æ®å¤„ç†ï¼Œé¢„æµ‹å’Œåˆ†ææœ¬æ¬¡å®éªŒå¯¹è®­ç»ƒé›†å’Œæµ‹è¯•é›†æŒ‰ç…§8ï¼š2è¿›è¡Œåˆ’åˆ†ï¼š mu = np.mean(X_norm,0) sigma = np.std(X_norm,0) for i in range(X.shape[1]): X_norm[:,i]=(X_norm[:,i]-mu[i])/sigma[i] y=np.array(y) num=np.random.permutation(len(y)) X_norm=X_norm[num] y=y[num] a=int(0.2*len(y)) X_test=X_norm[0:a-1,:] X_train=X_norm[a:,:] y_test=y[0:a-1] y_train=y[a:] é¢„æµ‹å‡½æ•°ï¼š m,n=X.shape ##SMO: p=np.dot(self.kappa(X, self.X),self.alpha*self.y) - self.b ##GD: p=np.dot(X,self.w)+self.b for i in range(m): ans=np.sign(p[i]) res.append(ans) æŸå¤±æ›²çº¿ï¼š loss=model2.fit(X_train,y_train) x = np.arange(1,len(loss)+1) plt.plot(x,loss) plt.xlabel(u\"times\") plt.ylabel(u\"loss-value\") plt.show() æ•°æ®åˆ†æ pred2 = model.predict(X_test) m = len(y_test) for i in range(m): if(y_test[i]&gt;0 and pred2[i]&gt;0): sum+=1 if(y_test[i]&lt;0 and pred2[i]&lt;0): sum+=1 print(sum/m) #SVMé¢„æµ‹çš„å‡†ç¡®ç‡ for i in range(m): if pred1[i]==pred2[i]: i+=1 print(i/m) #SVM1ï¼ŒSVM2çš„é¢„æµ‹ç›¸ä¼¼ç‡ å®éªŒç»“è®ºå’Œåˆ†ææ¢¯åº¦ä¸‹é™æ³•å‚æ•°è§£é‡Šï¼š Xï¼Œè®­ç»ƒé›†X yï¼Œè®­ç»ƒé›† lrï¼Œå­¦ä¹ ç‡ï¼Œé»˜è®¤ä¸º0.001 max_itersï¼Œæœ€å¤§è¿­ä»£æ¬¡æ•°ï¼Œé»˜è®¤ä¸º1000 tolï¼Œæœ€å°è¯¯å·®ï¼Œ 0.0001 è®­ç»ƒä¸€æ¬¡çš„æŸå¤±æ›²çº¿å¦‚ä¸‹æ‰€ç¤ºï¼ˆæ•°æ®è§„æ¨¡ä¸º10000ï¼Œç»´åº¦ä¸º20ï¼Œè®­ç»ƒæ—¶é—´ä¸º41.2sï¼‰ï¼Œåˆå§‹çš„losså€¼è¾ƒå¤§æ˜¯è®­ç»ƒæ—¶é¢„è®¾äº†wçš„å€¼ä¸ºéšæœºç”Ÿæˆnp.random.randn(col,1). å‡†ç¡®ç‡ï¼š96.1% å¯ä»¥çœ‹å‡ºæ¢¯åº¦ä¸‹é™çš„æ”¶æ•›æ•ˆæœè¾ƒå¥½ï¼Œåœ¨è®­ç»ƒæ¬¡æ•°è¾ƒä½æ—¶æŸå¤±å‡½æ•°æ˜¾è‘—é™ä½ï¼Œå¾—åˆ°çš„ç»“æœå‡†ç¡®ç‡ä¹Ÿè¾ƒé«˜ã€‚ è€Œå½“å­¦ä¹ ç‡å˜å¤§ï¼ˆæ”¹ä¸ºlr=0.1)æ—¶ï¼ŒæŸå¤±å‡½æ•°ä¼šå‘ç”Ÿéœ‡è¡ï¼Œå¯¼è‡´é¢„æµ‹çš„å‡†ç¡®ç‡é™ä½ SMOå‚æ•°è§£é‡Šï¼š dimï¼šæ•°æ®çš„ç»´åº¦ cï¼šæ¾å¼›å˜é‡ï¼Œé»˜è®¤ä¸º1.0 epsï¼šå®¹é”™ç‡ï¼Œé»˜è®¤ä¸º0.01 max_iters:æœ€å¤§è¿­ä»£æ¬¡æ•°ï¼Œé»˜è®¤ä¸º1000 kappaå‡½æ•°ï¼šé€‰å–çš„æ ¸å‡½æ•°ç±»å‹ï¼Œé»˜è®¤ä¸ºlinear è®­ç»ƒä¸€æ¬¡çš„æŸå¤±æ›²çº¿ï¼ˆæ•°æ®è§„æ¨¡ä¸º2000ï¼Œ20ç»´ï¼Œè®­ç»ƒæ¬¡æ•°1000ï¼Œè®­ç»ƒæ—¶é—´10sï¼‰ æ¢¯åº¦ä¸‹é™æ³•å’ŒSMOçš„å¯¹æ¯”æ€»ä½“æ¥è¯´ï¼Œæ¢¯åº¦ä¸‹é™æ³•å’ŒSMOçš„å‡†ç¡®ç‡å‡åœ¨90%ä»¥ä¸Šï¼Œæ”¶æ•›çš„é€Ÿåº¦éƒ½å¾ˆå¿«ï¼Œå¯¹ç»“æœé¢„æµ‹çš„ç›¸ä¼¼åº¦ä¸º97%ï¼Œä¸¤ç§æ¨¡å‹çš„è®­ç»ƒæ•ˆæœå‡è¾ƒå¥½ï¼Œæ¢¯åº¦ä¸‹é™çš„å‡†ç¡®ç‡ç›¸å¯¹æ›´é«˜ï¼Œè®­ç»ƒè¿‡ç¨‹ç›¸å¯¹æ›´ç›´è§‚ï¼›SMOçš„ä¼˜åŠ¿åœ¨äºæ¯æ¬¡åªå¯¹æœ€å°çš„é—®é¢˜è¿›è¡Œä¼˜åŒ–ï¼Œé—®é¢˜è§„æ¨¡å°ï¼Œå ç”¨çš„å†…å­˜å°‘ï¼Œå¯¹ç¡¬ä»¶çš„è¦æ±‚ä½ï¼Œå¯¹äºä¸åŒçš„å‚æ•°ï¼Œæˆ–è€…è¾ƒå¤§æˆ–è¾ƒå°çš„æ•°æ®é›†éƒ½æœ‰è¾ƒå¥½çš„ç»“æœã€‚","categories":[{"name":"æœºå™¨å­¦ä¹ ","slug":"æœºå™¨å­¦ä¹ ","permalink":"http://sn1987a-1.github.io/categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/"}],"tags":[{"name":"ä¸“ä¸šè¯¾","slug":"ä¸“ä¸šè¯¾","permalink":"http://sn1987a-1.github.io/tags/%E4%B8%93%E4%B8%9A%E8%AF%BE/"}]},{"title":"ç¼–è¯‘åŸç†-LLVM IRè¯­æ³•","slug":"ç¼–è¯‘åŸç†2","date":"2023-10-17T12:48:34.000Z","updated":"2023-09-24T05:28:23.642Z","comments":true,"path":"posts/615503d3.html","link":"","permalink":"http://sn1987a-1.github.io/posts/615503d3.html","excerpt":"","text":"é—®é¢˜1: getelementptrè¯·ç»™å‡º IR.md ä¸­æåˆ°çš„ä¸¤ç§ getelementptr ç”¨æ³•çš„åŒºåˆ«,å¹¶ç¨åŠ è§£é‡Š: %2 = getelementptr [10 x i32], [10 x i32]* %1, i32 0, i32 %0 %2 = getelementptr i32, i32* %1, i32 %0 ä¸¤ç§GEPéƒ½æ˜¯å–æ•°ç»„ä¸­çš„ç‰¹å®šå…ƒç´ çš„åœ°å€æŒ‡é’ˆï¼ŒåŒºåˆ«åœ¨äºï¼ˆ1ï¼‰è®¡ç®—åŸºç¡€ç±»å‹ä¸ºæ•°ç»„æŒ‡é’ˆï¼Œï¼ˆ2ï¼‰ä¸­çš„è®¡ç®—åŸºç¡€ç±»å‹ä¸ºå…ƒç´ æŒ‡é’ˆï¼Œ (1)ä¸­çš„ç”¨æ³•æ˜¯å€ŸåŠ©é•¿åº¦ä¸º10ï¼Œæ•°æ®ç±»å‹ä¸ºi32çš„æ•°ç»„æŒ‡é’ˆå–å…¶ä¸­æŸä¸ªå…ƒç´ çš„åœ°å€æŒ‡é’ˆï¼Œå…¶ä¸­æ•°æ®ç´¢å¼•çš„åç§»æœ‰ä¸¤ä¸ªï¼Œå› ä¸ºæ•°æ®ç±»å‹æ˜¯[10 x i32],ç¬¬ä¸€ä¸ªåç§»å¯¹åº”çš„å†…å­˜åç§»é‡ä¸ºåç§»å€¼ï¼ˆ0ï¼‰ x 10 x 4ï¼Œç¬¬äºŒä¸ªåç§»å¯¹åº”çš„å†…å­˜åç§»é‡ä¸ºåç§»å€¼ï¼ˆ%0ï¼‰ x 4ï¼Œåç§»é‡ä¸åŸåœ°å€ç›¸åŠ è®¡ç®—å¾—åˆ°çš„æ•°æ®å­˜å…¥%2ä¸­ï¼Œç±»å‹ä¸ºi32ï¼›ï¼ˆ2ï¼‰ä¸­çš„ç”¨æ³•æ˜¯é€šè¿‡å…ƒç´ æŒ‡é’ˆå’Œåç§»å€¼å¾—åˆ°æŸä¸ªå…ƒç´ çš„åœ°å€æŒ‡é’ˆï¼Œæ•°æ®ç±»å‹ä¸ºi32ï¼Œå› æ­¤åªæœ‰ä¸€ä¸ªåç§»å€¼ï¼Œå¯¹åº”çš„å†…å­˜åç§»é‡ä¸ºåç§»å€¼ï¼ˆ%0ï¼‰ x 4ï¼Œåç§»é‡ä¸åŸåœ°å€ç›¸åŠ è®¡ç®—å¾—åˆ°çš„æ•°æ®å­˜å…¥%2ä¸­ï¼Œç±»å‹ä¸ºi32ã€‚ é—®é¢˜2: cpp ä¸ .ll çš„å¯¹åº” assign ä¸å«æœ‰è½¬ç§»æŒ‡ä»¤ï¼Œå› æ­¤æ•´ä¸ªå‡½æ•°ä¸»ä½“éƒ¨åˆ†ä¸.llæ–‡ä»¶mainå‡½æ•°éƒ¨åˆ†å¯¹åº” fun std::vector&lt;Type *&gt; Ints(1, Int32Type); auto calleeFunType = FunctionType::get(Int32Type, Ints); auto calleeFun = Function::create(calleeFunType, \"callee\", module); auto bb = BasicBlock::create(module, \"entry\", calleeFun); builder-&gt;set_insert_point(bb); std::vector&lt;Value *&gt; args; for (auto arg = calleeFun-&gt;arg_begin(); arg != calleeFun-&gt;arg_end(); arg++) { args.push_back(*arg); } auto temp = builder-&gt;create_imul(CONST_INT(2),args[0]); builder-&gt;create_ret(temp); /*å¯¹åº”ï¼š define dso_local i32 @callee (i32 %0) #0 { %2 = mul i32 2,%0 ret i32 %2 } */ auto mainFun = Function::create(FunctionType::get(Int32Type, {}), \"main\", module); bb = BasicBlock::create(module, \"entry\", mainFun); builder-&gt;set_insert_point(bb); auto call = builder-&gt;create_call(calleeFun, {CONST_INT(110)}); /*å¯¹åº”ï¼š define dso_local i32 @main () #0{ %1 = call i32 @callee(i32 110) */ builder-&gt;create_ret(call); /*å¯¹åº”ï¼š ret i32 %1 */ if auto mainFun = Function::create(FunctionType::get(Int32Type, {}), \"main\", module); auto bb = BasicBlock::create(module, \"entry\", mainFun); builder-&gt;set_insert_point(bb); auto aAlloca = builder-&gt;create_alloca(FloatTypenum); builder-&gt;create_store(CONST_FP(5.555),aAlloca); auto aload = builder-&gt;create_load(aAlloca); auto fcmp = builder-&gt;create_fcmp_gt(aload,CONST_FP(1.0)); auto trueBB = BasicBlock::create(module, \"trueBB\", mainFun); auto falseBB = BasicBlock::create(module, \"falseBB\", mainFun); auto br = builder-&gt;create_cond_br(fcmp, trueBB, falseBB); /*å¯¹åº”ï¼š %1 = alloca float store float 0x40163851E0000000, float* %1 %2 = load float, float* %1 %3 = fcmp ogt float %2,1.000000e+00 br i1 %3, label %4, label %5 */ builder-&gt;set_insert_point(trueBB); builder-&gt;create_ret(CONST_INT(233)); /*å¯¹åº”ï¼š 4: ret i32 233 */ builder-&gt;set_insert_point(falseBB); builder-&gt;create_ret(CONST_INT(0)); /*å¯¹åº”ï¼š 5: ret i32 0 */ while auto aAlloca = builder-&gt;create_alloca(Int32Type); auto iAlloca = builder-&gt;create_alloca(Int32Type); builder-&gt;create_store(CONST_INT(10),aAlloca); builder-&gt;create_store(CONST_INT(0),iAlloca); builder-&gt;create_br(loopBB); /*å¯¹åº”ï¼š %1 = alloca i32 store i32 10,i32* %1 %2 = alloca i32 store i32 0,i32* %2 br label %3 */ builder-&gt;set_insert_point(loopBB); auto iLoad = builder-&gt;create_load(iAlloca); auto icmp = builder-&gt;create_icmp_lt(iLoad,CONST_INT(10)); auto br = builder-&gt;create_cond_br(icmp, trueBB, falseBB); /*å¯¹åº”ï¼š 3: %4 = load i32, i32* %2 %5 = icmp slt i32 %4,10 br i1 %5,label %6,label %11 */ builder-&gt;set_insert_point(trueBB); auto temp = builder-&gt;create_iadd(iLoad,CONST_INT(1)); builder-&gt;create_store(temp,iAlloca); iLoad = builder-&gt;create_load(iAlloca); auto aLoad = builder-&gt;create_load(aAlloca); auto temp1 = builder-&gt;create_iadd(aLoad,iLoad); builder-&gt;create_store(temp1,aAlloca); builder-&gt;create_br(loopBB); /*å¯¹åº”ï¼š 6: %7 = add i32 %4,1 store i32 %7, i32* %2 %8 = load i32, i32* %2 %9 = load i32, i32* %1 %10 = add i32 %8,%9 store i32 %10, i32* %1 br label %3 */ builder-&gt;set_insert_point(falseBB); aLoad = builder-&gt;create_load(aAlloca); builder-&gt;create_ret(aLoad); /* å¯¹åº”ï¼š 11: %12 = load i32, i32* %1 ret i32 %12 */ é—®é¢˜3: Visitor Patternåˆ†æ calc ç¨‹åºåœ¨è¾“å…¥ä¸º 4 * (8 + 4 - 1) / 2 æ—¶çš„è¡Œä¸ºï¼š è¯·ç”»å‡ºè¯¥è¡¨è¾¾å¼å¯¹åº”çš„æŠ½è±¡è¯­æ³•æ ‘ï¼ˆä½¿ç”¨ calc_ast.hpp ä¸­çš„ CalcAST* ç±»å‹å’Œåœ¨è¯¥ç±»å‹ä¸­å­˜å‚¨çš„å€¼æ¥è¡¨ç¤ºï¼‰ï¼Œå¹¶ç»™èŠ‚ç‚¹ä½¿ç”¨æ•°å­—ç¼–å·ã€‚ è¯·æŒ‡å‡ºç¤ºä¾‹ä»£ç åœ¨ç”¨è®¿é—®è€…æ¨¡å¼éå†è¯¥è¯­æ³•æ ‘æ—¶çš„éå†é¡ºåºã€‚ åºåˆ—è¯·æŒ‰å¦‚ä¸‹æ ¼å¼æŒ‡æ˜ï¼ˆåºå·ä¸ºé—®é¢˜ 3.1 ä¸­çš„ç¼–å·ï¼‰ï¼š 3-&gt;2-&gt;5-&gt;1 æŠ½è±¡è¯­æ³•æ ‘ï¼š éå†é¡ºåºï¼š 1-&gt;2-&gt;3-&gt;4-&gt;6-&gt;8-&gt;7-&gt;9-&gt;11-&gt;14-&gt;16-&gt;12-&gt;15-&gt;10-&gt;13-&gt;5 å®éªŒè¦æ±‚æœ¬æ¬¡å®éªŒçš„æ ¸å¿ƒä»»åŠ¡æ˜¯ä½¿ç”¨è®¿é—®è€…æ¨¡å¼æ¥å®ç°cminus-f è¯­è¨€çš„LLVM IR çš„è‡ªåŠ¨ç”Ÿæˆã€‚ å®éªŒéš¾ç‚¹ æ•°æ®ç±»å‹ä¸åŒ¹é…æ—¶åŠæ—¶è¿›è¡Œæ•°æ®è½¬æ¢ï¼Œå¦‚ä»¥ä¸‹æƒ…å†µ assignè¯­å¥ æ¯”è¾ƒ/è®¡ç®—ç­‰äºŒå…ƒè¿ç®—çš„å‚æ•°ç±»å‹ä¸ä¸€è‡´ è®¡ç®—æ•°ç»„ä¸‹æ ‡çš„ç»“æœå¹¶éintå‹ å‡½æ•°å‚æ•°ç±»å‹å’Œè°ƒç”¨æ—¶çš„å®å‚ç±»å‹ä¸åŒ¹é… å‡½æ•°è¿”å›å€¼çš„è¡¨è¾¾å¼å’Œç±»å‹ä¸åŒ¹é… å…¶ä¸­int,floatä¹‹é—´çš„è½¬æ¢éœ€è¦çš„å‡½æ•°ä¸ºcreate_sitofp,create_fptosi,int1å’Œint32ä¹‹é—´çš„è½¬æ¢éœ€è¦çš„å‡½æ•°ä¸ºcreate_zext,create_icmp_ne(*,CONST_INT(0))ã€‚ åŒºåˆ«å…ƒç´ å€¼å’Œå…ƒç´ åœ°å€ï¼ŒäºŒè€…å­˜å‚¨çš„æ•°æ®ç±»å‹å‡ä¸ºValue *ç±»å‹ï¼Œæœ¬å®éªŒä¸­ï¼Œè®¾ç½®ä¸¤ä¸ªå…¨å±€å˜é‡cur_val,cur_expråˆ†åˆ«å­˜å‚¨åœ°å€å’Œå€¼ï¼Œå…¶ä¸­åœ°å€ä»…åœ¨æŒ‡é’ˆ/æ•°ç»„è¿ç®—ä»¥åŠèµ‹å€¼è¯­å¥è¢«ç”¨åˆ°ã€‚ åŒºåˆ†æŒ‡é’ˆç±»å‹å’Œæ•°ç»„ç±»å‹ï¼Œæ ¹æ®lab2é—®é¢˜1ï¼Œè·å–å…ƒç´ çš„åœ°å€æœ‰ä¸¤ç§æ–¹æ³•ï¼Œåˆ†åˆ«æ˜¯ä½œä¸ºæŒ‡é’ˆæ ¹æ®åŸºå…ƒç´ çš„å€¼è¿›è¡Œè¿ç®—ï¼Œå’Œä½œä¸ºæ•°ç»„ç±»å‹çš„æŒ‡é’ˆæ ¹æ®åŸºå…ƒç´ çš„åœ°å€è¿›è¡Œè®¡ç®—ï¼Œåœ¨è°ƒç”¨æ—¶è¦åŠ ä»¥åŒºåˆ†ã€‚ å‡½æ•°å½¢å‚å’Œå®å‚çš„å¤„ç† å®éªŒè®¾è®¡å…¨å±€å˜é‡ number åœ¨å¯¹åŸºæœ¬å—è¿›è¡Œå‘½åæ—¶ï¼Œå¦‚æœç¨‹åºä¸­å­˜åœ¨å¤šä¸ªç±»å‹ç›¸åŒçš„åŸºæœ¬å—ï¼Œåˆ™ä¼šå‘ç”Ÿå†²çªï¼Œå› æ­¤è®¾ç½®ä¸€ä¸ªintç±»å‹çš„å…¨å±€å˜é‡ï¼Œæ¯é‡åˆ°éœ€è¦æ˜¾ç¤ºå‘½åçš„åŸºæœ¬å—ï¼Œåˆ™å°†å½“å‰numberçš„å€¼è½¬åŒ–ä¸ºå­—ç¬¦ä¸²åŠ å…¥åŸºæœ¬å—çš„å‘½åä¸­(std::to_string(number++))ã€‚ cur_val &amp; cur_expr cur_valè®°å½•å½“å‰æ•°æ®å¯¹åº”çš„åœ°å€ï¼Œå¦‚è¿è¡Œèµ‹å€¼è¯­å¥æ—¶ï¼Œå³å€¼è®¡ç®—çš„æ•°å€¼å°†å­˜å‚¨åˆ°å·¦å€¼ä¸­å¯¹åº”çš„åœ°å€ä¸­ï¼Œä»¥åŠæ ¹æ®åŸºåœ°å€è®¡ç®—æ•°ç»„æŸä¸ªå…ƒç´ å¯¹åº”çš„ä½ç½®ï¼› cur_exprè®°å½•å½“å‰æ•°æ®å¯¹åº”çš„å€¼çš„æ‹·è´ï¼Œç”¨äºå„ç±»è¡¨è¾¾å¼çš„è®¡ç®—å’Œèµ‹å€¼ï¼Œè°ƒç”¨create_load(cur_val)å³å¯å¾—åˆ°å½“å‰æ•°æ®åœ°å€çš„å¯¹åº”çš„å€¼ã€‚ ä¼˜åŒ– SelectionStmtéƒ¨åˆ†ï¼Œåœ¨trueBBï¼ŒfalseBBå¯¹åº”çš„è¯­å¥æ‰§è¡Œç»“æŸåï¼Œå¦‚æœåœ¨æ‰§è¡Œå®Œçš„åŸºæœ¬å—ä¸­æ²¡æœ‰ç»ˆæ­¢è¯­å¥ï¼Œåˆ™ä¸ä¼šäº§ç”Ÿå‘ä¸‹ä¸€ä¸ªåŸºæœ¬å—çš„è·³è½¬ã€‚ int exist=0; if(builder-&gt;get_insert_block()-&gt;get_terminator()==nullptr) { retBB=BasicBlock::create(module.get(),\"retBB\"+std::to_string(number),cur_fun); builder-&gt;create_br(retBB); exist=1; } if(builder-&gt;get_insert_block()-&gt;get_terminator()==nullptr) { if(exist==0) { retBB=BasicBlock::create(module.get(),\"retBB\"+std::to_string(number),cur_fun); builder-&gt;create_br(retBB); exist=1; } else builder-&gt;create_br(retBB); } iterationåŒç† æ•°ç»„è´Ÿä¸‹æ ‡æ£€æµ‹,è°ƒç”¨neg_idx_expectå‡½æ•°ï¼Œä»…å¯¹è´Ÿä¸‹æ ‡è¿›è¡Œæ£€æµ‹ï¼Œä¸ä¼šå¯¹æ•°ç»„çš„ä¸Šç•Œè¿›è¡Œæ£€æŸ¥ï¼ˆå³è¶Šç•Œè®¿é—®ï¼‰ auto b=builder-&gt;create_icmp_lt(cur_expr,CONST_INT(0)); auto trueBB=...; autofalseBB=...; auto br=builder-&gt;create_cond_br(b,trueBB,falseBB); builder-&gt;set_insert_point(trueBB); auto err=scope.find(\"neg_idx_except\"); builder-&gt;create_call(err,{}); builder-&gt;create_br(falseBB); builder-&gt;set_insert_point(falseBB); å‡½æ•°å£°æ˜éƒ¨åˆ†ï¼Œå¯¹å‡½æ•°å‚æ•°çš„å¤„ç†ä»…åœ¨FunDeclarationéƒ¨åˆ†å®Œæˆï¼Œæœªè°ƒç”¨ASTParaméƒ¨åˆ†ã€‚ å®éªŒæ€»ç»“ å®éªŒæ¡†æ¶çš„åŸºæœ¬æ€è·¯æ˜¯è®¿é—®è€…æ¨¡å¼å®ç°LRçš„è‡ªåŠ¨ç”Ÿæˆï¼Œå’Œlab2ä¸­é—®é¢˜ä¸‰çš„æ€è·¯ç±»ä¼¼ã€‚ åŠ æ·±äº†å¯¹æ•°ç»„å’ŒæŒ‡é’ˆç±»å‹çš„ç†è§£ï¼Œä»¥åŠå¯¹åŸºæœ¬å—ï¼Œè·³è½¬è¯­å¥ç­‰çš„ç†è§£ å¯¹C++çš„è¯­æ³•æŒæ¡æ›´å¤š","categories":[{"name":"ç¼–è¯‘åŸç†","slug":"ç¼–è¯‘åŸç†","permalink":"http://sn1987a-1.github.io/categories/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86/"}],"tags":[{"name":"ä¸“ä¸šè¯¾","slug":"ä¸“ä¸šè¯¾","permalink":"http://sn1987a-1.github.io/tags/%E4%B8%93%E4%B8%9A%E8%AF%BE/"}]},{"title":"LLVM IRè¯­æ³•","slug":"ç¼–è¯‘åŸç†3","date":"2023-10-17T12:48:34.000Z","updated":"2023-09-24T05:27:12.380Z","comments":true,"path":"posts/b38fcafd.html","link":"","permalink":"http://sn1987a-1.github.io/posts/b38fcafd.html","excerpt":"","text":"","categories":[{"name":"ç¼–è¯‘åŸç†","slug":"ç¼–è¯‘åŸç†","permalink":"http://sn1987a-1.github.io/categories/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86/"}],"tags":[{"name":"ä¸“ä¸šè¯¾","slug":"ä¸“ä¸šè¯¾","permalink":"http://sn1987a-1.github.io/tags/%E4%B8%93%E4%B8%9A%E8%AF%BE/"}]},{"title":"MLç®—æ³•ï¼šé€»è¾‘å›å½’","slug":"é€»è¾‘å›å½’","date":"2023-10-17T12:48:34.000Z","updated":"2023-09-24T03:48:50.515Z","comments":true,"path":"posts/f1383170.html","link":"","permalink":"http://sn1987a-1.github.io/posts/f1383170.html","excerpt":"","text":"é€»è¾‘å›å½’å®éªŒå†…å®¹åŠæ­¥éª¤æœ¬å®éªŒä¸»è¦åˆ©ç”¨é€»è¾‘å›å½’(logistics regression)å¯¹kaggleæ•°æ®é›†è¿›è¡Œåˆ†æé¢„æµ‹ã€‚ æ•°æ®å¤„ç† #NULLé¡¹èˆå¼ƒ df=df.dropna() ENcodeï¼Œå°†éæ•°å­—å‹çš„å±æ€§å€¼ç¼–ç ä¸º0~1çš„æ•°å­— df.Gender=df.Gender.map({'Male':1,'Female':0}) df.Married=df.Married.map({'Yes':1,'No':0}) df.Dependents=df.Dependents.map({'1':0,'0':0.3,'2':0.6,'3+':1}) df.Education=df.Education.map({'Graduate':1,'Not Graduate':0}) df.Self_Employed=df.Self_Employed.map({'Yes':1,'No':0}) df.Property_Area=df.Property_Area.map({'Rural':0,'Urban':0.5,'Semiurban':1}) df.Loan_Status=df.Loan_Status.map({'Y':1,'N':0}) æ•°æ®å½’ä¸€åŒ–ï¼Œé‡‡ç”¨$X_{norm}=(X-\\mu)/\\sigma$ï¼Œå…¶ä¸­$\\mu$ä¸ºå¹³å‡å€¼ï¼Œ$\\sigma$ä¸ºæ ‡å‡†å·® import numpy as np from sklearn.model_selection import train_test_split X = df.drop([\"Loan_Status\"], axis=1) y = df[\"Loan_Status\"] X_norm=np.array(X) mu = np.mean(X_norm,0) sigma = np.std(X_norm,0) for i in range(X.shape[1]): X_norm[:,i]=(X_norm[:,i]-mu[i])/sigma[i] åˆ’åˆ†è®­ç»ƒé›†å’Œæµ‹è¯•é›†ï¼Œæ­¤å¤„é‡‡ç”¨è®­ç»ƒé›†ï¼šæµ‹è¯•æœº=8ï¼š2çš„æ–¹å¼è¿›è¡Œåˆ’åˆ†ï¼Œåˆ©ç”¨permutation()å‡½æ•°è¿›è¡Œå¤„ç† num=np.random.permutation(len(y)) X_norm=X_norm[num] y=y[num] a=int(0.2*len(y)) X_test=X_norm[0:a-1,:] X_train=X_norm[a:,:] y_test=y[0:a-1] y_train=y[a:] è®­ç»ƒéƒ¨åˆ†é¢„å¤„ç† col=X.shape[1]+1 m=len(y) X=np.array(X) X = np.hstack((np.ones((m,1)),X)) y=np.array(y).reshape(-1,1) theta=np.zeros((col,1)) n=len(theta) temp=np.matrix(np.zeros((n,int(max_iter)))) æŸå¤±å‡½æ•°ï¼šåˆ©ç”¨äº¤å‰ç†µæŸå¤±å‡½æ•°è®¡ç®— loss=-np.dot(np.transpose(np.log(self.sigmoid(X,theta))),y)/m-np.dot(np.transpose(np.log(1-self.sigmoid(X,theta))),1-y)/m æ¢¯åº¦ä¸‹é™ grad=np.dot(np.transpose(X),self.sigmoid(X,theta)-y) æ­£åˆ™åŒ–ï¼Œå…¶ä¸­L1ç›¸å½“äºæ·»åŠ 1-èŒƒæ•°é¡¹ï¼ŒL2ç›¸å½“äºåœ¨æŸå¤±å‡½æ•°ä¸­æ·»åŠ 2-èŒƒæ•°é¡¹ if self.penalty==\"l1\": loss+=self.gamma*np.sum(np.abs(theta))/m grad+=self.gamma*np.sign(theta) else: loss+=self.gamma*np.sum(np.square(theta))/m grad+=self.gamma*theta è®­ç»ƒéƒ¨åˆ†å‡½æ•°ä¸»ä½“ for i in range(int(max_iter)): #è®¡ç®—losså’Œgard temp[:,i]=theta-(lr/m)*grad theta=temp[:,i] m = len(y) j_history=np.append(j_history,np.sum(np.square(loss)) if np.sum(np.square(loss))&lt;tol: break sigmoidå‡½æ•° return 1.0/(1+np.exp(-np.dot(w,x))) é¢„æµ‹å‡½æ•° def predict(self, X,y,theta): m=len(y) X=np.array(X) X=np.hstack((np.ones((m,1)),X)) p=np.dot(X,theta) p=p.reshape(-1,1) y=np.array(y).reshape(-1,1) sum=0 for i in range(m): if y[i]==1 and p[i]&gt;0: sum+=1 elif y[i]==0 and p[i]&lt;0: sum+=1 return sum/m å®éªŒç»“æœåŠåˆ†æé‡‡ç”¨å®éªŒé»˜è®¤å‚æ•°è¿›è¡Œè®­ç»ƒï¼šlr=0.01, tol=1e-7, max_iter=3e3,penalty=â€l2â€,gamma=0,fit_intercept=True Acc=83.2% å‚æ•°æ¯”è¾ƒ é¦–å…ˆå¯¹ä¸åŒçš„å­¦ä¹ ç‡è¿›è¡Œæ¯”è¾ƒï¼Œå¦‚ä¸‹ä¸ºä¸åŒçš„å­¦ä¹ ç‡ä¸‹çš„æŸå¤±å‡½æ•° lr=0.001,æ­¤æ—¶åˆ°è¾¾max_iteræ—¶æŸå¤±å‡½æ•°ä»åœ¨å¿«é€Ÿé€’å‡ã€ ç›¸æ¯”ä¹‹ä¸‹lr=0.01çš„å­¦ä¹ ç‡é¿å…äº†å›¾åƒçš„æŠ–åŠ¨ï¼Œä¹Ÿé¿å…äº†è®­ç»ƒè¿‡æ…¢å¯¼è‡´è®­ç»ƒæ—¶é—´é•¿ã€‚ ä¸åŒçš„æ­£åˆ™åŒ–å‚æ•°ï¼š è§‚å¯Ÿå›¾åƒçš„çºµåæ ‡ï¼Œå¯ä»¥çœ‹å‡ºé€‰æ‹©l2æ­£åˆ™åŒ–çš„æ”¶æ•›æ•ˆæœæœ€å¥½ï¼Œå› æ­¤é‡‡å–l2æ­£åˆ™åŒ–ã€‚ æœ€ä½³å‡†ç¡®ç‡çš„æƒ…å†µï¼š ï¼ˆæ­¤æ—¶çš„å‚æ•°ï¼šlr=0.01, tol=1e-7, max_iter=3e3,penalty=â€l2â€,gamma=1,fit_intercept=Trueï¼‰ å‡†ç¡®ç‡è¾¾åˆ°äº†87.37%ï¼Œå…¶ä¸­æµ‹è¯•é›†å’Œè®­ç»ƒé›†çš„æ¯”ä¾‹ä¸º2ï¼š8","categories":[{"name":"æœºå™¨å­¦ä¹ ","slug":"æœºå™¨å­¦ä¹ ","permalink":"http://sn1987a-1.github.io/categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/"}],"tags":[{"name":"ä¸“ä¸šè¯¾","slug":"ä¸“ä¸šè¯¾","permalink":"http://sn1987a-1.github.io/tags/%E4%B8%93%E4%B8%9A%E8%AF%BE/"}]},{"title":"Ginæ¡†æ¶","slug":"Ginæ¡†æ¶","date":"2023-09-23T12:48:34.000Z","updated":"2023-09-23T13:05:25.832Z","comments":true,"path":"posts/6d104c29.html","link":"","permalink":"http://sn1987a-1.github.io/posts/6d104c29.html","excerpt":"","text":"GoWebå®˜æ–¹åŒ…net/httpæä¾›äº†åŸºç¡€çš„è·¯ç”±å‡½æ•°ç»„åˆå’ŒåŠŸèƒ½å‡½æ•°ï¼Œæ— éœ€API package main import (...) func echo(wr http.ResponseWriter, r *http.Request) { msg, err := ioutil.ReadAll(r.Body) if err != nil { wr.Write([]byte(\"echo error\")) return } writeLen, err := wr.Write(msg) if err != nil || writeLen != len(msg) { log.Println(err, \"write len:\", writeLen) } } func main() { http.HandleFunc(\"/\", echo) err := http.ListenAndServe(\":8080\", nil) if err != nil { log.Fatal(err) } } æ¡†æ¶ç±»å‹ Router MVC GinGin Ginè·¯ç”±func main() { // åˆ›å»ºä¸€ä¸ª Gin è·¯ç”± r := gin.Default() // è®¾ç½®ä¸€ä¸ªè·¯ç”±å¤„ç†å™¨ï¼Œå¤„ç†æ ¹è·¯å¾„ \"/\" r.GET(\"/\", func(c *gin.Context) { // å‘é€ \"Hello, World!\" ä½œä¸ºå“åº” c.String(http.StatusOK, \"Hello, World!\") }) // åœ¨ç«¯å£ 8000 ä¸Šå¯åŠ¨ Web æœåŠ¡å™¨ r.Run(\":8000\") } ç±»ä¼¼åœ° r.POST(\"/xxxpost\",getting) r.PUT(\"/xxxput\") æ”¯æŒRestfulé£æ ¼APIï¼Œï¼ˆè¡¨ç°å±‚çŠ¶æ€è½¬åŒ–ï¼‰ï¼Œæ˜¯ä¸€ç§äº’è”ç½‘åº”ç”¨ç¨‹åºçš„APIè®¾è®¡ç†å¿µï¼šURLå®šä½èµ„æºï¼Œç”¨HTTPæè¿°æ“ä½œ 1.è·å–æ–‡ç«  /blog/getXxx Get blog/Xxx 2.æ·»åŠ  /blog/addXxx POST blog/Xxx 3.ä¿®æ”¹ /blog/updateXxx PUT blog/Xxx 4.åˆ é™¤ /blog/delXxxx DELETE blog/Xxx APIå‚æ•°ï¼šå¯ä»¥é€šè¿‡contextåœ°Paramæ–¹æ³•è·å–APIå‚æ•° r.GET(\"/user/:name/*action\", func(c *gin.Context) { name := c.Param(\"name\") action := c.Param(\"action\") action = strings.Trim(action, \"/\") c.String(http.StatusOK, name+\" is \"+action) }) URLå‚æ•°ï¼šå¯ä»¥é€šè¿‡DefaultQuery()ï¼ˆå‚æ•°ä¸å­˜åœ¨ï¼Œè¿”å›é»˜è®¤å€¼ï¼‰æˆ–Query()ï¼ˆå‚æ•°ä¸å­˜åœ¨ï¼Œè¿”å›ç©ºä¸²ï¼‰æ–¹æ³•è·å– name := c.DefaultQuery(\"xx\",\"é»˜è®¤å€¼\") è¡¨å•å‚æ•°è¡¨å•å‚æ•°æ˜¯postè¯·æ±‚ï¼Œé€šè¿‡PostFormè·å– types := c.DefaultPostForm(\"type\", \"post\") username := c.PostForm(\"username\") password := c.PostForm(\"userpassword\") &lt;form action=\"http://localhost:8080/form\" method=\"post\" action=\"application/x-www-form-urlencoded\"&gt; ç”¨æˆ·åï¼š&lt;input type=\"text\" name=\"username\" placeholder=\"è¯·è¾“å…¥ä½ çš„ç”¨æˆ·å\"&gt; &lt;br&gt; å¯†&amp;nbsp;&amp;nbsp;&amp;nbsp;ç ï¼š&lt;input type=\"password\" name=\"userpassword\" placeholder=\"è¯·è¾“å…¥ä½ çš„å¯†ç \"&gt; &lt;br&gt; &lt;input type=\"submit\" value=\"æäº¤\"&gt; &lt;/form&gt; ä¸Šä¼ æ–‡ä»¶ file, err := c.FormFile(\"file\") if err != nil { c.String(500, \"ä¸Šä¼ å›¾ç‰‡å‡ºé”™\") } c.SaveUploadedFile(file, file.Filename) c.String(http.StatusOK, file.Filename) å¯¹äºä¸Šä¼ çš„æ–‡ä»¶ï¼Œå¯ä»¥é™åˆ¶æ–‡ä»¶ç±»å‹ï¼Œæ–‡ä»¶å¤§å° ä¹Ÿå¯ä»¥ä¸Šä¼ å¤šä¸ªæ–‡ä»¶ï¼Œè·å–æ‰€æœ‰çš„æ–‡ä»¶ï¼Œå†éå†æ–‡ä»¶ï¼Œé€ä¸ªå¤„ç†ï¼ˆhtmlçš„multipleï¼‰ routes group ç®¡ç†ç›¸åŒçš„URL v1 := r.Group(\"/v1\") // {} æ˜¯ä¹¦å†™è§„èŒƒ { v1.GET(\"/login\", login) v1.GET(\"/submit\", submit) } v2... è·¯ç”±åŸç†ï¼šhttprouterä¼šå°†æ‰€æœ‰è·¯ç”±è§„åˆ™æ„é€ æˆå‰ç¼€æ ‘ URIåŒ…å«URLå’ŒURN urlç”¨æ¥æ ‡è¯†èµ„æºçš„ä½ç½® urnç”¨æ¥æ ‡è¯†èµ„æºçš„åç§°ï¼Œä¸å«ä½ç½®ä¿¡æ¯ uriæ•°æ®æŒ‡çš„æ˜¯URIçš„å­—ç¬¦ä¸²è¡¨ç¤ºå½¢å¼ ginæ•°æ®è§£æå’Œç»‘å®šjsonæ•°æ® type Login struct { // binding:\"required\"ä¿®é¥°çš„å­—æ®µï¼Œè‹¥æ¥æ”¶ä¸ºç©ºå€¼ï¼Œåˆ™æŠ¥é”™ï¼Œæ˜¯å¿…é¡»å­—æ®µ User string `form:\"username\" json:\"user\" uri:\"user\" xml:\"user\" binding:\"required\"` Pssword string `form:\"password\" json:\"password\" uri:\"password\" xml:\"password\" binding:\"required\"` } var json Login // å°†requestçš„bodyä¸­çš„æ•°æ®ï¼Œè‡ªåŠ¨æŒ‰ç…§jsonæ ¼å¼è§£æåˆ°ç»“æ„ä½“ if err := c.ShouldBindJSON(&amp;json); err != nil { // è¿”å›é”™è¯¯ä¿¡æ¯ // gin.Hå°è£…äº†ç”Ÿæˆjsonæ•°æ®çš„å·¥å…· c.JSON(http.StatusBadRequest, gin.H{\"error\": err.Error()}) return } // åˆ¤æ–­ç”¨æˆ·åå¯†ç æ˜¯å¦æ­£ç¡® if json.User != \"root\" || json.Pssword != \"admin\" { c.JSON(http.StatusBadRequest, gin.H{\"status\": \"304\"}) return } c.JSON(http.StatusOK, gin.H{\"status\": \"200\"}) è¡¨å•æ•°æ®ï¼Œç±»ä¼¼äºjsonæ•°æ®ï¼Œåªéœ€ä¿®æ”¹è§£æçš„å‡½æ•°ï¼Œä½¿ç”¨bind()é»˜è®¤è§£æåˆ°formçš„æ ¼å¼ var form Login // Bind()é»˜è®¤è§£æå¹¶ç»‘å®šformæ ¼å¼ // æ ¹æ®è¯·æ±‚å¤´ä¸­content-typeè‡ªåŠ¨æ¨æ–­ if err := c.Bind(&amp;form); err != nil { URIæ•°æ® URIæ•°æ®çš„getå‡½æ•°å‚æ•°\"/:user/:password\"ä»¥ä¾¿æ ‡è¯† if err := c.ShouldBindUri(&amp;login); err != nil {... ginæ¸²æŸ“JSONï¼ŒXMLï¼ŒYAMLï¼Œç»“æ„ä½“ r.get(\"/someXML\")(æ›¿æ¢æˆsomeStruct/someYAML/someJSON)ï¼Œç”¨c.XML...æ¥æ”¶ï¼ˆstructæ ¼å¼éœ€è¦å¤„ç†msgæ ¼å¼ï¼Œç”¨c.JSONæ¥æ”¶ï¼‰ HTMLæ¨¡æ¿æ¸²æŸ“ åœ¨r.GETä¹‹å‰è°ƒç”¨r.LoadHTMLGlob(\"tem/**/*\")(å…·ä½“æ ¹æ®ç›®å½•æ¥å®š) HTMLé¦–å°¾åˆ†ç¦» é¦–ï¼š {{define \"public/header\"}} &lt;!DOCTYPE html&gt; &lt;html lang=\"en\"&gt; &lt;head&gt; &lt;meta charset=\"UTF-8\"&gt; &lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"&gt; &lt;meta http-equiv=\"X-UA-Compatible\" content=\"ie=edge\"&gt; &lt;title&gt;{{.title}}&lt;/title&gt; &lt;/head&gt; &lt;body&gt; {{end}} å°¾ï¼š {{define \"public/footer\"}} &lt;/body&gt; &lt;/html&gt; {{ end }} indexæ–‡ä»¶ï¼š {{ define \"user/index.html\" }} {{template \"public/header\" .}} fgkjdskjdsh{{.address}} {{template \"public/footer\" .}} {{ end }} é‡å®šå‘ c.Redirect(http.StatusMovedPermanently, \"http...\") åŒæ­¥å’Œå¼‚æ­¥å¤„ç† goroutineå¯ä»¥è¿›è¡Œå¼‚æ­¥å¤„ç† å¯åŠ¨æ–°çš„goroutineæ—¶ï¼Œä¸åº”è¯¥ä½¿ç”¨åŸå§‹ä¸Šä¸‹æ–‡ï¼Œè€Œæ˜¯ä½¿ç”¨åªè¯»å‰¯æœ¬ // 1.å¼‚æ­¥ r.GET(\"/long_async\", func(c *gin.Context) { // éœ€è¦æä¸€ä¸ªå‰¯æœ¬ copyContext := c.Copy() // å¼‚æ­¥å¤„ç† go func() { time.Sleep(3 * time.Second) log.Println(\"å¼‚æ­¥æ‰§è¡Œï¼š\" + copyContext.Request.URL.Path) }() }) // 2.åŒæ­¥ r.GET(\"/long_sync\", func(c *gin.Context) { time.Sleep(3 * time.Second) log.Println(\"åŒæ­¥æ‰§è¡Œï¼š\" + c.Request.URL.Path) }) ginä¸­é—´ä»¶â€œé»˜è®¤ä½¿ç”¨ä¸¤ä¸ªä¸­é—´ä»¶ï¼šLoggerï¼ŒRecoveryâ€r:=gin.Default() å…¨å±€ä¸­é—´ä»¶ï¼šæ‰€æœ‰è¯·æ±‚éƒ½ç»è¿‡è¯¥ä¸­é—´ä»¶ å®šä¹‰ä¸­é—´ä»¶ï¼š func MiddleWare() gin.HandlerFunc{ //è®¾ç½®å˜é‡åˆ°Contextçš„keyä¸­ï¼Œå¯ä»¥é€šè¿‡â€™Getâ€˜è·å– c.Set(\"request\",\"...\") //è·å–ç›¸å…³å˜é‡ status := c.Writer.Status() } æ³¨å†Œä¸­é—´ä»¶ï¼š r.Use(MiddleWare()) r.GET(\"/ce\",func(c *gin.Context)){}... Next()æ–¹æ³•ï¼šä¸­é—´ä»¶æ‰§è¡Œå®Œåç»­çš„ä¸€äº›äº‹æƒ…ï¼Œåœ¨å®šä¹‰ä¸­é—´ä»¶éƒ¨åˆ†å†™å…¥ func MiddleWare() gin.HandlerFunc { return func(c *gin.Context) { t := time.Now() c.Set(\"request\", \"ä¸­é—´ä»¶\") c.Next() status := c.Writer.Status() t2 := time.Since(t) fmt.Println(\"time:\", t2) } } å¯¹æ¯”ï¼š å»æ‰c.Next()å‡½æ•°ï¼šè¾“å‡ºçš„timeï¼ˆæ—¶é—´é—´éš”ï¼‰ä¸º0 åŠ ä¸Šc.Next()å‡½æ•°ï¼Œè¾“å‡ºçš„timeä¸ä¸º0ï¼Œä¸ºä¸­é—´ä»¶å¼€å§‹æ‰§è¡Œåˆ°è¿è¡Œç»“æŸçš„æ—¶é—´ å±€éƒ¨ä¸­é—´ä»¶ å±€éƒ¨ä¸­é—´ä»¶æ³¨å†Œçš„æ–¹æ³•ï¼šï¼ˆä¹Ÿå¯ä»¥ç±»ä¼¼äºå…¨å±€çš„å£°æ˜ï¼‰ r.GET(\"/ce\",MiddleWare(),func(c *gin.Context){...}) å±€éƒ¨å’Œå…¨å±€çš„åŒºåˆ«ï¼šå±€éƒ¨å¯ä»¥é’ˆå¯¹å¿’å…šçš„è·¯ç”±æˆ–è·¯ç”±ç»„ç”Ÿæ•ˆï¼Œåœ¨æ³¨å†Œå‰åˆ›å»ºè·¯ç”±ç»„ï¼š authgroup:=r.Group(\"/xxx\") authgroup.USE(MiddleWare) authgroup.GET(...) ä¼šè¯æ§åˆ¶HTTPï¼šæ— çŠ¶æ€åè®®ï¼ŒHTTP1.1å¼•å…¥cookieè§£å†³æ— çŠ¶æ€çš„æ–¹æ¡ˆï¼ŒCookieç”±æœåŠ¡å™¨åˆ›å»ºï¼Œæµè§ˆå™¨ä¿å­˜ï¼Œæ¯æ¬¡å‘é€è¯·æ±‚ç»™æœåŠ¡å™¨æ—¶ï¼Œå‘é€Cookie cookieè®¾ç½® r.GET(\"cookie\",func(c *gin.Context){ cookie,err=c.Cookie(\"key_cookie\") if err !=nil{ //è¯´æ˜cookieæœªè®¾ç½® c.SetCookie()... } }) å€ŸåŠ©ä¸­é—´ä»¶æ ¡éªŒcookieï¼Œå¦‚æœæ ¡éªŒå¤±è´¥ï¼šè¿”å›é”™è¯¯ä¿¡æ¯å¹¶é€€å‡º c.JSON(http.StatusUnauthorized,gin.H{\"error\":\"err\"}) c.Abort()) ä¸Šè¿°cookieçš„ç¼ºç‚¹ ä¸å®‰å…¨ï¼Œé€šè¿‡æ˜æ–‡ä¼ è¾“ï¼ˆåªæœ‰httpsä¼ è¾“æ‰å¯ä»¥ä¿è¯å®‰å…¨æ€§ï¼‰ å¯ä»¥è¢«ç¦ç”¨ å¢åŠ å®½å¸¦æŸè€— cookieæœ‰ä¸Šé™ åªåœ¨åŒä¸€åŸŸåä¸‹çš„é¡µé¢ä¹‹é—´å…±äº« Sessions ä¸»è¦åŠŸèƒ½ï¼š ç®€å•çš„APIï¼Œå¯ä»¥ä½œä¸ºè®¾ç½®ç­¾åcookieçš„ç®€ä¾¿æ–¹æ³• å†…ç½®çš„åç«¯å¯ä»¥å°†sessionå­˜å‚¨åœ¨cookieçš„æˆ–è€…æ–‡ä»¶ç³»ç»Ÿä¸­ Flashæ¶ˆæ¯ï¼šæŒç»­è¯»å–session åˆ‡æ¢Sessionçš„æŒä¹…æ€§å’Œä¾¿æ·æ–¹æ³• æ—‹è½¬èº«ä»½éªŒè¯ï¼ŒåŠ å¯†å¯†é’¥ æ¯ä¸ªè¯·æ±‚æœ‰å¤šä¸ªsession è‡ªå®šä¹‰sessionåç«¯çš„æ¥å£å’ŒåŸºç¡€ç»“æ„ï¼Œå¯ä»¥é€šè¿‡APIå‡å°‘å¹¶æ‰¹é‡ä¿å­˜ sessionsçš„ç‰¹ç‚¹ åœ¨æœåŠ¡å™¨å­˜å‚¨ï¼Œå­˜å‚¨åœ¨æœåŠ¡å™¨çš„å†…å­˜æˆ–è€…æ•°æ®åº“ä¸­ æ²¡æœ‰æ˜ç¡®çš„å®¹é‡é™åˆ¶ å¯ä»¥æŒä¹…å­˜åœ¨ å®¢æˆ·ç«¯æ— æ³•ç›´æ¥è®¿é—®ä½ æˆ–ä¿®æ”¹ï¼Œæ›´å®‰å…¨ å¯ä»¥è§£å†³cookieçš„è·¨åŸŸé—®é¢˜ï¼Œæ›´çµæ´» é€šå¸¸ç”¨æ¥å­˜å‚¨æ•æ„Ÿæ•°æ®ï¼Œå¦‚ç”¨æˆ·çš„èº«ä»½éªŒè¯ä¿¡æ¯ sessionsç›¸å…³å‡½æ•°ç”¨æ³•ï¼š ä¿å­˜sessionï¼ˆæ›´æ”¹ï¼‰ func SaveSession(w http.ResponseWriter, r *http.Request) { session, err := store.Get(r, \"session-name\") //Getæ°¸è¿œä¼šè¿”å›ä¸€ä¸ªsessionï¼Œå³ä¾¿æ˜¯ç©ºçš„session if err != nil { http.Error(w, err.Error(), http.StatusInternalServerError) return } session.Values[\"foo\"] = \"bar\" ... // ä¿å­˜æ›´æ”¹ session.Save(r, w) } è·å–session func GetSession(w http.ResponseWriter, r *http.Request) { session, err := store.Get(r, \"session-name\") if err != nil { http.Error(w, err.Error(), http.StatusInternalServerError) return } foo := session.Values[\"foo\"] fmt.Println(foo) } åˆ é™¤session: å°†sessionçš„æœ€å¤§å­˜å‚¨æ—¶é—´è®¾ç½®ä¸ºå°äºé›¶çš„æ•°å³ä¸ºåˆ é™¤ session.Options.MaxAge = -1 session.Save(r, w) å‚æ•°éªŒè¯ç»“æ„ä½“éªŒè¯ï¼šGINæ¡†æ¶è¿›è¡Œæ•°æ®éªŒè¯ï¼Œæ— éœ€è§£ææ•°æ®ï¼Œæ›´ç®€æ´ var person Person if err := c.ShouldBind(&amp;person); err != nil { c.String(500, fmt.Sprint(err)) return } c.String(200, fmt.Sprintf(\"%#v\", person)) å¦‚æœéœ€è¦æ·»åŠ è‡ªå®šä¹‰éªŒè¯ï¼š é¦–å…ˆï¼Œè¦åœ¨structä¸­é™åˆ¶ï¼šformï¼Œbindingç­‰ï¼ˆç”¨``ï¼‰ è‡ªå®šä¹‰æ ¡éªŒæ–¹æ³•ï¼ˆå¦‚é™åˆ¶å­—æ®µä¸ä¸ºç©ºï¼Œä¸ç­‰äºadminï¼‰ æ³¨å†Œæ ¡éªŒæ–¹æ³• v:=binding.Validator.Engine().(*validator.Validate) v.RegisterValidation(\"name\",func_name) å†ç”¨ShouldBindè¿›è¡Œæ ¡éªŒ å¤šè¯­è¨€ç¿»è¯‘éªŒè¯ å½“ä¸šåŠ¡ç³»ç»Ÿå¯¹éªŒè¯ä¿¡æ¯æœ‰ç‰¹æ®Šéœ€æ±‚æ—¶ï¼Œä¾‹å¦‚ï¼šè¿”å›ä¿¡æ¯éœ€è¦è‡ªå®šä¹‰ï¼Œæ‰‹æœºç«¯è¿”å›çš„ä¿¡æ¯éœ€è¦æ˜¯ä¸­æ–‡è€Œpcç«¯è¿”å›çš„ä¿¡æ¯éœ€è¦æ—¶è‹±æ–‡ï¼Œå¦‚ä½•åšåˆ°è¯·æ±‚ä¸€ä¸ªæ¥å£æ»¡è¶³ä¸Šè¿°ä¸‰ç§æƒ…å†µã€‚ å€ŸåŠ©ä¸­é—´ä»¶å®ç°ã€‚ func startPage(c *gin.Context) { //è¿™éƒ¨åˆ†åº”æ”¾åˆ°ä¸­é—´ä»¶ä¸­ locale := c.DefaultQuery(\"locale\", \"zh\") trans, _ := Uni.GetTranslator(locale) switch locale { ... break } //è‡ªå®šä¹‰é”™è¯¯å†…å®¹ Validate.RegisterTranslation(\"required\", trans, func(ut ut.Translator) error { return ut.Add(\"required\", \"{0} must have a value!\", true) // see universal-translator for details }, func(ut ut.Translator, fe validator.FieldError) string { t, _ := ut.T(\"required\", fe.Field()) return t }) //è¿™å—åº”è¯¥æ”¾åˆ°å…¬å…±éªŒè¯æ–¹æ³•ä¸­ user := User{} c.ShouldBind(&amp;user) fmt.Println(user) err := Validate.Struct(user) if err != nil { errs := err.(validator.ValidationErrors) sliceErrs := []string{} for _, e := range errs { sliceErrs = append(sliceErrs, e.Translate(trans)) } c.String(200, fmt.Sprintf(\"%#v\", sliceErrs)) } c.String(200, fmt.Sprintf(\"%#v\", \"user\")) } éªŒè¯ç åº“ï¼šgithub.com/dchest/captcha å…·ä½“å®ç°ï¼š ç”Ÿæˆä¸€ä¸ªè·¯ç”±ï¼Œåœ¨sessioné‡Œå†™å…¥é”®å€¼å¯¹kï¼Œvï¼Œå°†våŠ è½½åˆ°å›¾ç‰‡ä¸Šï¼Œç„¶åç”Ÿæˆå›¾ç‰‡ã€‚åœ¨æµè§ˆå™¨æ˜¾ç¤º å‰ç«¯å°†å›¾ç‰‡çš„å†…å®¹å‘é€ç»™åç«¯ï¼Œåç«¯æ ¹æ®sessionä¸­çš„kå–å¾—vï¼Œæ¯”å¯¹æ ¡éªŒ ç¤ºä¾‹ä»£ç  package main import ( \"bytes\" \"github.com/dchest/captcha\" \"github.com/gin-contrib/sessions\" \"github.com/gin-contrib/sessions/cookie\" \"github.com/gin-gonic/gin\" \"net/http\" \"time\" ) // ä¸­é—´ä»¶ï¼Œå¤„ç†session func Session(keyPairs string) gin.HandlerFunc { store := SessionConfig() return sessions.Sessions(keyPairs, store) } func SessionConfig() sessions.Store { sessionMaxAge := 3600 sessionSecret := \"topgoer\" var store sessions.Store store = cookie.NewStore([]byte(sessionSecret)) store.Options(sessions.Options{ MaxAge: sessionMaxAge, //seconds Path: \"/\", }) return store } func Captcha(c *gin.Context, length ...int) { l := captcha.DefaultLen w, h := 107, 36 if len(length) == 1 { l = length[0] } if len(length) == 2 { w = length[1] } if len(length) == 3 { h = length[2] } captchaId := captcha.NewLen(l) session := sessions.Default(c) session.Set(\"captcha\", captchaId) _ = session.Save() _ = Serve(c.Writer, c.Request, captchaId, \".png\", \"zh\", false, w, h) } func CaptchaVerify(c *gin.Context, code string) bool { session := sessions.Default(c) if captchaId := session.Get(\"captcha\"); captchaId != nil { session.Delete(\"captcha\") _ = session.Save() if captcha.VerifyString(captchaId.(string), code) { return true } else { return false } } else { return false } } func Serve(w http.ResponseWriter, r *http.Request, id, ext, lang string, download bool, width, height int) error { w.Header().Set(\"Cache-Control\", \"no-cache, no-store, must-revalidate\") w.Header().Set(\"Pragma\", \"no-cache\") w.Header().Set(\"Expires\", \"0\") var content bytes.Buffer switch ext { case \".png\": w.Header().Set(\"Content-Type\", \"image/png\") _ = captcha.WriteImage(&amp;content, id, width, height) case \".wav\": w.Header().Set(\"Content-Type\", \"audio/x-wav\") _ = captcha.WriteAudio(&amp;content, id, lang) default: return captcha.ErrNotFound } if download { w.Header().Set(\"Content-Type\", \"application/octet-stream\") } http.ServeContent(w, r, id+ext, time.Time{}, bytes.NewReader(content.Bytes())) return nil } func main() { router := gin.Default() router.LoadHTMLGlob(\"./*.html\") router.Use(Session(\"topgoer\")) router.GET(\"/captcha\", func(c *gin.Context) { Captcha(c, 4) }) router.GET(\"/\", func(c *gin.Context) { c.HTML(http.StatusOK, \"index.html\", nil) }) router.GET(\"/captcha/verify/:value\", func(c *gin.Context) { value := c.Param(\"value\") if CaptchaVerify(c, value) { c.JSON(http.StatusOK, gin.H{\"status\": 0, \"msg\": \"success\"}) } else { c.JSON(http.StatusOK, gin.H{\"status\": 1, \"msg\": \"failed\"}) } }) router.Run(\":8080\") }","categories":[{"name":"Golang","slug":"Golang","permalink":"http://sn1987a-1.github.io/categories/Golang/"}],"tags":[{"name":"Gin","slug":"Gin","permalink":"http://sn1987a-1.github.io/tags/Gin/"}]},{"title":"VueåŸºç¡€çŸ¥è¯†","slug":"vueåŸºç¡€çŸ¥è¯†","date":"2023-09-23T12:48:34.000Z","updated":"2023-09-23T13:29:20.201Z","comments":true,"path":"posts/1d1c79fd.html","link":"","permalink":"http://sn1987a-1.github.io/posts/1d1c79fd.html","excerpt":"","text":"","categories":[{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"http://sn1987a-1.github.io/categories/%E5%89%8D%E7%AB%AF/"}],"tags":[{"name":"Vue","slug":"Vue","permalink":"http://sn1987a-1.github.io/tags/Vue/"}]},{"title":"å¹¶è¡Œæ•°æ®ç»“æ„-p-tree","slug":"å¹¶è¡Œæ•°æ®ç»“æ„-p-tree","date":"2023-09-22T07:46:11.000Z","updated":"2023-09-23T13:05:25.842Z","comments":true,"path":"posts/a4d33f77.html","link":"","permalink":"http://sn1987a-1.github.io/posts/a4d33f77.html","excerpt":"","text":"å¹¶è¡Œæ•°æ®ç»“æ„å¹¶è¡Œæ•°æ®ç»“æ„çš„å‡ ä¸ªæ¦‚å¿µ non-blocking ä¸€ä¸ªçº¿ç¨‹è¢«æŒ‚èµ·æˆ–ä¸­æ–­ä¸ä¼šå¯¼è‡´å…¶ä»–çº¿ç¨‹æ‰§è¡Œè¢«block lock-free ä¿è¯æ•´ä¸ªç³»ç»Ÿçš„æ‰§è¡Œè¿›åº¦æ˜¯ä¸æ–­æ¨è¿›çš„ wait-free ä¿è¯æ¯ä¸ªçº¿ç¨‹çš„æ‰§è¡Œè¿›åº¦æ˜¯ä¸æ–­æ¨è¿›çš„ é€šå¸¸éœ€è¦åšåˆ°lock-free,ä¸è¦æ±‚wait-free(è¾ƒéš¾å®ç°ï¼Œæ€§èƒ½è¾ƒå·®) lock-free: auto expected = x.load(); do { bool ok = x.compare_exchange_strong(expected, new_value); } while(!ok) //compare_exchange_strong è§£é‡Šã€‚ // if true, åˆ™xå’Œexpectedç›¸ç­‰ï¼Œä½¿ç”¨new_valueæ›¿æ¢xçš„å€¼ //if false, åˆ™xå’Œexpectedä¸ç›¸ç­‰ï¼Œå¹¶expectedä¼šè¢«ä¿®æ”¹æˆxçš„å€¼ ï¼ˆå¦åˆ™éœ€è¦spin lockï¼‰ ä»…ä»…ä½¿ç”¨ä¸²è¡Œæ•°æ®ç»“æ„+é”è¿œè¿œä¸èƒ½è¾¾åˆ°è¦æ±‚ï¼ˆè¿˜å¯èƒ½å¯¼è‡´æ­»é”ï¼‰ æ¶‰åŠçš„æ•°æ®ç»“æ„ CSDSï¼ˆå¹¶è¡ŒæŸ¥æ‰¾æ•°æ®ç»“æ„ï¼‰ é“¾è¡¨ï¼Œè·³è¡¨ï¼Œå“ˆå¸Œè¡¨ ä¸»è¦å®ç°ï¼šæŸ¥æ‰¾ï¼Œæ’å…¥ï¼Œåˆ é™¤ æŸ¥æ‰¾ï¼šéå† æ’å…¥åˆ é™¤ï¼Œå…ˆæ‰¾åˆ°ä½ç½®ï¼Œå†è¿›è¡Œæ“ä½œ å…³é”® é€Ÿåº¦å¿«ï¼Œé¿å…è€—æ—¶æ“ä½œï¼ˆå†™æ“ä½œï¼‰ï¼Œç­‰å¾…å’Œé‡è¯• ç»†ç²’åº¦ï¼Œä¿®æ”¹å°½é‡è®¾è®¡è¾ƒå°çš„èŒƒå›´ï¼Œéœ€è¦ç”¨é”ï¼šç»†ç²’åº¦é” éæŸ¥æ‰¾æ•°æ®ç»“æ„ï¼š é˜Ÿåˆ—ï¼Œæ ˆï¼Œç«äº‰ç‚¹éƒ½åœ¨å¤´/å°¾ï¼Œé˜Ÿå°¾ç«äº‰æ¿€çƒˆ å¹¶è¡Œæ•°æ®ç»“æ„è®¾è®¡å•é“¾è¡¨ä¸²è¡Œæ•°æ®ç»“æ„çš„å•é“¾è¡¨çš„å¢åˆ æ”¹æŸ¥éƒ½ç›¸å¯¹å®¹æ˜“ï¼Œåœ¨å¹¶å‘ä¸­å®¹æ˜“é‡åˆ°çš„é—®é¢˜ï¼š åˆ é™¤å’Œæ’å…¥ï¼Œæ’å…¥å’Œæ’å…¥ï¼Œåˆ é™¤å’Œåˆ é™¤ï¼Œéƒ½ä¼šå¼•å‘é—®é¢˜ å†…å­˜ç®¡ç†é—®é¢˜ï¼šå¯¹å·²åˆ é™¤çš„èŠ‚ç‚¹ï¼Œéœ€è¦é‡Šæ”¾å†…å­˜ï¼Œä½†å¦‚æœå…¶ä»–çº¿ç¨‹æŒæœ‰åœ¨è¯¥ç‚¹çš„æ“ä½œï¼Œä¸èƒ½ç«‹å³é‡Šæ”¾ ABAé—®é¢˜ï¼šæ’å…¥æŸèŠ‚ç‚¹æ—¶ï¼Œè¯¥èŠ‚ç‚¹çš„å‰é©±åˆšè¢«é‡Šæ”¾ä¸”ç©ºé—´è¢«åˆ†é…åˆ°å¦ä¸€ä¸ªèŠ‚ç‚¹ï¼ˆå†…å­˜å¤ç”¨ï¼‰ï¼Œå¯¼è‡´é“¾è¡¨ä¹±åº çº¿æ€§åŒ–é—®é¢˜ï¼šéå†é“¾è¡¨å¾—åˆ°çš„éå†ç»“æœä¸ä¸€å®šæ˜¯å†å²å­˜åœ¨è¿‡çš„é“¾è¡¨ç‰ˆæœ¬æ•°æ®ï¼ˆè§£å†³æ–¹æ¡ˆï¼šä¸æä¾›éå†æ“ä½œå³å¯ï¼Œåªæä¾›æ’å…¥åˆ é™¤å’ŒæŸ¥æ‰¾ï¼Œè¿™ä¸‰ä¸ªæ“ä½œå¯ä»¥æ˜¯çº¿æ€§åŒ–çš„ï¼‰ è§£å†³æ–¹æ¡ˆï¼ˆå¤§éƒ¨åˆ†çš„é—®é¢˜éƒ½æ˜¯åˆ é™¤æ“ä½œã€é‡Šæ”¾ç©ºé—´äº§ç”Ÿçš„ï¼‰ èŠ‚ç‚¹ä¸åˆ é™¤ï¼Œå…ˆæ ‡è®°å†é›†ä¸­GCï¼ŒGCåŠ é” såˆ é™¤å¯¼è‡´çš„GCä¼šå‡ºç°çŸ­æš‚é˜»å¡ï¼Œå‡ºç°é•¿å°¾ èŠ‚ç‚¹åˆ é™¤ä½†ä¸é‡Šæ”¾å†…å­˜ å†…å­˜ä¼šä¸æ–­å¢é•¿ èŠ‚ç‚¹åˆ é™¤å¹¶é‡Šæ”¾å†…å­˜ ä½¿ç”¨å¼•ç”¨è®¡æ•°çš„æ–¹å¼ç®¡ç†é“¾è¡¨å†…å­˜é‡Šæ”¾ï¼Œæ¯æ¬¡éå†å¯¹èŠ‚ç‚¹è¿›è¡Œå¼•ç”¨è®¡æ•°ï¼ˆå¯¹æ€§èƒ½å½±å“è¾ƒå¤§ï¼‰ æ’å…¥åˆ é™¤å†²çªçš„è§£å†³ å…³é”®åœ¨äºï¼šè¢«åˆ é™¤èŠ‚ç‚¹çš„nextä¸èƒ½è¢«æ”¹å˜ï¼Œå¯ä»¥å°†è¢«åˆ é™¤èŠ‚ç‚¹çš„nextæ·»åŠ æ ‡è®°ç¬¦1ï¼ˆnext&amp;1ï¼‰ï¼Œé˜»æ­¢å…¶ä»–çº¿ç¨‹æ”¹å˜è¯¥èŠ‚ç‚¹çš„å€¼ã€‚ bool del_node(ListNode* pre_del_node) { ListNode* del_node = pre_del_node-&gt;next.load(); //1. æ ‡è®°del_node-&gt;next; ListNode* excepted_next = del_node-&gt;next.load(); //2. nextæŒ‡é’ˆæ·»åŠ æ ‡è®°ä½ if (!del_node-&gt;next-&gt;compare_exchange_strong(excepted_next, excepted_next&amp;1)) { return false; } //3. ä¿®æ”¹å‰é©±èŠ‚ç‚¹nextæŒ‡é’ˆ if(!pre_del_node-&gt;next.compare_exchange_strong(del_node, del_node-&gt;next)) { return false; } return true; } å¦‚æœä¿®æ”¹ä¸æˆåŠŸå°†é€€å‡ºï¼Œæ’å…¥ä¹Ÿç±»ä¼¼ã€‚ compare_exchange_strong ABAé—®é¢˜çš„è§£å†³ ä½¿ç”¨tagged pointerè§£å†³ï¼ˆåœ¨æŒ‡é’ˆä¸Šå¸¦ä¸Šç‰ˆæœ¬å·è¿›è¡Œç®¡ç†ï¼‰ ä½¿ç”¨æŒ‡é’ˆçš„æœ€é«˜16å°¾å­˜å‚¨æŒ‡é’ˆçš„ç‰ˆæœ¬ä¿¡æ¯ï¼Œæ¯æ¬¡æŒ‡é’ˆå†…å®¹å‘ç”Ÿå˜åŒ–æ—¶æ”¹å˜ç‰ˆæœ¬å·ï¼ˆæŒ‡é’ˆä¸€èˆ¬64ä½ï¼ŒCPUå†…å­˜è¿œè¿œä¸åŠï¼‰å‚è€ƒ å†…å­˜ç®¡ç†é—®é¢˜è§£å†³ é£é™©æŒ‡é’ˆHazard Pointers åŸç†ï¼š æ¯ä¸ªçº¿ç¨‹æŠŠè‡ªå·±è®¿é—®çš„èŠ‚ç‚¹çš„åœ°å€æ”¾åœ¨å…¨å±€å¯è§çš„åœ°æ–¹ï¼Œè¿™æ ·çš„å…¨å±€å¯è§çš„æŒ‡é’ˆè¢«ç§°ä¸ºé£é™©æŒ‡é’ˆï¼Œè®¿é—®å®ŒèŠ‚ç‚¹åæ¸…é™¤è‡ªå·±çš„é£é™©æŒ‡é’ˆ æ¯ä¸ªçº¿ç¨‹ç»´æŠ¤ä¸€ä¸ªfreelistï¼š å½“æŸä¸ªç»“ç‚¹Aè¢«åˆ é™¤åï¼Œæ”¾åˆ°freelisté‡Œ æ£€æŸ¥å…¶ä»–çº¿ç¨‹çš„é£é™©æŒ‡é’ˆï¼Œçœ‹çœ‹æœ‰æ²¡æœ‰å’ŒAç›¸åŒçš„åœ°å€ï¼Œå¦‚æœæ²¡æœ‰å…¶ä»–èŠ‚ç‚¹æ­£åœ¨è®¿é—®Aï¼ŒAå¯ä»¥è¢«é‡Šæ”¾ ä¼˜åŒ–ï¼šé£é™©æŒ‡é’ˆè‡ªèº«ä¹Ÿè¦ä¿è¯çº¿ç¨‹å®‰å…¨ï¼Œéœ€è¦é«˜æ•ˆå®ç°â€”â€”shared_ptr ä½¿ç”¨shared-ptrç»„ç»‡é“¾è¡¨ï¼Œæ¯ä¸ªListNode*éƒ½æ˜¯æ™ºèƒ½æŒ‡é’ˆã€‚ å­˜åœ¨çš„é—®é¢˜ï¼š éå†é“¾è¡¨æ—¶ï¼Œæ¯èµ°è¿‡ä¸€ä¸ªèŠ‚ç‚¹ï¼Œè¯¥èŠ‚ç‚¹å¼•ç”¨æ•°+1ï¼Œç¦»å¼€æ—¶å¼•ç”¨æ•°-1ï¼ŒåŸå­æ“ä½œæ¯”è¾ƒæ…¢ï¼Œå› æ­¤æœç´¢é€Ÿåº¦æ…¢ï¼Œä¸æ»¡è¶³CSDSçš„åŸåˆ™ é‡‡ç”¨é€’å½’æ–¹å¼é‡Šæ”¾æ•´ä¸ªé“¾è¡¨ï¼Œæˆ–è€…é“¾è¡¨ä¸­çš„ä¸€æ®µï¼Œå¯èƒ½ä¼šå¯¼è‡´æ ˆæº¢å‡º å¦‚æœä¸€ä¸ªçº¿ç¨‹è·å¾—ä¸€ä¸ªç»“ç‚¹çš„å¼•ç”¨è®¡æ•°ï¼Œä½†è¢«å¡ä½äº†ä¸€æ®µæ—¶é—´ä¹‹åæ‰ä¼šé‡Šæ”¾è¿™ä¸ªè®¡æ•°ï¼Œè¯¥èŠ‚ç‚¹æ‰€æœ‰çš„åç»§èŠ‚ç‚¹éƒ½ä¼šè¢«å»¶è¿Ÿé‡Šæ”¾ å¹¶è¡Œæ‰©å¼ æ ‘P-treeSunYihan Parallel Ordered Sets Using Join 2016,PAM: Parallel Augmented Maps 2018,Join-based Parallel Balanced Binary Trees 2019 å¯¹äºå­˜å‚¨åœ¨ç£ç›˜ä¸Šçš„ä¸Šä¸‡ä¸ªå›¾èŠ‚ç‚¹ï¼Œåœ¨åšå›¾ç®—æ³•æ—¶ï¼Œå¯¹å›¾è¿›è¡Œè™šæ‹ŸåŒ–ã€‚è™šæ‹Ÿå›¾å¯ä»¥ä½¿ç”¨å¦‚ä¸‹ä¸¤ç§æ–¹å¼æ¥åŠ¨æ€æ„å»ºï¼š1. â€œä¸­æ–­â€å¼çš„æ„å»ºï¼›2. å¤šçº¿ç¨‹çš„æ„å»ºï¼Œå³å­˜åœ¨ä¸€ä¸ªæ‰«æçº¿ç¨‹ï¼Œåå°æ‰«ææ»¡è¶³è¦æ±‚çš„èŠ‚ç‚¹ï¼ŒåŠ è½½åˆ°è™šæ‹Ÿå›¾ä¸­ã€‚ æ‰€è°“â€œä¸­æ–­â€å¼çš„æ„å»ºï¼Œæ˜¯æŒ‡è¦éå†åˆ°çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ä¸åœ¨è™šæ‹Ÿå›¾ä¸Šï¼Œè§¦å‘â€œä¸­æ–­â€ï¼Œå¼€å§‹ä»ç£ç›˜åŠ è½½ä¸€æ‰¹æ–°çš„å›¾èŠ‚ç‚¹è¿›æ¥ã€‚è€Œå¤šçº¿ç¨‹æ„å»ºæ–¹å¼ï¼Œåˆ™æ˜¯åŠ¨æ€å¸è½½å·²ç»è®¿é—®è¿‡çš„èŠ‚ç‚¹ï¼ŒåŒæ—¶åŠ¨æ€åŠ è½½æ–°çš„èŠ‚ç‚¹ã€‚ä¸ºäº†æé«˜å¯¹è™šæ‹Ÿå›¾è¯»å†™çš„å¹¶å‘æ€§ï¼Œå°±éœ€è¦ä½¿ç”¨ä¸€ç§æ•°æ®ç»“æ„ï¼šParrellel Auguemented Map. ä¸¤ä¸ªåŸºæœ¬å‡½æ•°ï¼š join(l,k,R)ï¼Œè¡¨ç¤ºä»¥kä¸ºæ ¹èŠ‚ç‚¹è¿æ¥çš„å·¦å³ä¸¤æ£µå­æ ‘LR expose(T)è¡¨ç¤ºä»¥æ ‘Tçš„æ ¹kä½œä¸ºåˆ†è£‚èŠ‚ç‚¹ï¼Œå°†æ ‘åˆ†è£‚ä¸ºLï¼Œkï¼ŒRå¹¶è¿”å› ç›¸å…³å‡½æ•°ï¼š split ()ä»¥kä¸ºèŠ‚ç‚¹åˆ’åˆ†æ ‘ï¼Œè¿”å›å·¦å­æ ‘ï¼Œå³å­æ ‘å’Œæ˜¯å¦null split(T,k) if T = null (null,false,null) else (L,m,R)=expose(T) if k = m (L,true,R) else if k &lt; m (LL,b,LR)=split(L,k) (LL,b,join(LR,m,R)) else (RL,b,RR)=split(R,k) (join(L,m,RL),b,RR) insertï¼ˆï¼‰æ’å…¥ä¸€ä¸ªæ–°èŠ‚ç‚¹ insert(T,k) (TL,m,TR)=split(T,k) join(TL,k,TR) splitlast() ç§»é™¤Tæœ€å¤§å€¼çš„èŠ‚ç‚¹ï¼ˆå³å³å­æ ‘çš„æœ€ä¸‹æ–¹çš„å€¼ï¼Œè¿”å›ç§»é™¤åçš„å¹³è¡¡æ ‘å’Œç§»é™¤çš„èŠ‚ç‚¹ï¼‰ splitlast(T) (L,k,R)=expose(T) if R=null (L,k) else (T',k')=splitLast(R) (join(L,k,T'),k') join2() å°†ä¸¤æ£µæ ‘æ‹¼æ¥èµ·æ¥ï¼Œæ ¹èŠ‚ç‚¹ä¸ºå·¦å­æ ‘çš„æœ€å¤§æ ¹ join2(TL,TR) if TL = null TR else (TL',k)=splitlast(TL) join(TL',k,TR) delete()ä»Tä¸­åˆ é™¤ä¸€ä¸ªèŠ‚ç‚¹k delete(T,k) (TL,m,TR)=split(T,k) join2(TL,TR) ä»¥ä¸Šçš„å‡ ä¸ªå‡½æ•°æœªæ¶‰åŠå¹¶å‘ï¼Œåœ¨ä»¥ä¸Šçš„åŸºç¡€ä¸Šï¼Œä½¿ç”¨å¹¶å‘è¿›è¡Œå®ç°ä»¥ä¸‹å‡½æ•°ï¼š(ç”¨æ¥å¤„ç†èŠ‚ç‚¹è¿‡å¤šçš„æƒ…å†µï¼Œæé«˜æ•ˆç‡) å…¶ä¸­ï¼Œ||è¡¨ç¤ºå·¦å³ä¸¤è¾¹çš„å‡½æ•°å¯ä»¥å¹¶å‘è¿›è¡Œ union()å°†ä¸¤ä¸ªæ ‘åˆå¹¶æˆä¸€ä¸ªæ–°çš„æ ‘ union(T1,T2) if T1 = null T2 else if T2 = null T1 else (L2,k,R2)=expose(T2) (L1,m,R1)=spilt(T1,k) TL=union(L1,L2)|| TR=union(R1,R2) join(TL,k,TR) difference(T1,T2) å°†T1ä¸­åŒ…å«T2çš„èŠ‚ç‚¹åˆ é™¤ï¼Œå¯ä»¥ç”¨æ¥æ‰¹é‡åˆ é™¤èŠ‚ç‚¹ difference(T1,T2) if T1=null null else if T2=null T1 else (L2,k,R2)=expose(T2) (L1,m,R2)=split(T1,k) T1=difference(L1,L2) || T2=difference(R1,R2) join2(T1,TR)","categories":[{"name":"HPC","slug":"HPC","permalink":"http://sn1987a-1.github.io/categories/HPC/"}],"tags":[{"name":"å¹¶è¡Œæ•°æ®ç»“æ„","slug":"å¹¶è¡Œæ•°æ®ç»“æ„","permalink":"http://sn1987a-1.github.io/tags/%E5%B9%B6%E8%A1%8C%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}]},{"title":"CGO","slug":"CGOåŸºç¡€çŸ¥è¯†","date":"2023-09-20T12:48:34.000Z","updated":"2023-09-23T13:03:50.253Z","comments":true,"path":"posts/d4c66f48.html","link":"","permalink":"http://sn1987a-1.github.io/posts/d4c66f48.html","excerpt":"","text":"CGOåœ¨Goä¸­è°ƒç”¨Cçš„ä»£ç //include \"xxx.h\" import \"C\" C.puts(helloworld) .hæ–‡ä»¶ä¸­å£°æ˜å‡½æ•°ï¼Œ.c/.cppæ–‡ä»¶å¯¹åº”å‡½æ•°çš„å®šä¹‰ import â€œCâ€å‰é¢çš„æ³¨é‡Šå³ä¸ºè¦è¿è¡Œçš„Cä»£ç  é»˜è®¤Cï¼Œå¦‚æœéœ€è¦ç”¨C++ï¼ˆcppæ–‡ä»¶ï¼‰ï¼Œè¦å£°æ˜ï¼š #include &lt;iostream&gt; export \"C\"{ #include &lt;xxx.h&gt; } Goç”ŸæˆCå‡½æ•° é€šè¿‡ä½¿ç”¨extern \"C\"ï¼Œå¯ä»¥ç¡®ä¿å‡½æ•°åœ¨Cé“¾æ¥ä¸‹å¯ç”¨ï¼Œä»è€Œå…è®¸ä»Cä»£ç ä¸­è°ƒç”¨å®ƒï¼Œè€Œä¸ä¼šå—åˆ°C++åç§°é‡æ•´çš„å½±å“ã€‚ //export funct func funct (){ ... } ... func main(){ C.funct() } ä½¿ç”¨goé‡æ–°å®ç°Cè¯­è¨€å‡½æ•°ã€‚ goå‡½æ•°C.CSstring()å°†å­—ç¬¦ä¸²è½¬åŒ–ä¸º(const)char* ä¸Šè¿°å‡½æ•°è¿è¡Œè¿‡ç¨‹ï¼š Goçš„mainå‡½æ•°æ‰§è¡Œï¼Œåˆ°CGOè‡ªåŠ¨ç”Ÿæˆçš„Cè¯­è¨€ç‰ˆæœ¬çš„functæ¡¥æ¥å‡½æ•°ï¼Œå›åˆ°GOä¸­çš„functå‡½æ•°ã€‚ Cè¯­è¨€å¯ä»¥è°ƒç”¨GOç”Ÿæˆçš„å‡½æ•°ï¼ŒCGOçœçš„â€_cgi_export.hâ€åŒ…å«äº†å¯¼å‡ºåçš„Cè¯­è¨€å‡½æ•°å£°æ˜ ç±»å‹è½¬åŒ–æ•°å­—ç±»å‹è½¬åŒ–ï¼š C è¯­è¨€ç±»å‹ CGO ç±»å‹ Go è¯­è¨€ç±»å‹ char C.char byte signed char C.schar int8 unsigned char C.uchar uint8 short C.short int16 unsigned short C.ushort uint16 int C.int int32 unsigned int C.uint uint32 long C.long int32 unsigned long C.ulong uint32 long long int C.longlong int64 unsigned long long int C.ulonglong uint64 float C.float float32 double C.double float64 size_t C.size_t uint åœ¨CGOç”Ÿæˆçš„_cgo_export.hå¤´æ–‡ä»¶ä¸­ï¼Œä¼šä¸ºgoçš„å­—ç¬¦ä¸²ï¼Œåˆ‡ç‰‡ï¼Œå­—å…¸ï¼Œæ¥å£ï¼Œç®¡é“ç­‰ç‰¹æ®Šæ•°æ®ç»“æ„ç”Ÿæˆå¯¹åº”çš„Cè¯­è¨€ç±»å‹ã€‚ï¼ˆåªæœ‰åˆ‡ç‰‡å’Œå­—ç¬¦ä¸²æœ‰ä¸€å®šçš„è°ƒç”¨ä»·å€¼ï¼Œå› CGOå¯¹ä»–ä»¬çš„æŸäº›æ“ä½œå‡½æ•°ç”Ÿæˆäº†å¯¹åº”çš„Cè¯­è¨€ç‰ˆæœ¬ï¼‰ typedef struct {const char *p; GoInt n;} GoString; typedef void *GoMap; typedef void *GoChan; typedef struct {void *t; void *v;} GoInterface; typedef struct {void *data; GoInt len; GoInt cap;} GoSlice; ç»“æ„ä½“ é€šè¿‡C.struct_xxxè®¿é—®Cä¸­å®šä¹‰çš„struct xxxçš„ç»“æ„ä½“ç±»å‹ï¼Œç»“æ„ä½“å†…å­˜å¸ƒå±€æŒ‰ç…§Cè¯­è¨€é€šç”¨å¯¹é½è§„åˆ™ï¼ˆ32/64ä½ï¼‰ï¼Œè‹¥ç»“æ„ä½“çš„æˆå‘˜çš„åå­—æ˜¯goçš„å…³é”®å­—ï¼Œå¯ä»¥åœ¨æˆå‘˜åå¼€å¤´æ·»åŠ _æ¥è®¿é—® /* struct A { int type; // type æ˜¯ Go è¯­è¨€çš„å…³é”®å­— }; */ import \"C\" import \"fmt\" func main() { var a C.struct_A fmt.Println(a._type) // _type å¯¹åº” type } å¦‚æœæ°å¥½æœ‰ä¸¤ä¸ªæˆå‘˜ type,_typeï¼Œåˆ™typeå°†è¢«å±è”½ã€‚ Cè¯­è¨€ä¸­æ— æ³•ç›´æ¥è®¿é—®Goå®šä¹‰çš„ç»“æ„ä½“ç±»å‹ã€‚ åˆ‡ç‰‡å’Œå­—ç¬¦ä¸² Goä¸­çš„åˆ‡ç‰‡å’ŒCä¸­çš„æŒ‡å‘ä¸€å®šé•¿åº¦å†…å­˜çš„æŒ‡é’ˆï¼ˆsliceå®é™…ä¸Šæ˜¯ç®€åŒ–ç‰ˆçš„åŠ¨æ€æ•°å­—ï¼‰ goä¸­çš„å­—ç¬¦ä¸²æ˜¯åªè¯»çš„ æŒ‡é’ˆ Cè¯­è¨€ä¸­çš„æŒ‡é’ˆå¯ä»¥è¿›è¡Œæ˜¾ç¤ºæˆ–éšå¼åˆ‡æ¢ï¼ˆéšå¼ä¼šåœ¨ç¼–è¯‘é˜¶æ®µç»™å‡ºwarningsï¼‰ï¼Œgoå¯¹ä¸åŒç±»å‹çš„è½¬æ¢éå¸¸ä¸¥æ ¼ï¼Œæ— æ³•è‡ªç”±è½¬æ¢ã€‚å¦‚æœæ ¼å¼ä¸€è‡´ï¼ŒæŒ‡é’ˆå¯ä»¥é€šç”¨ã€‚CGOè§£å†³äº†GOæ— æ³•è‡ªç”±è½¬æ¢å’Œè¿›è¡ŒæŒ‡é’ˆè¿ç®—çš„é™åˆ¶ã€‚ var p *X var q *Y q = (*Y)(unsafe.Pointer(p)) // *X =&gt; *Y p = (*X)(unsafe.Pointer(q)) // *Y =&gt; *X ä½¿ç”¨unsafe.Pointerä½œä¸ºä¸­é—´æ¡¥æ¥ç±»å‹å®ç°ä¸åŒç±»å‹æŒ‡é’ˆçš„è½¬æ¢ï¼Œè½¬æ¢æµç¨‹ï¼š*X-&gt;unsafe.pointer-&gt;*Y åŒæ ·ï¼Œgoä¹Ÿæ— æ³•å®ç°æ•°å€¼ç±»å‹è½¬åŒ–ä¸ºæŒ‡é’ˆç±»å‹ï¼Œé‡‡ç”¨uintpträ½œä¸ºä¸­é—´ç±»å‹å®ç°ï¼Œè½¬åŒ–è¿‡ç¨‹ï¼šint32-&gt;uintptr-&gt;unsafe.pointer-&gt;char* å‡½æ•°è°ƒç”¨Cä¸æ”¯æŒå¤šè¿”å›å€¼ï¼Œä½†Goéœ€è¦errorè¿”å›æŠ¥é”™ä¿¡æ¯(å¦‚divé™¤æ•°ä¸º0)ï¼Œè§£å†³æ–¹æ¡ˆï¼š å¼•å…¥errnoåŒ… #include &lt;errno.h&gt; int div(int a, int b) { if(b == 0) { errno = EINVAL; return 0; } return a/b; } CGOçš„å¤„ç†ï¼šåœ¨CGOä¸­å¦‚æœæœ‰ä¸¤ä¸ªè¿”å›å€¼ï¼Œé‚£ä¹ˆç¬¬äºŒä¸ªè¿”å›å€¼ä¸ºerrnoï¼Œå¯ä»¥è¿‘ä¼¼åœ°å°†å‡½æ•°çœ‹ä½œä»¥ä¸‹ç±»å‹ï¼š func C.div(a,b C.int)(C.int,[error]) voidå‡½æ•°è¿”å›å€¼ æŒ‰ç…§å‰æ–‡æ‰€è¿°ï¼Œå¯¹äºæ²¡æœ‰è¿”å›å€¼çš„voidå‡½æ•°ï¼Œå¦‚æœå‡ºç°errnoï¼Œä¹Ÿåªæœ‰ä¸€ä¸ªè¿”å›å€¼ï¼ŒCGOæ— æ³•ç›´æ¥åˆ¤æ–­é”™è¯¯çŠ¶æ€ï¼ŒCGOçš„å¤„ç†å¦‚ä¸‹ï¼š import \"C\" import \"fmt\" func main() { _, err := C.noreturn() fmt.Println(err) }","categories":[{"name":"Golang","slug":"Golang","permalink":"http://sn1987a-1.github.io/categories/Golang/"}],"tags":[{"name":"CGO","slug":"CGO","permalink":"http://sn1987a-1.github.io/tags/CGO/"}]},{"title":"GolangåŸºç¡€çŸ¥è¯†","slug":"GolangåŸºç¡€çŸ¥è¯†","date":"2023-09-18T12:48:34.000Z","updated":"2023-09-23T13:03:58.933Z","comments":true,"path":"posts/c303e9c6.html","link":"","permalink":"http://sn1987a-1.github.io/posts/c303e9c6.html","excerpt":"","text":"golangmapå®ç°ï¼šå“ˆå¸ŒæŸ¥æ‰¾è¡¨ï¼Œé€šè¿‡é“¾è¡¨æ³•è§£å†³å“ˆå¸Œå†²çª éšæœºéå†ï¼Œé¡ºåºæ— æ³•é¢„æµ‹ æ‰©å®¹ç‰¹ç‚¹ï¼šé€æ­¥è¿›è¡Œï¼Œæ–°ï¼Œæ—§bucket éå†ä¸­å‡ºç°æ‰©å®¹ éå†å‰å·²ç»å¼€å§‹æ‰©å®¹ sliceåº•å±‚ç»“æ„ï¼šæœ¬è´¨ä¸Šæ˜¯å¼•ç”¨ç±»å‹ï¼Œåº•å±‚ç»“æ„æœ‰ä¸‰ä¸ªå˜é‡ï¼šlenï¼Œcapï¼Œåº•å±‚æ•°ç»„çš„æŒ‡é’ˆ ç©ºåˆ‡ç‰‡æ—¶ï¼Œcap=len=0 ä¸€èˆ¬åˆå§‹åŒ–æ–¹å¼a:=[]int{}cap=len=åˆå§‹åŒ–é•¿åº¦ ä½¿ç”¨makeè¿›è¡Œåˆå§‹åŒ–ï¼ša:=make([]int,4,5)ï¼šcap=5ï¼Œlen=4ï¼Œaä¸º[0,0,0,0] var a []inté»˜è®¤cap=len=0 appendæ“ä½œ capè¶³å¤Ÿï¼Œç›´æ¥ä¿®æ”¹lenï¼Œè¿½åŠ  capä¸è¶³æ—¶â€¦ capè¶³å¤Ÿæ—¶ï¼Œä¸€æ¬¡è¿½åŠ å¤šä¸ªå’Œå¤šæ¬¡è¿½åŠ ä¸€ä¸ªç»“æœç›¸åŒï¼Œcapä¸è¶³æ—¶ä¼šå‡ºç°ä¸ä¸€æ ·çš„ç»“æœï¼ˆcapçš„ç»“æœä¸åŒï¼Œå¤šæ¬¡è¿½åŠ ä¸€ä¸ªçš„æƒ…å†µå¯èƒ½ä¼šæ›´å¤§ï¼‰ åˆ‡ç‰‡æˆªå–æ“ä½œï¼š åˆ‡ç‰‡è¿›è¡Œæˆªå–æ—¶ï¼Œæ•°ç»„å®¹é‡çš„æœ«å°¾å’ŒåŸåˆ‡ç‰‡æ•°ç»„æœ«å°¾å¯¹é½ï¼Œæ•°ç»„åœ°å€ä¸ºæˆªå–å•å…ƒçš„é¦–åœ°å€ï¼Œä¸”å¯ä»¥è¶…è¿‡å…¶lençš„èŒƒå›´è¿›è¡Œæˆªå–ï¼Œå½“å…¶ä¸­ä¸€ä¸ªæ•°ç»„å‘ç”Ÿæ‰©å®¹æ—¶ï¼Œå¦ä¸€ä¸ªæ•°ç»„çš„åœ°å€ä¸å˜ åˆ‡ç‰‡æ‰©å®¹æ—¶ä¼šæ”¹å˜ï¼šcapå’Œæ•°å­—æŒ‡é’ˆ åƒåœ¾å›æ”¶ å¼•ç”¨è®¡æ•°ï¼Œ0å›æ”¶ï¼Œæ— æ³•å¤„ç† å¾ªç¯å¼•ç”¨ æ ‡è®°-æ¸…é™¤ï¼š éœ€è¦STW åˆ†ä»£æ”¶é›†ï¼šæŒ‰ç…§ç”Ÿå­˜å‘¨æœŸè€/æ–°ä¸åŒçš„ç®—æ³•ï¼Œæ•ˆç‡é«˜ï¼Œç®—æ³•è®¾è®¡å¤æ‚ ä¸‰è‰²æ ‡è®°æ³•ï¼šç™½-åƒåœ¾ï¼Œç°-éå†åˆ°çš„å¯¹è±¡ï¼Œé»‘ï¼Œéå†ç°è‰²ï¼Œæ ‡è®°ä¸ºé»‘è‰²å¹¶å°†å¼•ç”¨çš„å˜é‡æ ‡è®°ä¸ºç°è‰²ï¼Œç›´åˆ°æ²¡æœ‰ç°è‰² æ¯æ¬¡GCå¾ªç¯æ—¶ï¼Œä¸éœ€è¦å°†æ‰€æœ‰å¯¹è±¡ç§»åŠ¨åˆ°ç™½è‰²åŒºåŸŸï¼Œåªè¦å°†é»‘è‰²å’Œç™½è‰²çš„é¢œè‰²äº’æ¢å³å¯ï¼Œæ›´é«˜æ•ˆ STWï¼šå½±å“æ€§èƒ½&lt;1ms å†™å±éšœæŠ€æœ¯ç¼©çŸ­STW å¼•ç”¨å¯¹è±¡ä¸¢å¤±ï¼šé»‘è‰²èŠ‚ç‚¹æ·»åŠ äº†æŒ‡å‘ç™½è‰²ç»“ç‚¹çš„å¼•ç”¨ï¼Œä½†æ— æ³•è¢«æ‰«æ ç ´åä»¥ä¸‹äºŒè€…ä¹‹ä¸€ï¼š dijistraå†™å±éšœï¼ˆå¼ºä¸‰è‰²ä¸å˜æ€§ï¼‰ï¼Œä¸å…è®¸é»‘è‰²èŠ‚ç‚¹å¼•ç”¨ç™½è‰²èŠ‚ç‚¹ï¼Œå¼•ç”¨åˆ™å°†ç™½è‰²èŠ‚ç‚¹æ”¹ä¸ºç°è‰² yuasaå†™å±éšœï¼ˆå¼±ä¸‰è‰²ä¸å˜æ€§ï¼‰ï¼Œç™½è‰²èŠ‚ç‚¹è¢«åˆ é™¤äº†ä¸€ä¸ªå¼•ç”¨æ—¶ï¼Œè®¤ä¸ºä¼šè¢«é»‘è‰²èŠ‚ç‚¹æ–°å¢å¼•ç”¨ï¼ˆæ‚²è§‚ï¼‰ï¼Œè®¾ç½®ä¸ºç°è‰² goçš„åƒåœ¾å›æ”¶å™¨æ˜¯å’Œä¸»ç¨‹åºå¹¶è¡Œçš„ï¼Œå…³é”®åœ¨äºä¸‰è‰²æ ‡è®°æ³•èƒ½è®©ç³»ç»Ÿçš„gcæš‚åœæ—¶é—´èƒ½å¤Ÿé¢„æµ‹ GPMè°ƒåº¦å’ŒCSPæ¨¡å‹ä¸è¦ä»¥å…±äº«å†…å­˜çš„æ–¹å¼æ¥é€šä¿¡ï¼Œè¦ä»¥é€šä¿¡çš„æ–¹å¼æ¥å…±äº«å†…å­˜ CSPæ¨¡å‹ï¼šä»¥é€šä¿¡çš„æ–¹å¼å…±äº«å†…å­˜ï¼ˆchannelè¿›è¡Œé€šä¿¡ï¼‰ GPMå«ä¹‰ Gï¼šgoåç¨‹Goroutine Mï¼šå·¥ä½œçº¿ç¨‹ï¼ŒCPUæ•°é‡ Pï¼šå¤„ç†å™¨ï¼Œç”¨æ¥è°ƒåº¦Gï¼ŒMçš„å…³è”å…³ç³»ï¼ŒMæ‹¥æœ‰Pæ‰èƒ½æ‰§è¡ŒGçš„ä»£ç  Goroutineçš„è°ƒåº¦ç­–ç•¥ é˜Ÿåˆ—è½®è½¬ï¼šPå‘¨æœŸæ€§åœ°è°ƒåº¦Gåˆ°Mä¸­è¿è¡Œï¼Œä¸€æ®µæ—¶é—´åä¿å­˜ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼ˆé˜Ÿåˆ—ï¼‰ ç³»ç»Ÿè°ƒç”¨ï¼šG0å³å°†è¿›å…¥ç³»ç»Ÿè°ƒç”¨æ—¶ï¼ŒM0é‡Šæ”¾Pï¼ŒæŸä¸ªM1è·å¾—Pè¿è¡Œå‰©ä¸‹çš„Gï¼ŒG0ç»“æŸåç­‰å¾…å…¶ä»–çš„Pè°ƒåº¦ï¼ˆæˆ–ç©ºé—²Pï¼‰ï¼Œæ­¤åè¿›å…¥ç¼“å­˜æ± ç¡çœ  ChanåŸç†ï¼ˆchannelï¼‰ type hchan struct { qcount uint // é˜Ÿåˆ—ä¸­çš„æ€»å…ƒç´ ä¸ªæ•° dataqsiz uint // ç¯å½¢é˜Ÿåˆ—å¤§å°ï¼Œå³å¯å­˜æ”¾å…ƒç´ çš„ä¸ªæ•° buf unsafe.Pointer // ç¯å½¢é˜Ÿåˆ—æŒ‡é’ˆ elemsize uint16 //æ¯ä¸ªå…ƒç´ çš„å¤§å° closed uint32 //æ ‡è¯†å…³é—­çŠ¶æ€ elemtype *_type // å…ƒç´ ç±»å‹ sendx uint // å‘é€ç´¢å¼•ï¼Œå…ƒç´ å†™å…¥æ—¶å­˜æ”¾åˆ°é˜Ÿåˆ—ä¸­çš„ä½ç½® recvx uint // æ¥æ”¶ç´¢å¼•ï¼Œå…ƒç´ ä»é˜Ÿåˆ—çš„è¯¥ä½ç½®è¯»å‡º recvq waitq // ç­‰å¾…è¯»æ¶ˆæ¯çš„goroutineé˜Ÿåˆ— sendq waitq // ç­‰å¾…å†™æ¶ˆæ¯çš„goroutineé˜Ÿåˆ— lock mutex //äº’æ–¥é”ï¼Œchanä¸å…è®¸å¹¶å‘è¯»å†™ } å†™æ•°æ® recvqä¸ä¸ºç©ºï¼Œç¼“å†²åŒºæ— æ•°æ®/æ— ç¼“å†²åŒºï¼Œåˆ™ç›´æ¥ä»recvqå–å‡ºGï¼Œå†™å…¥æ•°æ®ï¼Œå¹¶æŠŠGå”¤é†’ ç¼“å†²åŒºæœ‰ç©ºä½™ä½ç½®ï¼Œå†™å…¥ç¼“å†²åŒº ç¼“å†²åŒºæ— ç©ºä½™ä½ç½®ï¼Œå°†æ•°æ®å†™å…¥Gï¼Œå°†å½“å‰GåŠ å…¥sendqï¼Œè¿›å…¥ç¡çœ è¢«å”¤é†’ è¯»æ•°æ® sendqä¸ä¸ºç©ºï¼Œä¸”æ— ç¼“å†²åŒºï¼Œç›´æ¥ä»sendqå»é™¤Gï¼ŒæŠŠGæ•°æ®è¯»èµ°å¹¶å”¤é†’ sendqä¸ä¸ºç©ºï¼ˆç¼“å†²åŒºå·²æ»¡ï¼‰ï¼Œä»ç¼“å†²åŒºé¦–éƒ¨è¯»å‡ºæ•°æ®ï¼Œå°†Gä¸­çš„æ•°æ®å†™å…¥ç¼“å†²åŒºå°¾éƒ¨ï¼Œå”¤é†’G ç¼“å†²åŒºæœ‰æ•°æ®ï¼Œä»ç¼“å†²åŒºè¯»å–æ•°æ® å°†å½“å‰GåŠ å…¥recvqè¿›å…¥ç¡çœ  å…³é—­channel å”¤é†’recvqä¸­æ‰€æœ‰çš„Gï¼Œæœ¬è¯¥å†™å…¥æ•°æ®çš„å†…å®¹ä¸ºnilï¼Œsendqä¸­çš„Gå”¤é†’ï¼ˆä¼šå‡ºç°panicï¼‰ panicå‡ºç°çš„åœºæ™¯ å…³é—­å€¼ä¸ºnilçš„channel å…³é—­å·²ç»å…³é—­çš„channel å‘å·²å…³é—­çš„channelå†™å…¥æ•°æ® æ— ç¼“å†²åŒºæƒ…å†µï¼šè¯»å’Œå†™åŒæ­¥ï¼ˆä¼šé˜»å¡ï¼‰ contextä¸Šä¸‹æ–‡ç»“æ„å¹¶å‘å®‰å…¨ï¼Œæ ‘çŠ¶çš„goroutine åªå®šä¹‰äº†æ¥å£ type Context interface { Deadline() (deadline time.Time, ok bool) Done() &lt;-chan struct{} Err() error Value(key interface{}) interface{} } deadlineï¼šåˆ°è¾¾ddlè‡ªåŠ¨å‘èµ·å–æ¶ˆè¯·æ±‚ Doneï¼šè¿”å›åªè¯»çš„channelï¼Œå¦‚æœå¯ä»¥è¯»å–è¯´æ˜å·²ç»å‘å‡ºå–æ¶ˆä¿¡å·ï¼Œå¯ä»¥æ¸…ç†å¹¶é‡Šæ”¾ errï¼šè¿”å›è¢«å–æ¶ˆçš„åŸå›  valueï¼šè·å–contextä¸Šç»‘å®šçš„å€¼ï¼Œkey-value ç«æ€ä¸å†…å­˜é€ƒé€¸ ç«æ€ï¼šåœ¨ç¨‹åºä¸­ï¼ŒåŒä¸€ä¸ªå†…å­˜å—è¢«å¤šä¸ªgorountineè®¿é—® è§£å†³ï¼šå¯¹èµ„æºè¿›è¡ŒåŠ é”ï¼Œsync.Mutex,sync.RWMutex æ£€æµ‹ï¼šæ·»åŠ -race é€ƒé€¸åˆ†æï¼šå†…å­˜çš„åˆ†é…ä½ç½®ç”±ç¼–è¯‘å™¨å†³å®šï¼Œåˆ†é…é€Ÿåº¦æ…¢ä¸”ä¼šå½¢æˆå†…å­˜ç¢ç‰‡ ä»¥ä¸‹åœºæ™¯ æŒ‡é’ˆé€ƒé€¸ æ ˆç©ºé—´ä¸è¶³é€ƒé€¸ åŠ¨æ€ç±»å‹é€ƒé€¸ é—­åŒ…å¼•ç”¨å¯¹è±¡é€ƒé€¸ é›¶ç¢å®‰å…¨è¯»å†™å…±äº«å˜é‡æ–¹å¼ Mutexé” goroutineé€šè¿‡channel newå’Œmakeçš„åŒºåˆ« makeç”¨æ¥åˆ†é…å’Œåˆå§‹åŒ–ç±»å‹ä¸ºsliceï¼Œmapï¼Œchançš„æ•°æ®ï¼Œnewä»»æ„æ•°æ®å¹¶è¿”å›å†…å­˜æŒ‡é’ˆ makeè¿”å›å¼•ç”¨ï¼Œå³typeï¼Œåˆ†é…ç©ºé—´åè¿›è¡Œåˆå§‹ï¼Œnewåˆ†é…çš„ç©ºé—´ä¼šè¢«æ¸…é›¶ å¯¹nilçš„sliceå’Œç©ºsilceçš„å¤„ç†åŒºåˆ« slice:=make([]int,0)ï¼šç©ºsliceï¼Œä¸ä¸º0 slice:=[]int{} å€¼æ˜¯nilï¼Œä¿è¯è¿”å›sliceçš„å‡½æ•°å¼‚å¸¸æ—¶ä»å¯ä¿è¯è¿”å›nil åç¨‹ï¼Œè¿›ç¨‹ï¼Œçº¿ç¨‹çš„åŒºåˆ« è¿›ç¨‹: è¿›ç¨‹æ˜¯å…·æœ‰ä¸€å®šç‹¬ç«‹åŠŸèƒ½çš„ç¨‹åºï¼Œè¿›ç¨‹æ˜¯ç³»ç»Ÿèµ„æºåˆ†é…å’Œè°ƒåº¦çš„æœ€å°å•ä½ã€‚ æ¯ä¸ªè¿›ç¨‹éƒ½æœ‰è‡ªå·±çš„ç‹¬ç«‹å†…å­˜ç©ºé—´ï¼Œä¸åŒè¿›ç¨‹é€šè¿‡è¿›ç¨‹é—´é€šä¿¡æ¥é€šä¿¡ã€‚ç”±äºè¿›ç¨‹æ¯”è¾ƒé‡é‡ï¼Œå æ®ç‹¬ç«‹çš„å†…å­˜ï¼Œæ‰€ä»¥ä¸Šä¸‹æ–‡è¿›ç¨‹é—´çš„åˆ‡æ¢å¼€é”€ï¼ˆæ ˆã€å¯„å­˜å™¨ã€è™šæ‹Ÿå†…å­˜ã€æ–‡ä»¶å¥æŸ„ç­‰ï¼‰æ¯”è¾ƒå¤§ï¼Œä½†ç›¸å¯¹æ¯”è¾ƒç¨³å®šå®‰å…¨ã€‚ çº¿ç¨‹: çº¿ç¨‹æ˜¯è¿›ç¨‹çš„ä¸€ä¸ªå®ä½“,çº¿ç¨‹æ˜¯å†…æ ¸æ€,è€Œä¸”æ˜¯CPUè°ƒåº¦å’Œåˆ†æ´¾çš„åŸºæœ¬å•ä½,å®ƒæ˜¯æ¯”è¿›ç¨‹æ›´å°çš„èƒ½ç‹¬ç«‹è¿è¡Œçš„åŸºæœ¬å•ä½ã€‚çº¿ç¨‹é—´é€šä¿¡ä¸»è¦é€šè¿‡å…±äº«å†…å­˜ï¼Œä¸Šä¸‹æ–‡åˆ‡æ¢å¾ˆå¿«ï¼Œèµ„æºå¼€é”€è¾ƒå°‘ï¼Œä½†ç›¸æ¯”è¿›ç¨‹ä¸å¤Ÿç¨³å®šå®¹æ˜“ä¸¢å¤±æ•°æ®ã€‚ åç¨‹: åç¨‹æ˜¯ä¸€ç§ç”¨æˆ·æ€çš„è½»é‡çº§çº¿ç¨‹ï¼Œåç¨‹çš„è°ƒåº¦å®Œå…¨æ˜¯ç”±ç”¨æˆ·æ¥æ§åˆ¶çš„ã€‚åç¨‹æ‹¥æœ‰è‡ªå·±çš„å¯„å­˜å™¨ä¸Šä¸‹æ–‡å’Œæ ˆã€‚ åç¨‹è°ƒåº¦åˆ‡æ¢æ—¶ï¼Œå°†å¯„å­˜å™¨ä¸Šä¸‹æ–‡å’Œæ ˆä¿å­˜åˆ°å…¶ä»–åœ°æ–¹ï¼Œåœ¨åˆ‡å›æ¥çš„æ—¶å€™ï¼Œæ¢å¤å…ˆå‰ä¿å­˜çš„å¯„å­˜å™¨ä¸Šä¸‹æ–‡å’Œæ ˆï¼Œç›´æ¥æ“ä½œæ ˆåˆ™åŸºæœ¬æ²¡æœ‰å†…æ ¸åˆ‡æ¢çš„å¼€é”€ï¼Œå¯ä»¥ä¸åŠ é”çš„è®¿é—®å…¨å±€å˜é‡ï¼Œæ‰€ä»¥ä¸Šä¸‹æ–‡çš„åˆ‡æ¢éå¸¸å¿«ã€‚ golangçš„å†…å­˜æ¨¡å‹ä¸­ï¼Œä¸ºä»€ä¹ˆå°å¯¹è±¡å¤šäº†ä¼šåŠ å¤§GCå‹åŠ› å°å¯¹è±¡è¿‡å¤šä¼šå¯¼è‡´GCä¸‰è‰²æ³•æ¶ˆè€—è¿‡å¤šCPU è§£å†³æ€è·¯ï¼šå‡å°‘å¯¹è±¡åˆ†é… channelä¸ºä»€ä¹ˆå¯ä»¥åšåˆ°çº¿ç¨‹å®‰å…¨ å…ˆè¿›å…ˆå‡ºï¼Œæœ¬èº«ç”¨æ¥åœ¨å¤šä»»åŠ¡é—´ä¼ é€’æ•°æ®ï¼Œé€šè¿‡é€šä¿¡å…±äº«å†…å­˜ï¼Œæœ‰å¤©ç„¶ä¼˜åŠ¿ GCè§¦å‘æ¡ä»¶ æ‰‹åŠ¨è§¦å‘ï¼ˆä¸»åŠ¨ï¼‰ï¼šè°ƒç”¨runtime.GCï¼Œé˜»å¡å¼ è¢«åŠ¨è§¦å‘ï¼š ç³»ç»Ÿç›‘æ§ï¼Œè¶…è¿‡ä¸¤åˆ†é’Ÿæ²¡æœ‰GCåˆ™è§¦å‘ pacingï¼ˆæ­¥è°ƒï¼‰ç®—æ³•ï¼Œæ§åˆ¶å†…å­˜å¢é•¿çš„æ¯”ä¾‹ï¼Œæ¯æ¬¡åˆ†é…å†…å­˜æ—¶æ£€æµ‹æ˜¯å¦ä»¥è¾¾åˆ°é˜ˆå€¼ï¼Œé»˜è®¤100% goroutineçš„æ•°é‡æŸ¥çœ‹å’Œé™åˆ¶ æŸ¥çœ‹ï¼š GOMAXPROCSæ§åˆ¶æœªè¢«é˜»å¡çš„æ‰€æœ‰goroutineï¼Œé€šè¿‡GOMAXPROCEå³å¯æŸ¥çœ‹ é™åˆ¶ï¼šä½¿ç”¨channelï¼Œæ¯æ¬¡æ‰§è¡Œgoroutineå‰å‘é€šé“å†™å…¥å€¼ Channelæ˜¯åŒæ­¥è¿˜æ˜¯å¼‚æ­¥çš„ â€‹ å¼‚æ­¥çš„ channelçš„çŠ¶æ€ï¼š nilï¼Œåˆå§‹æˆ–æ‰‹åŠ¨èµ‹å€¼ï¼Œæ— æ³•å…³é—­ï¼ˆpanicï¼‰ï¼Œsend/recvè¢«æ°¸ä¹…é˜»å¡ closedï¼Œå…³é—­æˆ–sendä¼španicï¼Œrecvä¸ä¼šé˜»å¡ activeï¼Œå¯å…³é—­ï¼Œsend/recv goroutine å’Œçº¿ç¨‹çš„åŒºåˆ« çº¿ç¨‹å¯ä»¥æœ‰å¤šä¸ªgoroutine çº¿ç¨‹ï¼Œè¿›ç¨‹éƒ½æ˜¯åŒæ­¥çš„ï¼Œåç¨‹æ˜¯å¼‚æ­¥çš„ åç¨‹å¯ä»¥ä¿ç•™ä¸Šä¸€æ¬¡è°ƒç”¨çš„çŠ¶æ€ åç¨‹éœ€è¦çº¿ç¨‹æ¥æ‰¿è½½è¿è¡Œï¼Œä¸èƒ½ä»£æ›¿çº¿ç¨‹ çº¿ç¨‹æ˜¯åˆ†å‰²çš„CPUèµ„æºï¼Œåç¨‹æ˜¯ç»„ç»‡å¥½çš„ä»£ç æµç¨‹ structèƒ½ä¸èƒ½æ¯”è¾ƒ ç›¸åŒstructç±»å‹å¯ä»¥ ä¸åŒstructä¸èƒ½æ¯”è¾ƒï¼Œç¼–è¯‘ä¸é€šè¿‡ goä¸»åç¨‹å¦‚ä½•ç­‰å¾…å…¶ä»–åç¨‹ ç”¨sync.WaitGroupï¼Œå†…éƒ¨å®ç°è®¡æ•°å™¨è®¡æ•°æœªå®Œæˆçš„æ“ä½œä¸ªæ•°ï¼ŒAdd()æ·»åŠ è®¡æ•°ï¼ŒDone()è®¡æ•°å‡ä¸€ï¼ŒWait()ç­‰å¾…æ‰€æœ‰æ“ä½œç»“æŸï¼Œè®¡æ•°ä¸º0ï¼ˆç«‹å³è¿”å›ï¼‰ sliceæ‰©å®¹ appendè¿½åŠ å…ƒç´ ï¼Œç©ºé—´ä¸è¶³åˆ™æ‰©å®¹ï¼Œé‡æ–°åˆ†é…slice æ‰©å®¹è§„åˆ™ï¼ˆåªå¯¹å®¹é‡ï¼‰ å°äº1024ï¼šæ‰©å®¹æ—¶ç¿»å€ï¼Œè¶…è¿‡1024ï¼Œå¢é•¿å› å­å˜ä¸º1.25 å®¹é‡å¤Ÿç”¨åˆ™è¿½åŠ ï¼Œlen++ å®¹é‡ä¸å¤Ÿç”¨ï¼Œå…ˆæ‰©å®¹å†è¿½åŠ  mapé¡ºåºè¯»å– ï¼ˆä¸€èˆ¬æ˜¯éšæœºçš„ï¼‰ å…ˆæŠŠmapä¸­çš„keyç”¨sortæ’åºåæ ¹æ®keyè¯»å– å€¼æ¥æ”¶è€…å’ŒæŒ‡é’ˆæ¥æ”¶è€… æ–¹æ³•çš„æ¥æ”¶è€… å€¼ç±»å‹ï¼šå¯ä»¥è°ƒç”¨å€¼æ¥æ”¶è€…çš„æ–¹æ³•å’ŒæŒ‡é’ˆæ¥æ”¶è€…çš„æ–¹æ³• æŒ‡é’ˆç±»å‹ï¼šå¯ä»¥è°ƒç”¨å€¼æ¥æ”¶è€…çš„æ–¹æ³•å’ŒæŒ‡é’ˆæ¥æ”¶è€…çš„æ–¹æ³• æ¥å£å®ç°ä¸åŒï¼š å€¼ç±»å‹æ¥å£ï¼šç±»å‹æœ¬èº«å’Œè¯¥ç±»å‹çš„æŒ‡é’ˆç±»å‹éƒ½å®ç°äº†è¯¥æ¥å£ æŒ‡é’ˆç±»å‹æ¥å£ï¼šåªæœ‰å¯¹åº”çš„æŒ‡é’ˆç±»å‹æ‰è¢«è®¤ä¸ºå®ç°äº†æ¥å£ é€šå¸¸ä½¿ç”¨æŒ‡é’ˆä½œä¸ºæ–¹æ³•çš„æ¥æ”¶è€… èƒ½å¤Ÿä¿®æ”¹æ¥æ”¶è€…æŒ‡å‘çš„å€¼ é¿å…æ¯æ¬¡è°ƒç”¨æ–¹æ³•æ—¶å¤åˆ¶è¯¥å€¼ï¼Œæ›´é«˜æ•ˆ å‘ç”Ÿå†…å­˜æ³„æ¼çš„åŸå›  goroutineéœ€è¦ç»´æŠ¤ç”¨æˆ·ä»£ç çš„ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œè¿è¡Œè¿‡ç¨‹ä¸­éœ€è¦æ¶ˆè€—ä¸€å®šçš„å†…å­˜æ¥ä¿å­˜æ­¤ç±»ä¿¡æ¯ï¼Œå¦‚æœä¸€ä¸ªç¨‹åºä¸æ–­äº§ç”Ÿgoroutineï¼Œä¸ç»“æŸå·²åˆ›å»ºçš„goroutineå¹¶å¤ç”¨è¯¥éƒ¨åˆ†å†…å­˜ï¼Œä¼šé€ æˆå†…å­˜æ³„æ¼ åç¨‹æ³„éœ²ï¼šï¼ˆæŸæ®µä»£ç å¡ä½ï¼Œé™·å…¥æ­»å¾ªç¯ç­‰ï¼‰åº”è¯¥è¢«é‡Šæ”¾çš„åç¨‹æ²¡æœ‰è¢«æ­£ç¡®é‡Šæ”¾ å¦‚ä½•æ£€æµ‹å†…å­˜æ³„æ¼ è‡ªå¸¦çš„å·¥å…·ï¼špprofï¼Œæˆ–è€…ç”¨Gopsæ£€æµ‹å½“å‰è¿è¡Œçš„goç¨‹å ç”¨çš„èµ„æº ä¸¤ä¸ªnilå¯èƒ½ä¸ç›¸ç­‰ æ¥å£interfaceæ˜¯å¯¹æ¥å£å€¼çš„å°è£…ï¼Œå†…éƒ¨åŒ…å«ç±»å‹Tå’Œå€¼Vï¼Œä¸€ä¸ªæ¥å£ä¸ºnilå½“ä¸”ä»…å½“T=nilï¼ŒV=unset ä¸¤ä¸ªæ¥å£æ¯”è¾ƒæ—¶ï¼Œå…ˆæ¯”è¾ƒTå†æ¯”è¾ƒV(æ¥å£å€¼å’Œéæ¥å£å€¼è¿›è¡Œæ¯”è¾ƒä¼šå°†éæ¥å£å€¼è½¬åŒ–ä¸ºæ¥å£å€¼) ä¾‹å¦‚var p *int =nilè½¬åŒ–ä¸ºæ¥å£å€¼T=*intï¼Œæ˜¾ç„¶å’Œå€¼ä¸ºnilçš„æ¥å£ä¸ç›¸ç­‰ å‡½æ•°ä¼ å‚æ˜¯å€¼ç±»å‹è¿˜æ˜¯å¼•ç”¨ç±»å‹ åªå­˜åœ¨å€¼ä¼ é€’ï¼ˆå€¼æˆ–æŒ‡é’ˆçš„å‰¯æœ¬ï¼‰ï¼Œéƒ½ä¼šå¼€è¾Ÿæ–°çš„ç©ºé—´ ä¸è¦æ··æ·†å€¼ä¼ é€’ï¼Œå¼•ç”¨ä¼ é€’å’Œå€¼ç±»å‹ï¼Œå¼•ç”¨ç±»å‹ å†…å­˜å¯¹é½ CPUéƒ½æ˜¯ä»¥å­—é•¿è®¿é—®çš„ï¼ˆ32ä½ï¼Œ64ä½ï¼‰ï¼Œä¸è¿›è¡Œå†…å­˜å¯¹é½ä¼šå¢åŠ CPUè®¿é—®å†…å­˜çš„æ¬¡æ•°ï¼Œå†…å­˜å¯¹é½å¯¹å®ç°å˜é‡çš„åŸå­æ€§æ“ä½œæœ‰å¥½å¤„ï¼ˆå¹¶å‘åœºæ™¯ä¸‹ï¼‰ ä¸¤ä¸ªinterfaceçš„æ¯”è¾ƒ åˆ¤æ–­ç±»å‹æ˜¯å¦ä¸€æ ·ï¼šreflect.TypeOf(a).Kind() åˆ¤æ–­æ¥å£æ˜¯å¦ç›¸ç­‰ï¼šreflect.DeepEqual(a,b,interface{}) å°†interfaceèµ‹å€¼ç»™å¦ä¸€ä¸ªï¼šreflect.ValueOf(a).Elem().Set(reflect.ValueOf(b)) æ‰“å°%v,%+v,%#vçš„åŒºåˆ« (è¾“å‡ºstructä¸­çš„å…ƒç´ ) %vè¾“å‡ºæ‰€æœ‰çš„å€¼ %+vå…ˆè¾“å‡ºå­—æ®µåå­—ï¼Œå†è¾“å‡ºè¯¥å­—æ®µçš„å€¼ï¼ˆname:valueï¼‰ %#vå…ˆè¾“å‡ºç»“æ„ä½“åå­—ï¼Œå†è¾“å‡ºç»“æ„ä½“ï¼ˆname:valueï¼‰ runeç±»å‹ goçš„å­—ç¬¦æœ‰ä»¥ä¸‹ä¸¤ç§ uint8ï¼ˆbyteï¼‰ï¼Œè¡¨ç¤ºASCIIçš„å­—ç¬¦ runeç±»å‹ï¼Œè¡¨ç¤ºUTF-8å­—ç¬¦ï¼Œç­‰ä»·äºint32 stringåº•å±‚é€šè¿‡byteæ•°ç»„å®ç°ï¼Œå¯¹stringæ±‚lenè®¡ç®—äº†å­—èŠ‚é•¿åº¦ []rune(str) :stringè½¬åŒ–ä¸ºruneç±»å‹ï¼Œç»Ÿè®¡é•¿åº¦ç¤ºä¾‹ï¼š â€œhello ä½ å¥½â€ string length=12(æ±‰å­—3ä¸ª),rune length=8 ç©ºstruct{}å ç”¨çš„ç©ºé—´ ä½¿ç”¨unsafe.Sizeof(struct{})=0ï¼Œä¸å ç”¨ä»»ä½•å†…å­˜ç©ºé—´ ç©ºstructçš„ç”¨é€” ä¼˜ç‚¹ï¼šä¸å å†…å­˜ç©ºé—´ï¼Œé€šå¸¸è¢«å½“ä½œå ä½ç¬¦ mapä½œä¸ºé›†åˆä½¿ç”¨ï¼ˆtype set map[string]struct{}) ä¸å‘é€æ•°æ®çš„channelï¼Œåªæ˜¯é€šçŸ¥å­åç¨‹æ‰§è¡Œä»»åŠ¡æˆ–æ§åˆ¶åç¨‹å¹¶å‘ï¼ˆmake(chan struct{})ï¼‰ æœ‰å¯èƒ½ç»“æ„ä½“ä¸­åªåŒ…å«æ–¹æ³•ï¼Œä¸å«ä»»ä½•å­—æ®µ å˜é‡çš„åˆ†é…ä½ç½®åœ¨å †ä¸Šè¿˜æ˜¯æ ˆä¸Š ç”±ç¼–è¯‘å™¨å†³å®šï¼Œå¦‚æœæ— æ³•åˆ¤æ–­å˜é‡ä½œç”¨åŸŸå’Œå¤§å°ï¼Œé€šå¸¸ä¼šåˆ†é…åˆ°å †ä¸Šï¼ˆå †ä¸Šçš„å˜é‡åœ¨å‡½æ•°å‡ºæ ˆè‡ªè¡Œé‡Šæ”¾ï¼Œæ— éœ€gcï¼‰ selectæ‰§è¡Œ selectï¼šå¤šä¸ªå¯ç”¨æ“ä½œï¼šéšæœºé€‰ä¸€ä¸ª select ä¸­åªè¦æœ‰ä¸€ä¸ª case èƒ½ returnï¼Œåˆ™ç«‹åˆ»æ‰§è¡Œ å½“å¦‚æœåŒä¸€æ—¶é—´æœ‰å¤šä¸ª case å‡èƒ½ return åˆ™ä¼ªéšæœºæ–¹å¼æŠ½å–ä»»æ„ä¸€ä¸ªæ‰§è¡Œ å¦‚æœæ²¡æœ‰ä¸€ä¸ª case èƒ½ return åˆ™å¯ä»¥æ‰§è¡Œâ€defaultâ€ å— arrayå’Œsliceçš„åŒºåˆ« arrayï¼šå›ºå®šé•¿åº¦ï¼Œé•¿åº¦æ˜¯æ•°ç»„ç±»å‹çš„ä¸€éƒ¨åˆ†ï¼Œéœ€æŒ‡å®šå¤§å°æˆ–æ ¹æ®åˆå§‹åŒ–å€¼ç¡®å®š sliceï¼šå¯å˜é•¿åº¦ï¼Œä¸‰ä¸ªå±æ€§ï¼šæŒ‡é’ˆï¼Œé•¿åº¦ï¼Œå®¹é‡ï¼Œé€šè¿‡makeåˆå§‹åŒ–ï¼Œå¯ä»¥æ‰©å®¹ deferçš„ä½œç”¨ åœ¨è°ƒç”¨æ™®é€šå‡½æ•°æˆ–æ–¹æ³•å‰åŠ ä¸Šå…³é”®è¯deferå³å¯ã€‚deferè¢«æ‰§è¡Œæ—¶ï¼Œdeferåé¢çš„å‡½æ•°è¢«å»¶è¿Ÿæ‰§è¡Œï¼Œç›´åˆ°åŒ…å«è¯¥deferè¯­å¥çš„å‡½æ•°æ‰§è¡Œå®Œæ¯•ï¼ˆä¸ç®¡returnç»“æŸè¿˜æ˜¯panicç»“æŸï¼‰ï¼Œå³ä¸ºåœ¨å‡½æ•°è¿”å›ä¹‹å‰è°ƒç”¨ï¼Œdeferæ˜¯åœ¨returnä¹‹å‰å®Œæˆçš„ã€‚ å¸¸è¢«ç”¨äºå¤„ç†æˆå¯¹çš„æ“ä½œï¼Œä¿è¯èµ„æºèƒ½è¢«é‡Šæ”¾ç­‰ï¼ˆæ‰“å¼€/å…³é—­ï¼Œè¿æ¥/æ–­å¼€ï¼ŒåŠ é”/é‡Šæ”¾é”ï¼‰ é‡Šæ”¾èµ„æºçš„deferè·Ÿåœ¨è¯·æ±‚èµ„æºçš„è¯­å¥å æœ€åé¢çš„deferæœ€å…ˆè¢«è°ƒç”¨ï¼ˆç±»ä¼¼äºæ ˆï¼‰ return xxxå¹¶ä¸æ˜¯ä¸€æ¡åŸå­è¯­å¥ï¼šå…ˆç»™è¿”å›å€¼èµ‹å€¼ï¼Œå†è°ƒç”¨deferè¯­å¥ï¼Œä¾‹å¦‚ï¼š func f() (r int) { t := 5 defer func() { t = t + 5 }() return t } è¿”å›å€¼ä¸º5 func defer_call() { defer func() { fmt.Println(\"æ‰“å°å‰\") }() defer func() { fmt.Println(\"æ‰“å°ä¸­\") }() defer func() { fmt.Println(\"æ‰“å°å\") }() panic(\"è§¦å‘å¼‚å¸¸\") } è¾“å‡ºç»“æœ æ‰“å°å æ‰“å°ä¸­ æ‰“å°å‰ panic:è§¦å‘å¼‚å¸¸ goå…³é”®å­— go func(x,y,z)åªæœ‰fun(x,y,z)åœ¨æ–°çš„goroutineä¸­è¿è¡Œï¼Œå‚æ•°çš„è®¡ç®—åœ¨åŸgoroutineä¸­å®Œæˆã€‚ varå’Œ:=å®šä¹‰å˜é‡çš„åŒºåˆ« :=åªèƒ½åœ¨å£°æ˜å±€éƒ¨å˜é‡ä½¿ç”¨ï¼Œvaræ— é™åˆ¶ ä»£ç type student struct { Name string Age int } func pase_student() { m := make(map[string]*student) stus := []student{ {Name: \"zhou\", Age: 24}, {Name: \"li\", Age: 23}, {Name: \"wang\", Age: 22}, } for _, stu := range stus { m[stu.Name] = &amp;stu } } é”™è¯¯ï¼šfor _, stu := range stus {m[stu.Name] = &amp;stu}ä¸€å¥ä¸­ï¼Œstuå®é™…ä¸Šæ˜¯å‰¯æœ¬ï¼Œæ‰€ä»¥æ­¤å¤„è¿”å›çš„å‡ä¸ºåŒä¸€ä¸ªåœ°å€ã€‚ ä¿®æ”¹ï¼š for i:=0;i&lt;len(stus);i++ { m[stus[i].Name] = &amp;stus[i] } func main() { runtime.GOMAXPROCS(1) wg := sync.WaitGroup{} wg.Add(20) for i := 0; i &lt; 10; i++ { go func() { fmt.Println(\"A: \", i) wg.Done() }() } for i := 0; i &lt; 10; i++ { go func(i int) { fmt.Println(\"B: \", i) wg.Done() }(i) } wg.Wait() } è¾“å‡ºç»“æœ A:å‡ä¸ºè¾“å‡º 10ï¼ŒB:ä» 0~9 è¾“å‡º (é¡ºåºä¸å®š) deferå¤šå±‚åµŒå¥— func main() { fmt.Println(\"A\") defer func() { fmt.Println(\"B\") defer fmt.Println(\"C\") fmt.Println(\"D\") }() defer fmt.Println(\"E\") fmt.Println(\"F\") } ç»“æœè¾“å‡ºé¡ºåºï¼šAFEDBC func main() { for i:=0; i&lt;5; i++ { defer func() { fmt.Println(i) }() } } è¾“å‡ºï¼š5 5 5 5 5 func main() { for i:=0; i&lt;5; i++ { defer func(i int) { fmt.Println(i) }(i) } } è¾“å‡ºï¼š4 3 2 1 0 func calc(index string, a, b int) int { ret := a + b fmt.Println(index, a, b, ret) return ret } func main() { a := 1 b := 2 defer calc(\"1\", a, calc(\"10\", a, b)) a = 0 defer calc(\"2\", a, calc(\"20\", a, b)) b = 1 } è¾“å‡º 10 1 2 3 20 0 2 2 2 0 2 2 1 1 3 4","categories":[{"name":"Golang","slug":"Golang","permalink":"http://sn1987a-1.github.io/categories/Golang/"}],"tags":[{"name":"Go","slug":"Go","permalink":"http://sn1987a-1.github.io/tags/Go/"}]},{"title":"AI algorithms","slug":"AI algorithms","date":"2023-06-30T12:48:34.000Z","updated":"2023-09-24T03:27:01.940Z","comments":true,"path":"posts/e95a583.html","link":"","permalink":"http://sn1987a-1.github.io/posts/e95a583.html","excerpt":"","text":"è´å¶æ–¯ç½‘ç»œï¼Œk-means å’Œtransformer PART1æ‰‹å†™æ•°å­—è¯†åˆ«æœ¬éƒ¨åˆ†é€šè¿‡è´å¶æ–¯ç½‘ç»œå®ç°æ‰‹å†™æ•°å­—çš„è¯†åˆ« å®éªŒå†…å®¹ fitå‡½æ•° Pixelsä¸­æ¯ä¸€è¡Œä»£è¡¨ä¸€ä¸ªå›¾åƒï¼Œæ¯ä¸€åˆ—ä»£è¡¨ä¸€ä¸ªåƒç´ å€¼ã€‚Labelsæ˜¯ä¸€ä¸ªå½¢çŠ¶ä¸ºï¼ˆn_samples,ï¼‰çš„å‘é‡ï¼Œå…¶ä¸­æ¯ä¸ªå…ƒç´ éƒ½æ˜¯ç›¸åº”å›¾åƒçš„ç±»æ ‡ç­¾ã€‚ è¯¥æ–¹æ³•é€šè¿‡è®¡ç®—æ¯ä¸ªç±»åˆ«çš„å…ˆéªŒæ¦‚ç‡å’Œç»™å®šæ¯ä¸ªç±»åˆ«çš„æ¯ä¸ªåƒç´ å€¼çš„æ¡ä»¶æ¦‚ç‡ï¼Œå°†æ¨¡å‹ä¸æ•°æ®æ‹Ÿåˆã€‚å®ƒä½¿ç”¨ç±»çš„ä¸¤ä¸ªå±æ€§ï¼šself.labels_prior å’Œ self.pixels_cond_labelã€‚å‰è€…æ˜¯ä¸€ä¸ªå½¢çŠ¶ä¸º(n_classes,)çš„å‘é‡ï¼Œç”¨äºå­˜å‚¨æ¯ä¸ªç±»åˆ«çš„å…ˆéªŒæ¦‚ç‡ã€‚åè€…æ˜¯ä¸€ä¸ªå½¢çŠ¶ä¸ºï¼ˆn_pixels, n_values, n_classesï¼‰çš„çŸ©é˜µï¼Œå­˜å‚¨äº†ç»™å®šæ¯ä¸ªç±»åˆ«çš„æ¯ä¸ªåƒç´ å€¼çš„æ¡ä»¶æ¦‚ç‡ã€‚è¯¥æ–¹æ³•é€šè¿‡è®¡ç®—æ•°æ®ä¸­æ¯ä¸ªç±»åˆ«å’Œæ¯ä¸ªåƒç´ å€¼çš„é¢‘ç‡å¹¶é™¤ä»¥é€‚å½“çš„åˆ†æ¯æ¥æ›´æ–°è¿™äº›å±æ€§ã€‚ def fit(self, pixels, labels): n_samples = len(labels) for label in labels: self.labels_prior[label] += 1 self.labels_prior /= n_samples for i in range(n_samples): pixel_values = pixels[i] label = labels[i] for pixel in range(self.n_pixels): self.pixels_cond_label[pixel][pixel_values[pixel]][label] += 1 for pixel in range(self.n_pixels): for value in range(self.n_values): self.pixels_cond_label[pixel][value] /= self.labels_prior predictå‡½æ•° è¯¥æ–¹æ³•è¿”å›ä¸€ä¸ªå½¢çŠ¶ä¸ºï¼ˆn_samples,ï¼‰çš„å‘é‡ï¼Œå…¶ä¸­æ¯ä¸ªå…ƒç´ éƒ½æ˜¯ç›¸åº”å›¾åƒçš„é¢„æµ‹ç±»åˆ«æ ‡ç­¾ã€‚é€šè¿‡æ‰¾åˆ°åéªŒæ¦‚ç‡æœ€å¤§çš„ç±»åˆ«æ¥è·å¾—é¢„æµ‹ç»“æœã€‚é€šè¿‡æ‹Ÿåˆæ–¹æ³•è®¡ç®—self.labels_priorå’Œself.pixels_cond_labelå±æ€§ã€‚è¯¥æ–¹æ³•å¯¹æ¯å¹…å›¾åƒå’Œæ¯ä¸ªç±»åˆ«è¿›è¡Œå¾ªç¯ï¼Œå¹¶é€šè¿‡å°†å…ˆéªŒæ¦‚ç‡çš„å¯¹æ•°ä¸ç»™å®šç±»åˆ«çš„æ¯ä¸ªåƒç´ å€¼çš„æ¡ä»¶æ¦‚ç‡çš„å¯¹æ•°ç›¸åŠ æ¥è®¡ç®—åéªŒæ¦‚ç‡ã€‚ç„¶åå°†åéªŒæ¦‚ç‡ä¸å½“å‰æœ€å¤§å€¼è¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æœåéªŒæ¦‚ç‡å¤§äºå½“å‰æœ€å¤§å€¼ï¼Œåˆ™æ›´æ–°é¢„æµ‹æ ‡ç­¾ã€‚ç„¶åå°†é¢„æµ‹æ ‡ç­¾åˆ†é…ç»™è¾“å‡ºå‘é‡ã€‚ def predict(self, pixels): n_samples = len(pixels) labels = np.zeros(n_samples) for i in range(n_samples): pixel_values = pixels[i] max_posterior = float(\"-inf\") predicted_label = None for label in range(self.n_labels): posterior = np.log(self.labels_prior[label]) for pixel in range(self.n_pixels): posterior += np.log(self.pixels_cond_label[pixel][pixel_values[pixel]][label]) if posterior &gt; max_posterior: max_posterior = posterior predicted_label = label labels[i] = predicted_label return labels å›¾ç‰‡å‹ç¼©æœ¬éƒ¨åˆ†ä½¿ç”¨k-meanså®ç°å›¾ç‰‡å‹ç¼©ï¼Œå¹¶åœ¨ä¸åŒçš„å‚æ•°ä¸‹å®ç°ä¸åŒçš„å‹ç¼©æ•ˆæœã€‚ å®éªŒåŸç†å›¾ç‰‡å‹ç¼©çš„åŸç†æ˜¯å°†å›¾ç‰‡ä¸­çš„åƒç´ åˆ†æˆå‡ ä¸ªç±»åˆ«ï¼Œæ¯ä¸ªç±»åˆ«ç”¨ä¸€ä¸ªä»£è¡¨é¢œè‰²æ¥è¡¨ç¤ºï¼Œä»è€Œå‡å°‘å›¾ç‰‡ä¸­çš„é¢œè‰²æ•°ç›®ï¼Œé™ä½æ–‡ä»¶å¤§å°ã€‚æ­¥éª¤å¦‚ä¸‹ï¼š ä½¿ç”¨RGBé¢œè‰²ç©ºé—´è¡¨ç¤ºå›¾åƒçš„é¢œè‰²ï¼Œå°†å›¾ç‰‡å±•å¹³ä¸ºä¸€ä¸ªäºŒç»´æ•°ç»„ï¼Œæ¯ä¸€è¡Œä»£è¡¨ä¸€ä¸ªåƒç´ ï¼Œæ¯ä¸€åˆ—ä»£è¡¨ä¸€ä¸ªé¢œè‰²é€šé“ã€‚ å¯¹å±•å¹³çš„å›¾ç‰‡æ•°ç»„åº”ç”¨K-meansèšç±»ç®—æ³•ï¼ŒKä»£è¡¨å‹ç¼©åçš„å›¾ç‰‡ä¸­æƒ³è¦çš„é¢œè‰²æ•°ç›®ã€‚ç®—æ³•ä¼šæ ¹æ®åƒç´ çš„RGBå€¼å°†ç›¸ä¼¼çš„åƒç´ åˆ†åˆ°ä¸€èµ·ï¼Œå¹¶ç»™æ¯ä¸ªç±»åˆ«åˆ†é…ä¸€ä¸ªå¹³å‡çš„RGBå€¼ã€‚å…¶ä¸­Kçš„å€¼å†³å®šäº†å‹ç¼©çš„ç¨‹åº¦ã€‚ å°†åŸå§‹å›¾ç‰‡ä¸­çš„æ¯ä¸ªåƒç´ æ›¿æ¢ä¸ºå…¶æ‰€å±ç±»åˆ«çš„å¹³å‡RGBå€¼ã€‚è¿™æ ·å°±å¾—åˆ°äº†ä¸€ä¸ªé¢œè‰²æ•°ç›®æ›´å°‘ï¼Œä½†æ˜¯å¤–è§‚ç›¸ä¼¼çš„å›¾ç‰‡ã€‚ å®éªŒå†…å®¹ assign_pointså‡½æ•° ä¸»è¦æµç¨‹ï¼š éå†æ¯ä¸ªæ ·æœ¬ç‚¹ï¼Œè®¡ç®—å®ƒä¸æ¯ä¸ªèšç±»ä¸­å¿ƒçš„æ¬§å‡ é‡Œå¾—è·ç¦»ï¼Œä½¿ç”¨np.linalg.normå‡½æ•°ã€‚ æ‰¾å‡ºè·ç¦»æœ€å°çš„èšç±»ä¸­å¿ƒçš„ç´¢å¼•ï¼Œä½¿ç”¨np.argminå‡½æ•°ï¼Œå°†å…¶ä½œä¸ºè¯¥æ ·æœ¬ç‚¹çš„èšç±»æ ‡ç­¾ï¼Œå­˜å…¥labelsæ•°ç»„ä¸­ã€‚ æœ€åæ›´æ–°labelsæ•°ç»„ã€‚ def assign_points(self, centers, points): n_samples, n_dims = points.shape labels = np.zeros(n_samples) for i in range(n_samples): distances = np.linalg.norm(points[i] - centers, axis=1) labels[i] = np.argmin(distances) return labels uptdate_centerså‡½æ•° ä¸»è¦æµç¨‹ éå†æ¯ä¸ªèšç±»ä¸­å¿ƒï¼Œæ‰¾å‡ºæ‰€æœ‰å±äºè¯¥èšç±»çš„æ ·æœ¬ç‚¹ã€‚ å¦‚æœè¯¥èšç±»æœ‰æ ·æœ¬ç‚¹ï¼Œåˆ™è®¡ç®—è¿™äº›æ ·æœ¬ç‚¹åœ¨æ¯ä¸ªç»´åº¦ä¸Šçš„å¹³å‡å€¼ä½œä¸ºæ–°çš„èšç±»ä¸­å¿ƒã€‚ å¦‚æœè¯¥èšç±»æ²¡æœ‰æ ·æœ¬ç‚¹ï¼Œåˆ™ä¿æŒåŸæ¥çš„èšç±»ä¸­å¿ƒä¸å˜ã€‚ def update_centers(self, centers, labels, points): for k in range(self.k): cluster_points = points[labels == k] if len(cluster_points) &gt; 0: centers[k] = cluster_points.mean(axis=0) return centers fitå‡½æ•° ä¸»è¦æµç¨‹ï¼š è°ƒç”¨initialize_centersæ–¹æ³•ï¼Œéšæœºåˆå§‹åŒ–èšç±»ä¸­å¿ƒcentersã€‚ è¿›è¡Œmax_iteræ¬¡å¾ªç¯ è°ƒç”¨assign_pointsæ–¹æ³•ï¼Œæ ¹æ®å½“å‰çš„èšç±»ä¸­å¿ƒcentersï¼Œå°†æ¯ä¸ªæ ·æœ¬ç‚¹åˆ†é…åˆ°æœ€è¿‘çš„èšç±»ä¸­ï¼Œå¾—åˆ°æ¯ä¸ªæ ·æœ¬ç‚¹çš„èšç±»æ ‡ç­¾labelsã€‚ è°ƒç”¨update_centersæ–¹æ³•ï¼Œæ ¹æ®æ–°çš„ç‚¹åˆ†é…labelsï¼Œæ›´æ–°èšç±»ä¸­å¿ƒcentersã€‚ è¿”å›æœ€ç»ˆçš„èšç±»ä¸­å¿ƒcentersã€‚ def fit(self, points): centers = self.initialize_centers(points) for _ in range(self.max_iter): labels = self.assign_points(centers, points) centers = self.update_centers(centers, labels, points) return centers compresså‡½æ•° ä¸»è¦æµç¨‹ å°†å›¾ç‰‡çš„åƒç´ å€¼å±•å¹³ä¸ºä¸€ä¸ªRGBäºŒç»´æ•°ç»„ã€‚ è°ƒç”¨fitæ–¹æ³•ï¼Œå¯¹å±•å¹³çš„åƒç´ ç‚¹è¿›è¡ŒK-meansèšç±»ï¼Œå¾—åˆ°èšç±»ä¸­å¿ƒcentersã€‚ å¯¹äºæ¯ä¸ªåƒç´ ç‚¹ï¼Œè®¡ç®—å®ƒä¸æ¯ä¸ªèšç±»ä¸­å¿ƒçš„æ¬§å‡ é‡Œå¾—è·ç¦»ï¼Œæ‰¾å‡ºè·ç¦»æœ€å°çš„èšç±»ä¸­å¿ƒçš„ç´¢å¼•ã€‚ ç”¨è·ç¦»æœ€å°çš„èšç±»ä¸­å¿ƒçš„é¢œè‰²å€¼æ›¿æ¢åŸæ¥çš„åƒç´ å€¼ï¼Œå¾—åˆ°å‹ç¼©åçš„åƒç´ ç‚¹ã€‚ åƒç´ ç‚¹é‡å¡‘ä¸ºåŸæ¥çš„å›¾ç‰‡å½¢çŠ¶ï¼Œå¾—åˆ°å‹ç¼©åçš„å›¾ç‰‡ã€‚ def compress(self, img): points = img.reshape((-1, img.shape[-1])) centers = self.fit(points) compressed_img = centers[np.argmin(np.linalg.norm(points[:, np.newaxis] - centers, axis=-1), axis=-1)] compressed_img = compressed_img.reshape(img.shape) return compressed_img PART 2Transformerå®éªŒå†…å®¹char_tokenizerå®ç°äº†ä¸€ä¸ªåŸºäºå­—ç¬¦çš„åˆ†è¯å™¨ã€‚å°†ä¸€ä¸ªå­—ç¬¦ä¸²è½¬æ¢ä¸ºä¸€ä¸ªæ•´æ•°åˆ—è¡¨ï¼Œæˆ–è€…å°†ä¸€ä¸ªæ•´æ•°åˆ—è¡¨è½¬æ¢ä¸ºä¸€ä¸ªå­—ç¬¦ä¸²ã€‚ å…·ä½“åŠŸèƒ½åŒ…å«ä»¥ä¸‹éƒ¨åˆ†ï¼š åˆå§‹åŒ–__init__ï¼Œè®¡ç®—è¯­æ–™åº“ä¸­çš„ä¸åŒå­—ç¬¦çš„ä¸ªæ•°ï¼Œå¹¶åˆ›å»ºä¸€ä¸ªå­—å…¸ï¼Œå°†æ¯ä¸ªå­—ç¬¦æ˜ å°„åˆ°ä¸€ä¸ªå”¯ä¸€çš„æ•´æ•°ã€‚ def __init__(self, corpus: List[str]): self.corpus = corpus self.vocab = {char: i for i, char in enumerate(sorted(list(set(''.join(corpus)))))} self.n_vocab = len(self.vocab) ç¼–ç encodeï¼Œç¼–ç æ–‡æœ¬ï¼Œå°†å­—ç¬¦ä¸²ä¸­çš„æ¯ä¸ªå­—ç¬¦æ›¿æ¢ä¸ºå­—å…¸ä¸­å¯¹åº”çš„æ•´æ•°ï¼Œå¹¶è¿”å›ä¸€ä¸ªæ•´æ•°åˆ—è¡¨ã€‚ def encode(self, string: str): encode_res=[self.vocab[c] for c in string] return encode_res è§£ç decodeï¼Œè§£ç ç¼–ç ã€‚å°†æ•´æ•°åˆ—è¡¨ä¸­çš„æ¯ä¸ªæ•´æ•°æ›¿æ¢ä¸ºå­—å…¸ä¸­å¯¹åº”çš„å­—ç¬¦ï¼Œå¹¶è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚ def decode(self, codes: List[int]): decode_res=''.join([list(self.vocab.keys())[list(self.vocab.values()).index(c)] for c in codes]) return decode_res Headè‡ªæ³¨æ„åŠ›æ˜¯ä¸€ç§ç”¨äºæ•æ‰åºåˆ—ä¸­çš„é•¿è·ç¦»ä¾èµ–å…³ç³»çš„æœºåˆ¶ï¼Œå®ƒé€šè¿‡è®¡ç®—åºåˆ—ä¸­æ¯ä¸ªå…ƒç´ ä¸å…¶ä»–å…ƒç´ çš„ç›¸å…³æ€§æ¥ç”Ÿæˆä¸€ä¸ªåŠ æƒå¹³å‡çš„è¾“å‡ºã€‚æœ¬éƒ¨åˆ†å®ç°äº†ä¸€ä¸ªæ³¨æ„åŠ›å•å¤´ã€‚ å…·ä½“åŠŸèƒ½åŒ…å«ä»¥ä¸‹éƒ¨åˆ†ï¼š init åˆ›å»ºä¸‰ä¸ªçº¿æ€§å±‚ï¼Œåˆ†åˆ«ç§°ä¸ºKeyï¼ŒQueryå’ŒValueï¼Œå®ƒä»¬éƒ½å°†è¾“å…¥ç»´åº¦n_embdæ˜ å°„åˆ°è¾“å‡ºç»´åº¦head_sizeã€‚ def __init__(self, head_size): super().__init__() self.Key = nn.Linear(n_embd, head_size) self.Query = nn.Linear(n_embd, head_size) self.Value = nn.Linear(n_embd, head_size) self.head_size = head_size self.register_buffer(\"tril\", torch.tril(torch.ones(block_size, block_size))) forwardå‡½æ•° è°ƒç”¨Keyï¼ŒQueryå’ŒValueå¯¹inputsè¿›è¡Œçº¿æ€§å˜æ¢ã€‚ è®¡ç®—queryå’Œkeyå¼ é‡çš„ç‚¹ç§¯ï¼Œå¹¶åœ¨æœ€åä¸¤ä¸ªç»´åº¦ä¸Šè½¬ç½®keyå¼ é‡ï¼Œå¾—åˆ°scoreså¼ é‡ã€‚ å¯¹scoreså¼ é‡è¿›è¡Œæ©ç æ“ä½œï¼Œå°†å…¶ä¸Šä¸‰è§’éƒ¨åˆ†ï¼ˆåŒ…æ‹¬å¯¹è§’çº¿ï¼‰å¡«å……ä¸ºè´Ÿæ— ç©·å¤§ã€‚ åœ¨æœ€åä¸€ä¸ªç»´åº¦ä¸Šå¯¹scoreså¼ é‡è¿›è¡Œsoftmaxæ“ä½œï¼Œå¾—åˆ°weightså¼ é‡ï¼Œè¡¨ç¤ºæ¯ä¸ªå…ƒç´ å¯¹å…¶ä»–å…ƒç´ çš„æ³¨æ„åŠ›æƒé‡ã€‚ é€šè¿‡weightså’Œvalueè®¡ç®—å¾—åˆ°outå¼ é‡ï¼Œè¡¨ç¤ºæ¯ä¸ªå…ƒç´ çš„åŠ æƒå¹³å‡è¾“å‡ºã€‚ def forward(self, inputs): key = self.Key(inputs) query = self.Query(inputs) value = self.Value(inputs) scores = torch.matmul(query, key.transpose(-2, -1)) / math.sqrt(self.head_size) mask = torch.tril(torch.ones_like(scores)).bool() scores = scores.masked_fill(mask == 0, float('-inf')) weights = F.softmax(scores, dim=-1) out = torch.matmul(weights, value) return out MultiHead_Attentionå¤šå¤´è‡ªæ³¨æ„åŠ›æ˜¯ä¸€ç§å°†å¤šä¸ªå•å¤´è‡ªæ³¨æ„åŠ›çš„è¾“å‡ºæ‹¼æ¥èµ·æ¥ï¼Œå¹¶è¿›è¡Œçº¿æ€§å˜æ¢çš„æœºåˆ¶ã€‚æœ¬éƒ¨åˆ†åœ¨Headçš„åŸºç¡€ä¸Šå®ç°äº†MultiHeadã€‚ initå‡½æ•° åˆ›å»ºä¸€ä¸ªæ¨¡å—åˆ—è¡¨ï¼ŒåŒ…å«n_headsä¸ªHeadå¯¹è±¡ã€‚ åˆ›å»ºä¸€ä¸ªçº¿æ€§å±‚ï¼Œå°†n_heads * head_sizeæ˜ å°„åˆ°n_embd def __init__(self, n_heads, head_size): super().__init__() self.heads = nn.ModuleList([Head(head_size) for i in range(n_heads)]) self.projection = nn.Linear(n_heads * head_size, n_embd) forwardå‡½æ•° å¯¹headsåˆ—è¡¨ä¸­çš„æ¯ä¸ªHeadå¯¹è±¡ï¼Œè°ƒç”¨å…¶å‰å‘æ–¹æ³•ï¼Œå¯¹inputsè¿›è¡Œå•å¤´è‡ªæ³¨æ„åŠ›ï¼Œå¹¶å°†æ‰€æœ‰å•å¤´çš„è¾“å‡ºåœ¨æœ€åä¸€ä¸ªç»´åº¦ä¸Šæ‹¼æ¥èµ·æ¥. è°ƒç”¨projectionå±‚ï¼Œå¯¹æ‹¼æ¥åçš„å¼ é‡è¿›è¡Œçº¿æ€§å˜æ¢ï¼Œå¹¶è¿”å›ã€‚ def forward(self, inputs): out = torch.cat([head(inputs) for head in self.heads], dim=-1) return self.projection(out) Feedforwardå‰é¦ˆç¥ç»ç½‘ç»œæ˜¯ä¸€ç§å°†è¾“å…¥é€šè¿‡ä¸€ç³»åˆ—çš„çº¿æ€§å˜æ¢å’Œéçº¿æ€§æ¿€æ´»å‡½æ•°æ˜ å°„åˆ°è¾“å‡ºçš„æœºåˆ¶ã€‚ initå‡½æ•° åˆ›å»ºä¸€ä¸ªé¡ºåºæ¨¡å—ï¼ŒåŒ…å«ä¸¤ä¸ªçº¿æ€§å±‚å’Œä¸€ä¸ªReLUæ¿€æ´»å‡½æ•°ã€‚ç¬¬ä¸€ä¸ªçº¿æ€§å±‚å°†n_embdæ˜ å°„åˆ°4n_embdï¼Œç¬¬äºŒä¸ªçº¿æ€§å±‚å°†4n_embdæ˜ å°„å›n_embdã€‚ class FeedForward(nn.Module): def __init__(self, n_embd): super().__init__() Linear_1 = nn.Linear(n_embd, 4*n_embd) Linear_2 = nn.Linear(4*n_embd, n_embd) self.net = nn.Sequential(Linear_1,nn.ReLU(),Linear_2) def forward(self, inputs): return self.net(inputs) Blockæœ¬éƒ¨åˆ†å°†å¤šå¤´è‡ªæ³¨æ„åŠ›å’Œå‰é¦ˆç¥ç»ç½‘ç»œç»“åˆèµ·æ¥ï¼Œå¹¶ä½¿ç”¨æ®‹å·®è¿æ¥å’Œå±‚å½’ä¸€åŒ–çš„æœºåˆ¶ï¼Œå®ç°åºåˆ—åˆ°åºåˆ—çš„æ˜ å°„å’Œç¼–ç ã€‚ initå‡½æ•° åˆ›å»ºä¸¤ä¸ªå±‚å½’ä¸€åŒ–å±‚ï¼Œä¸€ä¸ªå¤šå¤´è‡ªæ³¨æ„åŠ›æ¨¡å—å’Œä¸€ä¸ªå‰é¦ˆç¥ç»ç½‘ç»œæ¨¡å— def __init__(self, n_embd, n_heads): super().__init__() self.norm1 = nn.LayerNorm(n_embd) self.norm2 = nn.LayerNorm(n_embd) self.attention = MultiHeadAttention(n_heads, n_embd//n_heads) self.feed_forward = FeedForward(n_embd) forwardå‡½æ•° å¯¹inputså’Œå¤šå¤´è‡ªæ³¨æ„åŠ›æ¨¡å—çš„è¾“å‡ºå³ç›¸åŠ ï¼Œå¯¹ç¬¬ä¸€ä¸ªå±‚å½’ä¸€åŒ–ï¼Œå¾—åˆ°attention_outputã€‚ å¯¹attention_outputå’Œå‰é¦ˆç¥ç»ç½‘ç»œæ¨¡å—çš„è¾“å‡ºç›¸åŠ ï¼Œå¯¹ç¬¬äºŒä¸ªå±‚å½’ä¸€åŒ–å¾—åˆ°outputsã€‚ def forward(self, inputs): attention_output = self.norm1(inputs+self.attention(inputs)) outputs = self.norm2(attention_output+self.feed_forward(attention_output)) return outputs Transformerå€ŸåŠ©ä»¥ä¸Šçš„æ¨¡å—ï¼Œå¯ä»¥æ„å»ºTransformeræ¨¡å—ã€‚ init åµŒå…¥è¡¨ï¼Œå°†è¯æ±‡è¡¨ä¸­çš„æ¯ä¸ªå•è¯æ˜ å°„åˆ°ä¸€ä¸ªn_embdç»´çš„å‘é‡ã€‚ å½’ä¸€åŒ–å±‚ï¼Œå¯¹è¾“å…¥è¿›è¡Œå½’ä¸€åŒ–å¤„ç†ã€‚ çº¿æ€§å±‚ï¼Œå°†n_embdç»´çš„å‘é‡æ˜ å°„å›è¯æ±‡è¡¨ä¸­çš„æ¯ä¸ªå•è¯ã€‚ ä½ç½®åµŒå…¥å‚æ•°ï¼Œè¡¨ç¤ºæ¯ä¸ªä½ç½®çš„å‘é‡ï¼Œç”¨äºå¢åŠ ä½ç½®ä¿¡æ¯ã€‚ æ¨¡å—åˆ—è¡¨ï¼ŒåŒ…å«n_layersä¸ªå˜æ¢å™¨çš„å—ã€‚ def __init__(self): super().__init__() self.embedding = nn.Embedding(n_vocab, n_embd) self.norm = nn.LayerNorm(n_embd) self.linear = nn.Linear(n_embd, n_vocab) self.position_embedding = nn.Parameter(torch.zeros(1, block_size, n_embd)) self.blocks = nn.ModuleList([Block(n_embd, n_heads) for i in range(n_layers)]) forward å¾—åˆ°æ¯ä¸ªå•è¯çš„åµŒå…¥å‘é‡embeddingã€‚ æ ¹æ®inputsçš„æ—¶é—´ç»´åº¦ï¼Œæˆªå–ä½ç½®åµŒå…¥å‚æ•°ä¸­å¯¹åº”çš„éƒ¨åˆ†ï¼Œå¾—åˆ°position_embeddingå¼ é‡ï¼Œè¡¨ç¤ºæ¯ä¸ªä½ç½®çš„åµŒå…¥å‘é‡ã€‚ å°†embeddingå’Œposition_embeddingç›¸åŠ ï¼Œå¾—åˆ°attenså¼ é‡. å¯¹attensåˆ—è¡¨ä¸­çš„æ¯ä¸ªå˜æ¢å™¨çš„å—å¯¹è±¡ï¼Œè°ƒç”¨forwardæ–¹æ³•ï¼Œæ›´æ–°attenså¼ é‡ã€‚ å¯¹attensåº”ç”¨å±‚å½’ä¸€åŒ–å±‚ã€‚ å¯¹attensåº”ç”¨çº¿æ€§å±‚ï¼Œå¾—åˆ°logitså¼ é‡ï¼Œè¡¨ç¤ºæ¯ä¸ªæ—¶é—´æ­¥æ¯ä¸ªå•è¯çš„é¢„æµ‹æ¦‚ç‡ã€‚ def forward(self, inputs, labels=None): batch, time = inputs.shape embedding = self.embedding(inputs) position_embedding = self.position_embedding[:, :time] attens = embedding + position_embedding for block in self.blocks: attens = block(attens) attens = self.norm(attens) logits = self.linear(attens) if labels is None: loss = None else: batch, time, channel = logits.shape logits = logits.view(batch * time, channel) labels = labels.view(batch * time) loss = F.cross_entropy(logits, labels) return logits, loss generate forwardå¯¹inputsè¿›è¡Œé¢„æµ‹ï¼Œå¾—åˆ°logitså¼ é‡ã€‚ å¯¹logitså¼ é‡åœ¨æœ€åä¸€ä¸ªæ—¶é—´å–æœ€å¤§å€¼ï¼Œå¾—åˆ°æœ€å¯èƒ½çš„ç´¢å¼•ã€‚ å¹¶æ›´æ–°inputså¼ é‡ã€‚ ä»¥ä¸Šæ“ä½œè¿›è¡Œmax_new_tokensæ¬¡å¾ªç¯ def generate(self, inputs, max_new_tokens): for i in range(max_new_tokens): logits, _ = self(inputs) logits = logits[:, -1:, :].argmax(dim=-1) inputs = torch.cat([inputs, logits], dim=1) return inputs","categories":[{"name":"AI","slug":"AI","permalink":"http://sn1987a-1.github.io/categories/AI/"}],"tags":[{"name":"ä¸“ä¸šè¯¾","slug":"ä¸“ä¸šè¯¾","permalink":"http://sn1987a-1.github.io/tags/%E4%B8%93%E4%B8%9A%E8%AF%BE/"}]},{"title":"æ™ºèƒ½åˆçº¦","slug":"æ™ºèƒ½åˆçº¦","date":"2023-06-28T12:48:34.000Z","updated":"2023-09-24T03:52:18.905Z","comments":true,"path":"posts/c85b8ed3.html","link":"","permalink":"http://sn1987a-1.github.io/posts/c85b8ed3.html","excerpt":"","text":"å®éªŒç›®çš„ ç†è§£ä»¥å¤ªåŠä¸Šçš„æ™ºèƒ½åˆçº¦ å¼€å‘å®ç°ç®€å•çš„æ™ºèƒ½åˆçº¦ éƒ¨ç½²ä»¥å¤ªåŠä¸Šçš„æ™ºèƒ½åˆçº¦ å®éªŒåŸç†æ™ºèƒ½åˆçº¦æ˜¯ä¸€ç§ç‰¹æ®Šåè®®ï¼Œåœ¨åŒºå—é“¾å†…åˆ¶å®šåˆçº¦æ—¶ä½¿ç”¨ï¼Œå½“ä¸­å†…å«äº†ä»£ç å‡½æ•° (Function)ï¼Œäº¦èƒ½ä¸å…¶ä»–åˆçº¦è¿›è¡Œäº¤äº’ã€åšå†³ç­–ã€å­˜å‚¨èµ„æ–™åŠå‘é€ä»¥å¤ªå¸ç­‰åŠŸèƒ½ã€‚æ™ºèƒ½åˆçº¦ä¸»åŠ›æä¾›éªŒè¯åŠæ‰§è¡Œåˆçº¦å†…æ‰€è®¢ç«‹çš„æ¡ä»¶ã€‚æ™ºèƒ½åˆçº¦å…è®¸åœ¨æ²¡æœ‰ç¬¬ä¸‰æ–¹çš„æƒ…å†µä¸‹è¿›è¡Œå¯ä¿¡äº¤æ˜“ã€‚è¿™äº›äº¤æ˜“å¯è¿½è¸ªä¸”ä¸å¯é€†è½¬ã€‚ åœ¨ä»¥å¤ªåŠä¸Šï¼Œæ™ºèƒ½åˆçº¦æ˜¯ä¸€ä¸ªè¿è¡Œåœ¨ä»¥å¤ªåŠé“¾ä¸Šçš„ç¨‹åºã€‚ å®ƒæ˜¯ä½äºä»¥å¤ªåŠåŒºå—é“¾ä¸Šä¸€ä¸ªç‰¹å®šåœ°å€çš„ä¸€ç³»åˆ—ä»£ç ï¼ˆå‡½æ•°ï¼‰å’Œæ•°æ®ï¼ˆçŠ¶æ€ï¼‰ã€‚ æ™ºèƒ½åˆçº¦ä¹Ÿæ˜¯ä¸€ä¸ªä»¥å¤ªåŠå¸æˆ·ï¼Œå³åˆçº¦å¸æˆ·ã€‚ è¿™æ„å‘³ç€å®ƒä»¬æœ‰ä½™é¢ï¼Œå¯ä»¥æˆä¸ºäº¤æ˜“çš„å¯¹è±¡ã€‚ ä½†æ˜¯ï¼Œå®ƒä»¬æ— æ³•è¢«äººæ“æ§ï¼Œå®ƒä»¬æ˜¯è¢«éƒ¨ç½²åœ¨ç½‘ç»œä¸Šä½œä¸ºç¨‹åºè¿è¡Œç€ã€‚ ä¸ªäººç”¨æˆ·å¯ä»¥é€šè¿‡æäº¤äº¤æ˜“æ‰§è¡Œæ™ºèƒ½åˆçº¦çš„æŸä¸€ä¸ªå‡½æ•°æ¥ä¸æ™ºèƒ½åˆçº¦è¿›è¡Œäº¤äº’ã€‚ æ™ºèƒ½åˆçº¦èƒ½åƒå¸¸è§„åˆçº¦ä¸€æ ·å®šä¹‰è§„åˆ™ï¼Œå¹¶é€šè¿‡ä»£ç è‡ªåŠ¨å¼ºåˆ¶æ‰§è¡Œã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼Œæ‚¨æ— æ³•åˆ é™¤æ™ºèƒ½åˆçº¦ï¼Œä¸å®ƒä»¬çš„äº¤äº’æ˜¯ä¸å¯é€†çš„.ä»¥å¤ªåŠä¸Šçš„æ™ºèƒ½åˆçº¦åŸºæœ¬ç”Ÿå‘½å‘¨æœŸå¯ä»¥åˆ†ä¸ºå¼€å‘ã€ç¼–è¯‘ã€éƒ¨ç½²å’Œè¿è¡Œã€‚ å®éªŒå†…å®¹ç¼–å†™æŠ•ç¥¨åˆçº¦æœ¬å®éªŒå®ç°äº†ç®€å•çš„æŠ•ç¥¨åˆçº¦ç¤ºä¾‹ï¼Œå³VotingContractï¼ŒåŸºæœ¬ç»“æ„ä¸ºï¼š Optionè¡¨ç¤ºæ¯ä¸ªæŠ•ç¥¨é€‰é¡¹çš„åç§°å’ŒæŠ•ç¥¨è®¡æ•°ã€‚addoption()å¯ä»¥å¢åŠ æ–°çš„é€‰é¡¹ï¼›getOptionCount()è·å–å½“å‰çš„æŠ•ç¥¨é€‰é¡¹æ•°ç›®ï¼›getOption()è·å–ç‰¹å®šçš„é€‰é¡¹çš„å…·ä½“ä¿¡æ¯ã€‚99 8888888struct Option { string OptionName; uint256 voteCount; } Option[] public options; function addOption(string memory _name) public { options.push(Option(_name, 0)); } function getOptionCount() public view returns (uint256) { return options.length; } function getOption(uint256 _optionIndex) public view returns (string memory, uint256) { require(_optionIndex &lt; options.length, \"Invalid option index\"); Option memory option = options[_optionIndex]; return (option.OptionName, option.voteCount); } æŠ•ç¥¨ç”±voteså­˜å‚¨ï¼Œé€šè¿‡æ˜ å°„è®²åœ°å€å’Œé€‰é¡¹ç´¢å¼•å…³è”èµ·æ¥ mapping(address =&gt; uint256) public votes; ç”¨æˆ·é€šè¿‡vote()è¿›è¡ŒæŠ•ç¥¨ï¼Œå·²ç»æŠ•ç¥¨çš„ç”¨æˆ·æ— æ³•å†æŠ•ç¥¨ function vote(uint256 _optionIndex) public { require(_optionIndex &lt; options.length, \"Invalid option index\"); require(votes[msg.sender] == 0, \"Already voted\"); options[_optionIndex].voteCount++; votes[msg.sender] = _optionIndex; } éƒ¨ç½²å’Œè°ƒç”¨åˆçº¦å¯¹æŠ•ç¥¨åˆçº¦è¿›è¡Œéƒ¨ç½²ï¼Œä¿®æ”¹jsæ–‡ä»¶ï¼š const VotingContract = artifacts.require(\"VotingContract\"); module.exports = function(deployer) { deployer.deploy(VotingContract); }; éƒ¨ç½²å‘½ä»¤ï¼š truffle compile truffle develop truffle migrate --reset éƒ¨ç½²ç»“æœï¼š &gt; Compiling .\\contracts\\lab.sol &gt; Artifacts written to E:\\2023spring\\blockchain\\lab4\\build\\contracts &gt; Compiled successfully using: - solc: 0.8.20+commit.a1b79de6.Emscripten.clang è°ƒç”¨åˆçº¦ åˆ›å»ºæŠ•ç¥¨é€‰é¡¹ truffle(develop)&gt; let contract = await VotingContract.deployed() undefined truffle(develop)&gt; await contract.addOption(\"Option 1\") { tx: '0x7736c02bd8c1801d1785efa78ac225ca00cb670fe94f564965e241072ed8349a', recei ... } æŠ•ç¥¨ truffle(develop)&gt; await contract.vote(0); { tx: ' ... } æŸ¥çœ‹æŠ•ç¥¨ä¿¡æ¯ truffle(develop)&gt; let optionCount = await contract.getOptionCount(); undefined truffle(develop)&gt; console.log(\"Option count:\", optionCount.toNumber()); Option count: 1 undefined truffle(develop)&gt; let option = await contract.getOption(0); undefined truffle(develop)&gt; console.log(\"Option:\", option[0], \"Votes:\", option[1].toNumber()) Option: Option 1 Votes: 1 undefined","categories":[{"name":"åŒºå—é“¾","slug":"åŒºå—é“¾","permalink":"http://sn1987a-1.github.io/categories/%E5%8C%BA%E5%9D%97%E9%93%BE/"}],"tags":[{"name":"ä¸“ä¸šè¯¾","slug":"ä¸“ä¸šè¯¾","permalink":"http://sn1987a-1.github.io/tags/%E4%B8%93%E4%B8%9A%E8%AF%BE/"}]},{"title":"ä»£æ•°ç»“æ„ä¹ é¢˜è¯¾-2","slug":"ä»£æ•°ç»“æ„ä¹ é¢˜è¯¾2","date":"2023-06-02T12:48:34.000Z","updated":"2023-09-23T13:35:08.541Z","comments":true,"path":"posts/94cbcba9.html","link":"","permalink":"http://sn1987a-1.github.io/posts/94cbcba9.html","excerpt":"","text":"2023springä»£æ•°ç»“æ„ä¹ é¢˜è¯¾è®²ä¹‰ ç¬¬äºŒæ¬¡ä¹ é¢˜è¯¾çŸ¥è¯†æ•´ç†ç¯çš„å®šä¹‰ï¼ˆéªŒè¯$$æ˜¯å¦æ˜¯ç¯ï¼‰ $$æ˜¯äº¤æ¢ç¾¤ $$æ˜¯å«å¹ºåŠç¾¤ï¼ˆå°é—­æ€§ï¼Œç»“åˆå¾‹ï¼Œä¹˜æ³•å•ä½å…ƒï¼‰ ä¹˜æ³•å¯¹åŠ æ³•æœ‰å·¦å³åˆ†é…å¾‹ äº¤æ¢ç¯ï¼šä¹˜æ³•å…·æœ‰äº¤æ¢å¾‹ è´Ÿå…ƒï¼šåŠ æ³•é€†å…ƒï¼Œä¸€å®šå­˜åœ¨ å¯é€†å…ƒï¼šä¹˜æ³•é€†å…ƒå­˜åœ¨æ—¶ï¼Œç§°ä¸ºå¯é€†å…ƒ è¿ç®—:$a\\cdot 0=0\\cdot a=0,a\\cdot(-b)=(-a)\\cdot b=-(a\\cdot b),(-a)\\cdot (-b)=a\\cdot b$ ç‰¹æ®Šçš„ç¯ï¼š æ•°ç¯ï¼ŒRï¼ŒCï¼ŒQ è‡ªåŒæ€ç¯: $$æ˜¯äº¤æ¢ç¾¤ï¼Œ$E=\\{f|f:G\\rightarrow Gæ˜¯åŒæ€æ˜ å°„\\}$ï¼Œåœ¨Eä¸Šå®šä¹‰è¿ç®—ï¼š (f+g)(x)=f(x)+g(x)\\\\ (f\\cdot g)(x)=f(x)\\cdot g(x)æ­¤æ—¶$$ä¸ºç¯ï¼Œäº¤æ¢ç¾¤Gä¸Šçš„è‡ªåŒæ€ç¯ã€‚ æ¨¡nåŒä½™ç±»ç¯$&lt;\\Z_n,+,\\cdot&gt;$ [i]+[j]=[i+j]\\\\ [i]\\cdot[j]=[i\\cdot j] æ•´ç¯å’ŒåŸŸ é›¶å› å­ï¼Œå·¦ï¼ˆå³ï¼‰é›¶å› å­ï¼š$a\\in R,\\exist b,a\\cdot b=0(b\\cdot a=0)$ æ— é›¶å› å­ å½“ä¸”ä»…å½“ ä¹˜æ³•æœ‰å·¦å³æ¶ˆå»å¾‹ æ•´ç¯ï¼šéå¹³å‡¡äº¤æ¢ç¯ï¼Œæ— é›¶å› å­ æœ‰å·¦å³æ¶ˆå»å¾‹ åŠ é˜¶ï¼ˆå…³äºåŠ æ³•è¿ç®—çš„é˜¶ï¼‰ï¼šæ— é™ï¼ˆç‰¹å¾ä¸º0ï¼‰/ç´ æ•°ï¼ˆç‰¹å¾ä¸ºpï¼‰ åŸŸï¼šéå¹³å‡¡äº¤æ¢ç¯ï¼Œæ¯ä¸ªéé›¶å…ƒç´ aéƒ½å­˜åœ¨ä¹˜æ³•é€†å…ƒï¼ˆå…³äºä¹˜æ³•æ„æˆäº¤æ¢ç¾¤ï¼‰ åŸŸ$\\Rightarrow$æ•´ç¯ï¼ˆå¿…è¦ä¸å……åˆ†ï¼‰ æœ‰é™æ•´ç¯$\\Rightarrow$åŸŸï¼Œå³ä¸ºæœ‰é™åŸŸï¼Œç‰¹å¾ä¸ºpï¼ˆå……åˆ†ä¸å¿…è¦ï¼‰ æ•´æ•°ç¯ä¸æ˜¯åŸŸï¼Œ$&lt;\\Z_p,+\\cdot&gt;$æ˜¯åŸŸ å­ç¯ åˆ¤æ–­å­ç¯ å…³äºåŠ æ³•æ„æˆå­ç¾¤ å¯¹ä¹˜æ³•è¿ç®—å°é—­ åŒ…å«ä¹˜æ³•å•ä½å…ƒ ç¯åŒæ€æ˜ å°„fï¼š $f(a+b)=f(a)+f(b)$ $f(a\\cdot b)=f(a)\\cdot f(b)$ $f(1_{R_1})=1_{R_2}$(å¦‚æœæ²¡æœ‰è¯¥æ¡ä»¶ä¿è¯ï¼Œä¼šå‡ºç°$f(1_{R_1})=0_{R_2}$çš„æƒ…å†µ) åŒæ€æ˜ å°„ç›¸å…³æ€§è´¨ $f(0_{R_1})=0_{R_2}$ $f(-a)=-f(a)$ å¯é€†å…ƒæ˜ å°„åˆ°å¯é€†å…ƒï¼Œ$f(aâ€™)=(f(a))â€™$ åŒæ€æ˜ å°„ä¸èƒ½ä¿æŒæ•´ç¯/åŸŸç­‰çš„ç»“æ„ï¼ˆä¾‹7.14ï¼‰ï¼Œç¯åŒæ„æ˜ å°„å¯ä»¥ã€‚ å¯¹äºæ»¡å°„f: f(a+b)=f(a)+f(b)\\\\ f(a\\cdot b)=f(a)\\cdot f(b)å¯ä»¥åˆ¤æ–­æ˜¯ç¯ã€‚ ç†æƒ³å’Œå•†ç¯ ç†æƒ³ï¼šå¯¹äºç¯Rçš„éç©ºå­é›†Iï¼Œæ»¡è¶³$\\forall x,y\\in I,r\\in R\\Rightarrow x-y \\in I,x\\cdot r\\in I,r\\cdot x\\in I$ ç†æƒ³å…³äºåŠ æ³•æ„æˆå­ç¾¤ çœŸç†æƒ³ï¼Œå¹³å‡¡ç†æƒ³ ç†æƒ³çš„è¿ç®—å¾—åˆ°çš„éƒ½æ˜¯ç†æƒ³ I_1\\cdot I_2=\\{\\sum _{k=1}^{n}r_{1k}\\cdot r_{2k}|r_{1k}\\in R_1,r_{2k}\\in R_2,1\\leq k_1\\leq n,n=1,2... \\}\\\\ I_1+I_2=\\{r_1+r_2|r_1\\in I_1,r_2\\in I_2 \\} å•†ç¯ï¼š$R/I=\\{x+I|x\\in R\\}$ è‹¥ç†æƒ³Iä¸­æœ‰å¯é€†å…ƒï¼Œ$I=R$(å¹³å‡¡ç†æƒ³)$\\Rightarrow$åŸŸä¸­æ‰€æœ‰çš„ç†æƒ³éƒ½æ˜¯å¹³å‡¡ç†æƒ³ï¼Œæ²¡æœ‰çœŸç†æƒ³ ä¸»ç†æƒ³ï¼šäº¤æ¢ç¯ä¸­å…ƒç´ aç”Ÿæˆçš„ç†æƒ³ï¼š$\\forall a \\in R,(a)=\\{a\\cdot r|r\\in R\\}$ï¼›æ¨å¹¿åˆ°äº¤æ¢ç¯çš„å­é›†ï¼š$\\forall S=\\{a_1,a_2,â€¦a_k\\} \\subseteq R,(a_1,a_2,â€¦a_k)=\\{a_1\\cdot r_1+â€¦a_k\\cdot r_k|r_1,r_2,â€¦r_k\\in R\\}$ ä¸»ç†æƒ³ç¯ï¼šæ‰€æœ‰çš„ç†æƒ³éƒ½æ˜¯ä¸»ç†æƒ³ (æ•´æ•°ç¯) å¤šé¡¹å¼ç¯ ç¯Rä¸Šçš„å¤šé¡¹å¼$p(x)=a_0+a_1x+â€¦+a_nx^n,a_n\\neq 0_R,n\\geq 0$ $a_i$ä¸ºç³»æ•°ï¼Œxä¸ºæœªå®šå…ƒï¼Œnä¸ºæ¬¡æ•°$deg(p(x))=n$ï¼›Rä¸Šçš„éé›¶å…ƒç´ ï¼šå¸¸æ•°å¤šé¡¹å¼ï¼›$0_R$é›¶å¤šé¡¹å¼ï¼› å…¨ä½“å¤šé¡¹å¼è®°ä¸ºR[x]ï¼Œå®šä¹‰è¿ç®—ï¼š \\forall f(x),g(x)\\in R[x],\\\\ f(x)+g(x)=\\sum^{max\\{m,n\\}}_{k=0}(a_k+b_k)x^k\\\\ f(x)\\cdot g(x)=\\sum^{m+n}_{k=0}c_kx^k,c_k=\\sum_{i+j=k}a_i\\cdot b_j,0\\leq k\\leq m+nR[x]æ˜¯ç¯ï¼ˆé›¶å…ƒï¼Œé€†å…ƒï¼Œä¹˜æ³•å•ä½å…ƒï¼‰ï¼Œä¸”æ˜¯æ•´ç¯ã€‚ åŸŸä¸Šçš„å¤šé¡¹å¼ å¯¹äºR[x]ä¸Šçš„f(x),g(x)ï¼Œè‹¥g(x)ä¸æ˜¯é›¶å¤šé¡¹å¼ï¼Œå­˜åœ¨å”¯ä¸€çš„$q(x),r(x)\\in F[x]$: f(x)=q(x)\\cdot g(x)+r(x)ï¼Œå…¶ä¸­r(x)çš„æ¬¡æ•°å°äºdeg(g(x))ï¼Œä¹Ÿå¯èƒ½æ˜¯é›¶å¤šé¡¹å¼ã€‚è¯¥å¼å­è¯´æ˜åŸŸä¸Šçš„å¤šé¡¹å¼å¯ä»¥åšé™¤æ³•ï¼Œå•†å’Œä½™å¼å”¯ä¸€ç¡®å®šï¼›å…¶ä¸­$f(x)=q(x)\\cdot g(x)$æ—¶ï¼Œç§°g(x)ä¸ºf(x)çš„å› å¼ï¼› f(x)=q(x)\\cdot(x-a)+r_0\\Rightarrow f(a)=r_0å› æ­¤x-aä¸ºf(x)çš„å› å¼å½“ä¸”ä»…å½“$f(a)=0_F$,æ­¤æ—¶aä¸ºf(x)çš„æ ¹ã€‚ åŸŸä¸Šçš„å¤šé¡¹å¼ç¯æ˜¯ä¸»ç†æƒ³ç¯ã€‚ï¼ˆéƒ½å¯ä»¥å†™ä¸º$I=(g(x))$ï¼‰ åŸŸä¸Šçš„å¤šé¡¹å¼å•†ç¯ F[x]/P=\\{f(x)+P|f(x)\\in F(x) \\},f(x)=q(x)\\cdot p(x)+r(x),f(x)-r(x)\\in(p(x))\\\\ F[x]/P=\\{b_0+b_1x+...+b_{n-1}+P|b_0,b_1,...b_{n-1}\\in F \\} ç¯åŒæ€å®šç† åŒæ€æ ¸ï¼š$\\phi$ä¸ºä»$R_1$åˆ°$R_2$çš„åŒæ€æ˜ å°„ï¼Œ$Ker\\phi =\\{r|r\\in R_1,\\phi(r)=0_{R_2} \\}$ $Ker\\phi$ä¸º$R_1$çš„ç†æƒ³ ç¯åŒæ€åŸºæœ¬å®šç†ï¼šç¯$R_1$çš„ä»»æ„å•†ç¯éƒ½æ˜¯ç¯$R_1$çš„åŒæ€åƒã€‚è‹¥$\\phi$æ˜¯ä»$R_1$åˆ°$R_2$çš„æ»¡åŒæ€æ˜ å°„ R_1/Ker\\phi \\cong R_2 è‹¥fä¸ºä»$R_1$åˆ°$R_2$çš„åŒæ€æ˜ å°„ $S_1$æ˜¯$R_1$çš„å­ç¯ï¼Œ$f(S_1)$æ˜¯$R_2$çš„å­ç¯ï¼ˆ$f(R_1)$æ˜¯å­ç¯ï¼‰ $S_1$æ˜¯$R_1$çš„ç†æƒ³ï¼Œ$f(S_1)$æ˜¯$R_2$çš„ç†æƒ³ $S_2$æ˜¯$f(R_1)$çš„å­ç¯ï¼Œ$f^{-1}(S_2)$æ˜¯$R_1$çš„å­ç¯ $S_2$æ˜¯$f(R_1)$çš„ç†æƒ³ï¼Œ$f^{-1}(S_2)$æ˜¯$R_1$çš„ç†æƒ³ï¼Œä¸”$R_1/f^{-1}(S_2)\\cong f(R_1)/S_2$ è‹¥$I_1,I_2$ä¸ºRçš„ç†æƒ³ï¼Œ$I_2\\subseteq I_1$ï¼Œ$I_1/I_2$æ˜¯$R/I_2$çš„ç†æƒ³ \\frac{R/I_2}{I_1/I_2}\\cong R/I_1 è¡¥å……ä¹ é¢˜ æ‰¾åˆ°$\\mathbb{Z}[\\mathrm{i}],\\mathbb{Q}[\\mathrm{i}]$ä¸­å…¨éƒ¨å¯é€†å…ƒã€‚ $\\mathbb{Z}[\\mathrm{i}]$ä¸­çš„å…ƒç´ å¯ä»¥å†™ä¸º$a+b\\mathrm{i},a,b\\in\\mathbb{Z}$ï¼Œå½“$a,b$ä¸å…¨ä¸º0æ—¶ï¼Œè‹¥$(a+b\\mathrm{i})(c+d\\mathrm{i})=1$ï¼Œè§£å‡º$c=\\frac{a}{a^2+b^2},d=\\frac{-b}{a^2+b^2}$ã€‚è‹¥å¯é€†ï¼Œæ„å‘³ç€$c,d\\in\\mathbb{Z}$ã€‚å½“$a\\ne0,b\\ne0$æ—¶ï¼Œ$a&lt;a^2+b^2$ï¼Œ$c$ä¸å¯èƒ½ä¸ºæ•´æ•°ï¼Œå› æ­¤ä¸å¯èƒ½å¯é€†ï¼Œåˆ†$a=0$æˆ–$b=0$è®¨è®ºå¯çŸ¥$\\mathbb{Z}[\\mathrm{i}]$å¯é€†å…ƒä¸º$1,-1,\\mathrm{i},-\\mathrm{i}$ã€‚ $\\mathbb{Q}[\\mathrm{i}]$ä¸­çš„å…ƒç´ å¯ä»¥å†™ä¸º$a+b\\mathrm{i},a,b\\in\\mathbb{Q}$ï¼Œå½“$a,b$ä¸å…¨ä¸º0æ—¶ï¼Œè‹¥$(a+b\\mathrm{i})(c+d\\mathrm{i})=1$ï¼Œè§£å‡º$c=\\frac{a}{a^2+b^2},d=\\frac{-b}{a^2+b^2}$ã€‚è‹¥å¯é€†ï¼Œæ„å‘³ç€$c,d\\in\\mathbb{Q}$ã€‚éé›¶æœ‰ç†æ•°åŠ å‡ä¹˜é™¤ä¸€å®šè¿˜ä¸ºæœ‰ç†æ•°ï¼Œå› æ­¤$c,d\\in\\mathbb{Q}$ä¸€å®šæˆç«‹ï¼Œè¿™æ„å‘³ç€$\\mathbb{Q}[\\mathrm{i}]$ä¸­éé›¶å…ƒç´ å‡å¯é€†ï¼Œå®ƒæ˜¯åŸŸã€‚ è¯æ˜$\\mathbb{Z}[x]$ä¸ä¸ºä¸»ç†æƒ³ç¯ã€‚ è€ƒè™‘$(2,x)$ï¼Œè‹¥$(2,x)$ä¸ºä¸»ç†æƒ³ï¼Œæ„å‘³ç€å­˜åœ¨$f(x)\\in\\mathbb{Z}[x]$ä½¿å¾—$2=g(x)f(x),x=h(x)f(x),g(x),h(x)\\in\\mathbb{Z}[x]$ã€‚ç”±è¿™ä¸¤å¼å¯ä»¥æ¨å‡º$f(x)|\\gcd(2,x)=1$ï¼Œå› æ­¤$f(x)=\\pm1$ã€‚ ä½†æ˜¯ï¼Œ$f(x)=\\pm1$æ—¶ï¼Œ$f(x)$ç”Ÿæˆçš„ç†æƒ³ä¸º$\\mathbb{Z}[x]$ï¼Œè€Œ$2$ä¸$x$ç”Ÿæˆçš„ç†æƒ³ä¸åŒ…å«1ï¼ˆæ³¨æ„$\\frac{1}{2}\\notin\\mathbb{Z}[x]$ï¼‰ï¼ŒçŸ›ç›¾ï¼Œç”±æ­¤å³è¯æ˜äº†$(2,x)$ä¸ä¸ºä¸»ç†æƒ³ï¼Œ$\\mathbb{Z}[x]$ä¸ä¸ºä¸»ç†æƒ³ç¯ã€‚ è¿™ä¹Ÿå±•ç°äº†ä¸ºä»€ä¹ˆæœ€å¤§å…¬å› æ•°ä¸ç”Ÿæˆç†æƒ³å¸¸éƒ½è®°ä½œ$(a,b)$ï¼Œåœ¨ä¸»ç†æƒ³ç¯ä¸­ï¼Œå¯ä»¥è¯æ˜ç†æƒ³$(a,b)$å³ä¸ºæœ€å¤§å…¬å› æ•°$(a,b)$ç”Ÿæˆçš„ç†æƒ³ã€‚ ï¼ˆæ”¹ç¼–è‡ªå»å¹´æœŸæœ«è€ƒè¯•ï¼‰è¯æ˜$\\mathbb{R}[x]/(x^2+1)\\simeq\\mathbb{C}$ï¼Œè¿™é‡Œ$\\simeq$è¡¨ç¤ºç¯åŒæ„ã€‚ æ„é€ æ˜ å°„$\\phi:\\mathbb{R}[x]\\to\\mathbb{C},\\phi(f(x))=f(\\mathrm{i})$ï¼Œç”±äº$\\phi(f(x)+g(x))=f(\\mathrm{i})+g(\\mathrm{i})=\\phi(f(x))+\\phi(g(x))$ï¼Œ$\\phi(f(x)g(x))=f(\\mathrm{i})g(\\mathrm{i})=\\phi(f(x))\\phi(g(x))$ï¼Œå…¶ä¸ºç¯åŒæ€ã€‚ å¯¹å…¶åº”ç”¨ç¯åŒæ€ç¬¬ä¸€å®šç†ï¼Œ$\\mathrm{ker}\\phi=\\{f\\mid f(\\mathrm{i})=0\\}$ï¼Œä¸‹è¯$\\mathbb{R}[x]$ä¸­è¿™ç­‰ä»·äº$x^2+1\\mid f(x)$ï¼š è‹¥$f(\\mathrm{i})=0$ï¼Œç­‰å¼ä¸¤è¾¹å–å…±è½­ï¼Œç”±äºç³»æ•°å‡ä¸ºå®æ•°ï¼Œå¯çŸ¥$f(-\\mathrm{i})=0$ã€‚åˆ©ç”¨å› å¼å®šç†ï¼Œè¿™æ„å‘³ç€$(x-\\mathrm{i})(x+\\mathrm{i})\\mid f(x)$ï¼Œä¹Ÿå³$x^2+1\\mid f(x)$ï¼Œå¦ä¸€æ–¹é¢ï¼Œå½“$f(x)$æœ‰å› å¼$x^2+1$æ—¶ï¼Œä»£å…¥å¯çŸ¥$f(\\mathrm{i})=0$ã€‚ äºæ˜¯ï¼Œ$\\mathrm{ker}\\phi=\\{f\\mid x^2+1\\mid f(x)\\}=(x^2+1)$ã€‚ è€Œå¯¹ä»»ä½•$a+b\\mathrm{i}\\in\\mathbb{C}$ï¼Œå–$f(x)=bx+a$å³æœ‰$\\phi(f)=a+bi$ï¼Œå› æ­¤$\\phi$æ˜¯æ»¡å°„ï¼Œä»è€Œåˆ©ç”¨ç¯åŒæ€ç¬¬ä¸€å®šç†å¾—è¯ã€‚ ç¯åŒæ€ç¬¬ä¸€å®šç†çš„æœ€å¤§ä½œç”¨æ˜¯è¯æ˜å•†ç¯ä¸æŸä¸ªç¯åŒæ€ï¼Œä½†æ„é€ æ˜ å°„çš„è¿‡ç¨‹å¯èƒ½æœ‰ä¸€å®šçš„æŠ€å·§æ€§ã€‚æœ¬é¢˜æ˜¯ç”±äºæ³¨æ„åˆ°$\\mathbb{i}$æ˜¯$x^2+1$çš„æ ¹ï¼Œè€Œ$\\mathbb{C}=\\mathbb{R}[\\mathrm{i}]$ï¼Œå› æ­¤æƒ³åˆ°å¦‚æ­¤æ„é€ ã€‚ è¯æ˜$\\mathbb{Z}[x]/(x+1,x^2+4)\\simeq\\mathbb{Z}_5$ã€‚ æœ¬é¢˜åŸºæœ¬ä¸å¯èƒ½ç›´æ¥çœ‹å‡ºæ˜ å°„ï¼Œå› æ­¤éœ€è¦æ„é€ ï¼šå‡ºäº$\\ker\\phi=(x+1,x^2+4)$å¸Œæœ›$\\phi(x^2+4)=\\phi(x+1)=0$ã€‚æ³¨æ„åˆ°$x^2+4=(x-1)(x+1)+5$ï¼Œåˆ©ç”¨ç¯åŒæ€å¯çŸ¥$\\phi(x^2+4)=\\phi(x+1)\\phi(x-1)+\\phi(5)=0$ï¼Œäºæ˜¯$\\phi(5)=\\phi(x+1)=0$ã€‚å› æ­¤å¯ä»¥æ„é€ ï¼š æ„é€ $\\phi:\\mathbb{Z}[x]\\to\\mathbb{Z}_5$ï¼Œ$\\phi(f(x))=[f(-1)]$ï¼Œç±»ä¼¼ä¸Šé¢˜å¯è¯´æ˜å…¶ä¸ºç¯åŒæ€ï¼Œä¸‹é¢è®¡ç®—$\\ker\\phi$ã€‚ $f\\in\\ker\\phi\\Leftrightarrow 5\\mid f(-1)$ï¼Œåˆ©ç”¨å› å¼å®šç†å¾—ä¹Ÿå³å­˜åœ¨$t\\in\\mathbb{Z}$ä½¿å¾—$f(x)-5t=(x+1)g(x),g\\in\\mathbb{Z}[x]$ã€‚å› æ­¤ï¼Œ$f(x)=5t+(x+1)g(x)$ï¼Œè¿™æ„å‘³ç€$f(x)\\in(5,x+1)$ã€‚å¦ä¸€æ–¹é¢ï¼Œ$f(x)\\in(5,x+1)$æ—¶ï¼Œä¸€å®šå¯ä»¥å†™ä¸º$5g(x)+(x+1)h(x),g,h\\in\\mathbb{Z}[x]$ï¼Œäºæ˜¯$\\phi(f)=[5g(-1)]=[0]$ï¼Œå³è¯æ˜$\\ker\\phi=(5,x+1)$ã€‚ ç”±äº$x^2+4=(x-1)(x+1)+5$ï¼Œåœ¨æœ‰$x+1$æ—¶$x^2+4$ä¸5å¯ä»¥äº’ç›¸ç”Ÿæˆï¼Œäºæ˜¯$(x^2+4,x+1)=(5,x+1)$ã€‚æ­¤å¤–ï¼Œä»¤$f(x)=0,1,2,3,4$å¯çŸ¥$\\phi$æ˜¯æ»¡å°„ï¼Œä»è€Œåˆ©ç”¨ç¯åŒæ€ç¬¬ä¸€å®šç†å¾—è¯ã€‚ è¿™é‡Œä¹Ÿå¯ä»¥å‘ç°ï¼Œç”Ÿæˆç†æƒ³ä¸æœ€å¤§å…¬å› æ•°æœ‰ç±»ä¼¼çš„å…è®¸è¾—è½¬ç›¸é™¤æ€§è´¨ã€‚","categories":[{"name":"ä»£æ•°ç»“æ„","slug":"ä»£æ•°ç»“æ„","permalink":"http://sn1987a-1.github.io/categories/%E4%BB%A3%E6%95%B0%E7%BB%93%E6%9E%84/"}],"tags":[{"name":"ä¸“ä¸šè¯¾","slug":"ä¸“ä¸šè¯¾","permalink":"http://sn1987a-1.github.io/tags/%E4%B8%93%E4%B8%9A%E8%AF%BE/"}]},{"title":"Astar&CSP","slug":"Astar&CSP","date":"2023-06-01T12:48:34.000Z","updated":"2023-09-24T03:23:59.051Z","comments":true,"path":"posts/58da92e9.html","link":"","permalink":"http://sn1987a-1.github.io/posts/58da92e9.html","excerpt":"","text":"Astar and CSP Questionå®éªŒ1.1å®éªŒç›®çš„ä½¿ç”¨A-starç®—æ³•ï¼Œè§£å†³$N\\times N$äºŒè¿›åˆ¶è¿·é”é—®é¢˜ã€‚ å®éªŒå†…å®¹å¯å‘å¼å‡½æ•° åœ¨æœ¬å®éªŒä¸­ï¼Œé€‰ç”¨å¯å‘å¼å‡½æ•°$h(x)=\\frac13\\sum$(1çš„ä¸ªæ•°)ã€‚åœ¨å®é™…æœç´¢ä¸­ï¼Œå¯ä»¥æ ¹æ®å½“å‰çŠ¶æ€è®¡ç®—ä¸‹ä¸€æ­¥çš„1çš„ä¸ªæ•°ï¼Œæ— éœ€é‡æ–°éå†æ•°ç»„è¿›è¡Œè®¡ç®— admissibleï¼šæ¯æ¬¡æ“ä½œæ—¶ï¼Œå¯¹3ä¸ªä½ç½®è¿›è¡Œç¿»è½¬ï¼Œå› æ­¤å¯èƒ½å­˜åœ¨çš„æœ€ä¼˜è§£ä¸º$\\sum (d_{ij}==1)/3$å‘ä¸Šå–æ•´ï¼Œ$h(x)\\leq h*(x)$ consistentï¼šè¯¥å¯å‘å‡½æ•°æ˜¯consistentçš„ï¼Œå› ä¸ºä¸¤ä¸ªç›¸é‚»èŠ‚ç‚¹ä¹‹é—´$c(m,n)\\geq${mä¸­1çš„ä¸ªæ•°å’Œnä¸­1çš„ä¸ªæ•°çš„å·®}/3ï¼Œ$h(n)-h(m)=h(n-m)$ï¼Œå› æ­¤$h(n)\\leq c(n,m)+h(m)$ æ€è·¯ å€ŸåŠ©æ•°ç»„data[][]å­˜å‚¨å½“å‰çš„å›¾çš„æƒ…å†µï¼Œstepå­˜å‚¨å½“å‰çš„æ­¥æ•°ï¼Œsolutionå­˜å‚¨å½“å‰çš„è§£æ³•ï¼Œå…¶ä¸­solutionæ¯ä¸€è¡Œåˆ†åˆ«å­˜å‚¨æ¯ä¸€æ­¥çš„xï¼Œyåæ ‡å’Œä»¥è¯¥ç‚¹ä¸ºä¸­å¿ƒçš„å››ç§è½¬æ³•ï¼› ä½¿ç”¨å­˜å‚¨å—é™çš„å¯å‘å¼æœç´¢ï¼Œå¹¶é™åˆ¶æ·±åº¦ï¼Œæ¯æ¬¡é€’å½’æœç´¢ï¼Œä½¿ç”¨priority queueå­˜å‚¨æ¯æ¬¡æœç´¢æ—¶æ¢ç´¢çš„èŠ‚ç‚¹ï¼Œå…¶ä¸­ä¼˜å…ˆé˜Ÿåˆ—çš„æ’åºæ ¹æ®æ˜¯æ¯ä¸ªèŠ‚ç‚¹æ¢ç´¢åå‰©ä½™çš„1çš„ä¸ªæ•°ï¼Œä»å°åˆ°å¤§æ’åºï¼Œå³ä¸ºä¼˜å…ˆæ¢ç´¢å¯ä»¥æœ€å°åŒ–1çš„ä¸ªæ•°çš„æƒ…å†µã€‚ auto cmp = [](const int* a, const int* b) { return a[0] &gt; b[0]; }; priority_queue&lt;int*, vector&lt;int*&gt;, decltype(cmp)&gt; pq(cmp); while(!pq.empty()) { auto cur=pq.top(); pq.pop(); change_data(cur[1],cur[2],cur[3]); solution[step-1][0]=cur[1]; solution[step-1][1]=cur[2]; solution[step-1][2]=cur[3]; cur_1_num=cur[0]; visit_state[cur[1]][cur[2]][cur[3]]=1; if(RBFS()==2) return 2; visit_state[cur[1]][cur[2]][cur[3]]=0; change_data(cur[1],cur[2],cur[3]); cur_1_num=temp_1_num; } æ¯æ¬¡æœç´¢ï¼Œè®¡ç®—ä¸‹ä¸€æ­¥1çš„ä¸ªæ•° int each_step(int cases,int x,int y) { int after_num=cur_1_num; after_num+=1-2*data[x][y]; switch (cases) { case 1: after_num+=1-2*data[x][y+1]; after_num+=1-2*data[x-1][y]; break; //...case 2 3 4 default: break; } return after_num; } æ¯æ¬¡è¿›å…¥é€’å½’æˆ–é€€å‡ºé€’å½’æ—¶ï¼Œéƒ½è¦åŠæ—¶æ›´æ–°ï¼šstep,cur_1_num,data void change_data(int x,int y,int cases){ data[x][y]=1-data[x][y]; switch (cases) { case 1: data[x][y+1]=1-data[x][y+1]; data[x-1][y]=1-data[x-1][y]; break; //case 2 3 4: default: break; } } å‰ªææ“ä½œ ç”±äºæœ€ä¼˜è§£ä¸­ï¼Œä¸€å®šä¸å­˜åœ¨åŒä¸€ä¸ªä½ç½®çš„åŒä¸€ç§è½¬æ³•ï¼Œå¯ä»¥ç»´æŠ¤æ•°ç»„é™åˆ¶ä»…æ‹“å±•æœªè¢«æ¢ç´¢çš„èŠ‚ç‚¹ è§£æ³•çš„é¡ºåºä¸å½±å“è§£çš„ç»“æœï¼Œå› æ­¤å¯ä»¥é™åˆ¶æ¯æ¬¡æ‹“å±•çš„èŠ‚ç‚¹ï¼Œå…·ä½“æ–¹æ³•ä¸ºï¼šéå†dataæ•°ç»„ï¼Œç›´åˆ°é‡åˆ°ç¬¬ä¸€ä¸ª1ï¼Œè¦æŠŠè¿™ä¸ª1ç¿»è½¬æˆ0ï¼Œåˆ™å¿…é¡»å­˜åœ¨ä¸€æ­¥åŒ…å«è¯¥1ï¼Œè¿™æ ·çš„æ“ä½œæœ€å¤šå­˜åœ¨12ç§ï¼Œå› æ­¤åªéœ€æ‹“å±•ç›¸å…³çš„12ä¸ªèŠ‚ç‚¹å³å¯ã€‚ for(int i=0;i&lt;size;i++){ for(int j=0;j&lt;size;j++) { if(data[i][j]==1) { if(i!=0&amp;&amp;j!=0) { next_step=find_next(i,j,2); if(visit_state[i][j][2]==0) pq.push(next_step); next_step=find_next(i-1,j,3); if(visit_state[i-1][j][3]==0) pq.push(next_step); next_step=find_next(i,j-1,1); if(visit_state[i][j-1][1]==0) pq.push(next_step); } //...other nine states t_flag=1; break; } }} æ·±åº¦å—é™æœç´¢ä¸­ï¼Œç†è®ºä¸Šå¯¹äºæ¯ä¸ªå•ç‹¬å­˜åœ¨çš„1ï¼Œå¯ä»¥ç”¨3æ­¥å°†å…¶å˜ä¸º0ä¸”ä¸æ”¹å˜å…¶ä»–çš„çŠ¶æ€ï¼Œå› æ­¤å¯ä»¥æ ¹æ®æ¯æ¬¡æœç´¢åˆ°è§£æ—¶å½“å‰çš„è§£çš„æ­¥æ•°æ›´æ–°æ·±åº¦é™åˆ¶depth-limitï¼Œä»¥åŠæ›´æ–°å½“å‰æœ€ä¼˜è§£ if(cur_1_num==0) { if(step&lt;best_step) { best_step=step; for(int i=0;i&lt;step;i++) for(int j=0;j&lt;3;j++) best_solution[i][j]=solution[i][j]; } if(depth_limit&gt;step) depth_limit=step; step--; return 1; } å¯¹æ¯”Dijkstra Dijkstraæœç´¢å’Œå¯å‘å¼æœç´¢çš„åŒºåˆ«åœ¨äºDijkstraä¸éœ€è¦å€ŸåŠ©å¯å‘å‡½æ•°ç¡®å®šä¸‹ä¸€æ­¥éœ€æ‹“å±•çš„èŠ‚ç‚¹ï¼Œå³å°†åŸå‡½æ•°çš„å¯å‘å‡½æ•°ä¸€ç›´è®¤ä¸ºæ˜¯0å³å¯ï¼Œåœ¨å…¶ä»–æ¡ä»¶ä¸å˜çš„æƒ…å†µä¸‹ï¼Œå’Œå¯å‘å¼æœç´¢çš„åŒºåˆ«ï¼š å¦‚æœéœ€è¦æœç´¢æœ€ä¼˜è§£ï¼Œç”±äºå¯å‘å¼æœç´¢å¯¹æ·±åº¦é™åˆ¶å’Œå‰ªæçš„å­˜åœ¨ï¼Œå¯ä»¥å¤§å¤§é™ä½è¿è¡Œçš„æ—¶é—´å’Œè¿è¡Œçš„å†…å­˜å ç”¨ï¼ŒDijkstraå¹¶ä¸é€‚åˆæ±‚è§£æœ€ä¼˜è§£ å¦‚æœè¦æœç´¢å¯è¡Œè§£ï¼Œå¯å‘å¼æœç´¢çš„æœç´¢ç»“æœæ­¥æ•°ä½äºDijkstraç®—æ³• å®éªŒ1.2å®éªŒç›®çš„ä½¿ç”¨CSPç®—æ³•ï¼Œä¸ºå­¦æ ¡å®¿ç®¡é˜¿å§¨å®‰æ’å€¼ç­è¡¨ï¼Œä»¥æ»¡è¶³çº¦æŸæ¡ä»¶ï¼Œå°½å¯èƒ½åœ°æ»¡è¶³é˜¿å§¨ä»¬çš„è½®ç­è¯·æ±‚ï¼Œæ–Œå¹¶ä½¿ç”¨MRVã€Forward Checkingã€Constraint Propagationç­‰ä¼˜åŒ–æŠ€æœ¯ï¼Œä»¥ä¾¿å¿«é€Ÿè§£å†³ä»»åŠ¡å¹¶æœ€å¤§åŒ–æ»¡è¶³è¯·æ±‚æ•°ã€‚ å®éªŒå†…å®¹å®éªŒçš„é—®é¢˜æ¨¡å‹å¯ä»¥æŠ½è±¡ä¸ºä¸€ä¸ªCSPé—®é¢˜ï¼šè¦æ‰¾åˆ°æœ€å¤§åŒ–æ»¡è¶³çº¦æŸ$Request\\subset \\{0,1\\}^{N\\times D\\times S}$çš„å–å€¼ä¸ºstaff_numçš„days_num*shifts_numä¸ªå˜é‡ã€‚ä¸‹é¢æ˜¯CSPç®—æ³•è®¾è®¡çš„å…·ä½“å†…å®¹ï¼š æœ€å°å‰©ä½™å€¼ï¼šä½¿ç”¨MRVæ±‚è§£é—®é¢˜ï¼Œå¯ä»¥æé«˜æ±‚è§£é€Ÿåº¦ï¼Œmrvå‡½æ•°çš„å·¥ä½œå°±æ˜¯æ ¹æ®å½“å‰çš„æœªè¢«åˆ†é…çš„å˜é‡ä¸­ï¼Œå‰©ä½™å€¼æœ€å°‘çš„å˜é‡å¹¶è¿”å›å…¶ indexï¼Œå¦‚æœä¸å­˜åœ¨æœªè¢«åˆ†é…çš„å˜é‡ï¼Œå³å‰næ­¥å·²ç»å®Œæˆäº†æ’ç‰ˆï¼Œè¿”å›-1 int mrv() { int min_index=0; int flag=0; for(int i=1;i&lt;shifts_num*days_num;i++) { if(remaining_value[i]&lt;remaining_value[min_index]) min_index=i; if(remaining_value[i]&gt;0) flag=1; } if(flag==0||remaining_value[min_index]==1000000) return -1; return min_index; } å¤„äºå…¬å¹³èµ·è§ï¼Œåº”è¯¥è®©æ‰€æœ‰çš„staffè¢«æ’ç­çš„æ¬¡æ•°å‡æ¥è¿‘å¹³å‡å€¼ï¼Œä¸ºäº†è¾¾åˆ°è¿™ä¸€æ•ˆæœï¼Œæ¯æ¬¡å¯¹æŸä¸€æ—¶é—´æ®µè¿›è¡Œæ’ç‰ˆæ—¶ï¼Œæ ¹æ®æ»¡è¶³æ¡ä»¶çš„staffå·²ç»æ’ç­çš„æ¬¡æ•°ä»å°åˆ°å¤§è¿›è¡Œæ’åºï¼Œä¼˜å…ˆå®‰æ’æ’ç‰ˆæ¬¡æ•°è¾ƒå°‘è€…ï¼›å¦å¤–ï¼Œä¸ºäº†ä¿è¯ä¼˜å…ˆæœ€å¤§åŒ–è¯·æ±‚æ•°é‡ï¼Œå¦‚æœè¯¥æ—¶é—´æ®µå­˜åœ¨å¯ä»¥æ»¡è¶³çº¦æŸçš„è¯·æ±‚ï¼Œä¼˜å…ˆåœ¨å¯ä»¥æ»¡è¶³è¯·æ±‚çš„staffä¸­é€‰æ‹©ï¼Œä¸è€ƒè™‘æ— æ³•æ»¡è¶³çš„éƒ¨åˆ†ï¼Œå¦åˆ™å†è€ƒè™‘æ— æ³•æ»¡è¶³è¯·æ±‚çš„æƒ…å†µã€‚ vector&lt;int&gt; staff_order(int index) { vector&lt;int&gt; order; for(int i=0;i&lt;staff_num;i++) { if(data[i][index]==1) order.push_back(i); } if(order.size()==0) { for(int i=0;i&lt;staff_num;i++) { if(data[i][index]==0) order.push_back(i); } } sort(order.begin(), order.end(), [](int a, int b){return staff_times[a] &lt; staff_times[b];}); return order; } CSPç®—æ³•çš„ä¸»å¹²éƒ¨åˆ†ï¼Œé€’å½’æ±‚è§£ï¼Œä¸‹é¢æ˜¯ä¸ºå…¨éƒ¨çš„æ—¶é—´æ®µæ‰¾åˆ°è§£çš„å¤„ç†ï¼Œå…¶ä¸­å¯¹è¿”å›å€¼çš„è§£é‡Šå¦‚ä¸‹ï¼šå…¶ä¸­not_fot_numè®°å½•äº†æœªæ»¡è¶³çš„çº¦æŸçš„æ•°ç›® 1ï¼šæ‰¾åˆ°äº†æ»¡è¶³æ‰€æœ‰è¯·æ±‚çš„è§£ï¼Œæ­¤æ—¶è¦æ›´æ–°ç›¸å…³å‚æ•°å¹¶é€€å‡ºé€’å½’ 2ï¼šæ‰¾åˆ°äº†è§£ï¼Œæ²¡æœ‰æ»¡è¶³æ‰€æœ‰è¯·æ±‚ï¼Œä½†æ¯”ä¹‹å‰æ±‚è§£çš„è§£æ›´å¥½ï¼Œæ­¤æ—¶è¦æ›´æ–°ç›¸å…³å‚æ•° -1ï¼šæ‰¾åˆ°äº†ä¸æ»¡è¶³æ‰€æœ‰çº¦æŸçš„è§£ï¼Œå¹¶ä¸”ä¸å¦‚ä¹‹å‰çš„è§£ï¼Œä¸åšå¤„ç† if(num==days_num*shifts_num&amp;&amp;not_fit_num==0) { best_fit_num=not_fit_num; for(int i=0;i&lt;days_num*shifts_num;i++) { best_plan[i]=final_plan[i]; } return 1;} else if (not_fit_num&gt;best_fit_num) return -1; else if(num==days_num*shifts_num&amp;&amp;not_fit_num&lt;best_fit_num) { best_fit_num=not_fit_num; for(int i=0;i&lt;days_num*shifts_num;i++) { best_plan[i]=final_plan[i]; } return 2; } å¯¹äºä¸€èˆ¬çš„æƒ…å†µï¼Œè¦æ ¹æ®MRVçš„åŸåˆ™æ‰¾åˆ°æœ€å°å‰©ä½™å€¼ï¼Œå¹¶æ ¹æ®å·²æ’ç­æ•°é‡staff_numæ¥ç¡®å®šèµ‹å€¼é¡ºåºã€‚æ¯æ¬¡è¿›å…¥æˆ–é€€å‡ºé€’å½’æ—¶ï¼Œéƒ½è¦æ›´æ–°æˆ–æ¢å¤ç›¸å…³çš„å˜é‡ï¼š ä¿®æ”¹dataä¸­è¯¥staffç›¸é‚»æ—¶é—´çš„çŠ¶æ€ ä¿®æ”¹ç›¸é‚»æ—¶é—´ä¸­remain_value æ›´æ”¹æ— æ³•æ»¡è¶³çš„æƒ…å†µæ—¶not_fit_num ä¿®æ”¹staffå·²ç»è¢«æ’ç­çš„æ¬¡æ•° int index=mrv(); int state=0; auto order=staff_order(index); int t; for(int j=0;j&lt;order.size();j++) { int i=order[j]; int old_data_i_index=data[i][index]; if(old_data_i_index==0) not_fit_num+=1; data[i][index]=0; state=0; if(index!=0&amp;&amp;data[i][index-1]==1) { remaining_value[index-1]-=1; state=1; } if(index!=0) data[i][index-1]=-1; if(index!=days_num*shifts_num-1&amp;&amp;data[i][index+1]==1) { remaining_value[index+1]-=1; state+=2; } if(index!=days_num*shifts_num-1) data[i][index+1]=-1; final_plan[index]=i; int temp=remaining_value[index]; remaining_value[index]=1000000; staff_times[i]++; t=csp(num+1); staff_times[i]--; remaining_value[index]=temp; if(t==1) { return 1; } if(index!=0) data[i][index-1]=0; if(index!=days_num*shifts_num-1) data[i][index+1]=0; if(state%2==1) { data[i][index-1]=1; remaining_value[index-1]+=1; } if(state&gt;=2) { data[i][index+1]=1; remaining_value[index+1]+=1; } data[i][index]=old_data_i_index; if(old_data_i_index==0) not_fit_num--; } return 2; æœ€åå¤„ç†è¾“å…¥æ•°æ®ï¼Œè¾“å‡ºæ•°æ®æ¨¡å—ï¼Œå³å¯å®ŒæˆCSPæ’ç­çš„å…¨éƒ¨å†…å®¹ã€‚ void get_input(char * filename) { ifstream file(filename); char c; file&gt;&gt;staff_num&gt;&gt;c&gt;&gt;days_num&gt;&gt;c&gt;&gt;shifts_num; each_time=days_num*shifts_num/staff_num; best_fit_num=100000; not_fit_num=0; for(int i=0;i&lt;staff_num;i++) { for(int j=0;j&lt;days_num;j++) { for(int k=0;k&lt;shifts_num;k++) { if(k) file&gt;&gt;c; file&gt;&gt;data[i][j*shifts_num+k]; remaining_value[j*shifts_num+k]+=data[i][j*shifts_num+k]; }} }} void get_output(char * filename) { fstream file(filename); for(int i=0;i&lt;days_num;i++) { for(int j=0;j&lt;shifts_num;j++) { if(j!=shifts_num-1) file&lt;&lt;best_plan[i*shifts_num+j]&lt;&lt;','; else file&lt;&lt;best_plan[i*shifts_num+j]&lt;&lt;endl; } } file&lt;&lt;days_num*shifts_num-best_fit_num&lt;&lt;endl; }","categories":[{"name":"äººå·¥æ™ºèƒ½","slug":"äººå·¥æ™ºèƒ½","permalink":"http://sn1987a-1.github.io/categories/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD/"}],"tags":[{"name":"ä¸“ä¸šè¯¾","slug":"ä¸“ä¸šè¯¾","permalink":"http://sn1987a-1.github.io/tags/%E4%B8%93%E4%B8%9A%E8%AF%BE/"}]},{"title":"UTXOåŒºå—é“¾","slug":"åŒºå—é“¾","date":"2023-05-28T12:48:34.000Z","updated":"2023-09-24T03:52:59.486Z","comments":true,"path":"posts/e65e9bf0.html","link":"","permalink":"http://sn1987a-1.github.io/posts/e65e9bf0.html","excerpt":"","text":"PART1å®éªŒç›®çš„ äº†è§£åŒºå—é“¾ä¸Šçš„ç®€å•æ•°æ®ç»“æ„ å®ç°Merkleæ ‘çš„æ„å»º åˆæ­¥ç†è§£UTXOçš„ä½¿ç”¨å’ŒéªŒè¯ ç†è§£æ¯”ç‰¹å¸ä¸Šçš„äº¤æ˜“åˆ›å»º å®éªŒå†…å®¹åŒºå—é“¾çš„åŸºæœ¬ç»“æ„type BlockChain struct{ tip []byte//æœ€æ–°åŒºå—çš„å“ˆå¸Œå€¼ db *bolt.DB//æ•°æ®åº“è¿æ¥ } åŒºå—é“¾é€šè¿‡é“¾å¼ç»“æ„è¿æ¥å„ä¸ªåŒºå—ï¼Œå½¢æˆä¸€ä¸ªä¸æ–­å¢é•¿çš„åˆ†å¸ƒå¼è´¦æœ¬ç³»ç»Ÿã€‚ åŒºå—çš„åŸºæœ¬ç»“æ„ä½œä¸ºåŒºå—é“¾çš„ä¸»è¦ç»„æˆéƒ¨åˆ†ï¼ŒåŒºå—ç”±åŒºå—å¤´å’ŒåŒºå—ä½“æ„æˆï¼ŒåŒºå—å¤´å­˜å‚¨äº†ç‰ˆæœ¬å·ï¼Œä¸Šä¸€ä¸ªåŒºå—çš„å“ˆå¸Œå€¼ï¼Œå½“å‰åŒºå—äº¤æ˜“çš„å“ˆå¸Œå€¼ï¼Œæ—¶é—´æˆ³ç­‰ä¿¡æ¯ï¼Œå”¯ä¸€æ ‡è¯†ä¸€ä¸ªåŒºå—ã€‚ type BlkHeader struct { Version int64 PrevBlockHash []byte MerkleRoot []byte Timestamp int64 Bits int64 Nonce int64 } å®éªŒæ­¥éª¤Merkleæ ‘æ¯ä¸€ä¸ªåŒºå—çš„äº¤æ˜“èŠ‚ç‚¹ä»åº•å‘ä¸Šæ„å»ºMerkleæ ‘ï¼Œé‡‡ç”¨å“ˆå¸ŒåŠ å¯†ï¼ˆå•æ¬¡sha256ï¼‰ã€‚ æ–°å»ºMerkleèŠ‚ç‚¹ï¼Œåˆ†ä¸ºå¶å­èŠ‚ç‚¹å’Œéå¶å­èŠ‚ç‚¹ func NewMerkleNode(left, right *MerkleNode, data []byte) *MerkleNode { NewNode:=&amp;MerkleNode{} NewNode.Left=left NewNode.Right=right if left==nil &amp;&amp; right==nil{ data_sha:=sha256.Sum256(data) NewNode.Data=data_sha[:] } else{ data_c:=append(left.Data,right.Data...) data_sha:=sha256.Sum256(data_c) NewNode.Data=data_sha[:] } return NewNode } æ–°å»ºMerkleæ ‘ï¼Œè°ƒç”¨æ–°å»ºèŠ‚ç‚¹çš„å‡½æ•°è‡ªåº•å‘ä¸Šæ„å»ºï¼Œç›´åˆ°ç»“ç‚¹æ•°ä¸º1ï¼Œå¹¶ä¸”ä¿è¯èŠ‚ç‚¹æ•°é‡ä¸ºå¶æ•° func NewMerkleTree(data [][]byte) *MerkleTree { NewTree:=&amp;MerkleTree{} var nodes []MerkleNode NewTree.Leaf=data for _,data_i := range data{ node_i:=NewMerkleNode(nil,nil,data_i) nodes=append(nodes,*node_i) } for len(nodes)&gt;1{ var newnodes []MerkleNode for i:=0;i&lt;len(nodes)/2;i++{ node:=NewMerkleNode(&amp;nodes[2*i],&amp;nodes[2*i+1],nil) newnodes=append(newnodes,*node) } if len(nodes)%2==1{ node:=NewMerkleNode(&amp;nodes[len(nodes)-1],&amp;nodes[len(nodes)-1],nil) newnodes=append(newnodes,*node) } nodes=newnodes } NewTree.RootNode=&amp;nodes[0] return NewTree } SPVè¯æ˜è·¯å¾„ï¼Œè‡ªåº•å‘ä¸Šè·å–èŠ‚ç‚¹çš„è·¯å¾„çš„å…„å¼Ÿç»“ç‚¹çš„å“ˆå¸Œå€¼ å…ˆæ ¹æ®ç»“ç‚¹çš„indexåˆ¤æ–­èŠ‚ç‚¹åœ¨æ ‘çš„å…·ä½“ä½ç½®ï¼Œè‡ªé¡¶å‘ä¸‹è®¿é—®è·¯å¾„ï¼Œå†å°†è·¯å¾„é€†åºå³å¯è·å–SPVè¯æ˜è·¯å¾„ func (t *MerkleTree) SPVproof(index int) ([][]byte, error) { t_len:=len(t.Leaf) if index&gt;t_len{ return nil,fmt.Errorf(\"Outof Index\") } depth:=0 leaf_number:=1 t_node:=t.RootNode.Left for t_node!=nil{ t_node=t_node.Left depth+=1 leaf_number*=2 } var n_path [][]byte t_node=t.RootNode for t_node!=nil &amp;&amp; t_node.Left!=nil{ if index&gt;=leaf_number/2{ index-=leaf_number/2 n_path=append(n_path,t_node.Left.Data) t_node=t_node.Right } else{ n_path=append(n_path,t_node.Right.Data) t_node=t_node.Left } leaf_number/=2 } var path [][]byte for i:=0;i&lt;len(n_path);i++{ path=append(path,n_path[len(n_path)-1-i]) } return path, nil } éªŒè¯SPVè·¯å¾„ï¼Œå°†è¯¥èŠ‚ç‚¹çš„å“ˆå¸Œå€¼å’ŒSPVè¯æ˜è·¯å¾„ä¾æ¬¡è®¡ç®—ï¼Œæœ€ç»ˆå’Œæ ¹èŠ‚ç‚¹çš„å“ˆå¸Œå€¼æ¯”è¾ƒå³å¯å®ŒæˆSPVè·¯å¾„çš„éªŒè¯ã€‚ func (t *MerkleTree) VerifyProof(index int, path [][]byte) (bool, error) { if index&gt;len(t.Leaf){ return false,fmt.Errorf(\"Outof Index\") } data_sha:=sha256.Sum256(t.Leaf[index]) n_data:=data_sha[:] for _,t_data :=range path{ if index%2==1{ temp:=append(t_data,n_data...) temp2:=sha256.Sum256(temp) n_data=temp2[:] } else{ temp:=append(n_data,t_data...) temp2:=sha256.Sum256(temp) n_data=temp2[:] } index/=2 } for i:=0;i&lt;len(n_data);i++{ if t.RootNode.Data[i]!=n_data[i]{ return false,nil } } return true, nil } åˆ¤æ–­Coinbaseäº¤æ˜“æ¯ä¸ªåŒºå—æ–°å»ºç«‹æ—¶ï¼Œå¯ä»¥åŠ å…¥ä¸€ç¬”coinbaseäº¤æ˜“ï¼Œè¿™ç¬”äº¤æ˜“åªæœ‰è¾“å‡ºï¼Œæ²¡æœ‰è¾“å…¥ï¼Œåˆ¤æ–­çš„åŸºæœ¬ä¾æ®ä¸ºï¼š åªå‡ºç°åœ¨ç¬¬ä¸€ç¬”äº¤æ˜“ï¼Œå…¶ä»–äº¤æ˜“å‡ä¸æ˜¯coinbaseäº¤æ˜“ è¾“å…¥çš„Txidä¸ºç©ºï¼ŒVoutä¸º-1 func (t *Transaction) IsCoinBase() bool { if len(t.Vin[0].Txid)==0 &amp;&amp; (t.Vin[0].Vout==-1){ for i:=1;i&lt;len(t.Vin);i++{ if len(t.Vin[i].Txid)==0 &amp;&amp; (t.Vin[i].Vout==-1){ return false}} return true} return false} è®¡ç®—å…¬é’¥å¯¹åº”çš„åœ°å€æ¯”ç‰¹å¸ä¸Šçš„åœ°å€çš„è®¡ç®—å¦‚ä¸‹ è®¡ç®—å…¬é’¥çš„å“ˆå¸Œå€¼ï¼ˆRIPEMD16(SHA256(PubKey))ï¼‰ åœ°å€è®¡ç®—å‰åŠ å…¥ç‰ˆæœ¬å· æŠŠæ­¥éª¤2çš„å†…å®¹é€šè¿‡è®¡ç®—å…¬é’¥å“ˆå¸Œçš„åŒé‡SHA256å“ˆå¸ŒåŠ å¯†ï¼Œå–å‰4ä¸ªå­—èŠ‚ä½œä¸ºæ ¡éªŒå’Œ ç‰ˆæœ¬å·ï¼Œå…¬é’¥å“ˆå¸Œï¼Œæ ¡éªŒå’Œçš„ç»„åˆé€šè¿‡Base58åŠ å¯†ç”Ÿæˆæ¯”ç‰¹å¸çš„åœ°å€ func (w *Wallet) GetAddress() []byte { key_hash:=HashPublicKey(w.PublicKey) var temp []byte temp=append(temp,version) temp=append(temp,key_hash...) checksum:=sha256.Sum256(temp) hash_checksum:=checksum[:] checksum=sha256.Sum256(hash_checksum) hash_checksum=checksum[:] var res []byte res=append(res,version) res=append(res,key_hash...) res=append(res,hash_checksum[0:checkSumlen]...) res=[]byte(base58.Encode(res)) return res } P2PKHé”å®šéƒ¨åˆ†P2PKHæŒ‡çš„æ˜¯å‘å…¬é’¥çš„å“ˆå¸Œæ”¯ä»˜ï¼Œæ ¹æ®å…¬é’¥çš„åœ°å€çš„è®¡ç®—æ–¹æ³•ï¼Œç±»ä¼¼çš„å¯ä»¥é€šå…¬é’¥åœ°å€è·å–å…¬é’¥çš„å“ˆå¸Œï¼š å…¬é’¥åœ°å€ç»è¿‡base58è§£ç åï¼Œç¬¬ä¸€ä½æ˜¯versionç‰ˆæœ¬å·ï¼Œåå››ä½ä¸ºæ ¡éªŒå’Œï¼Œä¸­é—´å³ä¸ºå…¬é’¥å“ˆå¸Œ func (out *TXOutput) Lock(address []byte) { data,_:=base58.Decode(string(address)) out.PubKeyHash=data[1:len(data)-4] } å®éªŒç»“æœå€ŸåŠ©go testå¯¹å®éªŒç»“æœè¿›è¡Œæ£€éªŒ PS E:\\2023spring\\blockchain\\lab2\\lab2&gt; go test PASS ok lab2 0.657s PART2å®éªŒç›®çš„ è¿›ä¸€æ­¥ç†è§£åŒºå—é“¾ä¸Šçš„æ•°æ®ç»“æ„ å®ç°åŸºäºçš„POWå…±è¯†ç®—æ³•å‡ºå— å®ç°æ¯”ç‰¹å¸ä¸Šçš„è´¦æˆ·åˆ›å»ºå’ŒæŸ¥è¯¢ ç†è§£UTXOçš„åŸºæœ¬ä½¿ç”¨æ–¹æ³• å®ç°åŒºå—é“¾ä¸æ•°æ®åº“çš„äº¤äº’ å®éªŒå†…å®¹å·¥ä½œé‡è¯æ˜å·¥ä½œé‡çš„è¯æ˜æœºåˆ¶ï¼ˆPOWï¼‰ï¼Œç®€å•æ¥è¯´å°±æ˜¯é€šè¿‡æäº¤ä¸€ä¸ªå®¹æ˜“æ£€æµ‹ï¼Œä½†æ˜¯éš¾ä»¥è®¡ç®—çš„ç»“æœï¼Œæ¥è¯æ˜èŠ‚ç‚¹åšè¿‡ä¸€å®šé‡çš„å·¥ä½œã€‚ é¦–å…ˆå®ŒæˆRunå‡½æ•°ï¼Œè¯¥å‡½æ•°ä»£è¡¨çŸ¿å·¥é€šè¿‡å¦‚ä¸‹æµç¨‹å®ŒæˆæŒ–çŸ¿å·¥ä½œï¼š é¦–å…ˆæ„å»ºå½“å‰åŒºå—å¤´ï¼ŒåŒºå—å¤´åŒ…å«ç‰ˆæœ¬å·ï¼Œä¸Šâ¼€ä¸ªåŒºå—å“ˆå¸Œå€¼(32ä½)ï¼Œå½“å‰åŒºå—æ•°æ®å¯¹åº”å“ˆå¸Œï¼ˆ32ä½ï¼Œå³åŒºå—æ•°æ®çš„merkleæ ¹ï¼‰ï¼Œæ—¶é—´æˆ³ï¼ŒåŒºå—éš¾åº¦ï¼Œè®¡æ•°å™¨(nonce)ã€‚ æ·»åŠ è®¡æ•°å™¨ï¼Œä½œä¸ºéšæœºæ•°ã€‚è®¡ç®—å™¨ä»0å¼€å§‹åŸºç¡€ï¼Œæ¯ä¸ªå›åˆ+1 å¯¹äºä¸Šè¿°çš„æ•°æ®æ¥è¿›è¡Œä¸€ä¸ªå“ˆå¸Œçš„æ“ä½œã€‚ åˆ¤æ–­ç»“æœæ˜¯å¦æ»¡è¶³è®¡ç®—çš„æ¡ä»¶ï¼š å¦‚æœç¬¦åˆï¼Œåˆ™å¾—åˆ°äº†æ»¡è¶³ç»“æœã€‚ å¦‚æœæ²¡æœ‰ç¬¦åˆï¼Œä»2å¼€å§‹é‡æ–°ç›´æ¥2ã€3ã€4æ­¥éª¤ã€‚ func (pow *ProofOfWork) Run() (int64, []byte) { nonce := int64(0) var hash [32]byte var hashInt big.Int blkh := pow.block.Header for nonce &lt; maxNonce { var data []byte data=append(data,IntToHex(blkh.Version)...) data=append(data,blkh.PrevBlockHash[:]...) data=append(data,blkh.MerkleRoot[:]...) data=append(data,IntToHex(blkh.Timestamp)...) data=append(data,IntToHex(blkh.Bits)...) data=append(data,IntToHex(nonce)...) hash = sha256.Sum256(data) hashInt.SetBytes(hash[:]) if hashInt.Cmp(pow.target) == -1 { break } else { nonce++ } } return nonce, hash[:] } å€ŸåŠ©Validateå‡½æ•°å®Œæˆå¯¹æŒ–çŸ¿ç»“æœçš„éªŒè¯ï¼Œå³éªŒè¯çŸ¿å·¥ç»™å‡ºçš„Nonceæ˜¯å¦æ˜¯è¯¥éš¾é¢˜çš„ç­”æ¡ˆã€‚ func (pow *ProofOfWork) Validate() bool { var hashInt big.Int var hash [32]byte blkh := pow.block.Header var data []byte data=append(data,IntToHex(blkh.Version)...) data=append(data,blkh.PrevBlockHash[:]...) data=append(data,blkh.MerkleRoot[:]...) data=append(data,IntToHex(blkh.Timestamp)...) data=append(data,IntToHex(blkh.Bits)...) data=append(data,IntToHex(blkh.Nonce)...) hash = sha256.Sum256(data) hashInt.SetBytes(hash[:]) return hashInt.Cmp(pow.target) == -1 } UTXOUTXO(Unspent Transaction Outputs)ï¼Œå³æ²¡æœ‰èŠ±æ‰çš„äº¤æ˜“è¾“å‡ºï¼Œå®é™…å¯ä»¥ç†è§£ä¸ºåœ¨ä¸€æ¬¡è½¬è´¦æ—¶å‰©ä½™æ²¡æœ‰è½¬å‡ºçš„èµ„é‡‘ã€‚UTXOçš„äº¤æ˜“æ¨¡å‹ä¸Šï¼Œç”¨æˆ·é€šè¿‡ä½¿ç”¨æœªä½¿ç”¨çš„äº¤æ˜“è¾“å‡ºï¼ˆUTXOï¼‰æ¥æ‰§è¡Œä¸€ç¬”äº¤æ˜“ã€‚ æ„å»ºæ–°çš„UTXOäº¤æ˜“çš„æ–¹æ³•å¦‚ä¸‹æ‰€ç¤ºï¼š æ‰¾åˆ°è¾“å…¥åœ°å€å¯¹åº”çš„äº¤æ˜“PubKeyHashï¼Œå€ŸåŠ©findunspentOutputsæ‰¾åˆ°è¾“å…¥è´¦æˆ·çš„UTXO æ ¹æ®UTXOæ„å»ºäº¤æ˜“å¹¶è¿›è¡Œç­¾å å®Œæˆæ‰¾é›¶æ“ä½œï¼šå‰©ä½™çš„é‡‘é¢ä½œä¸ºUTXOè¿”å›åˆ°åŸè¾“å…¥ä¸­ func NewUTXOTransaction(from, to []byte, amount int, UTXOSet *UTXOSet) *Transaction { var inputs []TXInput var outputs []TXOutput wal , _ := NewWallets() bc := UTXOSet.Blockchain pubKeyHash := HashPublicKey(wal.GetWallet(from).PublicKey) acc, validOutputs := UTXOSet.FindUnspentOutputs(pubKeyHash, amount) if acc &lt; amount { log.Panic(\"ERROR: Not enough funds\") } for txid, outs := range validOutputs { txID, err := hex.DecodeString(txid) if err != nil { log.Panic(err) } for _, out := range outs { input := TXInput{ Txid: txID, Vout: out, Signature: nil, PubKey: wal.GetWallet(from).PublicKey, } inputs = append(inputs, input) } out_1 := TXOutput{amount,nil} out_1.Lock(to) outputs = append(outputs, out_1) if acc &gt; amount { out_2 := TXOutput{acc-amount,nil} out_2.Lock(from) outputs = append(outputs, out_2) } tx := Transaction{nil, inputs, outputs} bc.SignTransaction(&amp;tx,wal.GetWallet(from).PrivateKey) tx.SetID() return &amp;tx } UTXOæ± æ¯”ç‰¹å¸æ‰€æœ‰çš„äº¤æ˜“éƒ½æ˜¯æ”¾åœ¨UTXOæ± ä¸­ï¼Œè¿™æ ·çš„å¥½å¤„æ˜¯ä¸ºäº†å¿«é€Ÿçš„å¾—åˆ°æŸä¸ªUTXOæ˜¯å¦å½“å‰å¯ç”¨ã€‚éœ€è¦é€šè¿‡å…¬ç§é’¥çš„å”¯ä¸€æ ‡è¯†æ¥ç®—å‡ºæˆ‘ä»¬å½“å‰çš„ä½™é¢ã€‚åœ¨æ„å»ºUTXOçš„äº¤æ˜“æ—¶ï¼Œæˆ‘ä»¬éœ€è¦é€šè¿‡UTXOæ± æ¥éœ€è¦å½“å‰å±äºè‡ªå·±çš„UTXOï¼Œç„¶åè·å¾—ç›¸å¯¹åº”çš„è´¦æˆ·é‡‘é¢ï¼Œç„¶åå†ç”Ÿæˆå¯¹åº”çš„è¾“å‡ºã€‚FindUnspentOutputså‡½æ•°æ¥æŸ¥è¯¢ç”¨æˆ·å½“å‰æœªæœªèŠ±è´¹çš„UTXOé‡‘é¢åŠå…¶æ˜ å°„å…³ç³»(å­˜å‚¨txidå’Œå¯¹åº”çš„indexï¼Œä¾¿äºåç»­æŸ¥æ‰¾)ï¼Œå…·ä½“å®ç°å¦‚ä¸‹æ‰€ç¤ºï¼š func (u UTXOSet) FindUnspentOutputs(pubkeyHash []byte, amount int) (int, map[string][]int) { unspentOutputs := make(map[string][]int) totalAmount := 0 db := u.Blockchain.db err := db.View(func(tx *bolt.Tx) error { b := tx.Bucket([]byte(utxoBucket)) c := b.Cursor() for k, v := c.First(); k != nil; k, v = c.Next() { outs := DeserializeOutputs(v) txid := hex.EncodeToString(k) for outIndex, out := range outs.Outputs { if out.IsLockedWithKey(pubkeyHash) { unspentOutputs[txid] = append(unspentOutputs[txid], outIndex) totalAmount += out.Value if totalAmount &gt;= amount { return nil } } } } return nil }) if err != nil { log.Panic(err) } return totalAmount, unspentOutputs } BlockChainé™¤æ­¤ä¹‹å¤–ï¼Œè¿˜éœ€è¦å®Œæˆmineblockæ¥ç”Ÿæˆæ–°çš„åŒºå—ï¼šé’ˆå¯¹ä¸€ç»„äº¤æ˜“åœ¨åŒºå—é“¾ä¸Šå†™å…¥ä¸€ä¸ªæ–°å—ï¼Œç»´æŠ¤åŒºå—é“¾çš„ç›¸å…³ä¿¡æ¯ func (bc *Blockchain) MineBlock(transactions []*Transaction) *Block { var last_hash []byte err := bc.db.View(func(tx *bolt.Tx) error { b := tx.Bucket([]byte(blocksBucket)) last_hash = b.Get([]byte(\"l\")) return nil }) if err != nil { log.Panic(err) } var prev_hash [32]byte copy(prev_hash[:],(last_hash)[:32]) newBlock := NewBlock(transactions,prev_hash) err = bc.db.Update(func(tx *bolt.Tx) error { b := tx.Bucket([]byte(blocksBucket)) b.Put(newBlock.CalCulHash(), newBlock.Serialize()) b.Put([]byte(\"l\"), newBlock.CalCulHash()) bc.tip = newBlock.CalCulHash() return nil }) if err != nil { log.Panic(err) } return newBlock } å¦å¤–ï¼Œä¸ºäº†ç»´æŠ¤UTXOï¼Œéœ€è¦æ‰¾åˆ°æ‰€æœ‰UTXOå¹¶æ„å»ºæ˜ å°„ï¼Œé€šè¿‡å‡½æ•°findUTXOå®ç°ï¼š UTXOçš„ç‰¹ç‚¹ï¼šâ€œæœªä½¿ç”¨çš„äº¤æ˜“â€ å¯¹äºæ¯ç¬”éCoinBaseäº¤æ˜“ï¼Œæ¯ä¸ªè¾“å…¥éƒ½æŒ‡å‘ä¹‹å‰çš„è¾“å‡ºï¼Œæ ¹æ®æ‰€æœ‰äº¤æ˜“çš„è¾“å…¥åˆ¤æ–­ä¹‹å‰çš„äº¤æ˜“æ˜¯å¦å·²è¢«è¾“å‡º ç»´æŠ¤UTXOå’ŒspentTXOsé€šè¿‡å¾ªç¯æ±‚å¾—æœ€ç»ˆçš„UTXO func (bc *Blockchain) FindUTXO() map[string]TXOutputs { UTXO := make(map[string]TXOutputs) spentTXOs := make(map[string][]int) bci := bc.Iterator() for { block := bci.Next() for _, tx := range block.GetTransactions() { txID := hex.EncodeToString(tx.ID) Outputs: for outIdx, out := range tx.Vout { if spentTXOs[txID] != nil { for _, spentOutIdx := range spentTXOs[txID] { if spentOutIdx == outIdx { continue Outputs } } } outs := UTXO[txID] outs.Outputs = append(outs.Outputs, out) UTXO[txID] = outs } if tx.IsCoinBase() == false { for _, in := range tx.Vin { inTxID := hex.EncodeToString(in.Txid) spentTXOs[inTxID] = append(spentTXOs[inTxID], in.Vout) } } } if block.GetPrevhash() == [32]byte{} { break } } return UTXO } å®éªŒç»“æœæœ¬æ¬¡å®éªŒåŸºæœ¬å®Œæˆäº†åŸºäºæ¯”ç‰¹å¸çš„åŒºå—é“¾æ­å»ºï¼Œå…·æœ‰ä»¥ä¸‹åŠŸèƒ½ï¼š go run . createblockchain -address ADDRESS //åˆ›å»ºåŒºå—é“¾ go run . createwallet //åˆ›å»ºé’±åŒ… go run . getbalance -address ADDRESS //æŸ¥è¯¢è´¦æˆ·ä½™é¢ go run . listaddresses //æŸ¥è¯¢åŒºå—é“¾ä¸Šçš„åœ°å€ go run . printchain //æ‰“å°åŒºå—é“¾ go run . reindexutxo //é‡æ„UTXOæ±  go run . send -from FROM -to TO -amount AMOUNT //å‘èµ·è½¬è´¦äº¤æ˜“ å¯¹å®ç°çš„åŒºå—é“¾è¿›è¡Œgo test ... PASS ok lab3 0.188s","categories":[{"name":"åŒºå—é“¾","slug":"åŒºå—é“¾","permalink":"http://sn1987a-1.github.io/categories/%E5%8C%BA%E5%9D%97%E9%93%BE/"}],"tags":[{"name":"ä¸“ä¸šè¯¾","slug":"ä¸“ä¸šè¯¾","permalink":"http://sn1987a-1.github.io/tags/%E4%B8%93%E4%B8%9A%E8%AF%BE/"}]},{"title":"ä»£æ•°ç»“æ„ä¹ é¢˜è¯¾-1","slug":"ä»£æ•°ç»“æ„ä¹ é¢˜è¯¾1","date":"2023-05-02T12:48:34.000Z","updated":"2023-09-23T13:29:20.211Z","comments":true,"path":"posts/94cbcba9.html","link":"","permalink":"http://sn1987a-1.github.io/posts/94cbcba9.html","excerpt":"","text":"2023springä»£æ•°ç»“æ„ä¹ é¢˜è¯¾è®²ä¹‰ ä»£æ•°ç»“æ„ ç¬¬ä¸€æ¬¡ä¹ é¢˜è¯¾2023.5.3 ç¬¬ä¸‰ç«  æ˜ å°„å†…å®¹å›é¡¾ æ˜ å°„çš„åŸºæœ¬å®šä¹‰ æ¦‚å¿µï¼šæ˜ å°„ï¼ŒåŸåƒï¼Œåƒï¼Œå€¼åŸŸï¼Œæ˜ å°„ç›¸ç­‰ ç»™å®šé›†åˆAï¼ŒBï¼Œä»Aåˆ°Bçš„æ˜ å°„æœ‰$|B|^{|A|}$ä¸ª ç‰¹æ®Šæ˜ å°„ï¼šå¯¹äº$f:A\\rightarrow B$: $B=A,\\forall a,f(a)=a$ï¼šæ’ç­‰æ˜ å°„ $R_f=B$ï¼šæ»¡å°„ ä»»ç»™$a_1,a_2\\in A,a_1\\neq a_2\\Rightarrow f(a_1)\\neq f(a_2)$ï¼šå•å°„ å•å°„+æ»¡å°„ï¼šä¸€ä¸€æ˜ å°„ï¼ˆåŒå°„ï¼‰ ç›¸å…³æ€§è´¨ï¼š$f^{-1}$ï¼Œ$n!$ä¸ªåŒå°„ æ˜ å°„çš„å¤åˆï¼š$g\\circ f(a)=g(f(a))$ ä»å³å¾€å·¦è®¡ç®— ç»“åˆå¾‹ï¼š$(h\\circ g)\\circ f=h\\circ (g\\circ f)$ $f^{-1}\\circ f=f\\circ f^{-1}=I_A$ å¤åˆè¿ç®—ä¿æŒå•å°„/æ»¡å°„/åŒå°„ ç½®æ¢ï¼šæ˜ å°„åˆ°è‡ªèº«çš„åŒå°„ æ’ç­‰æ˜ å°„ä¹Ÿå¯ä»¥ç§°ä¸ºæ’ç­‰ç½®æ¢ æ±‚é€†ç½®æ¢ï¼šäº¤æ¢ä¸¤è¡Œå¹¶æŒ‰ç…§ç¬¬ä¸€è¡Œæ’åº å¥‡ç½®æ¢ä¸å¶ç½®æ¢ï¼šç”±é€†åºçš„ä¸ªæ•°å¥‡å¶å†³å®š è½®æ¢ï¼šç‰¹æ®Šçš„ç½®æ¢ï¼Œ$\\sigma=(a_1a_2â€¦a_r)$ ä¸ç›¸äº¤çš„è½®æ¢çš„ä¹˜ç§¯å¯ä»¥äº¤æ¢ ä»»ä½•ç½®æ¢éƒ½å¯ä»¥è¡¨ç¤ºæˆè‹¥å¹²ä¸ç›¸äº¤çš„è½®æ¢ä¹‹ä¹˜ç§¯ ç½®æ¢çš„é˜¶ï¼šå°†ç½®æ¢è¡¨ç¤ºä¸ºä¸ç›¸äº¤çš„è½®æ¢ï¼Œé˜¶ä¸ºå„è½®æ¢çš„å› å­é•¿åº¦çš„æœ€å°å…¬å€æ•° å¯¹æ¢ï¼šä¸¤ä¸ªå…ƒç´ çš„è½®æ¢ ä»»ä½•è½®æ¢éƒ½å¯ä»¥è¡¨ç¤ºæˆå¯¹æ¢ä¹‹ç§¯ å¯¹æ¢æ˜¯å¥‡ç½®æ¢ï¼Œnå…ƒç½®æ¢ä¸­ï¼Œå¥‡ç½®æ¢å’Œå¶ç½®æ¢å„å ä¸€åŠ å¼€å…³å‡½æ•°ï¼š$F_2={0,1},f(x_1,â€¦x_n)$ä¸º$F_2^n$åˆ°$F_2$çš„æ˜ å°„å³ä¸ºnå…ƒå¼€å…³å‡½æ•°ï¼Œå…±æœ‰$2^{2^n}$ä¸ª æ±‚è¡¥è¿ç®—$\\overline f$ï¼Œé€»è¾‘åŠ  $ +$ï¼Œé€»è¾‘ä¹˜ $ \\cdot$ ï¼ˆæ³¨æ„å’Œç®—æœ¯è¿ç®—çš„åŒºåˆ«ï¼‰ ç»“åˆå¾‹ï¼Œäº¤æ¢å¾‹ï¼Œåˆ†é…å¾‹ï¼Œ$f+0=f;f\\cdot 1=f;f+\\overline f=1;f\\cdot \\overline f=0$ å°é¡¹è¡¨è¾¾å¼ï¼šå”¯ä¸€çš„è¡¨è¾¾$f(x_1,..x_n)=\\sum_{a_i=0/1,1\\leq i\\leq n} f(a_1,..a_n)x_1^{a_1}â€¦x_n^{a_n}$ ä½œä¸šé¢˜ç›® 3.16 è¯æ˜ï¼šä»»ä½•nå…ƒç½®æ¢éƒ½å¯ä»¥è¡¨ç¤ºæˆ(1 2),(2 3),â€¦,(n-1,n)çš„ä¹˜ç§¯ æ–¹æ³•1ï¼šç”¨å½’çº³æ³•è¯æ˜ï¼š n=2æ—¶ï¼Œ2å…ƒç½®æ¢å³ä¸º(1 2); n&gt;2æ—¶ï¼Œå‡è®¾å¯¹äºä»»ä½•kï¼Œ$k\\le n$,æ»¡è¶³ä»»ä½•kå…ƒç½®æ¢éƒ½å¯ä»¥è¡¨ç¤ºæˆ(1 2),(2 3),â€¦,(k-1,k)çš„ä¹˜ç§¯ï¼Œè€ƒè™‘ä»»ä½•ä¸€ä¸ªnå…ƒç½®æ¢$\\sigma$,è®¾è¯¥ç½®æ¢å¯¹åº”çš„ä½ç½®içš„å…ƒç´ ä¸ºnï¼Œä»¤$\\tau=(n-1\\ n)â€¦(i+1\\ i+2)(i\\ i+1)\\sigma$ï¼Œä¾æ¬¡è®¡ç®—ï¼Œå³ä¸ºå°†$\\sigma$çš„ç¬¬iä¸ªå…ƒç´ å’Œç¬¬i+1ä¸ªå…ƒç´ å¯¹æ¢ï¼Œç¬¬i+1ä¸ªå…ƒç´ å’Œç¬¬i+2ä¸ªå…ƒç´ å¯¹æ¢â€¦æœ€ç»ˆå¯ä»¥å°†å…ƒç´ næ¢åˆ°ç¬¬nä¸ªä½ç½®ï¼Œå³$\\tau$ä¸ºï¼ˆn-1ï¼‰å…ƒç½®æ¢ï¼›å°†ä¸Šå¼è¿›è¡Œæ•´ç†ï¼ŒåŸnå…ƒç½®æ¢å¯ä»¥å†™ä¸º$\\sigma=(i+1\\ i+2)(i\\ i+1)â€¦(n-1\\ n)\\tau$ï¼Œæ ¹æ®å½’çº³å‡è®¾ï¼Œ$\\tau$å¯ä»¥å†™ä¸º(1 2),(2 3),â€¦,(k-1,k)çš„ä¹˜ç§¯ï¼Œå› æ­¤$\\sigma$å¯ä»¥å†™ä¸º(1 2),(2 3),â€¦,(n-1,n)çš„ä¹˜ç§¯ã€‚ ç»¼ä¸Šæ‰€è¿°ï¼Œä»»ä½•nå…ƒç½®æ¢éƒ½å¯ä»¥è¡¨ç¤ºæˆ(1 2),(2 3),â€¦,(n-1,n)çš„ä¹˜ç§¯ã€‚ æ–¹æ³•2ï¼š ä»»ä½•ç½®æ¢éƒ½å¯ä»¥è¡¨ç¤ºä¸ºæˆä¸ç›¸äº¤çš„è½®æ¢ä¹‹ç§¯ï¼Œä»»ä½•è½®æ¢éƒ½å¯ä»¥è¡¨ç¤ºæˆå¯¹æ¢ä¹‹ç§¯ï¼Œå› æ­¤åªéœ€è®¨è®ºå°†å¯¹æ¢è¡¨ç¤ºä¸º(1 2),(2 3),â€¦,(n-1,n)çš„ä¹˜ç§¯ã€‚å¯¹æ¢$(a_i\\ a_j),i&gt;j$å¯è¡¨ç¤ºä¸º$(a_{i+1}\\ a_{i+2})â€¦(a_{j-2}\\ a_{j-1})(a_{j-1}\\ a_{j})â€¦(a_{i+1}\\ a_{i+2})(a_i\\ a_{i+1})$ä»è€Œå¾—è¯ã€‚ 3.17 æ±‚è¯ä¸‹åˆ—æ’ç­‰å¼ ï¼ˆ1ï¼‰$x_1=x_1x_2x_3+x_1\\overline x_2x_3+x_1x_2\\overline x_3+x_1\\overline x_2\\overline x_3$ $x_1=x_1(x_2+\\overline x_2)(x_3+\\overline x_3)=x_1x_2x_3+x_1\\overline x_2x_3+x_1x_2\\overline x_3+x_1\\overline x_2\\overline x_3$ ï¼ˆ2ï¼‰$x_1x_2+x_2x_3+x_3\\overline x_1=x_1x_2+\\overline x_1x_3$ $x_1x_2+x_2x_3+x_3\\overline x_1=x_1x_2+x_2x_3(x_1+\\overline x_1)+x_3\\overline x_1 = x_1x_2(1+x_3)+\\overline x_1x_3(x_2+1)=x_1x_2+\\overline x_1x_3$ æ³¨æ„ï¼šå¼€å…³å‡½æ•°çš„è¿ç®—ä¸­$a+c=b+c$æ— æ³•æ¨å‡º$a=b$ è¡¥å……ä¹ é¢˜æ³¨æ„ï¼Œåœ¨ç½®æ¢/å¯¹æ¢/è½®æ¢çš„è®¡ç®—ä¸­ï¼Œä¹˜ç§¯è¦ä»å³å¾€å·¦è®¡ç®—ï¼Œè½®æ¢çš„è®¡ç®—æ–¹å¼æ˜¯å°†æ¯ä¸ªå…ƒç´ æ˜ å°„åˆ°å³è¾¹çš„ä½ç½®ã€‚ ç¬¬å››ç«  äºŒå…ƒå…³ç³»å†…å®¹å›é¡¾å…³ç³» å…³ç³»çš„å®šä¹‰ï¼š ç›¸å…³æ¦‚å¿µï¼šç©ºå…³ç³»ï¼ˆå¹³å‡¡å…³ç³»ï¼‰ï¼Œå…¨å…³ç³» å…³ç³»çš„æ€§è´¨ï¼šåˆ¤æ–­æ˜¯å¦å…·æœ‰æŸç§æ€§è´¨ è‡ªåæ€§ï¼Œåè‡ªåæ€§ï¼Œå¯¹ç§°æ€§ï¼Œåå¯¹ç§°æ€§ï¼Œä¼ é€’æ€§ å…³ç³»çš„è¡¨ç¤ºï¼š æœ‰åºäºŒå…ƒç»„ï¼š$xRy$ å…³ç³»çŸ©é˜µï¼š$mij=\\begin{cases}0,a_iR\\mkern-10.5mu/ a_j\\\\1,a_iRa_j\\end{cases} $ å…³ç³»å›¾ï¼šå¦‚æœæœ‰$a_iRa_j$ï¼Œåˆ™ç”»ä¸€æ¡ç”±$a_i$æŒ‡å‘$a_j$çš„æœ‰å‘å¼§ï¼ˆç¯ï¼‰ å…³ç³»çš„è¿ç®—ï¼š ç›¸ç­‰ï¼Œ$&lt;,\\leq,&gt;,\\geq$ å¹¶äº¤è¡¥è¿ç®—ï¼ˆäº¤æ¢å¾‹ï¼Œç»“åˆå¾‹ï¼‰ å¤åˆå…³ç³» ï¼šç»“åˆå¾‹ï¼Œå¹‚è¿ç®—$R^n=R^m\\circ R1^{n-m}$ è‡ªåé—­åŒ…ï¼šåŒ…å«Rä¸”æ»¡è¶³è‡ªåæ€§è´¨çš„æœ€å°å…³ç³» å¯¹ç§°é—­åŒ…ï¼Œä¼ é€’é—­åŒ… ç­‰ä»·å…³ç³» æ»¡è¶³è‡ªåï¼Œå¯¹ç§°ï¼Œä¼ é€’ ç­‰ä»·ç±»$[a]_R$ï¼Œä»£è¡¨å…ƒ é›†åˆçš„åˆ’åˆ†ä¸é›†åˆä¸Šçš„ç­‰ä»·å…³ç³»ä¸€ä¸€å¯¹åº”ï¼ˆåˆ’åˆ†ç›¸åŒâ€”â€”ç­‰ä»·å…³ç³»æœ¬è´¨ç›¸åŒï¼‰ A/Rï¼šå…³äºç­‰ä»·å…³ç³»Rçš„å•†é›† åºå…³ç³» $\\preceq$ï¼šè‡ªåï¼Œåå¯¹ç§°ï¼Œä¼ é€’ï¼›ååºé›†$$ å¯æ¯”è¾ƒ/ä¸å¯æ¯”è¾ƒ çº¿åºå…³ç³»ï¼šä»»æ„ä¸¤ä¸ªå…ƒç´ éƒ½æ˜¯å¯æ¯”è¾ƒçš„ï¼ˆå®Œå…¨åºå…³ç³»ï¼‰ åºå…³ç³»ä¸­çš„æ§åˆ¶å…³ç³»ï¼šyæ§åˆ¶xï¼Œå³$x\\hat \\preceq_\\neq y$ï¼Œä¸”ä¸å­˜åœ¨$z,x\\hat \\preceq_\\neq z ,z\\hat\\preceq_\\neq y$ æå¤§å…ƒï¼Œæå°å…ƒ å“ˆå¸Œå›¾ï¼šæœ€ä¸Šæ–¹æ˜¯æå¤§å…ƒï¼Œæœ€ä¸‹æ–¹æ˜¯æå°å…ƒ æœ€å¤§å…ƒï¼Œæœ€å°å…ƒ æœ€å¤§å…ƒä¸€å®šæ˜¯æå¤§å…ƒï¼Œæœ€å¤§å…ƒè‡³å¤šä¸€ä¸ª ï¼ˆå­é›†çš„ï¼‰ä¸Šç•Œ/ä¸‹ç•Œï¼šä¸ä¸€å®šæœ‰ï¼Œä¸ä¸€å®šå”¯ä¸€ æœ€å°ä¸Šç•Œ/ä¸Šç¡®ç•Œï¼›æœ€å¤§ä¸‹ç•Œ/ä¸‹ç¡®ç•Œ é›†åˆçš„åŠ¿ ç­‰åŠ¿ï¼š$A \\sim B$ï¼šå­˜åœ¨åŒå°„ $\\mathscr P(E)$ä¸Šçš„ç­‰ä»·å…³ç³» æœ‰é™é›†åˆ å¯æ•°é›†åˆ ï¼›å¯æ•°æ— é™é›†åˆï¼šä¸è‡ªç„¶æ•°é›†åˆç­‰åŠ¿çš„é›†åˆ åŠ¿çš„å¤§å°ï¼›æ”¯é…ï¼šAå’ŒBçš„ä¸€ä¸ªå­é›†ç­‰åŠ¿ï¼Œåˆ™ç§°Bæ”¯é…Aï¼Œ$A\\preceq B$ï¼šååºå…³ç³» $A\\prec \\mathscr P(A) $ æ— é™é›†åˆ æ¯ä¸ªæ— é™é›†åˆéƒ½æœ‰ä¸€ä¸ªå¯æ•°æ— é™å­é›† æ¯ä¸ªæ— é™é›†åˆéƒ½å’Œå®ƒçš„æŸä¸ªçœŸå­é›†é›†åˆç­‰åŠ¿ ä½œä¸šé¢˜ç›®4.7.è®¾$A=\\{1,2,3,4\\},$åœ¨$\\mathscr{P} (A)$ä¸Šå®šä¹‰å…³ç³»â€œ$\\sim$â€ã€‚ä»»ç»™$S,T\\in \\mathscr{P}(A)$, S\\sim T,å½“ä¸”ä»…å½“\\quad |S|=|T|è¯æ˜ï¼šâ€œ$\\sim$â€æ˜¯$\\mathscr{P}(A)$ä¸Šçš„ç­‰ä»·å…³ç³»ï¼Œå¹¶å†™å‡ºå®ƒçš„å•†é›†$\\mathscr{P}(A)/\\sim$ã€‚ è‡ªåæ€§ï¼š$\\forall S\\in \\mathscr P(A),|S|=|S|\\Rightarrow S\\sim S$ å¯¹ç§°æ€§ï¼š$\\forall S,T\\in \\mathscr P(A),S\\sim T\\Rightarrow |S|=|T|\\Rightarrow |T|=|S|\\Rightarrow T\\sim S$ ä¼ é€’æ€§ï¼š$\\forall S,T,V\\in \\mathscr P(A),S\\sim T,T\\sim V$ å•†é›†ï¼š$\\{\\{\\empty\\},\\\\\\{\\{1\\},\\{2\\},\\{3\\},\\{4\\}\\},\\\\\\{\\{1,2\\},\\{1,3\\},\\{1,4\\},\\{2,3\\},\\{2,4\\},\\{3,4\\}\\},\\\\\\{\\{1,2,3\\},\\{1,2,4\\},\\{1,3,4\\},\\{2,3,4\\}\\},\\\\\\{\\{1,2,3,4\\}\\}\\}$ 4.16.$A=\\{a_1,a_2,â€¦,a_n,â€¦\\}$æ˜¯ä»»æ„é›†åˆã€‚åœ¨ååºé›†$&lt;\\mathscr{P}(A),\\subseteq&gt;$ä¸­å–å­é›†åºåˆ—$\\{a_1\\},\\{a_1,a_2\\},\\{a_1,a_2,a_3\\},â€¦,\\{a_1,a_2,â€¦,a_n,\\},â€¦$,å®ƒä»¬çš„å¹¶é›†æ˜¯å¦æ˜¯$\\mathscr{P}(A)$çš„ä¸€ä¸ªæå¤§å…ƒï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ è‹¥Aä¸ºæœ‰é™é›†åˆï¼Œæ˜¾ç„¶å­é›†åºåˆ—çš„å¹¶é›†ä¸ºæå¤§å…ƒï¼ˆåè¯æ³•ï¼‰ è‹¥Aæ˜¯å¯æ•°æ— é™é›†åˆï¼Œåˆ™å¹¶é›†På¯èƒ½æ˜¯æå¤§å…ƒï¼Œä¹Ÿå¯èƒ½ä¸æ˜¯æå¤§å…ƒã€‚ä¸¾ä¾‹ï¼šè®¾Aä¸ºè‡ªç„¶æ•°é›†åˆ æ˜¯æå¤§å…ƒï¼š $a_i=i-1,\\{a_1,a_2,â€¦a_n,â€¦\\}=\\{0,1,â€¦.n,..\\}=A$ ä¸æ˜¯æå¤§å…ƒï¼š$a_i=i,\\{a_1,a_2,â€¦a_n,â€¦\\}=\\{1,2,â€¦n,â€¦\\}\\subset A$ è‹¥Aæ˜¯ä¸å¯æ•°é›†åˆï¼Œåˆ™ä¸€å®šä¸æ˜¯æå¤§å…ƒï¼Œå¦åˆ™å¹¶é›†$P=A,{a_1,a_2,â€¦a_n,â€¦}$åˆ—ä¸¾å‡ºäº†Açš„æ‰€æœ‰å…ƒç´ ï¼Œä¸Aæ˜¯ä¸å¯æ•°é›†åˆçŸ›ç›¾ã€‚","categories":[{"name":"ä»£æ•°ç»“æ„","slug":"ä»£æ•°ç»“æ„","permalink":"http://sn1987a-1.github.io/categories/%E4%BB%A3%E6%95%B0%E7%BB%93%E6%9E%84/"}],"tags":[{"name":"ä¸“ä¸šè¯¾","slug":"ä¸“ä¸šè¯¾","permalink":"http://sn1987a-1.github.io/tags/%E4%B8%93%E4%B8%9A%E8%AF%BE/"}]},{"title":"åŠ å¯†ç®—æ³•","slug":"åŒºå—é“¾åŠ å¯†ç®—æ³•","date":"2023-04-28T12:48:34.000Z","updated":"2023-09-24T03:52:09.035Z","comments":true,"path":"posts/79dcde63.html","link":"","permalink":"http://sn1987a-1.github.io/posts/79dcde63.html","excerpt":"","text":"å®éªŒç›®çš„ ç†è§£éå¯¹ç§°åŠ å¯†ç®—æ³• ç†è§£æ¤­åœ†æ›²çº¿ç®—æ³•ECC å®ç°æ¯”ç‰¹å¸ä¸Šçš„æ¤­åœ†æ›²çº¿secp256k1ç®—æ³• ECCç®—æ³•æµç¨‹ECCç®—æ³•ä¸­ï¼Œé™·é—¨å‡½æ•°æ˜¯å®šä¹‰åœ¨æœ‰é™åŸŸä¸Šçš„äºŒå…ƒä¸‰æ¬¡æ›²çº¿y^2^=x^3^+ax+bä¸Šçš„ç‚¹æ‰€ç»„æˆçš„é˜¿è´å°”ç¾¤ã€‚ å…¬é’¥ï¼šç‚¹Q ç§é’¥ï¼šå¤§æ•°k ECCç®—æ³•æ˜¯æœ‰é™åŸŸFpæ»¡è¶³å…¬å¼ï¼šQ=kPã€‚ ç­¾åè¿‡ç¨‹ï¼š å–ä¸€ä¸ªæ–°çš„éšæœºæ•°kï¼Œä»¤$k*G\\equiv R\\ mod \\ N$ è®¡ç®—Sï¼š uG + vP = R = kG \\\\ uG + veG = kG\\\\ u + ve = k \\\\ z/s + re/s = k\\\\ (z + re)/s = k\\\\ s = (z + re)/k è¿”å›ç­¾åï¼šsignature(s,r) ç­¾åçš„æ•°å­—ä¸ºï¼ˆs,rï¼‰ éªŒç­¾è¿‡ç¨‹ï¼š è®¡ç®—uï¼Œv è®¡ç®—uG+vP åˆ¤æ–­(uG+vp).xæ˜¯å¦å’Œræ¨¡NåŒä½™ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™ç­¾åæˆåŠŸ å®éªŒå†…å®¹ECCç­¾åfunc (ecc *MyECC) Sign(msg []byte, secKey *big.Int) (*Signature, error) { k,err :=newRand() if(err!=nil){ return nil,err } R := Multi(G,k) r:=R.X r=r.Mod(r,N) z:=crypto.Keccak256(msg) z_i := new(big.Int).SetBytes(z) s:=new(big.Int).Mul(new(big.Int).Add(z_i,new(big.Int).Mul(r,secKey)),Inv(k,N)) s=s.Mod(s,N) sig:=&amp;Signature{s,r} return sig,nil } ECCéªŒç­¾func (ecc *MyECC) VerifySignature(msg []byte, signature *Signature, pubkey *Point) bool { s:=signature.s r:=signature.r z:=crypto.Keccak256(msg) z_i := new(big.Int).SetBytes(z) s_inv:=Inv(s,N) s_inv=s_inv.Mod(s_inv,N) u:=new(big.Int).Mul(z_i,s_inv) u=u.Mod(u,N) v:=new(big.Int).Mul(r,s_inv) v=v.Mod(v,N) ans:=Add(Multi(G,u),Multi(pubkey,v)).X ans=ans.Mod(ans,N) return ans.Cmp(r)==0 }","categories":[{"name":"åŒºå—é“¾","slug":"åŒºå—é“¾","permalink":"http://sn1987a-1.github.io/categories/%E5%8C%BA%E5%9D%97%E9%93%BE/"}],"tags":[{"name":"ä¸“ä¸šè¯¾","slug":"ä¸“ä¸šè¯¾","permalink":"http://sn1987a-1.github.io/tags/%E4%B8%93%E4%B8%9A%E8%AF%BE/"}]},{"title":"MLç®—æ³•ï¼šç‰¹å¾æŠ½å–","slug":"MLç»¼åˆå®éªŒ","date":"2023-01-10T12:48:34.000Z","updated":"2023-09-24T03:49:02.486Z","comments":true,"path":"posts/72ae2b6b.html","link":"","permalink":"http://sn1987a-1.github.io/posts/72ae2b6b.html","excerpt":"","text":"ç‰¹å¾æŠ½å–å®éªŒç›®çš„æœ¬æ¬¡å®éªŒçš„å®éªŒç›®çš„æ˜¯å¯¹ä¸€æ•°æ®é›†è¿›è¡Œåˆ†ç±»ï¼Œå› ä¸ºæ•°æ®é›†ä¸­å­˜åœ¨ç€å™ªå£°æ•°æ®ï¼Œéœ€è¦å¯¹æ•°æ®è¿›è¡Œç‰¹å¾æŠ½å–ï¼Œå¹¶ä½¿ç”¨çº¿æ€§å›å½’ï¼Œå†³ç­–æ ‘ï¼Œç¥ç»ç½‘ç»œï¼ŒSVMä»¥åŠXGBooståˆ†åˆ«å®ç°å¯¹æ¨¡å‹çš„é¢„æµ‹å¹¶è¿›è¡Œè¯„ä¼°ã€‚ å®éªŒåŸç†ç‰¹å¾æŠ½å–å’Œç‰¹å¾é€‰æ‹©å¯¹å®éªŒçš„è®­ç»ƒæ•°æ®é›†è¿›è¡Œè§‚å¯Ÿå¯å¾—ï¼šå¯¹äºæ¯ä¸€æ¡æ ·æœ¬ï¼Œæœ‰ä¸ä¹‹ç›¸å…³çš„120ä¸ªfeatureï¼ˆä¸ªåˆ«featureå¯èƒ½æ˜¯naï¼‰ï¼Œä½†æ˜¯å¯¹äºè®­ç»ƒæœ‰æ•ˆçš„ç‰¹å¾ä¸è¶³20ä¸ªï¼Œå¦‚æœå¯¹åŸæ•°æ®é›†è¿›è¡Œè®­ç»ƒï¼Œå¯èƒ½ä¼šå¯¼è‡´è¿‡æ‹Ÿåˆï¼Œè®­ç»ƒè¿‡æ…¢ï¼Œæ•ˆæœè¾ƒå·®ç­‰ç»“æœï¼Œå› æ­¤è¦å¯¹æ•°æ®è¿›è¡Œç‰¹å¾æŠ½å–ï¼Œé€‰å–å¯¹è®­ç»ƒæœ‰ç›Šçš„ç‰¹å¾ æœ¬æ¬¡å®éªŒä¸­ï¼Œç‰¹å¾æŠ½å–ä½¿ç”¨äº†å¦‚ä¸‹ä¸¤ç§æ–¹æ³•ï¼š åŸºäºå†³ç­–æ ‘æŠ½å–æœ¬éƒ¨åˆ†å€ŸåŠ©sklearnä¸­çš„DecisionTreeClassifierè¿›è¡Œå¤„ç†ï¼Œå› ä¸ºæ¯ä¸ªç‰¹å¾å…·æœ‰å¯¹åº”çš„æƒé‡ï¼Œå¯¹äºåˆ†ç±»ç»“æœå¸®åŠ©è¾ƒå¤§çš„featureçš„æƒé‡å¤§ï¼Œä¸ºäº†ç­›é€‰å‡ºæœ‰ç”¨çš„ä¿¡æ¯ï¼Œå¯ä»¥é€‰æ‹©å†³ç­–æ ‘ä¸­æƒé‡å¤§çš„ç‚¹ï¼Œå¤„ç†æ€è·¯ä¸ºï¼š å°†æ•°æ®é›†åˆ’åˆ†ä¸ºè®­ç»ƒé›†å’Œæµ‹è¯•é›†ï¼Œå¾—åˆ°è®­ç»ƒé›†å¯¹åº”çš„å†³ç­–æ ‘ï¼Œåœ¨æµ‹è¯•é›†ä¸Šæµ‹è¯•å‡†ç¡®ç‡ å¦‚æœæµ‹è¯•é›†ä¸Šçš„å‡†ç¡®ç‡å¤§äº25.5%ï¼ˆè¡¨æ˜æ­¤æ¬¡è®­ç»ƒçš„ç»“æœè¾ƒä¸ºæœ‰æ•ˆï¼‰ï¼Œè®°å½•ä¸‹æ­¤æ—¶æ‰€æœ‰featureå¯¹åº”çš„æƒé‡ é‡å¤ä¸Šè¿°è¿‡ç¨‹ï¼Œç›´åˆ°æ”¶é›†åˆ°çš„æƒé‡æ•°å¤§äº100ï¼Œå°†å„ä¸ªfeatureå¾—åˆ°çš„æƒé‡ç›¸åŠ ï¼Œå¾—åˆ°æ–°çš„æƒé‡ æ ¹æ®æ–°çš„æƒé‡ï¼Œä¿ç•™æœ€å¤§çš„äºŒåä¸ªfeatureç”¨äºè®­ç»ƒ ç±»ä¼¼çš„ï¼Œä¸ä»…ä»…æ˜¯åŸºäºå†³ç­–æ ‘ï¼ŒåŸºäºXGBoostï¼ŒSVMç­‰é€šè¿‡å¤šæ¬¡æ„å»ºæ¨¡å‹æ‰¾åˆ°æƒé‡æœ€å¤§çš„ç‰¹å¾ RFEæ–¹æ³•ä¸ä¸Šä¸€ç§æŠ½å–æ–¹æ³•ç±»ä¼¼ï¼ŒRFEä¹Ÿæ˜¯å€ŸåŠ©åå¤æ„å»ºæ¨¡å‹å¯»æ‰¾è¾ƒå¥½çš„ç‰¹å¾ï¼Œä¸åŒçš„æ˜¯RFEå€ŸåŠ©é€’å½’çš„æ€è·¯ï¼Œä¾æ¬¡æ‰¾å‡ºç‰¹å¾ä¸­æœ€å¥½çš„ç‰¹å¾å¹¶å†ä¸‹ä¸€è½®è®­ç»ƒä¸­æ’é™¤å½“å‰ç‰¹å¾ï¼Œåœ¨å‰©ä½™çš„ç‰¹å¾ä¸Šé‡å¤è®­ç»ƒï¼Œç›´åˆ°æ‰¾å‡º20ä¸ªæœ€å¥½çš„ç‰¹å¾ã€‚ RFEä¹Ÿå¯ä»¥é‡‡å–çº¿æ€§å›å½’ï¼ŒSVMç­‰æ¨¡å‹ä½œä¸ºåº•å±‚æ¨¡å‹å®ç°ç‰¹å¾é€‰æ‹©ï¼Œæœ¬æ¬¡å®éªŒä¸­RFEå€ŸåŠ©sklearnåº“ä¸­çš„RFEå‡½æ•°ä»¥åŠçº¿æ€§å›å½’å‡½æ•°ä½œä¸ºæ•°æ®æŠ½å–çš„æ–¹æ³• Relief-Fæ–¹æ³•Reliefç®—æ³•æ˜¯ç”¨äºä¸¤ç±»æ•°æ®çš„åˆ†ç±»é—®é¢˜çš„ç‰¹å¾æƒé‡è®¡ç®—æ–¹æ³•ï¼Œè€ŒRelief-Fä½œä¸ºReliefç®—æ³•æ‹“å±•ï¼Œå¯ä»¥å®ç°å¤šåˆ†ç±»é—®é¢˜çš„ç‰¹å¾æƒé‡è®¡ç®—ï¼Œç®—æ³•çš„ä¸»è¦æ­¥éª¤ä¸ºï¼š å°†æ‰€æœ‰æ ·æœ¬æŒ‰ç±»åˆ«åˆ†ç±»ï¼Œå¯¹äºæ¯ç±»æ ·æœ¬ï¼Œåˆ†åˆ«æŠ½å–ä¸€ä¸ªæ ·æœ¬è®°ä½œx å¯¹äºæ¯ä¸€ä¸ªxï¼Œåœ¨è¯¥ç±»ä¸­æ‰¾åˆ°xçš„kä¸ªæœ€è¿‘é‚»ï¼Œåœ¨ä¸åŒ…å«è¯¥ç±»åˆ«çš„è®­ç»ƒé›†ä¸­ä¹Ÿæ‰¾å‡ºkä¸ªæœ€è¿‘é‚» æ ¹æ®è¿‘é‚»åŠæ‰€å±çš„ç±»åˆ«è®¡ç®—ç‰¹å¾çš„æƒé‡ å¯¹ç‰¹å¾çš„æƒé‡è¿›è¡Œæ´¾åˆ«ï¼Œå¾—åˆ°åˆé€‚çš„ç‰¹å¾ å¤šåˆ†ç±»ä»»åŠ¡åœ¨å‰é¢çš„å®éªŒä¸­ï¼Œå·²ç»å®Œæˆäº†å¯¹äºŒåˆ†ç±»ä»»åŠ¡çš„é€»è¾‘å›å½’ã€SVMæ¨¡å‹ï¼Œä¸ºäº†é€‚åº”æœ¬å®éªŒçš„ä»»åŠ¡ï¼Œè¦å°†å…¶è¿›è¡Œé€‚å½“ä¿®æ”¹ï¼Œä»¥ä¾¿å®ç°å¤šåˆ†ç±»ä»»åŠ¡ã€‚ å¤šåˆ†ç±»å­¦ä¹ å¯ä»¥æœ‰äºŒåˆ†ç±»å­¦ä¹ å™¨é›†æˆè€Œæ¥ï¼Œæœ‰ä¸‰ç§æ–¹æ³•ï¼š ä¸€å¯¹ä¸€ ä¸€å¯¹å…¶ä½™ å¤šå¯¹å¤š å…¶ä¸­ï¼Œæœ¬å®éªŒé‡‡ç”¨äº†å¤šå¯¹å¤šçš„æ–¹å¼è¿›è¡Œè®­ç»ƒï¼Œç”±äºæœ¬å®éªŒåˆ†ç±»ä¸ºå››ç±»ï¼Œå¯ä»¥å°†å¤šå¯¹å¤šçš„åˆ†ç±»å­¦ä¹ ç®€åŒ–è®¾è®¡å¦‚ä¸‹ï¼š è®¾è®¡ä¸åŒçš„äºŒåˆ†ç±»å™¨ï¼Œæ¯ä¸ªäºŒåˆ†ç±»å™¨å°†ä¸¤ä¸ªç±»åˆ«è§†ä½œæ­£ç±»ï¼Œå¦å¤–ä¸¤ä¸ªç±»åˆ«è§†ä¸ºè´Ÿç±»ï¼Œå› æ­¤å…±éœ€è¦å…­ä¸ªäºŒåˆ†ç±»å­¦ä¹ å™¨ å¯¹äºæ¯ä¸ªåˆ†ç±»å™¨ï¼Œå› ä¸ºå…¶å¯¹ç§°æ€§ï¼Œæ­£ç±»å’Œè´Ÿç±»çš„æƒé‡å¯ä»¥è§†ä¸ºä¸€è‡´çš„ï¼Œåœ¨é¢„æµ‹æ—¶ï¼Œå¯¹äºä¸€ä¸ªæ ·æœ¬ç»Ÿè®¡ï¼Œå°†æŸä¸€ç±»åˆ«è§†ä¸ºæ­£ç±»çš„æ¦‚ç‡ï¼Œå¾—åˆ°çš„æœ€å¤§çš„æ¦‚ç‡å¯¹åº”çš„ç±»åˆ«è§†ä½œè¯¥æ ·æœ¬çš„é¢„æµ‹å€¼ å®éªŒæ­¥éª¤æ•°æ®é¢„å¤„ç† ä»æ•°æ®é›†ä¸­è¯»å–æ•°æ® å°†ç©ºæ•°æ®å¡«å……ä¸ºè¯¥ç‰¹å¾ä¸­å…¶ä»–ä¸ä¸ºç©ºçš„æ•°æ®çš„ä¸­ä½æ•° for column in list(feature.columns[feature.isnull().sum() &gt; 0]): val = feature[column].median() feature[column].fillna(val, inplace=True) æ­£åˆ™åŒ–æ•°æ® å°†æ•°æ®é›†éšæœºåˆ†ä¸ºè®­ç»ƒé›†å’Œæµ‹è¯•é›†ï¼ˆ7ï¼š3ï¼‰ ç‰¹å¾æŠ½å– åŸºäºå†³ç­–æ ‘åˆ’åˆ†ï¼Œå¾—åˆ°æƒé‡æœ€å¤§çš„ç‰¹å¾å¯¹åº”çš„åºå· while 1: ...é‡æ–°åˆ’åˆ†è®­ç»ƒé›†å’Œæµ‹è¯•é›† dtree=tree.DecisionTreeClassifier(splitter=\"random\",min_samples_leaf=3) dtree=dtree.fit(train_data,train_label) test_res=dtree.predict(test_data) sum=0 for i in range(test_label.size): if(test_label[i]==test_res[i]): sum+=1 if sum/test_label.size&gt;0.255: weight+=dtree.feature_importances_ t+=1 if t&gt;100: break max_indexs = heapq.nlargest(20, range(len(weight)), weight.take) å€ŸåŠ©RFEåˆ’åˆ† from sklearn.feature_selection import RFE from sklearn.linear_model import LinearRegression as LR linear_model=LR() s= RFE(linear_model, n_features_to_select=20, step=1).fit(Data, Label) Data = s.transform(Data) çº¿æ€§å›å½’åœ¨LogisticRegressionä¸­æ·»åŠ ï¼š def multi_fit(self,X,y): yi=np.zeros((6,y.size)) ### set yi theta=[] J=np.zeros(3000) for i in range(0,6): t,j,temp=self.fit(X,yi[i]) theta.append(t) J+=j return theta,J def multi_pred(self,X,multi_theta): m=X.shape[0] pre=[] X=np.hstack((np.ones((m,1)),X)) for i in range(0,6): theta=multi_theta[i] p=np.dot(X,theta) p=p.reshape(-1,1) pre.append(p) return pre è¿›è¡Œè®­ç»ƒã€é¢„æµ‹ã€ç»˜åˆ¶å›¾åƒ lr=LogisticRegression() theta,loss=lr.multi_fit(train_data,train_label) preds=lr.multi_pred(test_data,theta) test_r=[preds[0]+preds[1]+preds[2],preds[0]+preds[3]+preds[4],preds[1]+preds[3]+preds[5],preds[2]+preds[4]+preds[5]] x = np.arange(1,len(loss)+1) plt.plot(x,loss) plt.xlabel(u\"times\") plt.ylabel(u\"loss-value\") plt.show() sum=0 for i in range(test_label.size): for j in range(0,4): if test_label[i]==j: if test_r[j][i]&gt;=test_r[0][i] and test_r[j][i]&gt;=test_r[1][i] and test_r[j][i]&gt;=test_r[2][i] and test_r[j][i]&gt;=test_r[2][i]: sum+=1 sum/test_label.size å†³ç­–æ ‘è°ƒç”¨sklearn.treeä¸­çš„DecisionTreeClassifierå®ç°ï¼š from sklearn import tree dtree=tree.DecisionTreeClassifier() dtree=dtree.fit(train_data,train_label) test_res=dtree.predict(test_data) ç¥ç»ç½‘ç»œè°ƒç”¨sklearnä¸­çš„neural_networkå®ç°ï¼š from sklearn import neural_network as NN nn=NN.MLPClassifier() nn=nn.fit(train_data,train_label) test_res=nn.predict(test_data) SVMå¤„ç†æ–¹å¼ä¸çº¿æ€§å›å½’çš„æ¨¡å‹ç›¸ä¼¼ XGBoostè°ƒç”¨xgboost.sklearnåº“å®ç°XGBoost xgb=XGB() xgb=xgb.fit(train_data,train_label) test_res=xgb.predict(test_data) å®éªŒç»“æœç‰¹å¾æŠ½å– åŸºäºå†³ç­–æ ‘è¿›è¡Œç‰¹å¾é€‰æ‹© æ‰€æœ‰èŠ‚ç‚¹çš„æƒé‡æ•°æ®:æ ¹æ®è§‚å¯Ÿä¸éš¾çœ‹å‡ºï¼Œä¸åŒç‰¹å¾çš„æƒé‡åˆ†å¸ƒå­˜åœ¨å·®è·ï¼Œå¤§éƒ¨åˆ†åˆ†å¸ƒåœ¨0.8-1.0ä¹‹é—´ RFEç‰¹å¾æŠ½å– å¯¹RFEåˆ†åˆ«å€ŸåŠ©çº¿æ€§å›å½’ï¼ŒSVMå’Œéšæœºæ£®æ—çš„åº•å±‚æ¨¡å‹è®­ç»ƒï¼Œå‘ç°çº¿æ€§å›å½’è®­ç»ƒæ—¶é—´è¾ƒçŸ­ï¼Œå¦å¤–ä¸¤ä¸ªæ¨¡å‹éœ€è¦è¾ƒé•¿æ—¶é—´çš„è®­ç»ƒï¼Œä¸”è¿™å‡ ç±»æ¨¡å‹å¯¹è®­ç»ƒç»“æœçš„é¢„æµ‹æ•ˆæœæ²¡æœ‰æ˜æ˜¾çš„å½±å“ï¼Œæ•…é€‰å–çº¿æ€§å›å½’æ¨¡å‹è¿›è¡ŒRFEå¤„ç†ã€‚ å¯¹ç‰¹å¾çš„é‡è¦æ€§è¿›è¡Œæ’åï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼šç­›é€‰å»å‰20ä¸ªç‰¹å¾ï¼Œè¿›è¡Œåç»­è®­ç»ƒå’Œæ¨¡å‹é¢„æµ‹ æ¨¡å‹è®­ç»ƒç»“æœäº”ä¸ªæ¨¡å‹æœ€ä½³å‚æ•°çš„è®­ç»ƒç»“æœï¼š æ¨¡å‹ è®­ç»ƒæ—¶é—´ å‡†ç¡®ç‡ LogisticRegression 15s 27.4% DecisionTree 0.4s 27.0% NeuralNetwork 2.3s 26.9% SVM 33s 26.3% XGBoost 4.5s 25.8% æ€»ä½“æ¥è¯´ï¼Œçº¿æ€§å›å½’çš„è®­ç»ƒæ•ˆæœè¾ƒå¥½ï¼Œä½†å‡ ç§æ¨¡å‹å‡åœ¨è¾ƒä½å‡†ç¡®ç‡çš„è¾ƒå°èŒƒå›´å†…æ³¢åŠ¨ï¼Œå¹¶æ²¡æœ‰å®ç°è¾ƒå¥½çš„ç»“æœã€‚ å¯¹äºä¸åŒçš„ç‰¹å¾é€‰æ‹©æ¨¡å‹ï¼Œç”šè‡³ä¸è¿›è¡Œç‰¹å¾é€‰æ‹©ï¼Œè®­ç»ƒå‡†ç¡®ç‡çš„å·®è·è¾ƒå°ï¼Œåœ¨åç»­è°ƒå‚è¿‡ç¨‹ä¸­ä¸åšåŒºåˆ†ã€‚ç”±äºDecisionTreeå’ŒNeuralNetworkæ¨¡å‹çš„è®­ç»ƒæ•ˆæœè¾ƒå¥½å¹¶ä¸”è®­ç»ƒæ—¶é—´çŸ­ï¼Œæœ¬æ¬¡å®éªŒå°†é‡ç‚¹åˆ†æè¯¥ä¸¤ç±»æ¨¡å‹çš„è°ƒå‚æ•ˆæœã€‚ é€»è¾‘å›å½’è¿­ä»£3000æ¬¡ï¼Œå¾—åˆ°çš„æŸå¤±å‡½æ•°å¦‚ä¸‹æ‰€ç¤ºï¼š è¯¥æ¬¡è®­ç»ƒç»“æœå‡†ç¡®ç‡ï¼š26.8% å¯ä»¥çœ‹å‡ºï¼Œæ¨¡å‹è®­ç»ƒçš„æŸå¤±æ˜¯é€æ¸é€’å‡è‡³æ”¶æ•›çš„ï¼Œä½†æ˜¯æŸå¤±çš„ä¸‹é™æœ‰é™ï¼šä»2.88ä¸‹é™åˆ°2.86ï¼Œä»…æœ‰2%çš„æå‡ï¼Œè¯´æ˜é€»è¾‘å›å½’æ— æ³•è¾ƒå¥½çš„å­¦ä¹ åˆ°æ¨¡å‹å“¦é‚£ä¸ªçš„åˆ†å¸ƒç‰¹å¾ã€‚ å†³ç­–æ ‘ä½¿ç”¨GridSearchCVå¯»æ‰¾æœ€ä¼˜å‚æ•°ï¼š param = [{'criterion':['gini','entropy']}, {'criterion':['gini'],'max_depth':[3,5,6],'min_samples_leaf':[2,3,5],'min_impurity_decrease':[0.1,0.2,0.5]}, {'max_depth': [30,60,100], 'min_impurity_decrease':[0.1,0.2,0.5]}] grid = GridSearchCV(tree.DecisionTreeClassifier(),param_grid=param,cv=6) grid.fit(train_data,train_label) å¾—åˆ°çš„æœ€ä¼˜å‚æ•°ï¼š æ­¤æ—¶æœ€ä¼˜ç»“æœï¼š26.8% å¯¹å‚æ•°max_depthå–ä¸åŒå€¼ç»Ÿè®¡å‡†ç¡®ç‡ é‡å¤å‡ æ¬¡å³å¯å‘ç°ï¼Œmax_depthå‚æ•°å¯¹å‡†ç¡®ç‡çš„å½±å“çš„ç»“æœä¸æ˜æ˜¾ï¼Œæ›´å¤šæ˜¯éšæœºçš„å› ç´ ã€‚ï¼ˆsplitter=â€randomâ€ï¼‰ åŒæ ·ï¼Œå¯¹äºå‚æ•°min_sample_leafï¼Œä¹Ÿæœ‰ç±»ä¼¼çš„ç»“æœ ç¥ç»ç½‘ç»œä¸€æ¬¡è®­ç»ƒè¿‡ç¨‹ä¸­çš„æŸå¤±ç‡ï¼š åŒæ ·ï¼Œä½¿ç”¨GridSearchCVå¯»æ‰¾æœ€ä¼˜å‚æ•°ï¼š from sklearn.model_selection import GridSearchCV param = [{'hidden_layer_sizes':[(50,50),(30,30),(100, )],'alpha':[0.1,0.001,0.0001],'learning_rate_init':[0.1,0.005,0.001]}] grid = GridSearchCV(NN.MLPClassifier(),param_grid=param,cv=6) grid.fit(train_data,train_label) æ­¤æ—¶çš„å‡†ç¡®ç‡ä¸º26.4% SVMå®éªŒä¸­ï¼Œè¯¥SVMæ¨¡å‹é‡‡ç”¨æ¢¯åº¦ä¸‹é™æ³•å®ç°ã€‚ æ­¤æ¬¡è®­ç»ƒçš„å‡†ç¡®ç‡ï¼š25.4% ç”±å›¾å¯è§ï¼ŒSVMæ¨¡å‹çš„è®­ç»ƒæ”¶æ•›é€Ÿåº¦è¾ƒå¿«ï¼Œå¤§çº¦10æ¬¡å³å¯æ”¶æ•›ï¼ŒæŸå¤±ç”±8500ä¸‹é™åˆ°äº†3500ï¼Œä½†æ˜¯åœ¨æµ‹è¯•é›†çš„å‡†ç¡®ç‡ä»è¾ƒä½ï¼Œè¯´æ˜SVMå¯èƒ½å¯¹è®­ç»ƒé›†å­˜åœ¨è¿‡æ‹Ÿåˆï¼Œä¹Ÿæ— æ³•è¾ƒå¥½çš„å­¦ä¹ åˆ°æ•°æ®é›†ä¸­çš„æ•°æ®ã€‚ XGBoostå¯¹åº”çš„å‚æ•°å’Œå‡†ç¡®ç‡ï¼š boost gamma max_depth max_delta_step å‡†ç¡®ç‡ gblinear - - 0 25.6% gbtree 0 - 0 25.2% gbtree 0 3 0 25.7% gbtree 0.1 3 0 25.4% gbtree 0.1 3 1 25.8% gbtree 0 3 1 25.4% å¯è§ï¼Œå‡†ç¡®ç‡æœ€é«˜çš„ä¸€ç»„å‚æ•°ä¸ºï¼šboost=â€™gbtreeâ€™,gamma=0.1,max_depth=3,max_delta_step=1 å®éªŒåˆ†æä»å®éªŒç»“æœçš„è§’åº¦åˆ†æï¼Œæœ¬æ¬¡å®éªŒçš„å®éªŒç»“æœè¾ƒä¸ç†æƒ³ï¼Œè®­ç»ƒæ•ˆæœæœ€å¥½çš„ä¸€ç»„æ•°æ®ä¸ºå€ŸåŠ©RFEè¿›è¡Œç‰¹å¾æŠ½å–ï¼Œçº¿æ€§å›å½’å¤šåˆ†ç±»æ¨¡å‹ï¼ˆ3000è½®è¿­ä»£ï¼‰ï¼Œæœ€ç»ˆçš„å‡†ç¡®ç‡ä¸º27.4%ï¼Œå…¶ä»–çš„æ¨¡å‹å‡åœ¨26%ä¸Šä¸‹æµ®åŠ¨ï¼Œå¯¹äºå››åˆ†ç±»é—®é¢˜ï¼Œè¿™æ ·çš„æ•ˆæœæ— ç–‘æ˜¯è¾ƒå·®çš„ï¼Œæ ¹æœ¬åŸå› åœ¨äºæ•°æ®ç‰¹å¾çš„æŠ½å–æ•ˆæœè¾ƒå·®ï¼Œä¾‹å¦‚æœ¬å®éªŒä¸­é‡‡ç”¨äº†ä¸‰ç§ä¸åŒçš„æ¨¡å‹æ¥è¿›è¡Œç‰¹å¾é€‰æ‹©ï¼Œæ¯æ¬¡é€‰å‡ºçš„ç‰¹å¾ä¹‹é—´çš„é‡åˆç‡è¾ƒä½ï¼Œå¹¶æœªæ‰¾åˆ°çœŸæ­£æœ‰æ•ˆçš„ç‰¹å¾ï¼Œå­¦ä¹ å™¨æ— æ³•å­¦åˆ°æ•°æ®çš„åˆ†å¸ƒç‰¹å¾ï¼Œå› æ­¤æ— è®ºæ˜¯åç»­è°ƒå‚è¿˜æ˜¯æ›´æ”¹æ¨¡å‹ï¼Œéƒ½æ— æ³•å¾—åˆ°è¾ƒå¥½çš„ç»“æœã€‚","categories":[{"name":"æœºå™¨å­¦ä¹ ","slug":"æœºå™¨å­¦ä¹ ","permalink":"http://sn1987a-1.github.io/categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/"}],"tags":[{"name":"ä¸“ä¸šè¯¾","slug":"ä¸“ä¸šè¯¾","permalink":"http://sn1987a-1.github.io/tags/%E4%B8%93%E4%B8%9A%E8%AF%BE/"}]},{"title":"ç¼–è¯‘åŸç†-GVN","slug":"ç¼–è¯‘åŸç†4","date":"2022-11-14T12:48:34.000Z","updated":"2023-09-24T05:30:05.756Z","comments":true,"path":"posts/7e7a9082.html","link":"","permalink":"http://sn1987a-1.github.io/posts/7e7a9082.html","excerpt":"","text":"æ€è€ƒé¢˜ è¯·ç®€è¿°æ¦‚å¿µï¼šæ”¯é…æ€§ã€ä¸¥æ ¼æ”¯é…æ€§ã€ç›´æ¥æ”¯é…æ€§ã€æ”¯é…è¾¹ç•Œã€‚ æ”¯é…æ€§ åœ¨å…¥å£èŠ‚ç‚¹ä¸ºb0çš„æµå›¾ä¸­ï¼Œè‹¥biåœ¨ä»b0åˆ°bjçš„æ‰€æœ‰è·¯å¾„ä¸­å‡å‡ºç°ï¼Œåˆ™ç§°b1æ”¯é…bjï¼Œå…¶ä¸­Dom(bj)æ˜¯æ‰€æœ‰æ”¯é…bjçš„èŠ‚ç‚¹çš„é›†åˆ ä¸¥æ ¼æ”¯é…æ€§ å¯¹äºæµå›¾ä¸­ç»™å®šçš„èŠ‚ç‚¹bï¼Œè‹¥èŠ‚ç‚¹$a\\in Dom(b)-b$,åˆ™ç§°aä¸¥æ ¼æ”¯é…bèŠ‚ç‚¹ ç›´æ¥æ”¯é…æ€§ å¯¹äºæµå›¾ä¸­ç»™å®šçš„èŠ‚ç‚¹bï¼Œä¸¥æ ¼æ”¯é…bçš„èŠ‚ç‚¹é›†åˆä¸ºDom(b)-b,åœ¨è¯¥é›†åˆä¸­è·ç¦»bæœ€è¿‘çš„èŠ‚ç‚¹ç›´æ¥æ”¯é…bï¼Œè®°ä¸ºIDom(b) æ”¯é…è¾¹ç•Œ å¯¹äºæµå›¾ä¸­ç»™å®šçš„èŠ‚ç‚¹bï¼Œè‹¥èŠ‚ç‚¹aæ»¡è¶³:(1)bæ”¯é…aä¸€ä¸ªå‰é©±q($q\\in preds(a),b\\in Dom(q)$)(2)bä¸ä¸¥æ ¼æ”¯é…aï¼Œå°†å…·æœ‰è¿™ç§æ€§è´¨çš„açš„é›†åˆè®°ä¸ºbçš„æ”¯é…è¾¹ç•ŒDF(b) phièŠ‚ç‚¹æ˜¯SSAçš„å…³é”®ç‰¹å¾ï¼Œè¯·ç®€è¿°phièŠ‚ç‚¹çš„æ¦‚å¿µï¼Œä»¥åŠå¼•å…¥phièŠ‚ç‚¹çš„ç†ç”±ã€‚ phièŠ‚ç‚¹:å‡ºç°åœ¨ç¨‹åºåŸºæœ¬å—æ±‡åˆèŠ‚ç‚¹çš„å¯¹æŸä¸€å˜é‡xè¿›è¡Œä¸€æ¬¡æ–°çš„å®šä¹‰ï¼Œä½œä¸ºç¨‹åºçš„ä¸€æ¡æŒ‡ä»¤ï¼Œå®Œæˆäº†å°†æ¥è‡ªä¸åŒè¾¹çš„xçš„å€¼è¿›è¡Œåˆå¹¶çš„å·¥ä½œ å¼•å…¥ç†ç”±:ä¸ºäº†æ»¡è¶³SSAçš„é™æ€å•èµ‹å€¼å½¢å¼ï¼Œæ²¿ç€æµå›¾çš„ä¸åŒè·¯å¾„ï¼Œxçš„å½“å‰å€¼å¯èƒ½è¢«åˆ†é…äº†ä¸€ä¸ªå”¯ä¸€çš„åå­—ï¼Œåœ¨å¤šæ¡è·¯å¾„çš„æ±‡åˆå¤„ï¼Œä¸åŒçš„é™æ€å•èµ‹å€¼å½¢å¼åå¿…é¡»è°ƒæ•´ä¸ºä¸€ä¸ªåå­—ï¼ŒphièŠ‚ç‚¹çš„ä½œç”¨å°±æ˜¯åœ¨è·¯å¾„æ±‡åˆç‚¹å°†åŒä¸€å˜é‡çš„å¤šä¸ªå½¢å¼ååˆå¹¶ä¸ºä¸€ä¸ªåå­—ã€‚ è§‚å¯Ÿä¸‹é¢ç»™å‡ºçš„cminusç¨‹åºå¯¹åº”çš„ LLVM IRï¼Œä¸å¼€å¯Mem2Regç”Ÿæˆçš„LLVM IRå¯¹æ¯”ï¼Œæ¯æ¡load, storeæŒ‡ä»¤å‘ç”Ÿäº†å˜åŒ–å—ï¼Ÿå˜åŒ–æˆ–è€…æ²¡å˜åŒ–çš„åŸå› æ˜¯ä»€ä¹ˆï¼Ÿè¯·åˆ†ç±»è§£é‡Šã€‚ int globVar; int func(int x){ if(x &gt; 0){ x = 0; } return x; } int main(void){ int arr[10]; int b; globVar = 1; arr[5] = 999; b = 2333; func(b); func(globVar); return 0; } before Mem2Regï¼š @globVar = global i32 zeroinitializer declare void @neg_idx_except() define i32 @func(i32 %arg0) { label_entry: %op1 = alloca i32 store i32 %arg0, i32* %op1 %op2 = load i32, i32* %op1 %op3 = icmp sgt i32 %op2, 0 %op4 = zext i1 %op3 to i32 %op5 = icmp ne i32 %op4, 0 br i1 %op5, label %label6, label %label7 label6: ; preds = %label_entry store i32 0, i32* %op1 br label %label7 label7: ; preds = %label_entry, %label6 %op8 = load i32, i32* %op1 ret i32 %op8 } define i32 @main() { label_entry: %op0 = alloca [10 x i32] %op1 = alloca i32 store i32 1, i32* @globVar %op2 = icmp slt i32 5, 0 br i1 %op2, label %label3, label %label4 label3: ; preds = %label_entry call void @neg_idx_except() ret i32 0 label4: ; preds = %label_entry %op5 = getelementptr [10 x i32], [10 x i32]* %op0, i32 0, i32 5 store i32 999, i32* %op5 store i32 2333, i32* %op1 %op6 = load i32, i32* %op1 %op7 = call i32 @func(i32 %op6) %op8 = load i32, i32* @globVar %op9 = call i32 @func(i32 %op8) ret i32 0 } After Mem2Regï¼š @globVar = global i32 zeroinitializer declare void @neg_idx_except() define i32 @func(i32 %arg0) { label_entry: %op3 = icmp sgt i32 %arg0, 0 %op4 = zext i1 %op3 to i32 %op5 = icmp ne i32 %op4, 0 br i1 %op5, label %label6, label %label7 label6: ; preds = %label_entry br label %label7 label7: ; preds = %label_entry, %label6 %op9 = phi i32 [ %arg0, %label_entry ], [ 0, %label6 ] ret i32 %op9 } define i32 @main() { label_entry: %op0 = alloca [10 x i32] store i32 1, i32* @globVar %op2 = icmp slt i32 5, 0 br i1 %op2, label %label3, label %label4 label3: ; preds = %label_entry call void @neg_idx_except() ret i32 0 label4: ; preds = %label_entry %op5 = getelementptr [10 x i32], [10 x i32]* %op0, i32 0, i32 5 store i32 999, i32* %op5 %op7 = call i32 @func(i32 2333) %op8 = load i32, i32* @globVar %op9 = call i32 @func(i32 %op8) ret i32 0 } åˆ é™¤çš„load/store: ç¬¬6ï¼Œ7è¡Œï¼šç¨‹åºä¸­å¯¹å˜é‡xè¿›è¡Œäº†å¤šæ¬¡èµ‹å€¼ï¼Œåœ¨æœªå¼€å¯Mem2Regçš„IRä¸­æ˜¯é€šè¿‡å†—ä½™çš„è®¿å­˜å®ç°çš„ï¼Œåœ¨loadè¯­å¥å‰çš„ç¨‹åºå—ä¸­å·²å­˜åœ¨xå¯¹åº”çš„å€¼ï¼Œåœ¨åˆ å»è¯¥æ¡loadåï¼Œå˜é‡xä¸ä¼šè¢«å…¶ä»–è¯­å¥loadï¼Œstoreè¯­å¥ä¹Ÿè¢«åˆ é™¤ï¼Œloadå’Œstoreæ˜¯ä¸å¿…è¦çš„ã€‚ ç¬¬13è¡Œï¼šæ­¤å¤„å¯¹xçš„å€¼è¿›è¡Œäº†å­˜å‚¨ï¼Œä½†æ˜¯åœ¨è¯¥è¯­å¥ä¹‹åxå¹¶ä¸æ˜¯æ´»è·ƒå˜é‡ï¼Œxçš„å€¼ä¸ä¼šè¢«è°ƒç”¨ï¼Œå› æ­¤è¯¥å¤„çš„storeæ˜¯å¤šä½™çš„ã€‚ ç¬¬32ï¼Œ33è¡Œï¼šç¨‹åºä¸­å¯¹å˜é‡bè¿›è¡Œäº†èµ‹å€¼ï¼Œåˆå°†bä½œä¸ºå‡½æ•°å‚æ•°è¿›è¡Œå‡½æ•°è°ƒç”¨ï¼Œå‡½æ•°è°ƒç”¨æ—¶æ‰€ç”¨çš„å€¼å®é™…ä¸Šå°±æ˜¯ç«‹å³æ•°ï¼Œæ˜¯åœ¨è¯¥ç¨‹åºå—ä¸­å·²å­˜åœ¨å¯¹åº”çš„å€¼ï¼Œå› æ­¤å¯ä»¥ä¸ç”¨loadï¼Œä¹Ÿæ— éœ€storeæŒ‡ä»¤ï¼Œæ­¤å¤„å¯ä»¥åˆ é™¤loadå’ŒstoreæŒ‡ä»¤ã€‚ æœªå˜åŒ–çš„load/store: ç¬¬23è¡Œï¼šæ­¤å¤„storeå¯¹å…¨å±€å˜é‡globVarè¿›è¡Œèµ‹å€¼ï¼Œå› ä¸ºæ˜¯ç”¨ç«‹å³æ•°æ›´æ–°æ•°æ®çš„å€¼ï¼Œç”±äºMem2Regä¸ä¼šå¯¹è¯¥å…¨å±€å˜é‡è¿›è¡Œå¤„ç†ï¼Œéœ€è¦åœ¨æ­¤å¤„å­˜å‚¨å˜é‡çš„å€¼ï¼Œä¸å­˜åœ¨å†—ä½™ã€‚ ç¬¬31è¡Œï¼šæ­¤å¤„storeå¯¹æ•°ç»„aä¸­çš„å…ƒç´ åˆ©ç”¨ç«‹å³æ•°è¿›è¡Œèµ‹å€¼ï¼Œç”±äºMem2Regä¸ä¼šå¯¹æ•°ç»„å‹å…ƒç´ è¿›è¡Œå¤„ç†ï¼Œéœ€è¦åœ¨æ­¤å¤„å­˜å‚¨å˜é‡çš„å€¼ï¼Œä¸å­˜åœ¨å†—ä½™ã€‚ ç¬¬35è¡Œï¼šæ­¤å¤„loadå°†å…¨å±€å˜é‡globVarçš„å€¼èµ‹ç»™ä¸´æ—¶å˜é‡ï¼Œç”¨äºåç»­å‡½æ•°è°ƒç”¨ä½œä¸ºå‡½æ•°çš„å‚æ•°ï¼Œä¸”æ­¤å‰globVarå¯¹åº”çš„å€¼åœ¨è¯¥å—ä¸­ä¸å­˜åœ¨ï¼Œä¸å­˜åœ¨å†—ä½™ï¼Œä¸éœ€è¦åˆ é™¤ã€‚ æŒ‡å‡ºæ”¾ç½®phièŠ‚ç‚¹çš„ä»£ç ï¼Œå¹¶è§£é‡Šæ˜¯å¦‚ä½•ä½¿ç”¨æ”¯é…æ ‘çš„ä¿¡æ¯çš„ã€‚ï¼ˆéœ€è¦ç»™å‡ºä»£ç ä¸­çš„æˆå‘˜å˜é‡æˆ–æˆå‘˜å‡½æ•°åç§°ï¼‰ æ”¾ç½®ä¼ªä»£ç çš„å‡½æ•°ä¸ºsrc\\optimization\\Mem2Reg.cppä¸­çš„Mem2Reg::generate_phiå‡½æ•°ã€‚ step1ï¼šä»¥åŸºæœ¬å—ä¸ºå•ä½ï¼Œé€ä¸ªéå†å‡½æ•°çš„æ‰€æœ‰æŒ‡ä»¤ï¼Œå…ˆæ‰¾å¤§æ´»è·ƒåœ¨å¤šä¸ªåŸºæœ¬å—çš„å˜é‡åŠå…¶å¯¹åº”çš„å—ï¼Œå­˜å‚¨åœ¨live_var_2blocksä¸­ step2ï¼šå¯¹äºæ‰€æœ‰çš„å˜é‡ï¼Œé€æ¬¡éå†live_var_2blocks,åœ¨å¯¹åº”çš„domé›†åˆbb_dominance_frontier_bbä¸­ä¾æ¬¡å¯»æ‰¾æ”¯é…è¾¹ç•Œï¼Œå¦‚æœåœ¨è¯¥åŸºæœ¬å—ä¸­æœªæ·»åŠ phiï¼ˆbb_has_var_phiä¸­ä¸å­˜åœ¨è®°å½•ï¼‰,åˆ™æ’å…¥phiï¼šcreate_phi,åœ¨bb_dominance_frontier_bbä¸­æ·»åŠ è¯¥è¯­å¥ï¼Œå¹¶åœ¨bb_has_var_phiä¸­æ·»åŠ è®°å½•ï¼Œé˜²æ­¢é‡å¤æ·»åŠ ã€‚ ç®—æ³•æ˜¯å¦‚ä½•é€‰æ‹©value(å˜é‡æœ€æ–°çš„å€¼)æ¥æ›¿æ¢loadæŒ‡ä»¤çš„ï¼Ÿï¼ˆæè¿°æ¸…æ¥šå¯¹åº”å˜é‡ä¸ç»´æŠ¤è¯¥å˜é‡çš„ä½ç½®ï¼‰ é€‰æ‹©valueæ¥æ›¿æ¢loadæŒ‡ä»¤çš„ä½ç½®åœ¨src\\optimization\\Mem2Reg.cppä¸­çš„Mem2Reg::rename()å‡½æ•°ã€‚ å¯¹å…¨å±€å˜é‡var_val_stackè¿›è¡Œä»¥ä¸‹è°ƒç”¨å’Œç»´æŠ¤ï¼š ç¬¬ä¸€æ¬¡éå†åŸºæœ¬å—çš„æ‰€æœ‰æŒ‡ä»¤ï¼šphiæŒ‡ä»¤ï¼šæ ¹æ®æ’å…¥çš„phiæŒ‡ä»¤ï¼Œå°†å¯¹åº”å˜é‡çš„æœ€æ–°å®šå€¼çš„ä½ç½®è®¾ä¸ºè¯¥phiè¯­å¥ ç¬¬äºŒæ¬¡éå†åŸºæœ¬å—ä¸­çš„æ‰€æœ‰æŒ‡ä»¤ï¼šloadæŒ‡ä»¤ï¼šå¦‚æœloadçš„å˜é‡åœ¨var_val_stackä¸­å·²ç»å­˜åœ¨ï¼Œåˆ™å°†è¯¥è¯­å¥åŠ å…¥wait_deleteï¼Œå¹¶ç»´æŠ¤å¯¹åº”çš„å…¨å±€å˜é‡ã€‚storeæŒ‡ä»¤ï¼šå°†storeå­˜å…¥å†…å­˜çš„å€¼ä½œä¸ºæœ€æ–°å®šå€¼ å€ŸåŠ©get_succ_basic_blocksè¡¥å……å› phiæ”¹åŠ¨çš„var_val_stackå¯¹åº”çš„å€¼ ç¬¬ä¸‰æ¬¡éå†åŸºæœ¬å—ä¸­çš„æ‰€æœ‰æŒ‡ä»¤ï¼špopå‡ºvar_val_stackä¸­çš„æœ€æ–°å®šå€¼ åœ¨ç¬¬äºŒæ¬¡éå†ä¸­ï¼Œå¯¹äºloadæŒ‡ä»¤ï¼Œå¦‚æœloadçš„å˜é‡åœ¨var_val_stackä¸­å·²ç»å­˜åœ¨ï¼Œåˆ™å°†è¯¥è¯­å¥åŠ å…¥wait_deleteï¼Œå¹¶åˆ©ç”¨replace_all_use_withå‡½æ•°ç»´æŠ¤å…¶ä»–æŒ‡ä»¤ã€‚æœ€åå°†wait_deleteè¿›è¡Œåˆ é™¤ï¼Œä¹Ÿå°±æ˜¯åˆ é™¤loadæŒ‡ä»¤ã€‚ ä»£ç é˜…è¯»æ€»ç»“æ­¤æ¬¡å®éªŒçš„ä¸»è¦å†…å®¹æ˜¯ç†Ÿæ‚‰ä»£ç ä¼˜åŒ–çš„åŸºç¡€çŸ¥è¯†ï¼Œäº†è§£SSAæ ¼å¼çš„IRçš„ç›¸å…³æ¦‚å¿µï¼Œå¹¶é˜…è¯»äº†ç”¨æ¥ä¼˜åŒ–Lab3ç”Ÿæˆçš„IRæŒ‡ä»¤çš„Mem2Regç›¸å…³ä»£ç ,ä¸»è¦ä¼˜åŒ–äº†å†—ä½™çš„loadï¼Œstoreï¼ŒallocaæŒ‡ä»¤ã€‚ä¸»è¦æ”¶è·æ˜¯ç†Ÿæ‚‰äº†æ”¯é…èŠ‚ç‚¹ï¼Œæ”¯é…è¾¹ç•Œç­‰æ¦‚å¿µï¼Œä»¥åŠå¦‚ä½•å°†è¿™äº›æ¦‚å¿µç”¨äºä»£ç ä¼˜åŒ–ï¼Œå¦‚ä½•åœ¨ç¨‹åºä¸­ç»´æŠ¤å’Œåˆ©ç”¨è¿™äº›å±æ€§æ¥å®ç°ä»£ç çš„ä¼˜åŒ–ã€‚ PART2 å®éªŒè¦æ±‚æœ¬æ¬¡å®éªŒè¦å®Œæˆçš„ç›®æ ‡æ˜¯åœ¨lab4.1 SSA IRçš„åŸºç¡€ä¸Šï¼Œæ ¹æ®å®éªŒæ¡†æ¶å®Œæˆå¯¹SSA IRåŸºäºæ•°æ®æµåˆ†æå®Œæˆçš„GVNä¼˜åŒ–ã€‚ å®éªŒéš¾ç‚¹ æ ¹æ®LLVM IRçš„æŒ‡ä»¤ç±»å‹è®¾è®¡Expressionå­ç±»çš„ç±»å‹ï¼Œå¹¶é€šè¿‡é€’å½’å®šä¹‰çš„æ–¹æ³•å®šä¹‰å€¼è¡¨è¾¾å¼ï¼Œå®ŒæˆValue Expr å¤„ç†phiæŒ‡ä»¤ï¼Œæ„æ€è®¾è®¡copy stmtéƒ¨åˆ†å’Œintersect,ValuePhiFuncå‡½æ•° å®éªŒè®¾è®¡å®éªŒæ€è·¯ValueNumberGVNçš„æ ¸å¿ƒå°±æ˜¯å»ºç«‹å…¨å±€å€¼ç¼–å·ï¼Œæœ¬æ¬¡å®éªŒä¸­ä½¿ç”¨valueexprä½œä¸ºå€¼ç¼–å·ï¼Œæ¯ä¸ªç­‰ä»·ç±»çš„valueexpræ˜¯å”¯ä¸€çš„ã€‚ ä¸ºäº†è§£å†³å¯èƒ½å­˜åœ¨çš„valueexprç›¸äº’ä¾èµ–å¯¼è‡´çš„æ— é™é€’å½’çš„é—®é¢˜ï¼Œå°†ç­‰ä»·ç±»è¿ç®—ç¬¦é‡è½½éƒ¨åˆ†å®šä¹‰ä¸ºï¼š bool CongruenceClass::operator==(const CongruenceClass &amp;other) const { auto v1=value_expr_; auto v2=other.value_expr_; if(v2==nullptr&amp;&amp;v1==nullptr) return true; else if(v1==nullptr||v2==nullptr) return false; if(members_==other.members_) return true; return false; } å³ï¼Œç®—æ³•æ”¶æ•›çš„åˆ¤æ–­ä¾æ®æ˜¯æ ¹æ®ç­‰ä»·ç±»æˆå‘˜ä¸å†æ”¹å˜ï¼Œè€Œä¸æ˜¯æ ¹æ®valueexprçš„å€¼ä¸å†æ”¹å˜ï¼Œè¿™æ ·å°±å¯ä»¥é¿å¼€valueexpræ— é™é€’å½’çš„æƒ…å†µã€‚ ä¸ºäº†è·å–ä¸€ä¸ªå˜é‡çš„valueexprï¼Œå°†getVNå®šä¹‰å¦‚ä¸‹ï¼š å…¶ä¸­å¦‚æœveçš„è¡¨è¾¾å¼ä¸ºSingleExpressionçš„ç±»å‹æ—¶ï¼Œæ˜¯åœ¨valueexprå¯»æ‰¾å‚æ•°å¯¹åº”çš„å€¼è¡¨è¾¾å¼æ—¶å»ºç«‹çš„Expressionã€‚ shared_ptr&lt;Expression&gt; GVN::getVN(const partitions &amp;pout, shared_ptr&lt;Expression&gt; ve) { if(ve==nullptr) return nullptr; auto sve=std::dynamic_pointer_cast&lt;SingleExpression&gt;(ve); if(sve!=nullptr) { auto num=dynamic_cast&lt;Constant*&gt;(sve-&gt;va()); if(num!=nullptr) return ConstantExpression::create(num); for(auto &amp;cc:pout) { if(cc-&gt;index_==0) return nullptr; for(auto &amp;mem:cc-&gt;members_) if(mem==sve-&gt;va()) return cc-&gt;value_expr_ ; } for(auto &amp;cc:pout) { if(cc-&gt;index_==0) return nullptr; if(*ve==*cc-&gt;value_expr_) return cc-&gt;value_expr_; } return nullptr; } valueexpråœ¨Expressionä¸­æ–°å»ºè‹¥å¹²å­ç±»ï¼Œå¹¶å®Œå–„å¯¹åº”çš„å†…éƒ¨å˜é‡å’Œåˆ›å»ºï¼Œæ¯”è¾ƒï¼Œæ‰“å°ç­‰å‡½æ•° Single Expressionï¼Œå­˜æ”¾éçº¯å‡½æ•°ï¼Œload/storeæŒ‡ä»¤çš„value Constant Expressionï¼Œå¸¸æ•° Binary Expressionï¼ŒäºŒå…ƒæŒ‡ä»¤çš„æ“ä½œæ•°å’Œç±»å‹ Phi Expressionï¼ŒphiæŒ‡ä»¤çš„æ“ä½œæ•° Call Expressionï¼Œå‡½æ•°è°ƒç”¨æŒ‡ä»¤çš„å‡½æ•°ç±»å‹å’Œå’Œå‡½æ•°å‚æ•°ï¼Œä»…è€ƒè™‘çº¯å‡½æ•° Gep Expressionï¼Œå­˜gepæŒ‡ä»¤çš„æ“ä½œæ•° Cmp Expressionï¼Œç±»å‹ä¸ºicmpçš„æŒ‡ä»¤çš„æŒ‡ä»¤ç±»å‹ï¼ˆcmp_op)å’Œæ“ä½œæ•° Fcmp Expressionï¼Œç±»å‹ä¸ºfcmpçš„æŒ‡ä»¤çš„æŒ‡ä»¤ç±»å‹ï¼ˆcmp_op)å’Œæ“ä½œæ•° Trans Expressionï¼Œç±»å‹è½¬æ¢çš„æŒ‡ä»¤ç±»å‹å’Œæ“ä½œæ•° æ ¹æ®æŒ‡ä»¤ç±»å‹çš„ä¸åŒåˆ†åˆ«å¤„ç†ï¼š phiæŒ‡ä»¤ï¼šå°†åœ¨intersectä¸­å’Œtransferä¸­å¤„ç†ï¼Œæ­¤å¤„ä¸ä¼šå¤„ç† voidç±»å‹æŒ‡ä»¤ï¼šæ­¤ç±»æŒ‡ä»¤ä¸ä¼šè¢«å¤„ç† callæŒ‡ä»¤ï¼šè‹¥å±äºçº¯å‡½æ•°ï¼Œæ‰¾åˆ°å‚æ•°çš„å€¼è¡¨è¾¾å¼å¹¶å»ºç«‹CallExpressionï¼Œå¦åˆ™æ–°å»ºä¸€ä¸ªSingleExpressionç±»å‹çš„ve gepæŒ‡ä»¤ï¼šç±»ä¼¼äºçº¯å‡½æ•°ï¼Œæ‰¾åˆ°å„ä¸ªå‚æ•°å¯¹åº”çš„å€¼è¡¨è¾¾å¼å¹¶å»ºç«‹GepExpression cmp,fcmp,binary,fp2si,si2fp,zextæŒ‡ä»¤ï¼šæ‰¾åˆ°å‚æ•°å¯¹åº”çš„å€¼è¡¨è¾¾å¼ï¼Œè¿›è¡Œå¸¸é‡ä¼ æ’­ï¼Œå¹¶å»ºç«‹å¯¹åº”çš„expressionï¼šCmpExpression,FcmpExpression,BinaryExpression,TransExpression å…¶ä»–è¯­å¥ï¼Œæ–°å»ºSingleExpressionä½œä¸ºå€¼è¡¨è¾¾å¼ å¤„ç†Phiç”±äºPhiæŒ‡ä»¤è¦ä½œä¸ºCopy stmtåŠ å…¥æ¯ä¸ªåŸºæœ¬å—çš„å‰é©±ä¸­ï¼Œä¸ºäº†æ–¹ä¾¿ï¼Œå¯ä»¥åœ¨æ¯ä¸ªåŸºæœ¬å—æŒ‡ä»¤éå†å®Œåï¼Œéå†å¹¶å¤„ç†è¯¥åŸºæœ¬å—åç»§ä¸­å‡ºç°çš„phiæŒ‡ä»¤ï¼Œå°†åç»§å—ä¸­çš„phiæŒ‡ä»¤åŠ å…¥è¯¥åŸºæœ¬å—çš„ç­‰ä»·ç±»ä¸­ã€‚ PhiæŒ‡ä»¤ä¸ºå››å…ƒæŒ‡ä»¤ï¼ŒæŒ‡ä»¤æ“ä½œæ•°ä¾æ¬¡ä¸º[op,label;op,label],æ­¤å¤„å¯ä»¥é€šè¿‡get_name()è·å–labelå’Œbbçš„åå­—è¿›è¡Œæ¯”å¯¹ï¼Œå¦‚æœç›¸åŒï¼Œåˆ™å€ŸåŠ©transferFunctionåœ¨è¯¥å—ç­‰ä»·ç±»ä¸­æ·»åŠ è¯¥æ¡è¯­å¥ã€‚ auto succ=bb.get_succ_basic_blocks(); if(succ.size()&gt;0) for(auto s:succ) for(auto &amp;sinst:s-&gt;get_instructions()) if(sinst.is_phi()) { auto op0=sinst.get_operand(0); //op1/2/3=... if(op1-&gt;get_name()==bb.get_name()) pouts=GVN::transferFunction(&amp;sinst,op0,pouts); if(op3-&gt;get_name()==bb.get_name()) pouts=GVN::transferFunction(&amp;sinst,op2,pouts); } ä¸ºäº†å¤„ç†å­˜åœ¨äº†ä¸¤ä¸ªå‰é©±å—çš„åŸºæœ¬å—çš„pinï¼Œéœ€è¦è®¾è®¡Joinå’Œintersectå‡½æ•°ã€‚ å…¶ä¸­ï¼ŒTopå—è®¾è®¡ä¸ºåªå«æœ‰ä¸€ä¸ªç­‰ä»·ç±»ï¼Œä¸”ç­‰ä»·ç±»çš„ç´¢å¼•ä¸º0çš„é›†åˆ;Joinå‡½æ•°é‡åˆ°Topå—æ—¶ï¼Œè§„å®šJoin(P, Top) = P = Join(Top, P)ï¼Œå¦åˆ™é€ä¸ªéå†ç­‰ä»·ç±»å¹¶è°ƒç”¨intersectå‡½æ•°ã€‚ è€Œå¯¹äºIntersectå‡½æ•°ï¼Œå¯¹äºå…¶ä»–éphiè¯­å¥ï¼Œè‹¥members_å­˜åœ¨äº¤é›†ï¼Œåˆ™å¿…ç„¶æœ‰è¯¥ä¸¤ä¸ªç­‰ä»·ç±»çš„å€¼è¡¨è¾¾å¼ä¸€è‡´ï¼Œè¿›è¡Œåˆå¹¶å³å¯ï¼Œå¦åˆ™åˆå¹¶å¾—åˆ°çš„Ckä¸ºç©ºï¼›å¯¹äºå°†å‡ºç°åœ¨ä¸‹ä¸€ä¸ªåŸºæœ¬å—çš„ï¼ˆåœ¨ä¸Šæ–‡ä¸­æ·»åŠ ï¼‰çš„phiè¯­å¥ï¼Œå°±ä¼šå­˜åœ¨membersä¸ä¸ºç©ºä¸”valueexprä¸ç›¸ç­‰çš„æƒ…å†µï¼Œæ­¤æ—¶åœ¨Ckä¸­æ ¹æ®Phiæ–°å»ºvalueexprå’ŒvaluePhiè¯­å¥ï¼Œå³å¯å®Œæˆå¯¹Phiè¯­å¥çš„å¤„ç†ã€‚ for(auto i :Ci-&gt;members_) if(Cj-&gt;members_.find(i)!=Cj-&gt;members_.end()) { Ck-&gt;members_.insert(i); if(Ck-&gt;leader_==nullptr) Ck-&gt;leader_=i; } if(Ci-&gt;value_expr_==Cj-&gt;value_expr_) { Ck-&gt;value_expr_=Ci-&gt;value_expr_; Ck-&gt;value_phi_=Ci-&gt;value_phi_; Ck-&gt;leader_=Ci-&gt;leader_; } else if(Ck-&gt;members_.size()!=0) { Ck-&gt;value_phi_=PhiExpression::create(Ci-&gt;value_expr_,Cj-&gt;value_expr_); Ck-&gt;value_expr_=PhiExpression::create(Ci-&gt;value_expr_,Cj-&gt;value_expr_); } æ­¤å¤–ï¼Œåœ¨valuePhiFuncå‡½æ•°ä¸­éœ€è¦è¯†åˆ«phiå‡½æ•°ä¹‹é—´å­˜åœ¨çš„å†—ä½™ï¼Œå‡½æ•°æ€è·¯å¦‚ä¸‹ï¼š åªéœ€è¦å¤„ç†binaryå‡½æ•°ä¸­çš„phiè¯­å¥å­˜åœ¨çš„å†—ä½™ï¼Œå¹¶ä¸”è¯¥binaryæŒ‡ä»¤çš„lhså’Œrhså‡ä¸ºPhiç±»å‹ï¼Œæ ¹æ®æŒ‡ä»¤çš„å€¼è¡¨è¾¾å¼å³å¯è¿›è¡Œä¸Šè¿°ç±»å‹åˆ¤æ–­ï¼ŒæŒ‡ä»¤æ ¼å¼ä¸ºbin(phi(vi1,vj1),phi(vi2,vj2)) æ ¹æ®vi1,vi2,vj1,vj2(æ­¤æ—¶å‡ä¸ºå€¼è¡¨è¾¾å¼)åˆ›å»ºæ–°çš„äºŒå…ƒè¡¨è¾¾å¼ï¼šc1=bin(vi1,vi2),c2=bin(vj1,vj2) åœ¨è¯¥åŸºæœ¬å—çš„å‰é©±å—ä¸­æ‰¾åˆ°c1,c2å¯¹åº”çš„å€¼è¡¨è¾¾å¼ï¼Œå€ŸåŠ©getVNå®ç°ï¼Œå¦‚æœæœªæ‰¾åˆ°å¯¹åº”çš„å€¼è¡¨è¾¾å¼ï¼Œåˆ™é€’å½’æŸ¥æ‰¾è¯¥å‰é©±å—çš„valuePhiFunc å¦‚æœæ‰¾åˆ°å¯¹åº”çš„å€¼è¡¨è¾¾å¼ï¼Œå€ŸåŠ©ä¸¤ä¸ªå€¼è¡¨è¾¾å¼æ–°å»ºphiæŒ‡ä»¤å¹¶è¿”å›ï¼Œå¦åˆ™è¿”å›nullptr transferFunctiontransferFunctionå‡½æ•°çš„ä¸»è¦æ€è·¯ï¼š åœ¨å·²æœ‰ç­‰ä»·ç±»ä¸­åˆ¤æ–­è¯¥æŒ‡ä»¤æ˜¯å¦å·²å­˜åœ¨ï¼Œå¦‚æœå­˜åœ¨åˆ™åˆ é™¤ï¼Œå¦‚æœè¯¥æŒ‡ä»¤åœ¨å¯¹åº”çš„ç­‰ä»·ç±»ä¸­ä½œä¸ºleaderå‡ºç°ï¼Œå°†é‡æ–°æŒ‡å®šleader æ‰¾åˆ°eå¯¹åº”çš„å€¼è¡¨è¾¾å¼ï¼ˆgetVNï¼‰ï¼Œå¦‚æœæ‰¾åˆ°ï¼Œå°†xæ·»åŠ åˆ°å¯¹åº”çš„ç­‰ä»·ç±»é›†åˆä¸­ï¼Œï¼ˆå¤„ç†åç»§å—phiè¯­å¥çš„æƒ…å†µä¸‹å¯èƒ½ä¼šæ‰§è¡Œè¯¥æ­¥éª¤ï¼‰ï¼Œè¿”å›pout å¦‚æœeä¸ºå¸¸æ•°ç±»ï¼Œå› ä¸ºä¸Šæ–‡ä¸­æœªæ‰¾åˆ°å¯¹åº”çš„ç­‰ä»·ç±»ï¼Œå°†æ–°å»ºç­‰ä»·ç±»ï¼Œvalue_expr_å³ä¸ºè¯¥å¸¸æ•°å¯¹åº”çš„å¸¸æ•°è¡¨è¾¾å¼ï¼Œæ·»åŠ åˆ°poutä¸­å¹¶è¿”å› è°ƒç”¨valueexprå’ŒvaluePhifuncå‡½æ•°ï¼Œæ‰¾åˆ°å¯¹åº”çš„veå’Œvpfï¼Œå¹¶éå†å·²æœ‰ç­‰ä»·ç±»ï¼Œå¦‚æœå·²æœ‰ç­‰ä»·ç±»ä¸­å­˜åœ¨è¯¥veæˆ–vpfï¼Œå³å¯åœ¨ç­‰ä»·ç±»ä¸­æ·»åŠ è¯¥æˆå‘˜ï¼Œå¦åˆ™ä»¥è¯¥æ¡æŒ‡ä»¤ä¸ºleaderæ–°å»ºç­‰ä»·ç±»ï¼Œè¿”å›pout detectEquivalencesåœ¨ä¸Šè¿°æ¡†æ¶çš„åŸºç¡€ä¸Šï¼Œå®Œå–„detectequivalenceså‡½æ•°ï¼š ä¸æ–­æ·±åº¦ä¼˜å…ˆéå†åŸºæœ¬å—ï¼Œç›´åˆ°æ¯ä¸ªåŸºæœ¬å—çš„ç­‰ä»·ç±»é›†åˆä¸å†æ”¹å˜ åœ¨label_entryä½ç½®å¤„ç†å‡½æ•°å‚æ•°ï¼Œå…¨å±€å˜é‡ï¼Œå¯¹äºè¿™ç±»å‚æ•°ç›´æ¥æ–°å»ºç­‰ä»·ç±»å³å¯ å¯¹äºæ¯ä¸ªåŸºæœ¬å—ï¼Œå¦‚æœåŒ…å«å¤šä¸ªå‰é©±ï¼Œè°ƒç”¨joinè·å–pinï¼Œå¦åˆ™ç›´æ¥å°†å‰é©±å—çš„ç­‰ä»·ç±»ä½œä¸ºpin éå†æ¯æ¡æŒ‡ä»¤å¹¶è°ƒç”¨transferFunctionå‡½æ•°æ›´æ”¹å½“å‰åŸºæœ¬å—ç­‰ä»·ç±»æˆå‘˜ è®¿é—®å½“å‰åŸºæœ¬å—çš„åç»§åŸºæœ¬å—ï¼Œå¤„ç†phiå‡½æ•° å…·ä½“ä»£ç æ€è·¯å¦‚ä¸‹æ‰€ç¤º for(auto &amp;bb:func_-&gt;get_basic_blocks()) if(&amp;bb==entry) continue; else pout_[&amp;bb]=clone(top); do next_value_number_=1; changed=false; for (auto &amp;bb : func_-&gt;get_basic_blocks()) partitions pouts={}; if(&amp;bb!=entry) if( bb.get_pre_basic_blocks().size()&gt;1) //use join() to deal with else for(auto s:predecessors) pouts=clone(pout_[s]); else //deal with func args and global var for(auto &amp;inst:bb.get_instructions()) if(!inst.is_void()&amp;&amp;!inst.is_phi()) pouts=GVN::transferFunction(&amp;inst,&amp;inst,pouts); //deal with phi instr if(pouts!=pout_[&amp;bb]) changed=true; pout_[&amp;bb]=std::move(pouts); while (changed); å¸¸é‡ä¼ æ’­å¸¸é‡ä¼ æ’­/å¸¸é‡æŠ˜å æ˜¯ä¸ºäº†åœ¨ç¼–è¯‘æ—¶è¿›è¡Œè®¡ç®—ç¨‹åºä¸­å­˜åœ¨çš„å¸¸æ•°ï¼Œå¦‚äºŒå…ƒè®¡ç®—ï¼Œcmpï¼Œç±»å‹è½¬æ¢æŒ‡ä»¤ï¼Œä»¥ä¾¿æä¾›æ›´å¤šå¯ä¼˜åŒ–çš„è¡¨è¾¾å¼ï¼Œæé«˜è¿è¡Œæ•ˆç‡ã€‚åªéœ€è¦åœ¨ä¸¤ä¸ªåœ°æ–¹å¤„ç†ï¼švalueexpréƒ¨åˆ†å’Œvaluephifuncéƒ¨åˆ†ã€‚ valueexpréƒ¨åˆ†ï¼šå¯¹binaryï¼Œcmpï¼Œtransè¯­å¥å‡è¿›è¡Œå¸¸é‡ä¼ æ’­ï¼š //äºŒå…ƒ if(expr1-&gt;get_expr_type()==Expression::e_constant&amp;&amp;expr2-&gt;get_expr_type()==Expression:: e_constant) { auto e1=std::dynamic_pointer_cast&lt;ConstantExpression&gt;(expr1); auto e2=std::dynamic_pointer_cast&lt;ConstantExpression&gt;(expr2); auto expr=folder_-&gt;compute(instr,e1-&gt;get_c(),e2-&gt;get_c()); return ConstantExpression::create(expr); } //ä¸€å…ƒ if(ve-&gt;get_expr_type()==Expression::e_constant) { auto e=std::dynamic_pointer_cast&lt;ConstantExpression&gt;(ve); auto expr=folder_-&gt;compute(instr,e-&gt;get_c()); return ConstantExpression::create(expr); } åœ¨valuePhiFuncä¸­ï¼Œåªéœ€å¤„ç†å¯¹binaryæŒ‡ä»¤çš„å¸¸é‡ä¼ æ’­ï¼Œä¸ºäº†æ–¹ä¾¿è®¡ç®—ï¼Œåœ¨ConstFolderç±»ä¸­æ·»åŠ å¯¹computeçš„é‡è½½ï¼ˆå‚æ•°ä¸ºInstruction::opID,Constant,Constant\\) auto e1=std::dynamic_pointer_cast&lt;ConstantExpression&gt;(vi1); auto e2=std::dynamic_pointer_cast&lt;ConstantExpression&gt;(vi2); auto e=folder_-&gt;compute(opid,e1-&gt;get_c(),e2-&gt;get_c()); c1=ConstantExpression::create(e); ä¸¾ä¾‹ä»¥bin.cminusä¸ºä¾‹ï¼Œæœªå¼€å¯ä»£ç ä¼˜åŒ–æ—¶ï¼Œç”Ÿæˆçš„LLVM ä»£ç å¦‚ä¸‹ï¼š define i32 @main() { label_entry: %op0 = call i32 @input() %op1 = call i32 @input() %op2 = icmp sgt i32 %op0, %op1 %op3 = zext i1 %op2 to i32 %op4 = icmp ne i32 %op3, 0 br i1 %op4, label %label5, label %label14 label5: ; preds = %label_entry %op6 = add i32 33, 33 %op7 = add i32 44, 44 %op8 = add i32 %op6, %op7 br label %label9 label9: ; preds = %label5, %label14 %op10 = phi i32 [ %op8, %label5 ], [ %op17, %label14 ] %op11 = phi i32 [ %op7, %label5 ], [ %op16, %label14 ] %op12 = phi i32 [ %op6, %label5 ], [ %op15, %label14 ] call void @output(i32 %op10) %op13 = add i32 %op12, %op11 call void @output(i32 %op13) ret i32 0 label14: ; preds = %label_entry %op15 = add i32 55, 55 %op16 = add i32 66, 66 %op17 = add i32 %op15, %op16 br label %label9 } å¼€å¯ä»£ç ä¼˜åŒ–åï¼Œæœ€ç»ˆç”Ÿæˆçš„ä»£ç ï¼› define i32 @main() { label_entry: %op0 = call i32 @input() %op1 = call i32 @input() %op2 = icmp sgt i32 %op0, %op1 %op3 = zext i1 %op2 to i32 %op4 = icmp ne i32 %op3, 0 br i1 %op4, label %label5, label %label14 label5: ; preds = %label_entry %op6 = add i32 33, 33 %op7 = add i32 44, 44 %op8 = add i32 %op6, %op7 br label %label9 label9: ; preds = %label5, %label14 %op10 = phi i32 [ %op8, %label5 ], [ %op17, %label14 ] call void @output(i32 %op10) call void @output(i32 %op10) ret i32 0 label14: ; preds = %label_entry %op15 = add i32 55, 55 %op16 = add i32 66, 66 %op17 = add i32 %op15, %op16 br label %label9 } å…¶ä¸­ï¼Œop13å’Œop10ç­‰ä»·ï¼Œç»è¿‡æ­»ä»£ç åˆ é™¤ï¼Œå°†åˆ é™¤è®¡ç®—op13ä¸op11ï¼Œop12çš„è¯­å¥ã€‚ ä¸Šè¿°ä¾‹å­å„ä¸ªåŸºæœ¬å—çš„ç­‰ä»·ç±»å¦‚ä¸‹æ‰€ç¤ºï¼š \"label_entry\": [[\"%op0\", ], [\"%op1\", ], [\"%op2\", ], [\"%op3\", ], [\"%op4\", ], ], \"label5\": [[\"%op0\", ], [\"%op1\", ], [\"%op2\", ], [\"%op3\", ], [\"%op4\", ], [\"%op6\", \"%op12\", ], [\"%op7\", \"%op11\", ], [\"%op8\", \"%op10\", ], ], \"label9\": [[\"%op0\", ], [\"%op1\", ], [\"%op2\", ], [\"%op3\", ], [\"%op4\", ], , [\"%op13\", \"%op10\", ], [\"%op11\", ], [\"%op12\", ], ], \"label14\": [[\"%op0\", ], [\"%op1\", ], [\"%op2\", ], [\"%op3\", ], [\"%op4\", ], [\"%op15\", \"%op12\", ], [\"%op16\", \"%op11\", ], [\"%op17\", \"%op10\", ],, ],}},] æ€è€ƒé¢˜1.è¯·ç®€è¦åˆ†æä½ çš„ç®—æ³•å¤æ‚åº¦ ä»…å¯¹ç¨‹åºçš„ä¸»è¦éƒ¨åˆ†ä»¥æŒ‡ä»¤ä¸ºå•ä½è¿›è¡Œè®¨è®ºï¼Œå®éªŒå®Œæˆéƒ¨åˆ†çš„ä»£ç ç”±run()å‡½æ•°é€ä¸ªåˆ†ææ¯ä¸ªå‡½æ•°ï¼Œå¹¶è¿›å…¥detectEquivalences()å‡½æ•°ï¼Œåœ¨detectEquivalences()å‡½æ•°ä¸­ï¼Œå¯¹å‡½æ•°ä¸­çš„åŸºæœ¬å—ä¸æ–­è¿›è¡Œéå†åˆ†æå¾—åˆ°æ¯ä¸ªåŸºæœ¬å—çš„pinå’Œpoutç­‰ä»·ç±»ï¼Œç›´åˆ°poutæ”¶æ•›ï¼Œä»£è¡¨è¯¥å‡½æ•°åˆ†æå®Œæˆï¼Œä¸€èˆ¬æ¥è¯´ï¼Œéå†çš„æ¬¡æ•°ä¸ºä¸€ä¸ªè¾ƒå°çš„æ•°ï¼ˆé€šå¸¸å°äº10ï¼‰ï¼Œè§†ä¸ºå¸¸æ•°ï¼›è€Œå¯¹äºæ¯ä¸ªåŸºæœ¬å—ï¼Œè¦ä¾æ¬¡éå†åŸºæœ¬å—ä¸­çš„æŒ‡ä»¤ï¼Œåœ¨transferfunctionä¸­å®Œæˆå¯¹æ¯ä¸ªæŒ‡ä»¤çš„åˆ†æï¼ŒåŒæ—¶åœ¨ç­‰ä»·ç±»ä¸­éå†å¯»æ‰¾å€¼è¡¨è¾¾å¼æˆ–å¯¹åº”çš„å€¼ã€‚ ç»¼ä¸Šåˆ†æï¼Œå¯¹äºä¸€ä¸ªç¨‹åºï¼Œæœ¬å®éªŒç®—æ³•çš„æ—¶é—´å¤æ‚åº¦å¤§çº¦ä¸º$T(n)=O(n^2)$,å…¶ä¸­nä¸ºæŒ‡ä»¤æ¡æ•° 2.std::shared_ptrå¦‚æœå­˜åœ¨ç¯å½¢å¼•ç”¨ï¼Œåˆ™æ— æ³•æ­£ç¡®é‡Šæ”¾å†…å­˜ï¼Œä½ çš„ Expression ç±»æ˜¯å¦å­˜åœ¨ circular reference? ä¸å­˜åœ¨ã€‚Expressionçš„å„ä¸ªå­ç±»æ˜¯é€’å½’å®šä¹‰çš„ï¼Œå…¶å­ç±»ä»¥åŠçš„æ„æˆæ–¹æ³•å¦‚ä¸‹ï¼š Single Expressionï¼Œç”±ä¸€ä¸ªValue *ç»„æˆï¼Œç”¨æ¥å¤„ç†ç‰¹æ®ŠæŒ‡ä»¤ï¼Œå¦‚éçº¯å‡½æ•°ï¼Œload,storeæŒ‡ä»¤ç­‰ Constant Expressionï¼Œç”±ä¸€ä¸ªConstant *ç»„æˆ Binary Expressionï¼Œç”±ä¸¤ä¸ªExpressionå’ŒæŒ‡ä»¤ç±»å‹ç»„æˆ Phi Expressionï¼Œç”±ä¸¤ä¸ªExpressionç»„æˆ Call Expressionï¼Œç”±å‡ ä¸ªExpressionå’ŒFunction*ç»„æˆ Gep Expressionï¼Œç”±å‡ ä¸ªExpressionç»„æˆ Cmp Expressionï¼Œç”±ä¸¤ä¸ªExpressionå’ŒæŒ‡ä»¤ç±»å‹ç»„æˆ Fcmp Expressionï¼Œç”±ä¸¤ä¸ªExpressionå’ŒæŒ‡ä»¤ç±»å‹ç»„æˆ Trans Expressionï¼Œç”±ä¸€ä¸ªExpressionå’ŒæŒ‡ä»¤ç±»å‹ç»„æˆ æ‰€æœ‰é€’å½’å®šä¹‰çš„Expressionæœ€ç»ˆéƒ½ä¼šå½’ç»“åˆ°Single Expressionä»¥åŠConstant ExpressionæŒ‡ä»¤ä¸Šï¼Œä¸ä¼šå‡ºç°ç¯å½¢å¼•ç”¨ 3.å°½ç®¡æœ¬æ¬¡å®éªŒå·²ç»å†™äº†å¾ˆå¤šä»£ç ï¼Œä½†æ˜¯åœ¨ç®—æ³•ä¸Šå’Œå·¥ç¨‹ä¸Šä»ç„¶å¯ä»¥å¯¹ GVN è¿›è¡Œæ”¹è¿›ï¼Œè¯·ç®€è¿°ä½ çš„ GVN å®ç°å¯ä»¥æ”¹è¿›çš„åœ°æ–¹ æœ¬æ¬¡å®éªŒValuePhiFuncå¯¹PhiæŒ‡ä»¤å†—ä½™çš„æ£€æµ‹ä»…ä»…æ£€æµ‹äº†BinarayæŒ‡ä»¤çš„å†—ä½™æƒ…å†µï¼Œå®é™…ä¸Šå¯ä»¥æ‰©å¤§æ£€æµ‹èŒƒå›´ï¼Œå¹¶ä¸”å¢åŠ æ£€æµ‹å†—ä½™çš„å½¢å¼ï¼Œå¦‚æ£€æµ‹phi(0, c+d)ä¸ phi(0,c)+phi(0,d)ï¼Œå®ç°æ€è·¯ç±»ä¼¼ã€‚ æ•ˆç‡è¾ƒä½ï¼Œå¯¹äºè§„æ¨¡è¾ƒå¤§çš„ä»£ç ï¼ŒGVNåˆ†æçš„æ•ˆç‡ä¼šå˜æ…¢ï¼Œå¯ä»¥é€šè¿‡å‡å°‘ä»£ç ä¸­ä¸å¿…è¦çš„éå†æ“ä½œæé«˜ç®—æ³•æ•ˆç‡ã€‚ å®éªŒæ€»ç»“ æœ¬æ¬¡å®éªŒåŸºäºè®ºæ–‡ã€ŠDetection of Redundant Expressions: A Complete and Polynomial-Time Algorithm in SSA ã€‹åŸºäºæ•°æ®æµåˆ†æå®Œæˆäº†SSA IRçš„GVNä¼˜åŒ–ï¼Œé€šè¿‡åŠ¨æ‰‹å®ç°å’Œè®¾è®¡å…·ä½“çš„ç®—æ³•ï¼Œè®©æˆ‘å¯¹æ•°æ®æµåˆ†ææœ‰äº†æ›´æ¸…æ¥šåœ°è®¤è¯† æœ¬æ¬¡å®éªŒä½œä¸ºä»£ç ä¼˜åŒ–éƒ¨åˆ†ä¸å‰å‡ æ¬¡å®éªŒå…±åŒå®Œæˆäº†Cminusçš„Compilerï¼Œå¯¹ã€Šç¼–è¯‘åŸç†ä¸æŠ€æœ¯ã€‹ä¸€è¯¾çš„è¯¾ç¨‹å†…å®¹æœ‰äº†æ›´æ¸…æ™°çš„æ•´ä½“è®¤è¯†ã€‚","categories":[{"name":"ç¼–è¯‘åŸç†","slug":"ç¼–è¯‘åŸç†","permalink":"http://sn1987a-1.github.io/categories/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86/"}],"tags":[{"name":"ä¸“ä¸šè¯¾","slug":"ä¸“ä¸šè¯¾","permalink":"http://sn1987a-1.github.io/tags/%E4%B8%93%E4%B8%9A%E8%AF%BE/"}]},{"title":"ç¼–è¯‘åŸç†-è¯æ³•åˆ†æ","slug":"ç¼–è¯‘åŸç†1","date":"2022-09-25T12:48:34.000Z","updated":"2023-09-24T05:22:47.819Z","comments":true,"path":"posts/8254dc99.html","link":"","permalink":"http://sn1987a-1.github.io/posts/8254dc99.html","excerpt":"","text":"è¯æ³•åˆ†æå®éªŒè¦æ±‚ å®ŒæˆåŸºäºflexçš„C-minusè¯æ³•åˆ†æå™¨ å®ŒæˆåŸºäºbisonçš„C-minusè¯­æ³•åˆ†æå™¨ å®éªŒéš¾ç‚¹ æ ¹æ®C-minusçš„è¯æ³•ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼å®Œæˆè¯æ³•åˆ†æå™¨ ç†è§£flexå’Œbisonçš„ç”¨æ³•ä»¥åŠæŒæ¡flexï¼Œbisonè”åŠ¨æ„å»ºè¯­æ³•åˆ†æå™¨çš„æ–¹æ³• æ­£ç¡®æ„å»ºC-minusçš„è¯­æ³•æ ‘ å®éªŒè®¾è®¡ æ­£åˆ™åŒ¹é… æ­£ç¡®åŒ¹é…C-minusçš„æ‰€æœ‰tokenï¼Œä»¥åŠæ³¨é‡Šï¼Œç©ºæ ¼ï¼Œæ¢è¡Œç­‰ç‰¹æ®Šå­—ç¬¦ï¼Œåˆ©ç”¨flexä¸tokençš„åå­—å…³è”èµ·æ¥ï¼ˆä½œä¸ºè¿”å›å€¼ï¼‰ï¼Œä¾‹å¦‚:\"if\" {pos_start = pos_end-1; pos_end ++; pass_node(yytext); return IF;},åŒæ—¶ç»´æŠ¤pos_start,pos_endï¼Œlinesçš„å€¼ï¼Œè¡¨è¾¾å¼çš„é¡ºåºä»£è¡¨äº†åŒ¹é…çš„ä¼˜å…ˆçº§ï¼š æ³¨é‡Š \\/\\*(?:[^\\*]|\\*+[^\\/\\*])*\\*+\\/ ç©ºæ ¼ï¼Œåˆ¶è¡¨ç¬¦ \" \"|\\t æ¢è¡Œ\\n æµ®ç‚¹æ•°[0-9]+\\.[0-9]*|[0-9]*\\.[0-9]+ æ•´å½¢[0-9]+ å˜é‡å [a-zA-Z_]* å…¶ä»–token \"if\" \"else\" \"while\" \"return\"\"void\" \"int\" \"float\" \"+\" \"-\" \"*\" \"/\" \"{\" \"}\" \"(\" \")\" \"[\" \"]\" \"&gt;=\" \"&gt;\" \"==\" \"&lt;=\" \"&lt;\" \"!=\" \"=\"\",\" \";\" tokenï¼Œtypeçš„æ•°æ®ç±»å‹ %union { struct _syntax_tree_node *node; } %token &lt;node&gt; ERROR ADD SUB IF ELSE WHILE RETURN INT %token &lt;node&gt;FLOAT VOID GE G E L LE NE MUX DIV DOT SEM %token &lt;node&gt;LEFT1 LEFT2 LEFT3 RIGHT1 RIGHT2 RIGHT3 ASS %token &lt;node&gt; INTEGER ID FLOATPOINT %type &lt;node&gt; program %type &lt;node&gt; type-specifier relop addop mulop %type &lt;node&gt; declaration-list declaration var-declaration fun-declaration %type &lt;node&gt; local-declarations compound-stmt statement-list statement expression-stmt %type &lt;node&gt; iteration-stmt selection-stmt return-stmt expression simple-expression %type &lt;node&gt; var additive-expression term factor integer float call %type &lt;node&gt; params param-list param args arg-list æ„å»ºè¯­æ³•æ ‘ åˆ©ç”¨bisonæ ¹æ®C-minusçš„è¯­æ³•æ„å»ºè¯­æ³•æ ‘ï¼Œå…¶ä¸­æ¯ä¸ªtypeéƒ½æ˜¯è¯­æ³•æ ‘çš„éå¶å­èŠ‚ç‚¹ï¼Œtokenéƒ½æ˜¯è¯­æ³•æ ‘çš„å¶å­èŠ‚ç‚¹ã€‚ä¾‹å¦‚ï¼š declaration-list: declaration-list declaration {$$=node(\"declaration-list\",2,$1,$2);} | declaration {$$=node(\"declaration-list\",1,$1);}; param-list: param-list DOT param {$$=node(\"param-list\",3,$1,$2,$3);} |param {$$=node(\"param-list\",1,$1);}; å®éªŒç»“æœéªŒè¯ testæµ‹è¯•æ ·ä¾‹ ç•¥ è‡ªè¡Œè®¾è®¡çš„æ ·ä¾‹ è·¨è¡Œæ³¨é‡Šå’Œç©ºè¡Œï¼š /* This my testcase */ è¾“å‡ºï¼šä¸åœ¨parserå’Œlexerçš„åˆ†æä¸­å‡ºç° æ•°ç»„å®šä¹‰ int y[2]è¾“å‡º| | | | | &gt;â€”+ var-declaration| | | | | | &gt;â€”+ type-specifier| | | | | | | &gt;â€” int| | | | | | &gt;â€” y| | | | | | &gt;â€” [| | | | | | &gt;â€” 2| | | | | | &gt;â€” ]| | | | | | &gt;â€” ; å¾ªç¯ while (0) {y=0;} è¾“å‡º| &gt;â€” while| &gt;â€” (| &gt;â€”+ expression| | &gt;â€”+ simple-expression| | | &gt;â€”+ additive-expression| | | | &gt;â€”+ term| | | | | &gt;â€”+ factor| | | | | | &gt;â€”+ integer| | | | | | | &gt;â€” 0| &gt;â€” )| &gt;â€”+ statement| | &gt;â€”+ compound-stmt| | | &gt;â€” {| | | &gt;â€”+ local-declarations| | | | &gt;â€” epsilon| | | &gt;â€”+ statement-list| | | | &gt;â€”+ statement-list| | | | | &gt;â€” epsilon| | | | &gt;â€”+ statement| | | | | &gt;â€”+ expression-stmt| | | | | | &gt;â€”+ expression| | | | | | | &gt;â€”+ var| | | | | | | | &gt;â€” y| | | | | | | &gt;â€” =| | | | | | | &gt;â€”+ expression| | | | | | | | &gt;â€”+ simple-expression| | | | | | | | | &gt;â€”+ additive-expression| | | | | | | | | | &gt;â€”+ term| | | | | | | | | | | &gt;â€”+ factor| | | | | | | | | | | | &gt;â€”+ integer| | | | | | | | | | | | | &gt;â€” 0| | | | | | &gt;â€” ;| | | &gt;â€” }","categories":[{"name":"ç¼–è¯‘åŸç†","slug":"ç¼–è¯‘åŸç†","permalink":"http://sn1987a-1.github.io/categories/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86/"}],"tags":[{"name":"ä¸“ä¸šè¯¾","slug":"ä¸“ä¸šè¯¾","permalink":"http://sn1987a-1.github.io/tags/%E4%B8%93%E4%B8%9A%E8%AF%BE/"}]},{"title":"åŸºäºGPT-2çš„chatbot","slug":"chatbot","date":"2022-05-17T15:12:20.000Z","updated":"2023-09-23T13:14:31.422Z","comments":true,"path":"posts/156324.html","link":"","permalink":"http://sn1987a-1.github.io/posts/156324.html","excerpt":"","text":"chatbotè®¾è®¡è¯¥é¡¹ç›®çš„ä»“åº“é“¾æ¥ï¼šhttps://github.com/Wonderful-Me/GPT-Chinese ä¿¡æ¯çˆ¬å–æœ¬éƒ¨åˆ†é€šè¿‡ç½‘ç»œçˆ¬è™«å®ç°äº†å®æ—¶ä¿¡æ¯çš„è·å–ï¼Œæ¯”å¦‚æŸ¥è¯¢æ¯æ—¥å„ä¸ªçœä»½ç–«æƒ…çš„æƒ…å†µä»¥åŠå¤©æ°”æƒ…å†µï¼Œå¾®åšçƒ­ç‚¹æ–°é—»ã€‚åœ¨è¾“å…¥ç«¯è¾“å…¥å¯¹åº”çš„æŸ¥è¯¢è¯·æ±‚åï¼ŒèŠå¤©æœºå™¨äººä¾¿å¯ä»¥ä¼ªè£…æˆæµè§ˆå™¨è®¿é—®å¯¹åº”çš„ç½‘ç«™çˆ¬å–æ•°æ®å¹¶æŒ‘é€‰å‡ºéœ€è¦çš„æ•°æ®å¹¶è¿”å›ã€‚ æ–°å† ç–«æƒ…èŠå¤©äººå¯ä»¥è¯†åˆ«ä¸â€œæ–°å† ç–«æƒ…â€ç›¸å…³çš„é—®é¢˜ï¼Œè‡ªåŠ¨çˆ¬å–å„ä¸ªçœä»½ä»Šæ—¥æ–°å† ç–«æƒ…çš„æ–°å¢æƒ…å†µï¼Œå…·ä½“å®ç°åŠŸèƒ½å¦‚ä¸‹ï¼š æŸ¥è¯¢çœä»½ï¼šå¯ä»¥å¯¹æŸä¸ªçœä»½çš„ç–«æƒ…çŠ¶å†µï¼ˆæ–°å¢ç¡®è¯Šå’Œæ–°å¢æ— ç—‡çŠ¶ï¼‰ ç‚¹å‡»å³ä¸‹æ–¹é“¾æ¥å³å¯è·³è½¬åˆ°ç›¸å…³ç½‘ç«™æŸ¥è¯¢è¯¦æƒ… é€šè¿‡echartsæŸ±çŠ¶å›¾æ˜¾ç¤ºå„ä¸ªçœä»½çš„ç¡®è¯Šæƒ…å†µï¼Œæ”¯æŒæ‹–åŠ¨å’Œç¼©æ”¾ #alist å­˜å‚¨åŸå¸‚åï¼Œæ–°å¢ç¡®è¯Šå’Œæ–°å¢æ— ç—‡çŠ¶ for i in citylist: if (i['today']['wzz_add'] == 0): clist.append([i['name'],i['today']['confirm'],0]) else: clist.append([i['name'], i['today']['confirm'], i['today']['wzz_add']]) ä»Šæ—¥çƒ­æœèŠå¤©æœºå™¨äººå¯ä»¥è¯†åˆ«ä¸â€œä»Šæ—¥çƒ­æœâ€ç›¸å…³çš„é—®é¢˜ï¼Œè‡ªåŠ¨çˆ¬å–å½“å‰çš„å¾®åšçƒ­æœï¼Œå…·ä½“åŠŸèƒ½å¦‚ä¸‹ï¼š è¿”å›å½“å‰çƒ­æœä¸­çƒ­åº¦æœ€é«˜çš„æ–°é—»èµ„è®¯ ç‚¹å‡»çƒ­æœå†…å®¹çš„æ–‡æœ¬å³å¯è·³è½¬è‡³çƒ­æœçš„é“¾æ¥äº†è§£è¯¦æƒ… response = requests.get(\"https://weibo.com/ajax/side/hotSearch\") data_json = response.json()['data']['realtime'] for data_item in data_json: dic = {#å¾®åšè¯æ¡çš„ç½‘å€ä¸º'https://s.weibo.com/weibo?q=%23' + è¯æ¡åç§° + '%23' 'title': data_item['note'], 'url': 'https://s.weibo.com/weibo?q=%23' + data_item['word'] + '%23', 'num': data_item['num'] } å¤©æ°”æŸ¥è¯¢èŠå¤©æœºå™¨äººå¯ä»¥è¯†åˆ«ä¸â€œä»Šæ—¥å¤©æ°”â€ç›¸å…³çš„é—®é¢˜ï¼Œå¹¶ä¸”æ ¹æ®è¾“å…¥çš„åŸå¸‚çˆ¬å–è¯¥åŸå¸‚çš„å½“æ—¥å¤©æ°”çš„è¯¦ç»†æƒ…å†µã€‚ #å°†è¾“å…¥çš„æ±‰å­—ç”¨Pinyinè½¬åŒ–ä¸ºæ‹¼éŸ³å­—ç¬¦ä¸² city_pinyin=p.get_pinyin(sentence,'') #é€šè¿‡'https://www.tianqi.com/'+åŸå¸‚çš„æ‹¼éŸ³åå³å¯è®¿é—®ç›®çš„åŸå¸‚å¤©æ°” try: url = 'https://www.tianqi.com/'+city_pinyin r = urllib.request.Request(url=url, headers=headers) except urllib.error.URLError as e:#æŸ¥æ‰¾å¤±è´¥ return \"æŠ±æ­‰å“ˆï¼Œæ‰¾ä¸åˆ°ä½ æ‰€è¾“å…¥çš„åŸå¸‚\" #æŸ¥æ‰¾æˆåŠŸï¼Œåˆ©ç”¨beautifulsoupä¾æ¬¡æŸ¥æ‰¾è¦æ‰¾å‡ºçš„ä¿¡æ¯ weather.append(soup.select(...)[0].text) webå‰ç«¯èŠå¤©æœºå™¨äººçš„å‰ç«¯æ•ˆæœå¦‚ä¸‹æ‰€ç¤ºï¼š è¾“å…¥æ¡†æ¯æ¬¡æŒ‰ä¸‹æŒ‰é’®â€™å‘é€â€™ï¼Œä¸”è¾“å…¥æ¡†ä¸ä¸ºç©ºæ—¶ï¼Œå³å¯å‘æœºå™¨äººå‘é€ä¸€æ¡æ•°æ®ã€‚ &lt;div class=\"b-footer\"&gt; &lt;input type=\"text\" name=\"text\" id=\"f-left\" placeholder=\"è¾“å…¥ä½ æƒ³è¯´çš„è¯...\"/&gt; &lt;div id=\"btn\"&gt;å‘é€&lt;/div&gt; &lt;/div&gt; å¯¹è¯æ¡† å‘é€å®Œä¿¡æ¯åï¼Œåœ¨å¯¹è¯æ¡†å¼¹å‡ºè¯¥æ¡æ–‡æœ¬ï¼Œåœ¨æœºå™¨äººæ­£åœ¨ç”Ÿæˆå›ç­”æ—¶æ˜¾ç¤ºåŠ è½½åŠ¨ç”» $(\".b-body\").append(\"&lt;div class='mWord'&gt;&lt;span&gt;&lt;img src=\\\"p1.png\\\" /&gt;&lt;/span&gt;&lt;p&gt;\" + text.val() + \"&lt;/p&gt;&lt;/div&gt;\"); //åœ¨å¯¹è¯æ¡†'b-body'ä¸­å°†è¾“å…¥ä¿¡æ¯ä»¥mWordçš„æ ¼å¼æ·»åŠ æ–°çš„Divæ ‡ç­¾ï¼Œå†…å®¹åŒ…å«è¾“å…¥çš„æ–‡æœ¬ä¿¡æ¯å’Œå¤´åƒå›¾ç‰‡ $(\".b-body\").append(\"&lt;div class='wait'&gt;&lt;span&gt;&lt;img src=\\\"p2.png\\\" /&gt;&lt;/span&gt; &lt;p&gt;&lt;/p&gt;&lt;div class='Ball'&gt;&lt;/div&gt;&lt;/div&gt;\"); //æ˜¾ç¤ºåŠ è½½åŠ¨ç”» $(\".b-body\").scrollTop(10000000); //å°†å¯¹è¯ç•Œé¢æ‹‰åˆ°é¡µé¢æœ€ä¸‹æ–¹æ˜¾ç¤ºæœ€æ–°å¯¹è¯ æœºå™¨äººå°†å›å¤ä¿¡æ¯è¿”å›å‰ç«¯ function(result) { $('.wait').remove();//åˆ é™¤åŠ è½½åŠ¨ç”»æ ‡ç­¾ if(result[0]=='&lt;')//è¿”å›çš„å†…å®¹ä¸ºå¯ä»¥ç‚¹å‡»è·³è½¬çš„é“¾æ¥æ ¼å¼ $(\".b-body\").append(\"&lt;div class='rotWord'&gt;&lt;span&gt;&lt;img src=\\\"p.png\\\"/&gt;&lt;/span&gt; \" + result + \"&lt;/div&gt;\"); else//è¿”å›çš„å†…å®¹ä¸ºæ™®é€šæ–‡æœ¬ $(\".b-body\").append(\"&lt;div class='rotWord'&gt;&lt;span&gt;&lt;img src=\\p.png\\\" /&gt;&lt;/span&gt; &lt;a id='member'&gt;\" + result + \"&lt;/a&gt;&lt;/div&gt;\"); $(\".b-body\").scrollTop(10000000); } æ—¶é—´ä¿¡æ¯ æ¯éš”ä¸€åˆ†é’Ÿæ˜¾ç¤ºä¸€æ¬¡å½“å‰æ—¶é—´ä¿¡æ¯ï¼Œå¦‚å›¾æ‰€ç¤ºï¼š function setDate(){ d = new Date(); if (m != d.getMinutes()) {//mä¸ºå·²è®°å½•çš„æ—¶é—´ä¿¡æ¯ï¼Œåœ¨å¯¹è¯æ—¶æ¯åˆ†é’Ÿæ›´æ–°mï¼Œåœ¨å¯¹è¯æ¡†ä¸­æ˜¾ç¤ºå½“å‰æ—¶é—´ m = d.getMinutes(); $(\".b-body\").append('&lt;div class=\"timestamp\"&gt;' +'-------'+ d.getHours() + ':' + m +'-------'+ '&lt;/div&gt;');} } CSSæ¸²æŸ“ é™æ€æ¸²æŸ“ï¼š èƒŒæ™¯å’Œæ–‡æœ¬æ¡†çš„æ¸å˜è‰² è¾¹æ¡†åœ†è§’æ•ˆæœ aå¯¹è¯æ¡†åŠé€æ˜æ•ˆæœ é˜´å½±æ•ˆæœ background: -webkit-linear-gradient(0, #xxx 0, ..., #xxx 100%);/*æ¸å˜æ•ˆæœ*/ color: rgba(55, 55, 55, 0.3);/*0.3ä¸ºé€æ˜åº¦*/ border-radius: 15px;/*åœ†è§’æ•ˆæœ*/ box-shadow: 10px -5px 20px 10px #xxx;/*é˜´å½±æ•ˆæœ*/ åŠ¨æ€æ¸²æŸ“ åŠ è½½åŠ¨ç”»,å¾ªç¯æ’­æ”¾ä¸‰ä¸ªè·³åŠ¨çš„ç‚¹ .dot { /*åŸºæœ¬å±æ€§*/ animation: pulse-outer 7.5s infinite ease-in-out;/*åŠ¨ç”»å½¢å¼*/ } .dot:nth-child(2) {/*ç¬¬äºŒä¸ªç‚¹*/ left: 65px;/*åç§»*/ animation: pulse-inner 7.5s infinite ease-in-out; animation-delay: 0.2s;/*åŠ¨ç”»å»¶è¿Ÿ*/ } /*ç¬¬ä¸‰ä¸ªç‚¹...*/ @keyframes pulse-outer { 0% { transform: scale(1); } ... 100% { height: 17.5px; } } æ–°æ¶ˆæ¯å¼¹å‡ºåŠ¨ç”»ï¼šåœ¨äº§ç”Ÿæ–°å¯¹è¯æ—¶ï¼Œå¯¹æ–°å¼¹å‡ºçš„æ–‡æœ¬æ¡†è¿›è¡Œä¸€æ¬¡ç¼©æ”¾ï¼Œå®ç°å¼¹å‡ºçš„æ•ˆæœ .Word{ transform: scale(0); transform-origin: 0 0; animation: bounce 350ms linear both; } @keyframes bounce { 0%{transform:matrix3d(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1); } ... 100%{transform:matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1); } } åŠ¨æ€LOGOï¼šå‚è€ƒäº†Dribbbleçš„æ¨¡å‹ å…¶ä»– echartsæŸ±çŠ¶å›¾ åˆ©ç”¨äº†echartsæ¨¡å‹ï¼Œå½“è¯¢é—®æ–°å† ç–«æƒ…çš„ä¿¡æ¯æ—¶ï¼Œå¯ä»¥å¼¹å‡ºå¦‚å›¾æ‰€ç¤ºæŸ±çŠ¶å›¾ï¼Œæ›´ç›´è§‚åœ°è§‚å¯Ÿæ•°æ® åŠ¨æ€è·³è½¬æŒ‰é’® å¯¹äºä¸€äº›å®æ—¶ä¿¡æ¯çš„æŸ¥è¯¢ï¼Œä¸ºäº†æ–¹ä¾¿è¿›ä¸€æ­¥äº†è§£è¯¦æƒ…ï¼Œæ·»åŠ å¯ä»¥è·³è½¬çš„æŒ‰é’® $(\"#btn2\").click(function() { if(is_ask==1)//æ­£åœ¨æŸ¥è¯¢ä¿¡æ¯ window.location.href=\"https://xxx\";//åœ¨æ–°æ ‡ç­¾é¡µæ‰“å¼€é“¾æ¥ else location.reload([bForceGet]); //åœç•™åœ¨åŸé¡µé¢ }); å‰åç«¯äº¤äº’èŠå¤©æœºå™¨äººå‰åç«¯çš„ä¿¡æ¯äº¤äº’å’ŒåŒæ­¥éƒ¨åˆ†æ˜¯é€šè¿‡Flaskæ¡†æ¶å’ŒAjaxï¼ˆå¼‚æ­¥JavaScriptå’ŒXMLï¼‰å®ç°çš„ã€‚æ•°æ®äº¤äº’çš„åŸºæœ¬æ¨¡å¼å¦‚ä¸‹ï¼š Javascriptéƒ¨åˆ†: $(\"#btn\").click(function() { chatbot(); }); //æ¯æ¬¡æ£€æµ‹åˆ°\"å‘é€\"æŒ‰é’®æŒ‰ä¸‹ä¸”è¾“å…¥ä¸ä¸ºç©ºæ—¶è§¦å‘ function(){ var args= {url: \"url\",//ä¸pythonå‡½æ•°å¯¹åº”çš„\"URL\"ç›¸åŒ type: \"GET\",//\"GET\"æˆ–\"POST\" //\"GET\"ç”¨äºåç«¯å‘å‰ç«¯å‘é€ä¿¡æ¯,\"POST\"ç”¨äºå°†è¾“å…¥çš„æ–‡å­—ä¼ åˆ°åç«¯ success:function(result) {options();}} $.ajax(args); } pythonéƒ¨åˆ†ï¼š @app.route('/url') def get_data(): data=func() return data @app.route('/') @app.route('/index') def index(): return render_template('index.html') //é»˜è®¤æ˜¾ç¤ºçš„ä¸»é¡µ å½“ç”¨æˆ·åœ¨å‰ç«¯è¾“å…¥æƒ³è¦å¯¹æœºå™¨äººè¯´çš„è¯ï¼Œä¾¿å¯åˆ©ç”¨JSä¸­çš„Ajaxå·¥å…·å‘åç«¯ä¼ è¾“æ•°æ®ï¼Œå¹¶è·å–åç«¯å‘çš„æ•°æ®è¿”å›åˆ°èŠå¤©æ¡†ä¸­ï¼Œè¿™æ ·å°±å®Œæˆäº†ä¸€ç»„å¯¹è¯ï¼›å¦å¤–ï¼Œå¯¹äºæ–°å† ç–«æƒ…ç¡®è¯ŠæŸ±çŠ¶å›¾çš„æ›´æ–°ï¼Œä¹Ÿæ˜¯é€šè¿‡Ajaxå°†çˆ¬å–åˆ°çš„æ•°æ®ä¼ å…¥JSçš„å‡½æ•°ä¸­å®Œæˆçš„ã€‚","categories":[{"name":"CSII","slug":"CSII","permalink":"http://sn1987a-1.github.io/categories/CSII/"}],"tags":[{"name":"chatbot","slug":"chatbot","permalink":"http://sn1987a-1.github.io/tags/chatbot/"}]},{"title":"ChatBot","slug":"CSII","date":"2022-04-26T07:35:11.000Z","updated":"2023-09-23T13:14:52.332Z","comments":true,"path":"posts/26753.html","link":"","permalink":"http://sn1987a-1.github.io/posts/26753.html","excerpt":"","text":"the design of CHatBotsome resourcesGPT-2 ä¸­æ–‡æ–‡æœ¬ç”Ÿæˆ Re-Subjectï¼š é‡‡ç”¨æ­¤ç»„åˆä¸ºä¸»è¦çš„å‚è€ƒå†…å®¹ï¼Œå…¶ä»–çš„ä¸ºè¾… https://github.com/yangjianxin1/GPT2-chitchat ï¼ˆè¿‘æœŸä¹Ÿåœ¨å¼€å§‹ç¢ç£¨è¿™ä¸ªé¡¹ç›®ï¼‰ ä½¿ç”¨æŒ‡å—è§ï¼šGPT-2ç”Ÿæˆå¼å¤šè½®å¯¹è¯å…¥é—¨â€”â€”-æ·±å…¥ç†è§£â€œç”¨äºä¸­æ–‡é—²èŠçš„GPT2æ¨¡å‹â€é¡¹ç›®_ä¸‰é‡æç®€çš„åšå®¢-CSDNåšå®¢_gpt2 https://github.com/thu-coai/CDial-GPTã€[è®ºæ–‡](GPT.pdf)ã€‘ https://github.com/Morizeyao/GPT2-Chineseã€ä¿¡åº¦é«˜ã€ä½“é‡å¤§ / ç›¸å…³é¢å¹¿ï¼Œä¸‹è¾–å¯é€‰é¡¹å¤šã€‘ hughqiu/GPT2-Chinese: Chinese version of GPT2 training code, using BERT or BPE tokenizer. (github.com) ã€ä¸­æ„ã€‘ ä½¿ç”¨æŒ‡å—è§ï¼šGPT-2ä¸­æ–‡æ–‡æœ¬è®­ç»ƒåŠç”Ÿæˆ_æ˜¯æœ¨å­å•¦~çš„åšå®¢-CSDNåšå®¢_gpt2ä¸­æ–‡ç”Ÿæˆ æ•°æ®é›†æ¥æºï¼š å¤§è§„æ¨¡ä¸­æ–‡è‡ªç„¶è¯­è¨€å¤„ç†è¯­æ–™ Large Scale Chinese Corpus for NLP (github.com) THUCTC: ä¸€ä¸ªé«˜æ•ˆçš„ä¸­æ–‡æ–‡æœ¬åˆ†ç±»å·¥å…· (thunlp.org) the part Iâ€™m responsible forFront-end developmentuse HTML,css,jsâ€¦ there are several ideas I come up with. the basic chat frame the easy animination the loading animination(write a javascript function to generate a â€œdivâ€ when clicked and remove it after calculating) show time once a minute so onâ€¦ it seems this part has been finished still need to combine it with others code the animination in the left is inspired by https://copepen.io patterned answersuse regular expressions or import jieba to deal with the input(jieba can deal the input in a loop) write a crawler to get the current information like the weather â€¦ import some database like wikipedia reference: https://github.com/brightmart/nlp_chinese_corpus#readme keep on learningâ€¦","categories":[{"name":"CSII","slug":"CSII","permalink":"http://sn1987a-1.github.io/categories/CSII/"}],"tags":[{"name":"ä¸“ä¸šè¯¾","slug":"ä¸“ä¸šè¯¾","permalink":"http://sn1987a-1.github.io/tags/%E4%B8%93%E4%B8%9A%E8%AF%BE/"}]},{"title":"Knowledge Framework of OS PART II CH3","slug":"OS_notes2","date":"2022-03-07T07:35:11.000Z","updated":"2023-09-23T13:15:15.612Z","comments":true,"path":"posts/22413.html","link":"","permalink":"http://sn1987a-1.github.io/posts/22413.html","excerpt":"","text":"Part IIProcess Concept &amp; OperationsConcepts of Process the building of processing Pre-processor:like #define,#include â€”-try â€œgcc -E hello.câ€ Compiler and Optimizer compiler:Syntax checking and analyzing if no syntax:construct the intermediate codes i.e,assembly Optimizer :optimize the codes check the parameter of gcc Assembler and Linker assembler assembles hello.s and generate hello.o the linker puts together the objects files as well as library files compile multiple files? makefile What is a processprocess in memorya program is a program in execution a executable file load into mermory is Active process in memory : text section:program code stack heap data section program counter content of register process state a process executes changes states: new runnig waiting :for I/O readyâ€”need CPU resources terminated the state diagram and the switch between graph LR A[new]--admitted--&gt;B[ready] C[wait]--I/O or event completion--&gt;B D[running]--interrupt--&gt;B D--I/O or event wait --&gt;C B--scheduler dispatch--&gt;D D--exit--&gt;E[terminated] PCBâ€”process structureHow to locate /represent a process PCB:process control block or task control block program state program counter CPU registers CPU scheduling information memory-management information I/O status information Accouting informationprocess data structure in Linux represents by struct task_struct in C the relationship between program data&amp; PCB Conclusion on â€œwhat is a processâ€ a program in execution only one process can be running on any processor at any instant two processes maybe associated with one program a process can be an execution environment for other codes. Process Operationsprocess:all the files,memory,accouting information a system must provide the mechanism for:process identification,process creation,process execution,process termination some basic system calls: getpid(),fork(),exec*(),wait(),exit() Process identification each process was given a unique id:process ID,PID use getpid() #include â€˜.â€™:å½“å‰ç›®å½• use getpid()to check a program several times:get different PIDProcess creation a process may create several new processes parent process and chidren process the first process(the kernel runs when booting up)â€”-init PID=1,is running the program code â€œ/sbin/initâ€ the first task is to create more processes tree hierarchy all the process form a tree hierarchy program blossoming:command to view tree: â€œpstreeâ€ or â€œpstree -Aâ€â€”-for ascii-character-only on display the termination can be happen at any time:the parent terminate before the children:turn a tree hierarchy to a forest(a process become a orphan) orphan process may make a differenceâ€¦become a tree ,and when it terminate nobody will know? solve orphan process:re-parent operation the relationship between parent and children resource sharing options:all/subset/no execution options:execute concurrently/parent wait for children address space options:a duplicate of parent/a new program loaded into it to create :system call fork() printf(...getpid()..);fork;print(...getpid());:you will get three result(like 1234,1234,1235,not always cPID=pPID+1) the last print executed twice the fork():the parent and children executes the same codes,but not the same start:the children starts where the fork()is returned,the result of fork()will not loaded into children. the parent process will run first,using the same files like program counter and I/O devicesprogram execution fork( ) can only duplicate and run the same programâ€”â€”-use exec( ) execl( ) : a member of the exec() system call family(the family has 6 members),as an example example: â€¦. execl(â€œ/bin/lsâ€,â€/bin/lsâ€,NULL);â€¦. it means â€œlsâ€/or â€¦ execl(â€œ/bin/lsâ€,â€bin/lsâ€,â€-lâ€,NULL) $1^{st}$ argument:the program name $2^{st}$ argument:the first argument to the program $3^{rd}$ argument:the second argument to the program $4^{th}$ argument:indicate the end of list of arguments the word after this function will not be executed anywayâ€”â€”-no new process will be created and the PCB will not change ,but the code will be replaced,it will run till meeting â€œexit()â€,and will not return the former program ,losing many data as well note: fork() vs exec() fork()+exec()=?â€”(duplicate and then replace,the children will use exit(-1)to terminate)â€” write a system( ) library callâ€”â€”it will cause problem:the parents will first termination(actually cannot predict which will execute) fork()+exec() is not enough ,use system call fork()+exec()+wait(): â€œsuspend the executions of parent processæŒ‚èµ·çˆ¶è¿›ç¨‹â€â€wake the parent up after the childern is terminatedå”¤é†’â€ about wait() when to wake up: when one of the child processes changes from running to terminated does not suspend the calling process wait():usage: wait(NULL),has many cases while using case 1:the wait()system can suspend the calling parent process case 2: the parent will not suspend if there is no child process or there no running child process(still need time) more powerful wait?needs to wait for a particular child or detect child status changing(wait()can only waits for ant of the child and detect the status termination only) waitpid()â€”-read the man pages. program termination make a summarya process is created by cloning fork() :cloning is copying exec() wait()&amp;waitpid() the program exection is fundamental ,but not trivial:process is the place that hots a program and run it,and the exec*()changed the program the process is running,a process can run more than a program From Kernel Perspcetivedual modekernel-space &amp; user-space: kernel-space user-space stored what kernel data structure,kernel program,driven devices process memory,program code of the porcess accessed by whom kernel code user program &amp; kernel code a program will switch its execution from user mode and kernel mode (example : getpid() need to execute system call) user time &amp; system time user time : time spend on codes in user-space memory system time : time spend on codes in kernel-space memory total tunning time:user time + kernel time use tool: time(time ./filename): total/user/sys time the system callfork()fork behaved like cell division it create the child process by â€œcloningâ€ form the parent process,including: program counter :CPU register ï¼Œthat is why they both execute from the same line of code after fork() returns Program code memeory opened files(kernelâ€™s internal) does not clone: PID return value of fork() parent process running time:just created ,is 0 action: the startâ€”kernel-space updateâ€”user-mode update â€”-finish kernel-space updates: the running time will reset to 0 update pid the paretnt will have a new child and the child will have a pointer to its parent. user -space update: copyingâ€¦ array of opened files : array index: 0â€” standard of input stream :file *stdin 1â€” standard of output stream :file *stdout 2â€” standard error stream:file *stderr 3/beyondâ€” storing the file you opened,e.g,fopen(),open,etc thatâ€™s why the parents process shares the same terminal output system with the child process exec*()action:start,end process itself does not change user-space memory: local veriable,dynamically-allocated memory will be cleared,and the global variable will reset based on new code,code + constant will changed to new program code (**)wait() \\&amp;exit()exit()â€”â€”child side : not really remove the child process ,remain the entry of the child in the process table(template state) The child is now called zombie. Its storage in the kernel-space memory is kept to a minimum The PID (1235 in this example) and process structure are owned by the child. wake up the parent: The kernel notifies the parent of the child process about the termination of its child. The notification is a signal called SIGCHLD. signal: â€¢ What is signal? â€“ A software interrupt â€“ It takes steps as in the hardware interrupt â€¢ Two kinds of signals â€“ Generated from user space â€¢ Ctrl+C, kill() system call, etc. â€“ Generated from kernel and CPU â€¢ Segmentation fault (SIGSEGV), Floating point exception (SIGFPE), child process termination (SIGCHLD), etc. â€¢ Signal is very hard to master, will be skipped in this course â€“ Reference: Advanced Programming Environment in UNIX â€“ Linux manpage summary exit() Step (1) Clean up most of the allocated kernel-space memory. Step (2) Clean up all user-space memory. Step (3) Notify the parent with SIGCHLD Although the child is still in the system, it is no longer running. There is no program code!!! It turns into a mindless zombieâ€¦ wait()â€”â€”parent side: see the SIGCHLD signal and handle it. The kernel sets a signal handling routine (and it is a function pointer) to the process. That signal handling routine will be executed when SIGCHLD comes. By default, every process does not respond to the SIGCHLD signal (the signal handlers are set only when wait() is called). When SIGCHLD comes, the signal handling routine is invoked! Note: since the parent is still inside the system call, instead of the original program code, the parent process is still blocked in some senseâ€¦ Default Handling of SIGCHLD Accept and remove the SIGCHLD; Destroy the child process that sends her the signal. case 2-â€”the wait() is called after the child already termintated,which is safe in case 2,the SIGCHlD is also sent to parent before,and when the wait() is called ,it can return and kill the child process completely. short summary of exit() &amp;wait() A process is turned into a zombie whenâ€¦ The process calls exit(). The process returns from main(). The process terminates abnormally. You know, the kernel knows that the process is terminated abnormally. Hence, the kernel invokes exit() by itself. Remember why exec*() does not return to its calling process in previous exampleâ€¦ wait() is to reap zombie child processes You should never leave any zombies in the system. Linux will label zombie processes as &lt;defunct&gt;. To look for them:ps aux | grep defunct Learn waitpid() by yourselfâ€¦? If a orphan does not have a parent wait() when terminateâ€”may init a new parent . the role of wait() in the OS: Why calling wait() is important â€“ It is not about process execution/suspensionâ€¦ â€“ It is about system resource management. Think about it: â€“ A zombie takes up a PID; â€“ The total number of PIDs are limited; â€¢ Read the limit: â€œcat /proc/sys/kernel/pid_maxâ€ â€“ What will happen if we donâ€™t clean up the zombies? summaryconcepts: process data &amp; memoty PCB+ user-space mermory operations fork() exec*() wait()+exit()â€”â€”come together , calling wait() is imporrtant so..what is the kernel doing?â€¦ ThreadsThreadMotivation of Multi-Threading and ConceptsThread concepts:why use , structure in memory, benefits and challenge, thread models Progreamming :Basic programming;implicit threading motivation: application side:most software applications are multithreaded,each application is implemented as a process with several threads of control.(web browser or wiord processor) still remember what kind of data are include in a process: text data,statck,heap inuser-space memory PCB in kernel-space memory system side:modern computers usually contain multicores,but each processor can run only one process ata time,so to improve the efficiency: assign one task to each core real parallelism the process cannot visit another processâ€™s data and memory concurrency vs. parallelism internalsCode: all the threads use the same code. a thread starts with onr specfic functionâ€”â€”named it the thread function a thread function can invoke other functions or system calls a thread could never return to the caller of the thread function Global variables: all thread share the same global variable zone and the same dynamically allocated memory all thread can read from and write to Local variables: each therad has its own memory range for local variable so the stack is a private zone Benefits allow an application to do parallel tasks simulaneously ease in data sharing peocess share resources via shared memory or message passing Economy allocation memory and resources for process creations is costly ,dozens of time tha creation threadsâ€¦ context-switch between processes is also costly,several times of slower Scalablilty: thread may be running in parallel on different cores programming challenges indentifying tasks: divide seperate and concurrent tasks balance: tasks should perform equal work of equal value data splitting: data must be divided to run on seperate cores tdata dependency:synchronization is needed testing and debugging Thread modelsthread should include : data/resources in user-space memory structure in kernel provide thread support: user thread: implement in user space kernel thread: supported and managed by kernel 1.many-to-one models :(many in user space and one in kernel) all the threads are mapped to one process structure in the kernel easy for the kernel to implement drawback:when a blocking system call is called ,all the thread will be blocked old UNIX &amp; green thread 2.one-to-one each thread is mapped to one process structure in the kernel a high degree of concurrency drawback: cannot create too many threads as it is restricted by the size of the kernel memory most Linux and Windows a process ,without multi-threading,is actually one thread for the scheduler.(when the schduler interets in process / thread) 3.many-to-many model avoid drawbacks in many-to-one and one-to-oneâ€”â€”cannot be blocked , have a high degree of concurrency but most OS does not use man-to-many model(the drawback of one-to-one is not fatal) Basic ProgrammingThread libraryâ€”â€”-provide the programmer with an API for creating and managing threads. three main library threadings: POSIX Pthreads(user level or kernel level) Windows (kernel level) Java(implements using Windows API or Pthreads) creating multipule threadsasynchronous threading parent resumes execution after creating a child parent and child executes concurrency each thread run independently synchronous threading fork-join strategy : parents wait for children to terminate significant data sharing Pthreads: process is similar to thread process thread creation fork() pthread_create() I.D. type PID,an integer â€œpthread_tâ€,a structure who am i? getpid() pthread_self() wait for the child termination wait() or waitpid() pthread_join() terminaion exit() pthread_exit() kill? kill() pthread_kill() issue 1:create thread int main(void) pthread_t tid; pthread_create(&amp;tid,NULL,hello,\"hello world\");//å‡½æ•°åå’Œå‡½æ•°éœ€è¦çš„å‚æ•° pthread_join(tid,NULL); return 0; } void *hello (void * input) { printf(\"%s\",(char*)input); pthread_exit(NULL); } issue 2: passing parameter: local variable can be changed â€”-the stack of the new thread is on the same piece of the user-space memory as the main thread,not a new process,the pthread_create only create an address to the new thread ,the address is a pointer pointing to a variable stack of the main thread. issue 3:multiple threads: pthread_t tid[5]; for(i=0;i&lt;5;i++) pthread_create(tid[i],NULL,xxx,xxx); for(i=0;i&lt;5;i++) pthread_join(tid[i],NULL); issue 4: return valueâ€”-thread termination ,passing return value. void do_your_job(void *input){ ... *output=.....; pthread_exit(output); } ... pthread_join(tid,(void**)output); other threading â€” windows thread or java threads. Implicit Threading applications are containing hundreds or even thousands of threads program correctness is more difficult with explicit threads how to address the programming difficulties? transfer the creation and managements of the threadings from programmers to compliers and run-time libraries implicit threading two methods 1.thread pools 2.OpenMP !!!thread poolsproblem with multithreaded servers time required to create threads,which will be discarded once completed their work unlimited threads could exhaust the system resources solve: thread pool idea:create a number of threads in a pool where they wait for a work procedure: awaken a thread if necessary returns to the pool after completion wait until one becomes free if the pools cpntains no available thread advantages usually sightly faster to service a request with an existing thread than create a new thread allow the number of threads in the applications to be bound to the size of the pool OpenMPprovides supports for parallel programming in shared-memory environments set of compliers directives and an API for C,C++,FORTRAN Threading Issuessemantics of fork() and exec()1.fork():some UNIX has two versions: the new process duplicates all threads duplicates only the thread that invokes fork() exec(): usually work as normal: replace the running process ,includind all threads 2.signal handling signals are used in UNIX systems to notify a process that a particular event has occurred asnychronous signal and synchronous signal default handler or user-defined handler where should a signal be delivered in multi-thread program? to the thread signal applies all the threads a certain thread assign a specific thread to receive all the signals of all the threads deliver a signal to specific thread to receive all the signals for the process 3.thread cancellation terminating a thread before it has finished two genernal approaches: asynchronous cancellation terminates the target thread immediately problem:troublesome then updating data defferred cancellation:allow the target thread to periodically check if it should be cancelled(can be cancelled safely) three models: asynchronous,defferred,off(disabled cancellation) default : defferred 4.thread-local storage some applications ,each threads may needs its own copy of certain data. thread-local stroage:TLS TLS is visible across function invocations similar to static data TLS data are untique to each thread summary of thread virtually all morden OSes support multi-threading a thread is a basic unit of the CPU utilization each comprises a thread ID,a program counter,a,register set,a stack all the threads within a process share code section ,data,section,other resources like openfiles and signals take great care when writing multi-threaded programs,and alsoâ€” mutual exclusion synchronization Process communication &amp; Synchronizationthe processes within a system may be independent cooperating any process that shares the data is a cooperating process interprocess communication â€”-IPCtwo models: shared memory message passing IPC is used for exchanging data between processes cooperating processes need IPC for exchanging data two nodelsï¼š shared memory establish a shared memory region,read/write to share region accesses are treated as routine memory accesses faster producer-consumer problem a buffer os needed to allow processes to run concurrently the requirement: a buffer is a shared object,and is a queue problem: when producer wants to put anew item but the buffer is already full solution: the producer need to suepended ,and the consumer should wake the producer up after it has dequeue an item problem: when comsumer wants to dequeue an item but it is empty solution: the consumer is suspended and the producer should wake the cinsumer upâ€¦ a producer process produces a unit of data ,and writes that a piece of data to the tail of the buffer a consumer process removes a unit of data from the head of the bounded buffer at one time message passingneed a message queue to exchange communictating processes may reside on different computer conntected by a network IPC provide : send+receive exchange message require kernel intervention easier to implement in a distributed system if two process wish to communicate,they need: establish a communication link between exchange messages via send/receive issues: naming: direct/indirect direct: opreations: send and receive properties of indirect communication allow a link to be associated with at most two processes allow one process at a time to execute a receive opreation allow the system to select arbitrarily the receiver ,and sender is notified who the receiver is the mailbox is owned by the process (ownership may be passed)and the OS(neede a method to create ,send/receive.delete) synchronization : synchronousâ€” blocking/asynchronousâ€” non- blocking dofferent combinations :1.when the send and the receive are blocking , we have a rendezvous between the processes; 2. other conbinations need buffering buffering messages reside in a temporary queue , whic can be implemented in three ways: zero capacityâ€”no message qre queued, sender must wait for the receiver(no buffering) bounded capacity â€” finite length of n mesages,sender must wait if link is full undounded capacity - infinite length,sender never waits POSIX shared memoryPOSIX shared memory is orgranized using memory-mapped file,associate the region of shared memory with a file. illustrate wth the producer-consumer problem: producer create a shared memory object shm_fd=shm_open (name,O_CREAT |O_RDWR,0666);(perminssions ) configure object size ftruncate(shm_fd,SIZE); establish a memory-mapped file containing the object prtr mmap(0,SIZE,PORT_WRITE),MAP_SHARED,shm_fd,0);(changes to the shared-memory object) consumer open the shared-memory obect shm_fd=shm_open(name,O_RDONLY,0666); memory map the object ptr=mmap(0,SIZE,PORT_READ,MAP_SHARED,shm_fd,0); remove the shared memory object shp_unlink(name); Socketsa sockets is defined as an endpointer for communication(over a network) a pair of processes employ a pair of sockets a socker is indentified by an IP address and a port number all ports below 1024 are used for standard services telnet server listens to port 23 FTP server:port 21 HTTP server :port 80 Socket uses a client-server architecture server waits for incoming client request by listening to a specific port accepts a connection from the client socket to complete the connection all connection must be unique(establishing a new connection on the same host needs another port&gt;1024) special IP address 127.0.0.1(loopback)refers to itself PipesPipe ia a shared memory using pipes is a way to realize IPC acts as a conduit two processes to communicate issues : communication: unidirectional/bidirectional half/full duplex must the relationship exists between the communicating processes pipes used over a network two common pipes: ordinary pipes and named pipes ordinary pipes no name in file system only used for related process(parent-child relationship) unidirectional ceases to exit after communication has finished allow communication in standard producer-consumer style producer write to one end and the consumer reads from the other end UNIX pipe UNIX treats a pipe as a special file (child inherits it from parent) create : pipe(int fd[]);fd[0]-read end,fd[1]-write end create accesses the ordinary read(),write()system calls fork() duplicates parentâ€™s file descriptors,and parents and child use each end of the pipe pipes are anonymous named pipes UNIX treats as typical file:mkfifo(), open(), read (), write(),close() no parent-child relaitionship is necessary(or processes must reside one the same machine) several processes can use the named pipes for communication continue to exist communication is bidiectional(still half-duplex) è¯¾ç¨‹ä¸»é¡µ ä¸»è§‚é¢˜è§„èŒƒï¼šé€»è¾‘/è¯­è¨€è§„èŒƒ","categories":[{"name":"OS","slug":"OS","permalink":"http://sn1987a-1.github.io/categories/OS/"}],"tags":[{"name":"ä¸“ä¸šè¯¾","slug":"ä¸“ä¸šè¯¾","permalink":"http://sn1987a-1.github.io/tags/%E4%B8%93%E4%B8%9A%E8%AF%BE/"}]},{"title":"Knowledge Framework of OS PART I CH1&CH2","slug":"OS_notes","date":"2022-02-28T14:52:11.000Z","updated":"2023-09-23T13:15:19.112Z","comments":true,"path":"posts/28913.html","link":"","permalink":"http://sn1987a-1.github.io/posts/28913.html","excerpt":"","text":"Knowledge Framework of OS :PART I CH1&amp;CH2textbook: Operating System Concepts 10th Edition check course home : http://staff.ustc.edu.cn/~ykli/os2022 ch1 Overview of an Operating Systemsystem organizationcomputer-system organization One or more CPUs, device controllers connect through common bus providing access to shared memory Concurrent execution of CPUs and devices competing for memory cycles I/O devices and the CPU can execute concurrently Each device controller is in charge of a particular device type Each device controller has a local buffer CPU moves data from/to main memory to/from local buffers Device controller informs CPU that it has finished its operation by causing an interrupt computer start-up bootstrap program (å¯åŠ¨ç¨‹åº)is loaded at power-up or reboot (firmware) System processes or system daemons After fully booted, waits for events to occur â€“ Signaled by interrupt interrupt handling :can be triggered by hardware and software: Hardware sends signal to CPU Software executes a special operation:system call procedure :CPU stop-&gt;executes the service routine-&gt;CPU resumes operating system is interrupt driven interrupt architecture must save the address of the interrupted instruction interrupt timeline: Interrupt transfers control to the interrupt service routine . A table of pointers to interrupt routines, the interrupt vector,can be used to provide necessary speed .The table of pointers is stored in low memory. Storage Structure Main memory :random access,typically small size and volatile(æ˜“å¤±æ€§) Instruction-execution cycle 1.Fetch an instruction from memory and store in register â€“ Decode instruction (fetch operands if necessary) 2. Store result back to memory Secondary storage â€“ extension of main memory that provides large nonvolatile storage capacity (like heard disks ,solid-state disksâ€”faster and nonvolatile) cachingâ€”small ,important principle,in hardware ,opearting system,software. I/O structure:interrupt driven Direct Memory Access Structure:Device controller transfers blocks of data from buffer storage directly to main memory without CPU intervention,one interrupt per block System Architecture(å¤„ç†å™¨)CPUâ€”most use a single general-purpose processor Multiprocessors system:parallel systems,multicore systems, advances:Increased throughput;Economy of scale;Increased reliability two types: SMP:symmetric multiprocessing,all processors are peers AM:asymmetric multiprocessing,boss-worker relationship Multicore:: include multiple cores on a single chip .More efficient and less power distinguish:multicore &amp;SMP,multicore is more efficient but costs more. Clustered Systems:multiple systems working together â€‹ -SAN:storage-area network â€‹ -some are HPC:high-performance computing â€‹ -DLM:distributed lock manager,to avoid conflicting Soâ€¦ Where is the OS? Four components of a computer system â€“ Hardware â€“ provides basic computing resources (CPU, memory, I/O devices) â€“ Users: People, machines, other computers â€“ App. programs â€“ define the ways in which the sys. resources are used to solve the computing problems â€‹ â€¢ Word processors, compilers, web browsers, database systems, video games, etc. â€“ Operating system â€‹ â€¢ Controls and coordinates use of hardware among various applications and users What is the OS? â€¢It stands between the hardware and the user. â€“ A program that acts as an intermediary between a user of a computer and the computer hardware â€¢ Operating system goals: â€“ Execute user programs &amp; make solving user problems easier â€“ Make the computer system convenient to use â€“ Use the computer hardware in an efficient manner â€“ Design tradeoff between convenient and efficiency â€¢ How good is this design? â€“ The user does not have to program the hardware directly â€¢ Processes as the starting point! â€“ Whatever programs you run, you create processes. â€‹ â€¢ i.e., you need processes to open files, utilize system memory, listen to music, etc. â€“ So, process lifecycle, process management, and other related issues are essential topics of this course What Operating Systems Do? system view control program resource alocator User view wanr convenience in use and performance usability ,battery life, resource utilization,tradeoffâ€¦ well..OS has no universalyy accepted defination Operating Systems OperationsOS Operationscontrol programs/resource allocator Mutliprogramming:needed for efficiency,job run via job scheduling Time sharing,åˆ†æ—¶æ“ä½œç³»ç»Ÿ,logical extension in which CPU switches jobs so frequently that users can interact with each job while it is running, creating interactive computing allow many user to share the computer issues:â€“ If several jobs ready to run at the same time:CPU scheduling . If processes donâ€™t fit in memory, swapping moves them in and out to run . Virtual memory allows execution of processes not completely in memory Interrupt Driven Mechanism (in Multiprogramming)software and hardware Hardware interrupt by one of the devices software :(exception or trap),needed to request for opaerating system service Dual-mode Operationå¤šæ¨¡å¼æ“ä½œ user mode or kernel mode,and transistion between them system callsystem call is similar to a function call ,but it is inside the OS,named OS kernel System calls are the programming interface between processes and the OS kernel System calls provide the means for a user program to ask the operating system to perform tasks A system call usually takes the form of a trap to a specific location in the interrupt vector, treated by the hardware as a software interrupt The system call service routine is a part of the OS usually primitive,important,fundamental(like time()system call) Roughly speaking, we can categorize system calls as follows: | Process | FileSystem | Memory || â€”â€”â€”â€” | â€”â€”â€”â€”â€” | â€”â€”â€” || Security | Device | | distinguish between system call and library function call(library file:in windows :DLL dynameically linked library ,in Linux SO,shared objects) OS standards: ProcessProcess vs ProgramA process is an execution instance of a program,a process is not bounded to execute just one program.A process is active and has its own local states command about processes like psâ€”report a vast amount of information about every process in system(try ps -ef) shellâ€”-a process launching pad System has many processes, some user, some operating system running concurrently Memory Java donâ€™t have the above layout,and C is too low Storage ManagementFile System,FS like FAT16, FAT32, NTFS, Ext3, Ext4, BtrFS a FS must record :directories,files,allocated,space,free space Two face of a file system:1.storage design of the file system.(how it stored)2.the opreations of the file systems operations:creating can be replaced by opening;copying can be replaced by read and write;moving can be replaced by rename(in one disks),so the necessary operations are open,read,write,close,rename,delete,.. A FS is independent of an OS,an OS can use many FS Kernal Data StructuresLists,Trees,Hash Map and Bitmaps MISCProtection and Security this course will discuss the security of File System Computing Environments trandition to mobile:IOS ,Android Distributed computing ,like networkTCP/IP Client-Server(C-S computing) Peer-to-Peer computingâ€”å»ä¸­å¿ƒåŒ– Virtualization Cloud Computing (è¾ƒæˆç†Ÿ) Real-Time Embedded Systems Open-sourced OS Open-Source Operating Systemsâ€”-GNU LINUX,BSD UNIX(including mac OS) summary OS Overview OS Concept Multiprogramming &amp; Multitasking Dual Mode &amp; System Call OS Components Process Management Memory Management Storage Management Computer System Organization &amp; Architecture Interrupt ch2 Operating System StructuresOperating System Services common classes :Convenience of the user and Efficiency of the system Operating systems provide an environment for execution of programs and services to programs and users User Operating System Interfaceexecution:1.Load a program into memory 2.run the program3.end execution(normally or abnormally) for Helping Users I/O operations File-system manipulation communications implementations:(shared memory and Message passing) error detection,error types error handlingfor Ensuring Efficiency for ensuring efficiency resource allocation accountingâ€”to keep track of usage (usage statistics) the protection and security for Helping Users user interface(UI) form: CLI(command line),Batch,GUI(Graphics User Interface) CLI:shells,two ways of implementing commands: 1.The command interpreter itself contains the code â€¢ Jump to a section of its code &amp; make appropriate system call â€¢ Number of commands determines the size of CLI 2.Implements commands through system program (UNIX) â€¢ CLI does not understand the command â€¢ Use the command to identify a file to be loaded into memory and executed â€¢ Exp: rm file.txt (search for file rm, load into memory and exe w/ file.txt) â€¢ Add new commands easily touchsreen interfaceâ€¦virtual keyboard?voice command System CallsProgramming interface to the service provided by the OS Each OS ha its own Program Call System Call &amp;&amp; function Why us API? for System Call,a simple program like copy may make heavy use of OS,and not user friendly Mostly accessed by programs via a high-level API rather than direct system call use,and is easy of use(Simple programs may make heavy use of the OS)Program portability(Compile and run on any system that supports the same API ) remember the logic relationship between API and Program calls API:application programming interface common APIs:Win32 API for Windows,POSIX API,JAVA API(JAM,java virtual machine) How to use API? 1.via a library of code provided by OS2.Libc:UNIX/Linux with a C language API-System Call-OS relationship Type of System Call Process COntrol example: MS_DOS File Manipulation Device Manipulation Information Maintenance Communications Protection Operating System StructureæŒæ¡ä¼˜åŠ¿å’Œé—®é¢˜ï¼Œä¸éœ€è¦è®°ä½ä¾‹å­ simple structure :MS_DOS Monolothic Structure :UNIX limited structing beyond simple but not fully layered Layered Approach not efficient Microkernel System Structure Modules Hybrid System:combine different systems structure Examples:Linux,Windows,Mac OS X structure,IOS,Androidâ€¦ Operating System Design and Implementationâ€¦ is not solvable first problem :design goals and specifications improtant principle to separate(Mechanism for how to do and policy for what will be doneï¼‰Examples (Timer Mechanism for CPU protection and Priority Mechanism in job scheduling) benefits:maximum flexbility OS implementation much variation,earily in ass,now in C/C++ Acutually use a mix of language(body in C,lower levels in ass,system programs in C/C++,scripting language) pros and cons MISC:Debugging,Generation &amp;System Bootdebugging like GDB failure analysis:log files,core dump,crash dump performance tuning: trace list of the system behavior &amp; interactive tools(top displays the resources of usage processes) Kernighanâ€™s LAW:â€Debug is twice as hard as writing the code in the first place.Therefore,if you write the code as cleverly as possible,you are ,by defination,not smart to debug it.â€ Operation system Generationâ€”-OS is designed to run on any of a class of machines the system must be configured or generate for each specific computer site SYSGEN program:it obtains the information concerning the specfic configuration of the hardware system system boot system booting on most computer systems common bootstrap loader allows selection of kernel from multipule disks,versions,kernel options Summary of part I :ch1&amp;ch2 operating system overview â€”â€”multiprogramming &amp; multitasking OS operations:system call &amp; dual mode OS components computing environment OS structure process managements memory managements storage managements","categories":[{"name":"OS","slug":"OS","permalink":"http://sn1987a-1.github.io/categories/OS/"}],"tags":[{"name":"ä¸“ä¸šè¯¾","slug":"ä¸“ä¸šè¯¾","permalink":"http://sn1987a-1.github.io/tags/%E4%B8%93%E4%B8%9A%E8%AF%BE/"}]},{"title":"ä»¥git-ftpä¸ºä¸»çš„å­¦ä¹ è®°å½•","slug":"git-ftp","date":"2022-02-27T07:46:11.000Z","updated":"2023-09-23T13:15:41.582Z","comments":true,"path":"posts/15203.html","link":"","permalink":"http://sn1987a-1.github.io/posts/15203.html","excerpt":"","text":"ä»¥git-ftpä¸ºä¸»çš„å­¦ä¹ è®°å½• åŸæœ¬çš„ç›®çš„æ˜¯ç¾åŒ–ä¸ªäººFTPä¸»é¡µï¼ˆä¹‹å‰éƒ½æ˜¯ç”¨FileZillaè¿›è¡Œè¯¾ç¨‹pdfæ–‡ä»¶ç­‰çš„ä¼ è¾“ï¼Œçœ‹åˆ°åŒå­¦çš„ä¸ªäººä¸»é¡µåçªç„¶æ„è¯†åˆ°ä¹Ÿå¯ä»¥åˆ©ç”¨hexoå®Œæˆç›¸å…³åŠŸèƒ½ï¼Œè™½è¯´æ²¡ä»€ä¹ˆç”¨ï¼Œä½†ä¹Ÿè®°å½•ä¸€ä¸‹å­¦ä¹ çš„è¿‡ç¨‹ã€‚ â€¦â€¦é‡åˆ°äº†å¥½å¤šé—®é¢˜&gt; _ &lt;å°šæœªå®Œæˆ æ“ä½œç¯å¢ƒï¼šwin11 wsl2+Ubuntu 20.04 LTS,USTC ftpï¼ˆé»˜è®¤é¦–é¡µä¸ºpublic_htmlä¸‹çš„index.htmlæ–‡ä»¶ git-ftpå…³è”ä¼˜ç‚¹ï¼šä¾¿äºç®¡ç†ftp åœ¨githubä¸­åˆ›å»ºåä¸ºgit-ftpçš„repoåï¼Œä½¿ç”¨git cloneæ“ä½œå…‹éš†åˆ°æœ¬åœ°ï¼ˆæˆ–è€…å¯ä»¥åœ¨æœ¬åœ°è¿›è¡Œgit initæ“ä½œï¼Œåˆ›å»º.gitæ–‡ä»¶ï¼Œä½¿ç”¨git remoteæ“ä½œä¸è¿œç¨‹é“¾æ¥ï¼› å› ä¸º2021å¹´8æœˆ13èµ·githubä¸å…è®¸åœ¨gitæ“ä½œæ—¶è¿›è¡Œç™»å½•ç¡®è®¤ï¼Œå› æ­¤è¦æå‰é…ç½®å¥½ï¼š git config --global user.name YOURNAME git config --global user.email YOUREMAIL è¦ä½¿ç”¨git-ftpçš„åŠŸèƒ½ï¼Œéœ€è¦å…ˆå®‰è£…git-ftpï¼šï¼ˆç¡®ä¿gitå·²ç»å®‰è£…ï¼‰sudo apt-get install git-ftp æ­¤å¤–ï¼Œè¦è¿›è¡Œftpçš„configæ“ä½œï¼š git config git-ftp.url ftp-url git config git-ftp.user ftp-user git config git-ftp.password pswd è‹¥æƒ³å¯¹ä»¥ä¸Šå†…å®¹è¿›è¡ŒæŸ¥çœ‹ï¼Œå¯ä»¥åœ¨æœ¬ä»“åº“.gitç›®å½•è¿›è¡ŒæŸ¥çœ‹å’Œä¿®æ”¹ [core] repositoryformatversion = 0 filemode = true bare = false logallrefupdates = true [git-ftp] password = pswd user = name url = ftp-url [remote \"origin\"] #ååºæ·»åŠ å®Œå¯ä»¥æŸ¥çœ‹urlå’Œfetchå†…å®¹ å¯¹äºgit-ftpçš„ç›¸å…³æ“ä½œï¼Œå¯ä»¥é˜…è¯» å®˜æ–¹æ–‡æ¡£ ã€‚ ä¹‹åå¯ä»¥å¯¹è¯¥ç›®å½•è¿›è¡Œåˆå§‹åŒ–:git ftp init,æˆ–è€…å¯¹å·²å­˜åœ¨çš„æ–‡ä»¶è¿›è¡Œgit catchupæ“ä½œã€‚ ä¹‹åå¸¸ç”¨çš„æ“ä½œå°±æ˜¯git ftp push.é¡ºä¾¿æä¸€å¥ï¼Œå¯èƒ½ä¼šé‡åˆ°â€œDirty repository :Having uncommited changes.Exitingâ€¦â€çš„é—®é¢˜ï¼Œå°±è¦å…ˆè¿›è¡Œgit add .,git commit ..,git pushçš„æ“ä½œã€‚ æ­¤æ—¶ä»æ— æ³•è¿›è¡Œgit ftp pushçš„æ“ä½œï¼Œå› ä¸ºè¿™ä¸€æ“ä½œéœ€è¦å®‰è£…lftpï¼šsudo apt-get install lftp,å®‰è£…åå³å¯ä½¿ç”¨ã€‚ hexoæ­å»ºä¸ºäº†é˜²æ­¢hexoæ“ä½œå°†å…¶ä»–æ–‡ä»¶ä¸€å¹¶åˆ é™¤ï¼Œæ­¤å¤„å¯ä»¥æ–°å»ºä¸€ä¸ªæ–‡ä»¶å¤¹å­˜å‚¨hexoæ¡†æ¶ï¼šhexo init page,æ‰“å¼€ç›®å½•åº•ä¸‹çš„_config.ymlè¿›è¡Œä¿®æ”¹ï¼Œå¹¶ä¸”å°†deployè¿›è¡Œä¿®æ”¹ï¼š(å¯¹ç”Ÿæˆçš„public_diræ–‡ä»¶çš„ä½ç½®å¤§æ¦‚ä¹Ÿéœ€è¦æ”¹) PS:å¯¹äº_config.ymlçš„å†…å®¹ä¿®æ”¹ï¼Œå¯ä»¥ä¸éœ€è¦é‡æ–°è¿›è¡Œhexo g deploy: type: ftpsync host: # ftpæœåŠ¡å™¨åœ°å€ user: # ftpç”¨æˆ·å pass: # ä½ çš„ftpç”¨æˆ·å¯†ç  remote: # ä½ è¦ä¸Šä¼ åˆ°çš„åœ°å€ï¼Œä¾‹å¦‚/wwwroot port: # ftpç«¯å£ï¼Œä¸åŒçš„ftpå¯èƒ½ä¼šä¸ä¸€æ · delete: true # ä¸Šä¼ æœ¬åœ°æ–‡ä»¶æ˜¯å¦åˆ é™¤ftpä¸­çš„æ‰€æœ‰æ–‡ä»¶ verbose: true # æ˜¯å¦æ‰“å°è°ƒè¯•ä¿¡æ¯ ignore_errors: false # æ˜¯å¦å¿½ç•¥é”™è¯¯ å¤§éƒ¨åˆ†çš„æ“ä½œä¸ºhexoçš„å¸¸è§„æ“ä½œï¼Œä½†ä¸åˆ©ç”¨åŸŸåæ­å»ºçš„hexoåšå®¢ä¸åŒï¼Œè¿™é‡Œéœ€è¦å®‰è£…æ’ä»¶ï¼š npm install hexo-deployer-ftpsync â€“save è¿™é‡Œè¿˜æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œhexo dåï¼Œæˆ‘çš„åŸæœ¬å­˜åœ¨public_htmlåº•ä¸‹çš„æ–‡ä»¶è¢«åˆ é™¤ï¼Ÿ å¦‚æœä½¿ç”¨git cloneå®‰è£…äº†æ–°ä¸»é¢˜ï¼Œå¦‚æ­¤æ¬¡å®‰è£…äº†â€Archerâ€ä¸»é¢˜ï¼Œè‹¥hexoç‰ˆæœ¬åœ¨4.0.0ä»¥ä¸Šï¼Œéœ€è¦å°†/themes/Archerç›®å½•ä¸‹çš„_config.ymlé‡å‘½åä¸º _config.archer.ymlï¼Œå¹¶ç§»åŠ¨åˆ°æ ¹ç›®å½•ï¼ŒåŒæ—¶ï¼Œå› ä¸ºä½¿ç”¨çš„æ˜¯git cloneæ“ä½œï¼Œ ä¼šå°†åŸrepoçš„.gitæ–‡ä»¶cloneåˆ°æœ¬åœ°ï¼Œé»˜è®¤ä¸ºä¸åŸrepoå…³è”ï¼Œè¿™ä¸ªrepoæˆ‘ä»¬æ˜¯æ²¡æœ‰æƒé™è¿›è¡Œä¿®æ”¹çš„ï¼Œç›¸å¯¹äºä¸¤ä¸ªgité¡¹ç›®è¿›è¡Œäº†åµŒå¥—ï¼Œå¤–å±‚æ— æ³•updateå†…éƒ¨çš„repoï¼Œè¿™æ—¶åœ¨æ ¹ç›®å½•ä¸‹è¿›è¡Œgit add .æˆ–è€…git add allæ“ä½œå‡æ˜¯æ— æ³•å°†Archeræ–‡ä»¶çš„å†…å®¹è¿›è¡Œpushçš„ï¼Œä¹Ÿå°±æ— æ³•è¿›è¡Œgit ftp pushæ“ä½œï¼Œè§£å†³æ–¹æ³•å°±æ˜¯åˆ©ç”¨git remote removeæ“ä½œå–æ¶ˆå†…éƒ¨çš„gitå…³è”ã€‚ é‡åˆ°çš„çäº‹ä½¿ç”¨hexoæ“ä½œæ—¶ ï¼Œå‘ç”Ÿå¯¹äºYamlçš„æŠ¥é”™æç¤ºï¼Œä»StackOverflowå¾—çŸ¥éœ€è¦æ›´æ–°npmç‰ˆæœ¬ï¼Œé‚è¿›è¡Œæ›´æ–°ï¼Œä½¿ç”¨npm install -g npmæ—¶ï¼Œåˆå‘ç”ŸæŠ¥é”™ï¼Œå¤§è‡´æ„æ€ä¸ºå¯ä»¥æ£€æµ‹åˆ°æ–°ç‰ˆæœ¬ä½†æ˜¯å½“å‰çš„node.jsä¸å…¼å®¹æ–°ç‰ˆæœ¬ï¼Œæ— æ³•å®Œæˆæ›´æ–°ï¼Œè€Œä¸”æ­¤é¡¹æ›´æ–°æœªå®Œæˆæ—¶ï¼Œå¯èƒ½ä¼šå¯¹äºnpmå®‰è£…å…¶ä»–çš„æ’ä»¶æœ‰å½±å“ã€‚ googleäº†åŠå¤©ï¼Œç»ˆäºææ¸…æ¥šäº†ï¼š æˆ‘åœ¨ä¸€å¼€å§‹å®‰è£…npmæ—¶æœªå®‰è£…nvmï¼ŒäºŒè€…çš„å…³ç³»æ˜¯ï¼šnpmæ—¶node.jsçš„åŒ…ç®¡ç†å·¥å…·ï¼Œnvmæ˜¯node.jsçš„ç‰ˆæœ¬ç®¡ç†å·¥å…·ï¼ŒäºŒè€…å‡æ˜¯node.jsåº”ç”¨ç¨‹åºå¼€å‘çš„å·¥å…·ï¼Œå› æ­¤è¦æ›´æ–°Node.jsåˆ°æœ€è¿‘ç‰ˆæœ¬ï¼Œéœ€è¦å…ˆå®‰è£…nvmï¼Œ$ wget -qO- https://raw.githubusercontent.com/nvm-sh/nvm/v0.38.0/install.sh | sh,å…¶ä¸­shå¯ä»¥æ›¿æ¢æˆshellçš„å…·ä½“åç§°ï¼Œå¦‚æˆ‘çš„å°±æ˜¯zshï¼Œé»˜è®¤ä¸ºbashï¼Œå®‰è£…å®Œä¹‹åå¯ä»¥åœ¨~/.nvmçœ‹åˆ°è¯¥æ–‡ä»¶å¤¹ï¼Œä¸çŸ¥é“ä¸ºä»€ä¹ˆï¼Œæˆ‘çš„æ‰§è¡Œä¸Šè¿°æ“ä½œåæ— ååº”ï¼Œé‡æ–°å¯åŠ¨äº†wslæ‰æ­£å¸¸è¿›è¡Œï¼Œå®Œæˆåï¼Œåœ¨å¯¹åº”çš„é…ç½®æ–‡ä»¶( ~ /.bashrcæˆ–è€…~/.zshrc)ä¸­æ·»åŠ ï¼š export NVM_DIR=\"$([ -z \"${XDG_CONFIG_HOME-}\" ] &amp;&amp; printf %s \"${HOME}/.nvm\" || printf %s \"${XDG_CONFIG_HOME}/nvm\")\" [ -s \"$NVM_DIR/nvm.sh\" ] &amp;&amp; \\. \"$NVM_DIR/nvm.sh\" # This loads nvm å®Œæˆåä¿å­˜é€€å‡ºï¼Œsource ~/.zshrcï¼Œå³å¯ä½¿ç”¨nvmå‘½ä»¤ nvm installå¯ä»¥æŒ‡å®šå®‰è£…Node.js çš„ç‰ˆæœ¬ ï¼Œå¯ä»¥é€‰æ¯”è¾ƒè¿‘çš„ç¨³å®šç‰ˆæœ¬17.0.0ï¼Œå®‰è£…å®Œånvm lsæŸ¥çœ‹å·²å®‰è£…ç‰ˆæœ¬ï¼š â¯ nvm ls -&gt; v17.0.0 system default -&gt; v17.0.0 iojs -&gt; N/A (default) unstable -&gt; N/A (default) node -&gt; stable (-&gt; v17.0.0) (default) stable -&gt; 17.0 (-&gt; v17.0.0) (default) lts/* -&gt; lts/gallium (-&gt; N/A) lts/argon -&gt; v4.9.1 (-&gt; N/A) lts/boron -&gt; v6.17.1 (-&gt; N/A) lts/carbon -&gt; v8.17.0 (-&gt; N/A) lts/dubnium -&gt; v10.24.1 (-&gt; N/A) lts/erbium -&gt; v12.22.10 (-&gt; N/A) lts/fermium -&gt; v14.19.0 (-&gt; N/A) lts/gallium -&gt; v16.14.0 (-&gt; N/A) ä¹‹åå°±å¯ä»¥å¯¹npmè¿›è¡Œæ›´æ–°äº†ã€‚npm -vå¯ä»¥æŸ¥çœ‹ç°æœ‰çš„ç‰ˆæœ¬ï¼Œé—®é¢˜è§£å†³äº† è¿™é‡Œè¿˜æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯nvmå®‰è£…çš„ç‰ˆæœ¬å±…ç„¶ä¹Ÿä¸æ˜¯å…¨å±€ç‰ˆæœ¬ï¼Œåœ¨å¦å¤–ä¸€ä¸ªç›®å½•ä¸‹è¿›è¡Œnpm -væˆ–è€…node -vç«Ÿç„¶ä¹Ÿæ˜¯åŸç‰ˆæœ¬â€¦ emmmm åé¢æš´èºåˆ°ä¸æƒ³è®°å½•äº†å‘œå‘œå‘œ åˆ©ç”¨CSSå¯¹ç•Œé¢ä¼˜åŒ–2022.3.1update:learn how CSS works CSSç›¸å…³èµ„æºï¼š https://chokcoco.github.io/CSS-Inspiration/#/ https://cssreference.io/ è¿™ä¸ªç½‘ç«™æ•´åˆäº†å¾ˆå¤šCSSå·¥å…·ï¼š https://juejin.cn/post/6982363593241002014 HTML CSSå·¥å…·ç½‘ç«™,å¯ä»¥copyå·²æœ‰æ¨¡æ¿ï¼ˆniceï¼ï¼‰å’Œå®æ—¶è§‚å¯Ÿåˆ°html,CSS,JSçš„å‘ˆç°ç»“æœ https://codepen.io","categories":[{"name":"git","slug":"git","permalink":"http://sn1987a-1.github.io/categories/git/"}],"tags":[{"name":"WSL2","slug":"WSL2","permalink":"http://sn1987a-1.github.io/tags/WSL2/"}]},{"title":"WSL2ç¾åŒ–","slug":"WSL2ç¾åŒ–","date":"2022-01-21T14:12:20.000Z","updated":"2023-09-23T13:15:07.152Z","comments":true,"path":"posts/15684.html","link":"","permalink":"http://sn1987a-1.github.io/posts/15684.html","excerpt":"","text":"WSL2ç¾åŒ–æœ¬æ–‡ç®€è¦è®°å½•åŸºäºWindows11å¯¹WSLçš„ç»ˆç«¯è¿›è¡Œç¾åŒ–çš„ä¸»è¦æ­¥éª¤ã€‚ ç¯å¢ƒï¼šUbuntu 20.04ï¼ŒWindows Terminal(WT) ä¸»è¦å·¥å…·å’Œæ’ä»¶ï¼šzshï¼Œoh my zsh, povwerlevel10k(powerlevel9kä¹Ÿå¯ä»¥),autozsh-autosuggestions , zsh-syntax-highlig ä¸‹å›¾æ˜¯æˆ‘çš„ç¾åŒ–ç»“æœã€‚ å¯¹Windows terminalçš„å¤–è§‚è¿›è¡Œç¾åŒ–åœ¨å¾®è½¯åº”ç”¨å•†åº—æœç´¢Windows terminalå³å¯ä¸‹è½½æœ€æ–°ç‰ˆæœ¬ï¼Œå¦‚æœä¸æƒ³ç”¨Windows Terminalï¼Œä¹Ÿå¯ä»¥ä¸‹è½½å¦å¤–ä¸€ä¸ªè·¨å¹³å°ç»ˆç«¯â€”â€”Tabby Terminalï¼Œç‚¹å‡»ä¸‹è½½)ï¼Œé…ç½®æ–¹æ¡ˆä¹Ÿç±»ä¼¼ï¼Œä½†äº²æµ‹æ•ˆæœä¸å¦‚WTã€‚ ä¿®æ”¹é»˜è®¤é…ç½®æ‰“å¼€Windows Terminalï¼Œç‚¹å‡»ä¸Šæ–¹æ ä¸­â€œvâ€æŒ‰é’®ï¼Œé€‰æ‹©ä¾§è¾¹æ ä¸­çš„â€œsetting.jsonâ€æ–‡ä»¶å¹¶æ‰“å¼€ï¼Œåæ–‡ä¸­å¯¹WTçš„é…ç½®å‡å¯¹è¯¥æ–‡ä»¶è¿›è¡Œä¿®æ”¹ï¼ˆå¯ä»¥ç”¨VScodeæ‰“å¼€ï¼‰ã€‚ ä¾‹å¦‚ï¼Œè‹¥è¦è§„å®šé»˜è®¤æ‰“å¼€çš„ç•Œé¢æ˜¯WSL2/WSLçš„ç•Œé¢ï¼Œå³å¯åœ¨actionsä¸€æ è¿›è¡Œä¿®æ”¹ï¼š \"defaultProfile\": \"{07b52e3e-de2c-5db4-bd2d-ba144ed6c273}\",//æ‹¬å·å†…å¯¹åº”çš„åºåˆ—å¯åœ¨setting.jsonæ–‡ä»¶é‡ŒæŸ¥æ‰¾åˆ°Ubuntuå¯¹åº”çš„GUID ä¿®æ”¹é…è‰²æ–¹æ¡ˆåœ¨setting.jsonæœ€åéƒ¨åˆ†æœ‰schemesä¸€æ ï¼Œä»£è¡¨WTçš„é…è‰²æ–¹æ¡ˆï¼Œæ¯ä¸ªé…è‰²æ–¹æ¡ˆçš„nameé¡¹å³ä¸ºåç§°ï¼Œç³»ç»Ÿé»˜è®¤æä¾›äº†ä¸€éƒ¨åˆ†é…è‰²æ–¹æ¡ˆä»¥åŠåç§°ï¼Œä½†éƒ½ä¸æ˜¯å¾ˆå¥½çœ‹ï¼Œå°†è‡ªå®šä¹‰é…è‰²æ·»åŠ åˆ°schemesåº•ä¸‹å³å¯æ–°å¢é…è‰²æ–¹æ¡ˆï¼Œè‡ªå®šä¹‰é…è‰²ç½‘ç«™)æä¾›äº†è¾ƒå¤šæ¨èçš„é…è‰²ï¼Œå¯ä»¥ç›´æ¥å¤åˆ¶ã€‚ ä»¥ä¸‹ä¸ºæˆ‘é€‰æ‹©çš„é…è‰²ï¼š { \"name\": \"ChallengerDeep\", \"black\": \"#141228\", \"red\": \"#ff5458\", \"green\": \"#62d196\", \"yellow\": \"#ffb378\", \"blue\": \"#65b2ff\", \"purple\": \"#906cff\", \"cyan\": \"#63f2f1\", \"white\": \"#a6b3cc\", \"brightBlack\": \"#565575\", \"brightRed\": \"#ff8080\", \"brightGreen\": \"#95ffa4\", \"brightYellow\": \"#ffe9aa\", \"brightBlue\": \"#91ddff\", \"brightPurple\": \"#c991e1\", \"brightCyan\": \"#aaffe4\", \"brightWhite\": \"#cbe3e7\", \"background\": \"#1e1c31\", \"foreground\": \"#cbe1e7\", \"selectionBackground\": \"#cbe1e7\", \"cursorColor\": \"#fbfcfc\" }, æ·»åŠ å®Œé…è‰²æ–¹æ¡ˆåï¼Œè¿˜åº”è¯¥å¯¹profileséƒ¨åˆ†è¿›è¡Œä¿®æ”¹ï¼Œä»¥ä¾¿äºä½¿ç”¨æœ€æ–°é…è‰²æ–¹æ¡ˆã€‚å¦‚æœåªéœ€è¦å¯¹è™šæ‹Ÿæœºéƒ¨åˆ†æ·»åŠ å¦‚ä¸‹æ–‡æœ¬ï¼Œå¯ä»¥åªä¿®æ”¹nameä¸ºâ€œUbuntu-xx.xxâ€çš„éƒ¨åˆ†ï¼ˆå½“ç„¶å…¶ä»–éƒ¨åˆ†ä¹Ÿåªæ˜¯å¤åˆ¶ç²˜è´´ï¼‰ã€‚ \"colorScheme\": \"ChallengerDeep\", ä¿®æ”¹å­—ä½“WindowsåŸè£…å­—ä½“ä¸æ”¯æŒå¾ˆå¤šç¬¦å·çš„æ˜¾ç¤ºï¼Œè¿™é‡Œæ¨èä¿®æ”¹é»˜è®¤å­—ä½“ æ¯”è¾ƒç®€å•çš„ï¼Œå¯ä»¥åœ¨å¾®è½¯å®˜æ–¹ä¸‹è½½)Cascadia Code PLå­—ä½“ï¼Œæˆ–è€…æ˜¯ä¸‹è½½æ–‡ä»¶åå³é”®å•å‡»è¯¥å­—ä½“å¯¹åº”çš„.otf/.ttfæ–‡ä»¶å¹¶é€‰æ‹©å®‰è£…ã€‚ å½“ç„¶æœ‰åŠŸèƒ½æ›´åŠ å¼ºå¤§ï¼Œåº”ç”¨æ›´åŠ å¹¿æ³›çš„å­—ä½“Nerd Fond(Hack Nerd Fond)ï¼ŒåŒ…å«äº†æ›´å¤šå­—ç¬¦åº“ï¼Œç‚¹å‡»ä¸‹è½½]( https://github.com/ryanoasis/nerd-fonts ))ã€‚ å®‰è£…å®Œæˆåï¼ŒåŒæ ·åœ¨profilesç›®å½•çš„Ubuntu-xx.xxé‡Œä¿®æ”¹ï¼š \"fontFace\": \"Hack Nerd Fond\" \"fontSize\": 10, è®¾ç½®èƒŒæ™¯å’Œé€æ˜æ•ˆæœå‡æ˜¯åœ¨perfilesç›®å½•å†… æ·»åŠ èƒŒæ™¯å›¾ï¼š \"backgroundImage\": \"E:\\\\wallpaper\\\\wp3.jpg\",//èƒŒæ™¯çš„åœ°å€ æ·»åŠ é€æ˜æ•ˆæœï¼ˆ0~1ï¼Œè¶Šå°è¡¨ç¤ºè¶Šé€æ˜ï¼‰ \"acrylicOpacity\": 0.8, \"useAcrylic\": true æŒ‡å®šå¯åŠ¨æ—¶çš„é»˜è®¤è·¯å¾„ï¼š \"startingDirectory\": \"./\", è¿™æ ·Windows TerminalåŸºæœ¬å°±é…ç½®å¥½äº†ã€‚ ç¾åŒ–WSL2æ­¥éª¤ï¼š å°†åŸæœ‰çš„shellæ›¿æ¢ä¸ºzsh å®‰è£…oh my zsh å…³é”®å­—é«˜äº®ä»¥åŠè‡ªåŠ¨å¡«å……æ’ä»¶ å®‰è£…powerlevel10k å®‰è£…å®Œè‡ªåŠ¨å¡«å……ä»¥åŠé«˜äº®æ’ä»¶åå¯¹æ–‡ä»¶zshrcè¿›è¡Œçš„ä¸»è¦æ·»åŠ ä¸ºï¼š source /usr/share/zsh-autosuggestions/zsh-autosuggestions.zsh source /usr/share/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh è¿™é‡Œä¸»è¦ä»å®‰è£…powerlevel10kå¼€å§‹è®°å½•ã€‚ åœ¨å‘½ä»¤è¡Œè¾“å…¥ï¼š sudo vim ~/.zshrc æ‰“å¼€é…ç½®æ–‡ä»¶åï¼Œæ‰¾åˆ°THEMEä¸€è¡Œï¼Œä¿®æ”¹ä¸ºï¼š ZSH_THEME=\"powerlevel10k/powerlevel10k\" ä¹‹åé‡å¯æˆ–è¾“å…¥å‘½ä»¤ p10k configure ä¹‹åå¡«å†™å¼¹å‡ºçš„é—®å·å³å¯è‡ªå®šä¹‰å¹¶ä¿å­˜å½“å‰é…ç½®æ–‡ä»¶ã€‚å¦‚æœéœ€è¦ä½¿ç”¨å…¶ä»–è·¯å¾„çš„æ–‡ä»¶ï¼Œå¯ä»¥ä½¿ç”¨sourceå‘½ä»¤è¿›è¡Œå¯¼å…¥ã€‚","categories":[{"name":"WSL2","slug":"WSL2","permalink":"http://sn1987a-1.github.io/categories/WSL2/"}],"tags":[{"name":"WSL2","slug":"WSL2","permalink":"http://sn1987a-1.github.io/tags/WSL2/"}]},{"title":"DataStructåŸºç¡€çŸ¥è¯†","slug":"2021æ•°æ®ç»“æ„å¤ä¹ ","date":"2022-01-11T12:12:20.000Z","updated":"2023-09-23T13:16:04.642Z","comments":true,"path":"posts/131000.html","link":"","permalink":"http://sn1987a-1.github.io/posts/131000.html","excerpt":"","text":"2021æ•°æ®ç»“æ„å¤ä¹  è€ƒè¯•èŒƒå›´æ•°æ®ç»“æ„ ç®—æ³•æ—¶é—´å¤æ‚åº¦ç©ºé—´å¤æ‚åº¦åˆ†æ çº¿æ€§è¡¨ é¡ºåºè¡¨ç¤º é“¾å¼è¡¨ç¤º çº¿æ€§é“¾è¡¨ å¾ªç¯é“¾è¡¨ åŒå‘é“¾è¡¨ ä¸€å…ƒå¤šé¡¹å¼ï¼ˆå®éªŒå†…å®¹ï¼‰ æ ˆ æ•°å€¼è½¬æ¢ï¼Œæ‹¬å·åŒ¹é…ï¼Œè¡Œç¼–è¾‘ç¨‹åºï¼Œè¿·å®«æ±‚è§£ï¼Œè¡¨è¾¾å¼æ±‚å€¼ é˜Ÿåˆ— å®šä¹‰ é“¾é˜Ÿåˆ— å¾ªç¯é˜Ÿåˆ— ä¸² å®šé•¿é¡ºåºå­˜å‚¨ å †åˆ†é…å­˜å‚¨ ä¸²çš„å—é“¾å­˜å‚¨ æ•°ç»„ é¡ºåºè¡¨ç¤º ç‰¹æ®Šå­˜å‚¨ï¼šç‰¹æ®ŠçŸ©é˜µï¼Œç¨€ç–çŸ©é˜µ å¹¿ä¹‰è¡¨ å®šä¹‰å’Œå­˜å‚¨ç»“æ„ *å¹¿ä¹‰è¡¨çš„é€’å½’ç®—æ³• æ±‚å¹¿ä¹‰è¡¨æ·±åº¦ å¤åˆ¶å¹¿ä¹‰è¡¨ å»ºç«‹å¹¿ä¹‰è¡¨çš„å­˜å‚¨ç»“æ„ æ ‘å’ŒäºŒå‰æ ‘ äºŒå‰æ ‘ å®šä¹‰ï¼Œæ€§è´¨ï¼Œå­˜å‚¨ç»“æ„ éå†äºŒå‰æ ‘ çº¿ç´¢äºŒå‰æ ‘ æ ‘å’Œæ£®æ— æ ‘çš„å­˜å‚¨ç»“æ„ æ ‘å’ŒäºŒå‰æ ‘ä¹‹é—´çš„è½¬æ¢ æ ‘å’Œæ£®æ—çš„éå† Huffmanæ ‘ç›¸å…³é—®é¢˜ å›¾ å®šä¹‰å’Œæœ¯è¯­ å­˜å‚¨ç»“æ„ æ•°ç»„è¡¨ç¤ºæ³• é‚»æ¥è¡¨ åå­—é“¾è¡¨ é‚»æ¥å¤šé‡è¡¨ å›¾çš„éå† DFS BFS å›¾çš„è¿é€šæ€§é—®é¢˜ æ— å‘å›¾è¿é€šåˆ†é‡å’Œç”Ÿæˆæ ‘ æœ€å°ç”Ÿæˆæ ‘ æœ€çŸ­è·¯å¾„é—®é¢˜ ä»æŸä¸€ç‚¹åˆ°å…¶ä»–å„ä¸ªé¡¶ç‚¹çš„æœ€çŸ­è·ç¦» æ¯ä¸€å¯¹é¡¶ç‚¹ä¹‹é—´çš„æœ€çŸ­è·¯å¾„ æŸ¥æ‰¾ é™æ€æŸ¥æ‰¾è¡¨ é¡ºåºè¡¨æŸ¥æ‰¾ æœ‰åºè¡¨æŸ¥æ‰¾ ç´¢å¼•é¡ºåºè¡¨æŸ¥æ‰¾ åŠ¨æ€æŸ¥æ‰¾ äºŒå‰æ’åºæ ‘å’Œ *å¹³è¡¡äºŒå‰æ ‘ B-æ ‘å’ŒB+æ ‘ å“ˆå¸Œè¡¨ æ„é€ æ–¹æ³• å¤„ç†å†²çª æŸ¥æ‰¾ `#define INFEASIBLE -1 `#define OVERFLOW -2 çº¿æ€§è¡¨é¡ºåºè¡¨é€»è¾‘ä¸Šç›¸é‚»ï¼Œç‰©ç†ä¸Šç›¸é‚»ï¼Œéšæœºå­˜å– #define LIST_SIZE 100 #define LISTINCREMENT 10 typedef struct { ElemType *elem; int length; int listsize; }SqList; åŠ¨æ€åˆ†é…ï¼š void *malloc(); free(void *p); void *realloc(void *p,unsigned int size);//å¯å˜å¤§/å˜å° åŸºæœ¬æ“ä½œç•¥ é“¾è¡¨è¡¨ç¤ºé€»è¾‘ä¸Šç›¸é‚»ä¸ä»£è¡¨ç‰©ç†ä¸Šç›¸é‚»ï¼Œééšæœºå­˜å– ï¼ˆåŒºåˆ«ä¸åŒé€»è¾‘ç»“æ„çš„æ’å…¥åˆ é™¤æ“ä½œï¼‰ å•é“¾è¡¨typedef struct LNode { elemtype data; struct LNode *next; }Lnode ,*LinkList; åŸºæœ¬æ“ä½œï¼š Status GetElem_L(LinkList L,int i,ElemType &amp;e); Status ListInsert_L(LinkList &amp;L,int iï¼ŒElemType e); //è·å–ç»“ç‚¹çš„å‰é©±è€—æ—¶é—´ï¼ŒT(N)=O(N) Status ListDelete_L(LinkList &amp;L,int iï¼ŒElemType &amp;e); Status CreateList_L(LinkList &amp;L); åˆ›å»ºï¼šå¤´æ’æ³•ï¼ˆ$T(N)=O(N)$ï¼‰ï¼Œå°¾æ’æ³•($T(N)=O(N^2)$)(å¤´æ’æ³•åˆ›å»ºè¾ƒå¥½) ä½œä¸šä¹ é¢˜ï¼šå°±åœ°é€†ç½®å•é“¾è¡¨ æœ‰å¤´ç»“ç‚¹ï¼šLæŒ‡å‘å¤´ç»“ç‚¹ï¼Œé™¤å¤´ç»“ç‚¹å„ç‚¹å‡æœ‰å‰é©±ï¼› æ— å¤´ç»“ç‚¹ï¼šç©ºè¡¨æ—¶Lä¸ºNULLï¼› å¾ªç¯é“¾è¡¨ ä¾¿äºä»ä¸€ä¸ªç»“ç‚¹å‡ºå‘ï¼Œè®¿é—®å…¨éƒ¨çš„ç»“ç‚¹ åœ¨O(1)çš„æ—¶é—´å†…æ‰¾åˆ°é“¾è¡¨çš„ç¬¬ä¸€ä¸ªç»“ç‚¹å’Œæœ€åä¸€ä¸ªç»“ç‚¹ï¼ˆå¤´æŒ‡é’ˆ==å°¾æŒ‡é’ˆï¼‰ é™æ€é“¾è¡¨å’ŒåŠ¨æ€é“¾è¡¨é™æ€é“¾è¡¨(è‹¥è¯­è¨€ä¸æ”¯æŒæŒ‡é’ˆç±»å‹çš„å­˜å‚¨çš„æƒ…å†µ) #define MAXSIZE 1000 typedef struct{ ElemType data; int cur;//ä»£æ›¿æŒ‡é’ˆåŸŸ }component,SLinkList[MAXSIZE]; æ•°ç»„çš„ç¬¬0ä¸ªåˆ†é‡å¯ä»¥è§†ä¸ºï¼ˆå¤‡ç”¨é“¾çš„ï¼‰å¤´ç»“ç‚¹ï¼› é™æ€é“¾è¡¨çš„æ¨¡æ‹ŸåŠ¨æ€åˆ†é…ä¸é‡Šæ”¾ï¼ˆæœªåˆ©ç”¨çš„ç‚¹i[cur]=0;) åŠ¨æ€é“¾è¡¨ä¸é™æ€é“¾è¡¨çš„è¿ç”¨ï¼šä¾‹ï¼šæ±‚å·®é›† åŒå‘é“¾è¡¨typedef struct DuLNode{ ElemType data; struct DuLNode *prior; struct DuLNode *next; }DuLNode ,*DuLinkList; å¯å¸¦å¤´ç»“ç‚¹ï¼Œå¯ä¸å¸¦ï¼ˆå¤šåŠæ˜¯å¸¦çš„ï¼‰ã€‚ å…¶ä»–è¡¨ç¤ºæ ¹æ®é¢˜ç›®è¦æ±‚è§„å®šè¿›è¡Œè®¾è®¡ï¼Œå¦‚åŒæ—¶å­˜å‚¨å•é“¾è¡¨çš„å¤´å’Œå°¾ï¼Œç‰¹æ®Šçº¿æ€§è¡¨â€”â€”æœ‰åºè¡¨ã€‚ ä¾‹é¢˜1.åŒå‘å¾ªç¯é“¾è¡¨çš„è‡ªèº«å˜æ¢ï¼Œå¦‚å°†$L=\\{a_1,a_2,â€¦..a_n\\}$å˜æ¢ä¸º$Lâ€™=\\{a_1,a_3,â€¦.a_n,â€¦a_4,a_2\\}$ â€‹ (é¡ºç€åå‘é“¾ï¼Œå‰å‘é“¾è¿›è¡Œæ’å…¥) æ ˆä¸é˜Ÿåˆ—éš¾ç‚¹ï¼šé€’å½’ä¸éé€’å½’å®ç°ï¼Œå¾ªç¯é˜Ÿåˆ— æ ˆLIFO åªèƒ½åœ¨Topç«¯è¿›è¡Œæ’å…¥åˆ é™¤æ“ä½œ Traverseæ“ä½œæ˜¯ä»æ ˆåº•åˆ°æ ˆé¡¶è¿›è¡Œè®¿é—® å¤šä¸ºé¡ºåºæ ˆï¼šçº¦å®šï¼šS.topæŒ‡å‘æ ˆé¡¶å…ƒç´ çš„ä¸‹ä¸€ä¸ªä½ç½® #define STACK_INT_SIZE 100 #define STACKINCREMENT 10 typedef struct { ElemType *base; ElemType *top; int stacksize;//å½“å‰åˆ†é…å®¹é‡ }SqStackï¼› æ ˆç©ºï¼šS.base==S.top æ ˆæ»¡ï¼šS.top-S.base&gt;=S.stacksize å…¥æ ˆï¼šS.top++; å‡ºæ ˆ: S.top - - ï¼› é“¾æ ˆï¼šæ— æ ˆæ»¡é—®é¢˜ï¼Œå¯ä»¥ä¸å¿…å¼•å…¥å¤´ç»“ç‚¹ï¼ˆåœ¨ç¬¬ä¸€ä¸ªç»“ç‚¹å¤„è¿›è¡Œæ’å…¥åˆ é™¤æ“ä½œï¼‰ã€‚ æ ˆçš„åŸºæœ¬åº”ç”¨1.æ•°åˆ¶è½¬æ¢ 2.è¡Œç¼–è¾‘ç¨‹åºï¼ˆå·²ä¸å¸¸ç”¨ï¼‰ â€‹ ç”¨æ ˆä¿å­˜ç»ˆç«¯è¾“å…¥çš„ä¸€è¡Œå­—ç¬¦è¿›è¡Œé€è¡Œå¤„ç†ï¼›é‡åˆ°â€˜#â€™é€€ä¸€æ ¼ï¼ˆå‡ºæ ˆï¼‰ï¼Œé‡åˆ°â€˜@â€™é€€ä¸€è¡Œï¼ˆæ¸…ç©ºæ ˆClearStackï¼‰ï¼Œå…¶ä»–å­—ç¬¦å…¥æ ˆï¼Œæœ€åéå†ï¼Œæ¸…ç©ºæ ˆã€‚ 3.è¡¨è¾¾å¼æ±‚å€¼ è¡¨è¾¾å¼è¡¨ç¤ºæ–¹æ³•ï¼š ä¸­ç¼€è¡¨è¾¾å¼ï¼Œè®°å¾—åŠ æ‹¬å· å‰ç¼€è¡¨è¾¾å¼ï¼ˆæ³¢å…°å¼ï¼‰-+abc d-ea åç¼€è¡¨è¾¾å¼ï¼ˆé€†æ³¢å…°å¼ï¼‰ab+cdea- - è¡¨è¾¾å¼æ±‚å€¼ä¹Ÿå¯ä»¥ç”¨äºŒå‰æ ‘è¡¨ç¤ºï¼šåˆ†æ”¯ä¿å­˜è¿ç®—ç¬¦ï¼Œå¶å­ç»“ç‚¹ä¿å­˜æ“ä½œæ•°ï¼Œä¸­åºè®¿é—®ï¼šä¸­ç¼€è¡¨è¾¾å¼ï¼›å…ˆåºè®¿é—®ï¼šå‰ç¼€è¡¨è¾¾å¼ï¼›ååºè®¿é—®ï¼šåç¼€è¡¨è¾¾å¼ è¦å…ˆç¡®ä¿ä¸­ç¼€è¡¨è¾¾å¼åˆæ³•ï¼šæ‹¬å·åŒ¹é… é»˜è®¤è¿ç®—å¼ç»“å°¾ä¸ºâ€™#â€™ å¯ä»¥è¿›è¡Œçš„æ“ä½œï¼šä¸­ç¼€è¡¨è¾¾å¼è½¬åŒ–ä¸ºå…ˆ/åç¼€è¡¨è¾¾å¼ï¼Œå…ˆ/åç¼€è¡¨è¾¾å¼æ±‚å€¼ï¼Œä¸­ç¼€è¡¨è¾¾å¼ç›´æ¥æ±‚å€¼ã€‚æ³¨æ„ï¼šä¸æ¶‰åŠä¸­ç¼€è¡¨è¾¾å¼çš„è¿ç®—ä¸éœ€è€ƒè™‘ä¼˜å…ˆçº§ã€‚ [1]ä¸­ç¼€è¡¨è¾¾å¼è½¬åç¼€è¡¨è¾¾å¼ï¼šè¿ç®—ç¬¦å…¥æ ˆ [2]ä¸­ç¼€è¡¨è¾¾å¼æ±‚å€¼ï¼šè¿ç®—ç¬¦ï¼ˆåŒ…æ‹¬å·¦æ‹¬å·ï¼‰å’Œè¿ç®—æ•°ä¸¤ä¸ªæ ˆï¼ŒæŒ‰ç…§æ“ä½œç¬¦ä¼˜å…ˆçº§è¿›è¡Œè¿ç®—ï¼Œ'#'ä¼˜å…ˆçº§æœ€ä½ã€‚ [3]å‰ç¼€è¡¨è¾¾å¼ä¸²æ±‚å€¼ï¼šè¿ç®—ç¬¦å’Œè¿ç®—æ•°å…¥åŒä¸€ä¸ªæ ˆï¼Œå¦‚æœæœ‰ä¸¤ä¸ªè¿ç®—æ•°åˆ™è¿›è¡Œè¿ç®— [4]å‰ç¼€è¡¨è¾¾å¼ä¸åç¼€è¡¨è¾¾å¼ç›¸äº’è½¬åŒ–ï¼šæ€è·¯ç›¸åï¼ŒåŒæ ·ç”¨æ ˆï¼Œç±»ä¼¼æ³¢å…°å¼/é€†æ³¢å…°å¼æ±‚å€¼ï¼Œå°†å­—ç¬¦ä¸²è§†ä½œè¿ç®—æ•°ã€‚ [5]åç¼€è¡¨è¾¾å¼æ±‚å€¼ï¼šè¿ç®—æ•°å…¥æ ˆ 4.æ ˆä¸é€’å½’çš„å®ç° åº”ç”¨ï¼šæ„å»ºå…¶ä»–æ•°æ®ç»“æ„ï¼šè¡¨ï¼Œå›¾ï¼Œæ ‘å’ŒäºŒå‰æ ‘ â€‹ é—®é¢˜æ±‚è§£ï¼šHanoiå¡”é—®é¢˜ï¼Œè¿·å®«é—®é¢˜/Nçš‡åé—®é¢˜ï¼ˆå›æº¯ï¼‰ é˜Ÿåˆ—FIFOï¼Œå…è®¸åœ¨é˜Ÿå°¾rearæ’å…¥ï¼Œé˜Ÿå¤´headåˆ é™¤ï¼ˆè·å–é˜Ÿå¤´å…ƒç´ GetHead(L,&amp;e),éå†æ“ä½œTraverse(Lï¼Œvisit())ä»headåˆ°rearï¼‰. é“¾é˜Ÿåˆ—ï¼ˆé€šå¸¸ï¼‰typedef struct QNode{ ElemType data; struct QNode *next; }QNode,*QueuePtr; typedef struct { QueuePtr front; QueuePtr rear; }LinkQueue; ï¼ˆæœ€å¥½æ˜¯å¼•å…¥å¤´ç»“ç‚¹â€”â€”é˜Ÿç©ºï¼šL.front ==L.rearï¼‰ å¾ªç¯é˜Ÿåˆ—(å¤„ç†å‡æº¢å‡º)#define MAXSIZE 100 typedef struct{ ElemType *base; int front; int rear;//æŒ‡å‘é˜Ÿå°¾å…ƒç´ çš„ä¸‹ä¸€ä¸ªä½ç½® }SqQueueï¼› é˜Ÿç©ºæ ‡å¿—ï¼šQ.front==Q.rear å¤šç”³è¯·ä¸€ä¸ªç©ºé—´ï¼Œé˜Ÿæ»¡æ ‡å¿—ï¼šQ.front==(Q.rear+1)%MAXSIZE INCREMENTï¼šé‡æ–°åˆ†é…ç©ºé—´ï¼Œå¹¶éå†åŸé˜Ÿåˆ—è¿›è¡Œå¤åˆ¶ åº”ç”¨ï¼šç¦»æ•£äº‹ä»¶æ¨¡æ‹Ÿ ä¸²æ¦‚å¿µï¼šä¸²çš„é•¿åº¦ï¼Œç©ºä¸²ï¼Œå­ä¸²ï¼Œä¸»ä¸²ï¼Œå­ä¸²/å­—ç¬¦åœ¨ä¸²ä¸­çš„ä½ç½® æ˜¯ç‰¹æ®Šçš„çº¿æ€§è¡¨ï¼šå¤„ç†å¯¹è±¡ä¸ºä¸ªä½“ï¼ˆå­—ç¬¦ï¼‰æˆ–æ•´ä½“ï¼ˆå­ä¸²ï¼‰ æ“ä½œï¼š StrAssign(S,\"...\");//èµ‹å€¼ StrCpoy(T,S);//å¤åˆ¶ä¸² StrCompare(S,T);//æ¯”è¾ƒ ConCat(T,\"...\");//æ‹¼æ¥ SubString(Sub,S,i,j);//å–å­ä¸²Subä¸ºSi,...Sj Index(s,\"a\",i);//è¿”å›Sä¸­iåç¬¬ä¸€å±‚å‡ºç°å­ä¸²çš„é¦–ä¸ªå­—æ¯çš„ä½ç½® Replace(S,\"..\",\"..\");//å°†å­ä¸²å…¨éƒ¨æ›¿æ¢ä¸ºç›®æ ‡å­ä¸² StrInsert(S,i,\"...\");//åœ¨iå¤„æ’å…¥å­ä¸² StrDelete(S,i,j);//åˆ é™¤Siåˆ°Sjçš„å­ä¸² å…·ä½“å­˜å‚¨ç»“æ„é¡ºåºæ˜ åƒå­˜å‚¨å¯†åº¦ä½ å®šé•¿é¡ºåºå­˜å‚¨ï¼Œä¸‹è¡¨ä¸º0çš„ä½ç½®å­˜å‚¨ä¸²çš„é•¿åº¦ï¼ˆbasic)æˆ–ä¸²å€¼æœ€ååŠ å…¥æ— å…³å­—ç¬¦ï¼Œå¦‚â€™\\0â€™ (C)ã€‚ å †åˆ†é…å­˜å‚¨â€”â€”é¡ºåºæ˜ åƒ typedef struct{ char *ch;//malloc() åŠ¨æ€åˆ†é… int length; }HString; â€‹ å—é“¾å­˜å‚¨â€”â€”é“¾å¼æ˜ åƒ typedef struct Chunk{ char ch[CHUNKSIZE]; struct Chunk *next; }Chunk; typedef struct{ Chunk *head,*tail; int curlen }LString; å—é“¾å­˜å‚¨ä¸­çš„æ’å…¥ï¼Œåˆ é™¤ï¼Œå¯»æ‰¾å­ä¸²ï¼Œå®šä½ï¼Œæ‹¼æ¥ç®—æ³•å¤æ‚åŒ–å¤„ç†ï¼ˆä½œä¸šé¢˜ç›®ï¼‰ ä¸²çš„æ¨¡å¼åŒ¹é…ç®—æ³•å¥½åƒä¸è€ƒã€‚ åº”ç”¨ä¸¾ä¾‹åº”ç”¨äºæ–‡æœ¬ç¼–è¾‘ï¼Œé¡µæ’å…¥/åˆ é™¤ï¼Œè¡Œæ’å…¥/åˆ é™¤ï¼Œé¡µè¡¨ï¼Œè¡Œè¡¨ï¼Œèµ·å§‹åœ°å€ï¼Œé•¿åº¦â€¦ å»ºç«‹å…³é”®è¯è¯ç´¢å¼•è¡¨ æ•°ç»„å’Œå¹¿ä¹‰è¡¨æ•°ç»„çš„æ“ä½œè²Œä¼¼ä¹Ÿä¸è€ƒï¼Œè¡¥å……ä¸‰å…ƒè¡¨ï¼Œç‰¹æ®Šæ•°ç»„åœ¨åç»­ç®—æ³•è¯¾ä¸­ã€‚ å¹¿ä¹‰è¡¨å¹¿ä¹‰è¡¨æ˜¯çº¿æ€§è¡¨çš„æ¨å¹¿ï¼Œå…ƒç´ ç±»å‹å¯ä»¥æ˜¯åŸå­æˆ–å­è¡¨ï¼Œä¹ æƒ¯ä¸Šç”¨å¤§å†™å­—æ¯è¡¨ç¤ºå­è¡¨ï¼Œå°å†™å­—æ¯è¡¨ç¤ºåŸå­ã€‚ï¼ˆä¹Ÿå¯ä»¥çœ‹ä½œç‰¹æ®Šå®šä¹‰çš„å›¾ï¼‰ è¡¨å¤„ç†è¯­è¨€LISPä¸­ï¼Œå°†å¹¿ä¹‰è¡¨è§†ä½œåŸºæœ¬çš„æ•°æ®ç»“æ„ã€‚ è¡¨å¤´ï¼šè¡¨ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´  GetHead(L) è¡¨å°¾ï¼šé™¤å»ç¬¬ä¸€ä¸ªå…ƒç´ å¤–çš„å…¶ä½™å…ƒç´ ç»„æˆçš„è¡¨ GetTail(L) åŸºæœ¬å®šä¹‰ ç©ºè¡¨ A=( ) é•¿åº¦ï¼šå…ƒç´ ä¸ªæ•°ï¼Œå¦‚B=(a,(b,c,d))é•¿åº¦ä¸º2ï¼Œç¬¬äºŒä¸ªå…ƒç´ ä¸ºè¡¨ A=(a,A) å¯ä»¥é€’å½’å®šä¹‰çš„è¡¨ GetHead(((())))=(()); GetTail((()))=() æ·±åº¦ï¼šæ‹¬å·çš„é‡æ•°çš„æœ€å¤§å€¼ å¹¿ä¹‰è¡¨çš„å­˜å‚¨ç»“æ„æ•°æ®å…ƒç´ ä¸åŒï¼Œéš¾ä»¥ç”¨é¡ºåºè¡¨å­˜å‚¨ã€‚ å¤´å°¾é“¾è¡¨å­˜å‚¨typedef enum{ATOM,LIST}ElemTag; typedef struct GLNode{ ElemTag tag; union{ AtomType atom; struct {GLNode *hp,*tp;}ptr; }; }*GList; æ‹“å±•çº¿æ€§é“¾è¡¨å­˜å‚¨typedef enum{ATOM,LIST}ElemTag; typedef struct GNode{ ElemTag tag; union{ AtomType atom; struct GLNode *hp; }; struct GLNode *tp; }*GLIst; å¹¿ä¹‰è¡¨çš„ç›¸å…³æ“ä½œæ­¤éƒ¨åˆ†ä¸è€ƒä»£ç è®¾è®¡ï¼Œå¯èƒ½æœ‰è¯»ä»£ç åˆ†æçš„é¢˜ç›® é€’å½’ç®—æ³•ï¼Œå½’çº³æ€ç»´ å¹¿ä¹‰è¡¨çš„æ·±åº¦è§„å®šï¼šLSä¸ºåŸå­ï¼šDEPTH=0ï¼› â€‹ LSä¸ºç©ºè¡¨ï¼šDEPTH=1ï¼› â€‹ å½’çº³é¡¹ï¼š$DEPTH(LS)=1+Max\\{DEPTH(a_i)\\},\\ n&gt;=1$ å‡è®¾é‡‡ç”¨å¤´å°¾é“¾è¡¨å­˜å‚¨ï¼š int GListDepth(GLIst L)//é€’å½’ { if(!L) return 1; if(L-&gt;tag==ATOM) return 0; for(max=0,pp=L;pp;pp=pp-&gt;ptr.tp) { dep=GListDepth(pp-&gt;ptr.hp); if(dep&gt;max) max=dep; } return max+1; } //å¯ä»¥ç”¨é˜Ÿåˆ—å®ç°éé€’å½’ç®—æ³•ï¼Œåœ¨æ¯å±‚å¼€å§‹å¤„è®¾ç½®æ ‡å¿— å¤åˆ¶å¹¿ä¹‰è¡¨å½’çº³ï¼šå¤åˆ¶LSâ€”&gt;å¤åˆ¶è¡¨å¤´+å¤åˆ¶è¡¨å°¾ Status CpoyList(GList &amp;T,GList L) {//å‡å®šå¤´å°¾é“¾è¡¨å­˜å‚¨ if(!L) { T=NULL; return OK;} T=(GList)malloc(sizeof(GLNode)); T-&gt;tag=L-&gt;tag; if(T-&gt;tag==ATOM) {T-&gt;atom=L-&gt;atom; return OK:} CopyList(T-&gt;ptr.hp,L-&gt;ptr.hp); CopyList(Y-&gt;ptr.tp,L-&gt;ptr.tp); return OK; } å¯ä»¥ç”¨æ ˆå®ç°éé€’å½’ç®—æ³•ã€‚ å¹¿ä¹‰è¡¨ç»“æ„çš„å»ºç«‹ç”±å­—ç¬¦ä¸²å»ºç«‹å¹¿ä¹‰è¡¨ è¡¨å¤´+è¡¨å°¾é€’å½’å¤„ç† ... å…¶ä»–åº”ç”¨ä½œä¸šé¢˜ç›®ï¼šå°±åœ°é€†ç½®å¹¿ä¹‰è¡¨(é€†è½¬æ‰€æœ‰å­è¡¨)é€’å½’å¤„ç† ``` æ³¨ï¼šå¹¿ä¹‰è¡¨çš„å­˜å‚¨æ ¼å¼ä¸€èˆ¬å¯ä»¥è‡ªé€‰ å¸¸è§æ€è·¯ï¼š1.å°†å¹¿ä¹‰è¡¨çœ‹ä½œè¡¨å¤´è¡¨å°¾ä¸¤éƒ¨åˆ†è¿›è¡Œé€’å½’å¤„ç† â€‹ 2.å°†å¹¿ä¹‰è¡¨çœ‹ä½œnä¸ªå¹¶åˆ—å­è¡¨ç»„æˆçš„è¡¨ ## æ ‘å’ŒäºŒå‰æ ‘ **äºŒå‰æ ‘çš„éå†ï¼ŒäºŒå‰æ ‘å’Œæ£®æ—çš„ç›¸äº’è½¬æ¢ç­‰ç›¸å…³ç®—æ³•è®¾è®¡** ### å®šä¹‰ ç©ºæ ‘n=0; è¡¨ç¤ºæ–¹æ³•ï¼š æ ‘å½¢è¡¨ç¤ºï¼ŒåµŒå¥—è¡¨ç¤ºï¼Œå¹¿ä¹‰è¡¨è¡¨ç¤ºï¼Œå‡¹å…¥è¡¨ç¤º æœ¯è¯­ï¼šé«˜åº¦ï¼Œå±‚æ¬¡ï¼ˆ1ï¼Œ2ï¼Œ...ï¼Œhï¼‰ï¼Œåº¦ï¼Œç¥–å…ˆï¼Œå­å­™ï¼Œæœ‰åºæ ‘ï¼Œæ— åºæ ‘ï¼Œç»ˆç«¯ç»“ç‚¹ï¼Œéç»ˆç«¯ç»“ç‚¹ï¼Œå†…éƒ¨ç»“ç‚¹... æ“ä½œï¼š ```c++ TreeDepth(T); Parent(T,cur_e); LeftChild(T,cur_e); RightSibling(T,cur_e); InsertChild(&amp;T,p,i,c);//æ’å…¥å­æ ‘ DeleteChild(&amp;T,p,i); TraverseTree(T,visit()); äºŒå‰æ ‘æ¯ä¸ªç»“ç‚¹æœ€å¤šæœ‰ä¸¤ä¸ªå­æ ‘ï¼Œåº¦æ•°ä¸€å®šæ˜¯2ï¼Œåˆ†å·¦å³ã€‚ æ€§è´¨ï¼š ç¬¬iå±‚æœ€å¤šæœ‰$2^{n-1}$ä¸ªç»“ç‚¹ æ·±åº¦ä¸ºhçš„äºŒå‰æ ‘æœ€å¤š$2^{h}-1$ä¸ªç»“ç‚¹ï¼ˆä¸Šè¿°ä¸¤æ¡å¯ä»¥æ¨å¹¿åˆ°nå‰æ ‘çš„æƒ…å†µï¼‰ $n_0=n_2+1;\\ \\ \\ n=n_0+n_1+n_2;\\ \\ \\ n-1=n_1+n_2$ è‹¥åŒ…å«nä¸ªç»“ç‚¹çš„æ ‘åªæœ‰å¶å­ç»“ç‚¹å’Œåº¦æ•°ä¸ºkçš„ç»“ç‚¹ï¼Œåˆ™æ ‘ä¸­åŒ…å«çš„å¶å­ç»“ç‚¹ä¸ºï¼š$n_0=n-(n-1)/k$ æ»¡äºŒå‰æ ‘ï¼šæ·±åº¦ä¸ºhä¸”å«æœ‰$2^{h}-1$ä¸ªç»“ç‚¹çš„äºŒå‰æ ‘ å®Œå…¨äºŒå‰æ ‘ï¼šå‰k-1å±‚ä¸ºæ»¡äºŒå‰æ ‘ï¼Œç¬¬kå±‚ç»“ç‚¹å…¨åœ¨é å·¦è¾¹ å…·æœ‰nä¸ªç»“ç‚¹çš„å®Œå…¨äºŒå‰æ ‘çš„æ·±åº¦ï¼š$h=[log_2n]+1$ è‹¥å¯¹ä¸€æœ‰nä¸ªç»“ç‚¹çš„å®Œå…¨äºŒå‰æ ‘æŒ‰å±‚åºç¼–å·ï¼Œåˆ™å¯¹ä»»æ„ç»“ç‚¹æœ‰ï¼š è‹¥i=1ï¼Œä¸ºæ ¹ç»“ç‚¹ï¼Œæ— åŒäº²ï¼›è‹¥i&gt;1ï¼ŒåŒäº²ç»“ç‚¹ä¸º[i/2] è‹¥2i&gt;n,åˆ™ç»“ç‚¹iæ— å·¦å­©å­ï¼Œå¦åˆ™å·¦å­©å­ä¸º2iã€‚ è‹¥2i+1&gt;nï¼Œåˆ™iæ— å³å­©å­ï¼Œå¦åˆ™å³å­©å­æ˜¯2i+1. ä¸Šè¿°ç»“è®ºå¯ä»¥å¤§è‡´æ¨å¹¿åˆ°kå‰æ ‘ äºŒå‰æ ‘çš„å­˜å‚¨ç»“æ„ï¼š é¡ºåºå­˜å‚¨ï¼šç©ºé—´å¼€é”€å¤§ é“¾å¼å­˜å‚¨ï¼šäºŒå‰é“¾ï¼ˆä¿å­˜åŒäº²ç»“ç‚¹å˜æˆä¸‰å‰é“¾ï¼‰ typedef struct{ ElemType data; struct BiTNode *lchild,*rchild; }BiTNode,*BiTree; äºŒå‰æ ‘çš„ç›¸å…³ç®—æ³•éå†å…ˆ/ä¸­/ååºéå†ï¼šæ¯ä¸ªç»“ç‚¹å‡è¢«è®¿é—®ä¸‰æ¬¡ é€’å½’/éé€’å½’ï¼ˆæ ˆï¼‰ç®—æ³•å®ç°ã€‚ æœ€å¥½ä½¿ç”¨å‡½æ•°è°ƒç”¨çš„ç»“æœè€Œä¸æ˜¯è¿”å›å€¼ï¼šä¸ºå®ç°å‡½æ•°å‡ºç°å¼‚å¸¸æ—¶æ”¹å˜StatusåŠæ—¶ç»ˆæ­¢ ç›¸å…³è¿ç”¨ï¼š åˆ›å»ºäºŒå‰æ ‘ï¼šç±»æ¯”å…ˆåºè®¿é—® æ¸…ç©ºé‡Šæ”¾äºŒå‰æ ‘ï¼Œæˆ–ä»¥æŸä¸ªç»“ç‚¹ä¸ºç¥–å…ˆçš„å­æ ‘ï¼šååºè®¿é—® å…ˆåº/ååºæ‹“è¡¥åºåˆ—å¯ä»¥å”¯ä¸€ç¡®å®šä¸€ä¸ªäºŒå‰æ ‘ã€‚ éé€’å½’ååºéå†è¦æ³¨æ„ï¼šè®¾ç½®è®¿é—®æ ‡å¿—tag æ±‚æ·±åº¦ å±‚æ¬¡éå†é€’å½’/éé€’å½’ï¼ˆé˜Ÿåˆ—ï¼‰å®ç° â€‹ â€”â€”å…ˆè®¿é—®çš„ç»“ç‚¹ï¼Œå­ç»“ç‚¹ä¹Ÿä¼šä¼˜å…ˆè®¿é—® å¯¹äºŒå‰æ ‘è¿›è¡Œå±‚æ¬¡éå†å¯ä»¥åˆ¤æ–­è¯¥äºŒå‰æ ‘æ˜¯å¦ä¸ºå®Œå…¨äºŒå‰æ ‘ã€‚ æ‰¾åˆ°è·ç¦»xæœ€è¿‘çš„å¶å­å­å­™åŠè·ç¦»ï¼šä»xå¼€å§‹è¿›è¡Œå±‚æ¬¡éå†ï¼Œæ‰¾åˆ°ç¬¬ä¸€ä¸ªå¶å­ç»“ç‚¹å³å¯ï¼ˆæ¯å±‚æœ«å°¾åŠ ä¸€ä¸ªè™šç»“ç‚¹è¿›è¡Œè®¡ç®—è·ç¦» è¾“å‡ºè·ç¦»xæœ€è¿‘çš„æ‰€æœ‰å¶å­åŠå…¶æ•°ç›® è¾“å‡ºxåˆ°æœ€è¿‘å¶å­å­å­™ç»“ç‚¹çš„è·¯å¾„ï¼šä¿®æ”¹åŸé˜Ÿåˆ—ï¼šä¸é‡Šæ”¾å·²ç»éå†çš„ç»“ç‚¹å¹¶è®°å½•æ¯ä¸ªç»“ç‚¹çš„åŒäº²ä¿¡æ¯ äºŒå‰æ ‘çš„åˆ›å»º å®Œå…¨äºŒå‰æ ‘çš„é¡ºåºæ˜ å°„ å…ˆåºæ‹“æ‰‘åºåˆ— å…ˆåº+ä¸­åºæˆ–ååº+ä¸­åºä¹Ÿå¯å”¯ä¸€ç¡®å®šçš„ä¸€æ£µäºŒå‰æ ‘â€”-çº¿ç´¢åŒ–äºŒå‰æ ‘ çº¿ç´¢äºŒå‰æ ‘åˆ©ç”¨å¶å­ç»“ç‚¹çš„æœªä½¿ç”¨çš„æŒ‡é’ˆåŸŸï¼ŒåŠ ä¸¤ä¸ªæ ‡è®° typedef enum{Link,Thread}PointerTag; typedef struct BiThrNode { ElemType data; struct BiThrNode *lchild,*rchild; PointerTag ltag,rtag; }BiThrNode,*BiThrTree; å…ˆåº/ä¸­åº/ååºçº¿ç´¢åŒ–äºŒå‰æ ‘ï¼šå¯¹åº”éå†é¡ºåºçš„ç›¸åº”å‰é©±ï¼Œåç»§ï¼Œå…¶ç®—æ³•å¯ä»¥ç±»æ¯”ç›¸åº”çš„éå†ç®—æ³•ã€‚ ä¸­åºçº¿ç´¢åŒ–ä¸­è§„ä¸­çŸ©ï¼ŒåŸºæœ¬æ˜¯ä¸­åºéå†çš„æ‹“å±•ï¼Œå·¦å­©å­ä¸ºå‰é©±ï¼Œå³å­©å­ä¸ºåç»§ï¼› å…ˆåº/ååºçº¿ç´¢åŒ–äºŒå‰æ ‘ ç›¸äº’å¯¹ç§°ï¼Œéš¾ç‚¹ï¼šæ‰¾å‰é©±å’Œåç»§ ååºæ‰¾åˆ°å‰é©±çš„æ–¹æ³•ï¼š è‹¥è¯¥ç»“ç‚¹æ— å·¦å­©å­ï¼Œå‰é©±ç”±lchildæŒ‡å‘ è‹¥è¯¥ç»“ç‚¹æœ‰å·¦å³å­©å­ï¼Œå‰é©±ä¸ºå³å­©å­ è‹¥è¯¥ç»“ç‚¹åªæœ‰å·¦å­©å­ï¼Œå‰é©±ä¸ºå·¦å­©å­ ååºæ‰¾åˆ°ç»“ç‚¹çš„åç»§ è‹¥ç»“ç‚¹ä¸ºæ ¹ç»“ç‚¹ï¼Œåç»§ä¸ºç©º è‹¥ç»“ç‚¹ä¸ºåŒäº²çš„å³å­©å­æˆ–æ²¡æœ‰å³å…„å¼Ÿï¼Œåç»§ä¸ºåŒäº² è‹¥ä¸ºæœ‰å³å…„å¼Ÿçš„å·¦å­©å­ï¼Œä¸”å³å…„å¼Ÿä¸ºå¶å­ç»“ç‚¹ï¼Œåç»§ä¸ºå³å…„å¼Ÿ è‹¥ä¸ºæœ‰å³å…„å¼Ÿçš„å·¦å­©å­ï¼Œä¸”å³å…„å¼Ÿä¸æ˜¯å¶å­ç»“ç‚¹ï¼Œåˆ™åç»§ä¸ºå³å…„å¼Ÿååºéå†çš„ç¬¬ä¸€ä¸ªç»“ç‚¹ ååºæ‰¾åˆ°ç»“ç‚¹çš„åç»§ è‹¥ç»“ç‚¹ä¸ºæ ¹ç»“ç‚¹ï¼Œå‰é©±ä¸ºç©º è‹¥ç»“ç‚¹ä¸ºåŒäº²çš„å·¦å­©å­æˆ–æ²¡æœ‰å·¦å…„å¼Ÿï¼Œå‰é©±ä¸ºåŒäº² è‹¥ä¸ºæœ‰å·¦å…„å¼Ÿçš„å³å­©å­ï¼Œä¸”å·¦å…„å¼Ÿä¸ºå¶å­ç»“ç‚¹ï¼Œå‰é©±ä¸ºå·¦å…„å¼Ÿ è‹¥ä¸ºæœ‰å·¦å…„å¼Ÿçš„å³å­©å­ï¼Œä¸”å·¦å…„å¼Ÿä¸æ˜¯å¶å­ç»“ç‚¹ï¼Œåˆ™å‰é©±ä¸ºå·¦å…„å¼Ÿå…ˆåºéå†çš„æœ€åä¸€ä¸ªç»“ç‚¹ å…ˆåºæ‰¾åˆ°åç»§çš„æ–¹æ³• è‹¥è¯¥ç»“ç‚¹æ— å³å­©å­ï¼Œåç»§ç”±å³å­©å­æŒ‡å‘ è‹¥è¯¥èŠ‚æœ‰å·¦å³å­©å­ï¼Œå…¶åç»§ä¸ºå·¦å­©å­ è‹¥è¯¥ç»“ç‚¹æœ‰å³å­©å­ä¸”æ— å·¦å­©å­ï¼Œå…¶åç»§ä¸ºå³å­©å­ æ¶‰åŠæ±‚ç»“ç‚¹çš„åŒäº²çš„é—®é¢˜â€”â€”â€”ä¸‰å‰é“¾è¡¨ æ ‘çš„å­˜å‚¨ç»“æ„åŒäº²è¡¨ç¤ºæ³•å¯ä»¥ç”¨äºé¡ºåºå­˜å‚¨ #define MAX_TREE_SIZE 100 typedef struct{ ElemType data; int parent; }PTNode; typedef struct{ PTNode nodes[MAX_TREE_SIZE]; int n;//ç»“ç‚¹æ•° }PTree; å­©å­è¡¨ç¤ºæ³•#define MAX_TREE_SIZE 100 typedef struct{ int child; struct CTNode *next; }*ChildPtr; typedef struct{ ElemType data; ChildPtr firstchild; }CTBox; typedef struct { CTBox nodes[MAX_TREE_SIZE]; int n,r;//ç»“ç‚¹æ•°å’Œæ ¹çš„ä½ç½® }CTree; å­©å­å…„å¼Ÿè¡¨ç¤ºæ³•typedef struct CSNode{ ElemType data; struct CSNode *firstchild,*nextsibling; }CSNode,*CSTree; æ ‘çš„éå†å…ˆæ ¹éå†&lt;â€”-&gt;äºŒå‰æ ‘çš„å…ˆåºéå† åæ ¹éå†&lt;â€”-&gt;äºŒå‰æ ‘çš„ä¸­åºéå† åº”ç”¨ï¼šé€šå¸¸ä»¥å­©å­-å…„å¼Ÿé“¾è¡¨ç¤º ç»Ÿè®¡æ ‘çš„é«˜åº¦ ç»Ÿè®¡æ ‘ä¸­å¶å­ç»“ç‚¹çš„ä¸ªæ•°ï¼ˆå¶å­ç»“ç‚¹çš„æ ‡å¿—ï¼šFirstchildä¸ºç©ºï¼‰ æ±‚æ ‘çš„åº¦ æ ‘å’Œæ£®æ—ä¸äºŒå‰æ ‘ä¹‹é—´çš„è½¬æ¢â€¦æ²¡è®²ï¼Œä¸çŸ¥é“è€ƒä¸è€ƒ Huffmanæ ‘ç›¸å…³æ¦‚å¿µï¼šæœ€ä¼˜æ ‘ï¼Œè·¯å¾„é•¿åº¦ï¼ˆå¸¦æƒï¼‰ï¼Œç»“ç‚¹å¸¦æƒè·¯å¾„é•¿åº¦ï¼Œ$WPL=\\sum_{i=1}^nw_il_i$ Huffmanç¼–ç ï¼ˆç®—æ³•åº”è¯¥ä¸è€ƒï¼Œè€ƒä¹Ÿæ— æ‰€è°“ï¼‰ å¼€æ‹“é—®é¢˜æ±‚è§£ç›¸å…³æ€è·¯è¯¾æœ¬æ²¡è®²ï¼Ÿã€‚ï¼Ÿåº”è¯¥ä¸è€ƒOvO åˆ’åˆ†ç­‰ä»·ç±»ï¼Œå›æº¯æ³•æ±‚è§£é—®é¢˜ï¼Œæ ‘çš„è®¡æ•°/ç¼–å· å›¾ç›¸å…³æ¦‚å¿µï¼šæœ‰å‘å›¾ï¼Œæ— å‘å›¾ï¼Œå¸¦æƒ/æ— æƒå›¾è·¯å¾„å’Œè¿é€šæ€§ï¼Œè¿é€šå’Œå¼ºè¿é€šï¼Œå­å›¾ï¼Œç”Ÿæˆæ ‘ï¼Œé¡¶ç‚¹/å¼§ï¼ˆç›¸å…³æ¦‚å¿µå¤ä¹ å›¾è®ºå†å†™ï¼‰ ä¸€èˆ¬ç®—æ³•ä¸­ä¸è€ƒè™‘å¸¦æƒå›¾çš„æƒå€¼ä¸ºè´Ÿæ•°çš„æƒ…å†µ åŸºæœ¬æ“ä½œ PS:æ“ä½œåŒ…å«å¯¹ç‚¹vexï¼Œå¯¹è¾¹arcçš„æ“ä½œ Status LocateVex(G,u); Status GetVex(G,v); Status FirstAdjVex(G,v); Status NextAdjVex(G,v,w); Status InsertVex(G,v); Status InsertArc(&amp;G,v,w); Status DeleteVex(&amp;G,v); Status DeleteArc(&amp;G,v,w); Status DFSTraverse(G,v,Visit()); Status BFSTraverse(G,v,Visit()); å›¾çš„å­˜å‚¨ç»“æ„ç”¨é¡ºåºè¡¨å­˜å‚¨é¡¶ç‚¹é›†ï¼Œä¸æ˜¯é¡ºåºæ˜ åƒ æœ€å¸¸ç”¨çš„è¿˜æ˜¯é‚»æ¥è¡¨ ç”¨ä»¥ä¸‹æ–¹æ³•å­˜å‚¨å…³ç³»é›†åˆ æ•°ç»„è¡¨ç¤ºâ€”é‚»æ¥çŸ©é˜µ#define INFINITY INT_MAX typedef enum{DG,DN,AG,AN}GraphKind;//æœ‰å‘/æ— å‘ï¼Œå¸¦æƒ/æ— æƒ typedef struct ArcCell{ //å¸¦æƒå›¾ï¼šadjä»£è¡¨æƒå€¼ï¼ŒINFINITYä»£è¡¨ä¸ç›¸é‚» //æ— æƒå›¾0ä»£è¡¨ä¸ç›¸é‚»ï¼Œ1ä»£è¡¨ç›¸é‚» int adj; InfoType *info;//æŒ‡å‘ç›¸å…³ä¿¡æ¯çš„æŒ‡é’ˆ }ArcCell,AdjMatrix[MAX_VERTEX_NUM][MAX_VEXTEX_NUM]; typedef struct { VextexType vexs[MAX_VEXTEX_NUM]; AdjMatrix arcs; int vexnum; int arcnum; GraphKind kind; }MGraph; æ— å‘å›¾çš„é‚»æ¥çŸ©é˜µï¼šå¯¹é˜µçŸ©é˜µ é“¾è¡¨è¡¨ç¤ºâ€”é‚»æ¥è¡¨/é€†é‚»æ¥è¡¨typedef struct ArcNode{ int adjvex; struct ArcNode *nextarc; InfoType *info; }ArcNode; typedef struct { VexType data; ArcNode *firstarc; }VNode,AdjList[MAX_VERTEX_NUM]; typedef struct{ AdjList vertices; int vexnum,arcnum; GraphKind kind; }ALGraph; å¯¹äºæœ‰å‘å›¾ï¼Œæ¯”è¾ƒå®¹æ˜“è®¡ç®—çš„æ˜¯é¡¶ç‚¹çš„å‡ºåº¦ï¼Œè€Œå…¥åº¦è¦å¯¹æ‰€æœ‰çš„è¾¹è¿›è¡Œéå†æ‰èƒ½æ±‚å‡ºï¼ˆåä¹‹ä¸ºé€†é‚»æ¥è¡¨ï¼‰ã€‚ å¯¹äºç¨€ç–å›¾ï¼ˆ$v&gt;log_2a$ï¼‰ï¼Œå¤šé‡‡ç”¨é‚»æ¥è¡¨ï¼Œé¿å…ç©ºé—´æµªè´¹ï¼Œå¦åˆ™å¯ä»¥é€‰ç”¨é‚»æ¥çŸ©é˜µã€‚ åå­—é“¾è¡¨â€”æœ‰å‘å›¾å¼§ç»“ç‚¹æ•°=å¼§æ•° æ–¹ä¾¿æ±‚å‡ºé¡¶ç‚¹çš„å…¥åº¦å’Œ å‡ºåº¦ typedef struct ArcBox{ int tailvex,headvex; struct ArcBox *hlink,*tlink; InfoType *info; }ArcBox; typedef struct VexNode{ VextexType data; ArcBox *firstin,*firstout; }VexNode; typedef struct{ VexNode xlist[MAX_VERTEX_NUM]; int vexnum,arcnum; }OLGraph; é‚»æ¥å¤šé‡è¡¨â€”æ— å‘å›¾é‚»æ¥è¡¨ä¸­ï¼šè¾¹ç»“ç‚¹æ•°==2*è¾¹æ•° ä¸´ç•Œå¤šé‡è¡¨ï¼šè¾¹ç»“ç‚¹æ•°==è¾¹æ•° typedef enum{unvisited ,visited}VisitIf; //è¾¹ç»“ç‚¹ typedef struct EBox{ VisitIf mark; int ivex,jvex; struct Ebox *ilink,jlink; InfoType *info; }EBox; //é¡¶ç‚¹ç»“ç‚¹ typedef struct VexBox{ VexType data; EBox *firstedge; }VexBox; //ä¸´ç•Œå¤šé‡è¡¨ typedef struct { VexBox adjmulist[MAX_VEXTEX_NUM]; int vexnum,edgenum; }AMLGraph; å›¾çš„éå†å¯¹é¡¶ç‚¹çš„éå†â€”â€”å¼•å…¥æ ‡è®°æ•°ç»„visitd[0,â€¦n-1]ï¼Œé˜²æ­¢é¡¶ç‚¹è¢«å¤šæ¬¡è®¿é—®ã€‚ è®¿é—®ç»“æŸå¯ä»¥å¾—åˆ°å›¾çš„ç”Ÿæˆæ ‘ï¼ˆè¿é€šå›¾å¯ä»¥ä»ä¸€ä¸ªé¡¶ç‚¹å®Œæˆå…¨éƒ¨çš„éå†ï¼Œéè¿é€šå›¾è¦åœ¨å¤–éƒ¨åŠ å¾ªç¯ç¡®ä¿æ‰€æœ‰é¡¶ç‚¹å‡è¢«è®¿é—®ï¼Œæœ‰å‘å›¾æ³¨æ„å¼ºè¿é€šï¼‰ï¼Œåç»­è¿é€šæ€§æ¨¡å—å°†è®¨è®ºã€‚ å¯ä»¥åŸºäºå›¾çš„å¤šç§å­˜å‚¨ç»“æ„è¿›è¡Œç›¸ä¼¼çš„éå†ï¼Œç®—æ³•å¯ä»¥åŸºäºADT Graphï¼ˆè°ƒç”¨ADTçš„å‡½æ•°ï¼Œå¦‚FirstAdjVexï¼ŒNextAdjVexç­‰ï¼‰æˆ–æŸç§å­˜å‚¨ç»“æ„å†™ã€‚ DFSæ·±åº¦ä¼˜å…ˆéå†â€”â€”æ ‘çš„å…ˆåºéå† ç”Ÿæˆä»èµ·ç‚¹vå‡ºå‘çš„æ·±åº¦ä¼˜å…ˆç”Ÿæˆæ ‘ï¼Œvå¯èƒ½å­˜åœ¨å¤šä¸ªå­æ ‘ éé€’å½’å®ç°ï¼šåˆ©ç”¨æ ˆåŠæ—¶è¿›è¡Œç°åœºä¿æŠ¤å’Œç°åœºç»´æŠ¤ BFSå¹¿åº¦ä¼˜å…ˆéå†â€”â€”æ ‘çš„å±‚æ¬¡éå† åˆ¤æ–­ä¸¤ä¸ªé¡¶ç‚¹æ˜¯å¦å­˜åœ¨è·¯å¾„ å¾—åˆ°æŸç‚¹åˆ°ä»»æ„ä¸€ä¸ªé¡¶ç‚¹ä¹‹é—´çš„æœ€çŸ­è·¯å¾„ï¼ˆæ— æƒï¼‰ æ±‚è·ç¦»vçš„æœ€çŸ­è·ç¦»æœ€é•¿/æœ€çŸ­çš„é¡¶ç‚¹ æ±‚è·ç¦»vè·ç¦»ä¸ºkçš„æ‰€æœ‰é¡¶ç‚¹ éå†ç®—æ³•çš„åº”ç”¨ æ±‚ä¸€æ¡åŒ…å«å›¾ä¸­æ‰€æœ‰é¡¶ç‚¹çš„ç®€å•è·¯å¾„ ä¸ä¸€å®šå­˜åœ¨ï¼ŒåŸºäºDFSå¯»æ‰¾ï¼Œæ˜¯å¦èƒ½æ‰¾åˆ°ä¸å…·ä½“é¡¶ç‚¹çš„é€‰æ‹©æœ‰å…³ å¯¹DFSçš„ä¿®æ”¹ï¼šè¦å›æº¯ï¼Œæ·»åŠ è®¡æ•°å™¨è®°å½•å½“å‰è·¯å¾„çš„ç»“ç‚¹æ•°nï¼ŒæŸ¥æ‰¾å¤±è´¥æ—¶æ¢å¤åŸæ¥çš„çŠ¶æ€ï¼Œn-- å¯ä»¥ä¿®æ”¹ç®—æ³•ï¼Œé€‰æ‹©è¾“å‡ºä¸€æ¡è·¯å¾„æˆ–è€…å…¨éƒ¨è·¯å¾„ï¼ˆæœ€å¥½æ˜¯ä¸€æ¡ï¼Ÿï¼‰ï¼Œç»Ÿè®¡æœ€çŸ­è·¯å¾„çš„æ¡æ•° æ±‚è·ç¦»vçš„æœ€çŸ­è·ç¦»æœ€é•¿çš„é¡¶ç‚¹å’Œæœ€é•¿çš„è·¯å¾„å€¼ å¯¹BFSè¿›è¡Œä¿®æ”¹ï¼Œåœ¨æ¯å±‚ç»“å°¾å…¥é˜Ÿä¸€ä¸ªç‰¹æ®Šå…ƒç´  æœ€åä¸€ä¸ªå‡ºé˜Ÿåˆ—çš„ä¸€å®šæ˜¯è·¯å¾„æœ€é•¿çš„é¡¶ç‚¹ å›¾çš„è¿é€šæ€§é—®é¢˜åŸºæœ¬æ¦‚å¿µï¼šè¿é€šåˆ†é‡çš„é¡¶ç‚¹é›†ï¼Œç”Ÿæˆæ ‘ï¼ŒDFSç”Ÿæˆæ ‘ï¼ŒBFSç”Ÿæˆæ ‘ï¼Œç”Ÿæˆæ£®æ— åŒæ ·å¯ä»¥åŸºäºADTGraphæˆ–å…·ä½“çš„å­˜å‚¨æ–¹å¼å†™å‡ºä¸åŒçš„ç®—æ³• BFS/DFSç”Ÿæˆæ ‘/ç”Ÿæˆæ£®æ— æœ‰å‘å›¾çš„å¼ºè¿é€šåˆ†é‡ ä»æŸé¡¶ç‚¹å‡ºå‘ï¼Œä»¥è¯¥é¡¶ç‚¹ä¸ºå°¾åšDFSï¼ŒæŒ‰ç…§å…¶æ‰€æœ‰é‚»æ¥ç‚¹çš„æœç´¢éƒ½å®Œæˆçš„é¡ºåºï¼ˆé€€å‡ºDFSçš„é¡ºåºï¼‰å­˜å‚¨åˆ°æ•°ç»„ ä»å­˜å‚¨åˆ°æ•°ç»„çš„é¡¶ç‚¹å‡ºå‘ï¼Œæ²¿ç€è¯¥é¡¶ç‚¹ä¸ºå¤´çš„å¼§è¿›è¡Œé€†å‘DFSï¼Œèƒ½è®¿é—®åˆ°çš„é¡¶ç‚¹åˆ™åœ¨åŒä¸€ä¸ªå¼ºè¿é€šåˆ†é‡ä¸­ å¤æ‚åº¦è¿‘ä¼¼å’ŒDFSéå†çš„å¤æ‚åº¦ç›¸åŒ æœ€å°ç”Ÿæˆæ ‘MSTâ€”â€”æ— å‘è¿é€šç½‘çš„æœ€å°ä»£ä»·ç”Ÿæˆæ ‘ â€œè‹¥ï¼ˆuï¼Œv)ä¸ºå…·æœ‰æœ€å°æƒå€¼çš„è¾¹ï¼Œåˆ™å¿…å­˜åœ¨åŒ…å«è¯¥è¾¹çš„æœ€å°ç”Ÿæˆæ ‘â€ Primç®—æ³•â€”â€”æœ€å°ç”Ÿæˆæ ‘ä¸æ–­å£®å¤§çš„è¿‡ç¨‹ é€‚ç”¨äºç¨ å¯†å›¾$T(N,e)=O(N^2)$ Kruskalç®—æ³•â€”â€”è¿é€šåˆ†é‡ä¸æ–­åˆå¹¶çš„è¿‡ç¨‹ é€‚ç”¨äºç¨€ç–å›¾$T(N,e)=O(N*log (e))$ å…³èŠ‚ç‚¹å’Œé‡è¿é€šåˆ†é‡ å…³èŠ‚ç‚¹ï¼šåˆ é™¤våä¸€ä¸ªè¿é€šåˆ†é‡å˜ä¸ºä¸¤ä¸ª/ä¸¤ä¸ªä»¥ä¸Š è‹¥ç”Ÿæˆæ ‘çš„æ ¹è‡³å°‘æœ‰ä¸¤æ£µæˆ–ä¸¤æ£µä»¥ä¸Šçš„å­æ ‘ï¼Œåˆ™è¯¥ç»“ç‚¹å¿…æ˜¯å…³èŠ‚ç‚¹ è‹¥ç”Ÿæˆæ ‘çš„æŸéå¶å­ç»“ç‚¹vçš„æŸæ£µå­æ ‘çš„ç»“ç‚¹å‡æ²¡æœ‰æŒ‡å‘vçš„ç¥–å…ˆçš„è¾¹ï¼Œåˆ™vä¸ºå…³èŠ‚ç‚¹ å¶å­ç»“ç‚¹ä¸€å®šä¸æ˜¯å…³èŠ‚ç‚¹ é‡è¿é€šå›¾ï¼šä¸å«å…³èŠ‚ç‚¹çš„å›¾ï¼Œä¿è¯äº†ä»»æ„ä¸¤ä¸ªé¡¶ç‚¹è‡³å°‘å­˜åœ¨ä¸¤æ¡è·¯å¾„ è¿é€šåº¦ï¼šè‹¥è¿é€šå›¾Gè‡³å°‘åˆ å»Kä¸ªé¡¶ç‚¹æ‰èƒ½å˜æˆä¸è¿é€šï¼Œåˆ™è¯¥å›¾çš„è¿é€šåº¦ä¸ºk æ”¹é€ DFSå¯ä»¥å¾—åˆ°å›¾çš„å…³èŠ‚ç‚¹ï¼Œåˆ¤æ–­æ˜¯å¦ä¸ºé‡è¿é€šå›¾ å¼•å…¥æ•°ç»„low[v]:ç”Ÿæˆæ ‘ä¸­ä»¥vä¸ºæ ¹çš„å­æ ‘ä¸­ç»“ç‚¹åˆ°vçš„ç¥–å…ˆçš„è¾¹æ‰€å…³è”çš„ç¥–å…ˆçš„æœ€å°æ¬¡åºå· è‹¥å¯¹äºvï¼Œvçš„å­©å­ç»“ç‚¹wæœ‰low[w]&gt;=visited[v]ï¼Œåˆ™è¯´æ˜vä¸ºå…³èŠ‚ç‚¹ æœ‰å‘æ— ç¯å›¾ï¼ˆ DAGï¼‰çš„åº”ç”¨ æ£€æµ‹æœ‰å‘å›¾ä¸­æ˜¯å¦æœ‰ç¯ï¼š ä»é¡¶ç‚¹vå‡ºå‘ï¼Œè‹¥DFSç»“æŸå‰å‘ç°å‡ºç°uåˆ°vçš„å›è¾¹ï¼Œåˆ™æœ‰ç¯ DAGæ˜¯æè¿°ä¸€é¡¹æ´»åŠ¨æˆ–ç³»ç»Ÿçš„è¿›è¡Œè¿‡ç¨‹çš„å·¥å…·ï¼š â€‹ é¡¶ç‚¹â€”å­å·¥ç¨‹ï¼Œè¾¹â€”å­å·¥ç¨‹ä¹‹é—´çš„çº¦æŸ åº”ç”¨ï¼š æ‹“æ‰‘æ’åºé—®é¢˜æè¿°ï¼šååº-&gt;å…¨åº ååºï¼šé›†åˆXä¸Šçš„å…ƒç´ æ˜¯è‡ªåçš„ï¼Œåå¯¹ç§°çš„ï¼Œä¼ é€’çš„ ä¸€ã€AOVç½‘ï¼šActivity on vextex network è¿›è¡Œæ‹“æ‰‘æ’åºçš„æ–¹æ³•ï¼š åœ¨æœ‰å‘å›¾ä¸­é€‰å–ä¸€ä¸ªæ²¡æœ‰å‰é©±çš„é¡¶ç‚¹å¹¶è¾“å‡º åœ¨å›¾ä¸­åˆ é™¤è¯¥é¡¶ç‚¹å’Œä»¥è¯¥é¡¶ç‚¹ä¸ºå°¾çš„å¼§ è½¬1ï¼Œé™¤éå·²ç»è¾“å‡ºå…¨éƒ¨é¡¶ç‚¹æˆ–ä¸å­˜åœ¨æ— å‰é©±çš„é¡¶ç‚¹ æœ‰å‘æ— ç¯å›¾ä¿è¯äº†è¯¥å›¾å­˜åœ¨æ‹“æ‰‘æ’åºï¼Œå­˜åœ¨æ‹“æ‰‘æ’åºä¿è¯äº†æœ‰å‘å›¾ä¸­æ²¡æœ‰ç¯ å¯¹äºä¸€ä¸ªæœ‰å‘æ— ç¯å›¾ï¼Œè¿›è¡ŒDFSéå†ï¼Œç¬¬ä¸€ä¸ªé€€å‡ºå¾ªç¯çš„é¡¶ç‚¹å³ä¸ºå‡ºåº¦ä¸º0çš„é¡¶ç‚¹ï¼Œï¼ˆå¯ä»¥ï¼‰æ˜¯æ‹“æ‰‘æ’åºçš„æœ€åä¸€ä¸ªé¡¶ç‚¹ è‹¥æœ‰å‘å›¾çš„é‚»æ¥çŸ©é˜µä¸ºä¸‰è§’çŸ©é˜µï¼Œåˆ™è¯¥é€”ä¸­å­˜åœ¨æ‹“æ‰‘æœ‰åºåºåˆ— äºŒã€AOEç½‘ï¼šActivity on edge network é—®é¢˜ï¼šå®Œæˆæ•´é¡¹å·¥ç¨‹çš„æœ€çŸ­æ—¶é—´/å…³é”®è·¯å¾„/äº‹ä»¶çš„æœ€æ—©å‘ç”Ÿæ—¶é—´ å…³é”®æ´»åŠ¨ï¼šæœ€æ—©å‘ç”Ÿæ—¶é—´ï¼ˆe(i)ï¼‰==æœ€æ™šå‘ç”Ÿæ—¶é—´ï¼ˆl(i)ï¼‰ æœ€æ—©å‘ç”Ÿæ—¶é—´ï¼šæ‹“æ‰‘æœ‰åº æœ€æ™šå‘ç”Ÿæ—¶é—´ï¼šé€†æ‹“æ‰‘æœ‰åº å…³é”®è·¯å¾„ï¼šè¾“å‡ºå…³é”®æ´»åŠ¨ï¼ˆå¯èƒ½ä¸æ­¢ä¸€æ¡ï¼‰ æœ€çŸ­è·¯å¾„æ— æƒå›¾çš„æœ€çŸ­è·¯å¾„ï¼šå¹¿åº¦ä¼˜å…ˆæœç´¢ å¸¦æƒæœ‰å‘å›¾çš„æœ€çŸ­è·¯å¾„â€”â€”dijkstraç®—æ³• æŒ‰è·¯å¾„é•¿åº¦é€’å¢çš„é¡ºåºäº§ç”Ÿæœ€çŸ­è·¯å¾„ æ±‚ä»»æ„ä¸¤ä¸ªé¡¶ç‚¹çš„æœ€çŸ­è·¯å¾„ å¯¹Dijkstraç®—æ³•è¿›è¡Œå¾ªç¯ï¼š$O(T,e)=O(n^3)$ å…·ä½“å®ç°åº”è¯¥ä¸ä¼šè€ƒï¼Œä¼šè€ƒç”»å›¾ï¼Ÿ Floydï¼ˆWallshallç®—æ³•ï¼‰ï¼šæ±‚viï¼Œvjä¹‹é—´çš„æœ€çŸ­è·¯å¾„ï¼Œä¾æ¬¡ä½¿å¾—ä¸­é—´è·¯å¾„åºå·ä¸å¤§äºkçš„æœ€çŸ­è·¯å¾„ï¼Œkä¾æ¬¡é€’å¢ã€‚ æŸ¥æ‰¾Search Tableæ“ä½œï¼šæ£€ç´¢/æŸ¥æ‰¾ï¼ˆé™æ€ï¼‰ï¼Œæ’å…¥/åˆ é™¤ï¼ˆåŠ¨æ€ï¼‰ å…³é”®å­—ï¼šä¸»å…³é”®å­—å”¯ä¸€ï¼Œæ¬¡å…³é”®å­—ä¸å”¯ä¸€ é™æ€æŸ¥æ‰¾é¡ºåºæŸ¥æ‰¾é€šè¿‡é¡ºåºè¡¨/çº¿æ€§é“¾è¡¨è¿›è¡ŒæŸ¥æ‰¾ 0çš„ä½ç½®è®¾ç½®â€œå“¨å…µâ€ï¼šé¿å…æ¯ä¸€æ¬¡æŸ¥æ‰¾éƒ½è¦åˆ¤æ–­æ˜¯å¦æŸ¥æ‰¾å®Œæ¯•ï¼Œå‡å°‘æ¯”è¾ƒæ¬¡æ•° æŸ¥æ‰¾æˆåŠŸï¼šASL=$(n+1)/2$ æŸ¥æ‰¾ä¸æˆåŠŸï¼šASL=n+1 æœ‰åºè¡¨çš„æŸ¥æ‰¾ æŠ˜åŠæŸ¥æ‰¾ åŸºæœ¬æ€æƒ³ï¼šç”¨low/highåšæ ‡è®°ï¼ŒæŸ¥æ‰¾åŒºé—´æŠ˜åŠç¼©å° æ€§èƒ½åˆ†æï¼šæŸ¥æ‰¾è¿‡ç¨‹å¯ä»¥ç”¨äºŒå‰æ ‘åˆ¤å®šæ ‘è¡¨ç¤ºï¼Œåˆ¤å®šæ ‘çš„å½¢æ€ä¸nç›´æ¥ç›¸å…³ï¼ˆä¸æ˜¯å®Œå…¨äºŒå‰æ ‘ä½†èƒœä¼¼å®Œå…¨äºŒå‰æ ‘ï¼‰ï¼ŒæŸ¥æ‰¾å±‚æ¬¡å³ä¸ºäºŒå‰æ ‘çš„å±‚æ¬¡ï¼Œä¹Ÿä»£è¡¨ASL æŸ¥æ‰¾æˆåŠŸæˆ–ä¸æˆåŠŸï¼š$ASL&lt;=[log_2n]+ 1$ n&gt;=50æ—¶ï¼Œå¯è¿‘ä¼¼å¾—åˆ°ç»“æœï¼š$ASL_{bs}\\approx log_2(n+1)-1$ æ–æ³¢é‚£å¥‘æŸ¥æ‰¾ æ ¹æ®æ–æ³¢é‚£å¥‘çš„ç‰¹å¾å¯¹æ ‡è¿›è¡Œåˆ†å‰²:å¼€å§‹è¡¨ä¸­çš„è®°å½•ä¸ªæ•°æ¯”æ–æ³¢é‚£å¥‘æ•°å°1ï¼Œåˆ™å°†å®šå€¼ä¸F(n-1)è¿›è¡Œæ¯”è¾ƒï¼Œç±»ä¼¼æŠ˜åŠæŸ¥æ‰¾ ç‰¹ç‚¹ï¼šåˆ†å‰²æ—¶åªéœ€è¿›æ€§åŠ å‡è¿ç®— å¹³å‡æ€§èƒ½æ¯”æŠ˜åŠæŸ¥æ‰¾å¥½ï¼Œä½†æœ€åçš„æƒ…å†µæ¯”æŠ˜åŠæŸ¥æ‰¾ç³Ÿç³• æ’å€¼æŸ¥æ‰¾ $i=\\frac{key-ST.elem[l].key}{ST.elem[h].key-ST.elem[l].key}(h-l+1)$ åªé€‚ç”¨äºå…³é”®å­—å‡åŒ€åˆ†å¸ƒçš„æƒ…å†µï¼Œè¿™ç§æƒ…å†µä¸‹å¹³å‡æ€§èƒ½ä¼˜äºæŠ˜åŠæŸ¥æ‰¾ é™æ€æ ‘è¡¨æŸ¥æ‰¾ æ ¹æ®å„ä¸ªè®°å½•çš„æŸ¥æ‰¾æ¦‚ç‡æ±‚ASL PHå€¼ï¼šåˆ¤å®šæ ‘å†…å¸¦æƒè·¯å¾„é•¿åº¦$PH=\\sum_{i=1}^nw_ih_i$,å…¶ä¸­$w_i=c*p_i$ä¸ºæƒï¼Œ$h_i$ä¸ºå±‚æ¬¡ PHå€¼æœ€å°ï¼šé™æ€æœ€ä¼˜æŸ¥æ‰¾æ ‘â€”â€”æ„é€ éœ€è¦çš„æ—¶é—´å¼€é”€è¿‡é«˜ æ„é€ è¾ƒå¥½çš„æ¬¡ä¼˜æŸ¥æ‰¾æ ‘ â€¦å†™åˆ°è¿™é‡Œå‘ç°æŸ¥æ‰¾æ ‘è¡¨ä¸è€ƒï¼Œå†è§ ç´¢å¼•é¡ºåºè¡¨ èµ·å› ï¼šé¡ºåºæŸ¥æ‰¾è¡¨æ•ˆç‡ä½è€ŒæŠ˜åŠæŸ¥æ‰¾ç­‰è¦æ±‚æŸ¥æ‰¾è¡¨æœ‰åº æ€æƒ³ï¼šåˆ†å—æœ‰åºâ€”â€”ç´¢å¼•æœ‰åºï¼ˆç´¢å¼•åŒ…å«æœ€å¤§é¡¹å’Œèµ·å§‹æŒ‡é’ˆï¼‰ è¿‡ç¨‹ï¼šå…ˆæŠ˜åŠæŸ¥æ‰¾è®°å½•æ‰€åœ¨çš„å—ï¼Œå†é¡ºåºæŸ¥æ‰¾å…ƒç´  $ASL_{bs}=L_b(æŸ¥æ‰¾å—)+L_w(æŸ¥æ‰¾å…ƒç´ )$ åŠ¨æ€æŸ¥æ‰¾äºŒå‰æŸ¥æ‰¾æ ‘BSTBinary Search TreeæŸ¥æ‰¾ç®—æ³•å¯ä»¥åŸºäºäºŒå‰æ ‘çš„å…ˆåºéå†ç®—æ³•å†™å‡º ä¸­åºéå†BSTå¯ä»¥å¾—åˆ°å…³é”®å­—çš„æœ‰åºåºåˆ— BSTçš„æ’å…¥ç®—æ³•ï¼šæŸ¥æ‰¾å¤±è´¥çš„åŒæ—¶æ·»åŠ å¶å­ç»“ç‚¹ BSTçš„åˆ é™¤ç®—æ³•ï¼š è‹¥Pä¸ºå¶å­ç»“ç‚¹ï¼Œç›´æ¥åˆ é™¤å¹¶ä¿®æ”¹åŒäº²çš„æŒ‡é’ˆåŸŸ è‹¥Påªæœ‰å·¦å­æ ‘æˆ–å³å­æ ‘ï¼Œå°†Påˆ é™¤å¹¶ä½¿Pçš„åŒäº²æŒ‡é’ˆåŸŸæŒ‡å‘Pçš„å­©å­ è‹¥Pæœ‰å·¦å³å­æ ‘ï¼Œå°†Pä¸Pçš„å³å­æ ‘çš„æœ€å·¦è¾¹çš„å…ƒç´ è¿›è¡Œäº’æ¢ï¼ˆä¸­åºéå†çš„é¦–ä¸ªå…ƒç´ ï¼‰ï¼Œæ¢è¨€ä¹‹ï¼Œå°†Pä¸Påœ¨æ ‘ä¸­ä¸­åºè®¿é—®åºåˆ—çš„ç›´æ¥å‰é©±æˆ–ç›´æ¥åç»§è¿›è¡Œäº¤æ¢å³å¯ï¼Œé¿å…æ ‘çš„é•¿é«˜ BSTçš„å»ºç«‹ï¼šäºŒå‰æ ‘çš„å½¢æ€ä¸è¾“å…¥çš„æ¬¡åºç›´æ¥ç›¸å…³ï¼Œè‹¥åŸæœ¬æœ‰åºå°†å¾—åˆ°æ¯å±‚åªæœ‰ä¸€ä¸ªç»“ç‚¹çš„ç³Ÿç³•æƒ…å†µ å¹³å‡æ€§èƒ½åˆ†æï¼š$P(n)&lt;=2(1+1\\frac{1}{n})ln\\ n$ å¹³è¡¡äºŒå‰æ ‘AVLæ ‘æ·±åº¦ä¸log(N)åŒé‡çº§ å¼•å…¥å¹³è¡¡å› å­BFï¼š-1ï¼Œ0ï¼Œ1 AVLæ ‘çš„æ—‹è½¬éƒ¨åˆ†ä¸ä¼šå•ç‹¬è€ƒå¯Ÿç®—æ³•è®¾è®¡ï¼Œç†è§£è¿‡ç¨‹å³å¯ LLå‹æ—‹è½¬ï¼šåœ¨Aç»“ç‚¹çš„å·¦å­©å­çš„å·¦å­æ ‘æ’å…¥ç»“ç‚¹ RRå‹æ—‹è½¬ï¼šåœ¨Aç»“ç‚¹çš„å³å­©å­çš„å³å­æ ‘æ’å…¥ç»“ç‚¹ LRå‹æ—‹è½¬ï¼šåœ¨Aç»“ç‚¹çš„å·¦å­©å­çš„å³å­æ ‘æ’å…¥ç»“ç‚¹ï¼Œå…ˆå·¦è½¬å†å³è½¬ RLå‹æ—‹è½¬ï¼šåœ¨Aç»“ç‚¹çš„å³å­©å­çš„å·¦å­æ ‘æ’å…¥ç»“ç‚¹ï¼Œå…ˆå³è½¬å†å·¦è½¬ åœ¨å¯¹AVLæ ‘è¿›è¡Œæ’å…¥å’Œåˆ é™¤æ“ä½œæ—¶åŠæ—¶ç»´æŠ¤å¹³è¡¡ æ€§èƒ½åˆ†æï¼š$T(N)=O(log\\ N)$ B-æ ‘å®šä¹‰ï¼š æ¯ä¸ªç»“ç‚¹è‡³å¤šæœ‰mä¸ªå­æ ‘ è‹¥æ ¹ç»“ç‚¹ä¸æ˜¯å¶å­ç»“ç‚¹ï¼Œè‡³å°‘æœ‰ä¸¤æ£µå­æ ‘ é™¤æ ¹ç»“ç‚¹å¤–çš„éå¾—ç»ˆç«¯ç»“ç‚¹è‡³å°‘$\\lceil m/2\\rceil$ä¸ªå­æ ‘ éç»ˆç«¯ç»“ç‚¹åŒ…å«ä»¥ä¸‹ä¿¡æ¯ï¼š$(n,A_0,K_1,A_1,K_2,â€¦,K_n,A_n)$ï¼Œå…¶ä¸­nä¸ºå…³é”®å­—æ•°ç›®ï¼Œ$K_i$ä¸ºå…³é”®å­—ï¼Œ$A_i$ä¸ºæŒ‡é’ˆï¼Œä¸”$A_{i-1}$æŒ‡å‘çš„æ‰€æœ‰ç»“ç‚¹çš„å…³é”®å­—å°äº$K_i$,å¤§äº$K_{i-1}$ æ‰€æœ‰å¶å­ç»“ç‚¹éƒ½å‡ºç°åœ¨åŒä¸€å±‚æ¬¡ä¸Š,ä¸”ä¸æºå¸¦ä¿¡æ¯ï¼Œå¯ä»¥è§†ä½œæŸ¥æ‰¾å¤±è´¥ï¼ŒæŒ‡å‘è¿™äº›ç»“ç‚¹çš„æŒ‡é’ˆä¸ºç©ºï¼Œå›¾ä¸­è¡¨ç¤ºä¸ºF ç›¸å…³ç®—æ³• æŸ¥æ‰¾ï¼šçºµå‘æŸ¥ç»“ç‚¹ï¼Œæ¨ªå‘æŸ¥å…³é”®å­— é€šå¸¸å­˜å‚¨åœ¨ç£ç›˜ä¸­ï¼Œæ˜¯æ•°æ®åº“çš„ä¸»è¦ç´¢å¼•ç»“æ„ æŸ¥æ‰¾æ•ˆç‡çš„é¦–è¦å› ç´ ï¼šå±‚æ¬¡ é€šå¸¸å–m=3ï¼Œæ­¤æ—¶åˆç§°ä¸º2-3æ ‘ å«æœ‰Nä¸ªå…³é”®å­—çš„mé˜¶B-æ ‘çš„æœ€å¤§æ·±åº¦ï¼š$log_{\\lceil m/e\\rceil}(\\frac{N+1}{2})$ è¾ƒä¸ºç‰¹æ®Šçš„æ’å…¥åˆ é™¤æ“ä½œï¼š â€¦åº”è¯¥ä¸è€ƒå¯Ÿç®—æ³•ï¼Œè¦ä¼šç”»å›¾ B+æ ‘B-æ ‘çš„å˜å½¢æ ‘ï¼Œå…·ä½“åŒºåˆ«ï¼š æœ‰næ£µå­æ ‘çš„ç»“ç‚¹åŒ…å«äº†nä¸ªå…³é”®å­— æ‰€æœ‰å¶å­ç»“ç‚¹åŒ…å«äº†å…³é”®å­—çš„ä¿¡æ¯ï¼Œä»¥åŠæŒ‡å‘è¿™äº›å…³é”®å­—è®°å½•çš„æŒ‡é’ˆï¼Œä¸”å¶å­ç»“ç‚¹æœ¬èº«ä¾å…³é”®å­—çš„å¤§å°è‡ªå°è€Œå¤§æ’åº éç»ˆç«¯ç»“ç‚¹ä¸ºç´¢å¼•éƒ¨åˆ†ï¼Œç»“ç‚¹ä»…å«æœ‰æœ€å¤§æˆ–è€…æœ€å°å…³é”®å­— B+æ ‘ä¸æ˜¯æ ‘ï¼›æ”¯æŒé¡ºåºæŸ¥æ‰¾ï¼ˆæ¨ªå‘ï¼‰ï¼ŒéšæœºæŸ¥æ‰¾ï¼ˆçºµå‘ï¼‰ é”®æ ‘å¥½åƒä¸è€ƒé”®æ ‘ å“ˆå¸Œè¡¨Hashå‡½æ•°ï¼šH(key) ä¾¿äºä¸€æ¬¡å­˜å–ç¡®å®šæ‰€æŸ¥è®°å½• å°†ä¸€ç»„å…³é”®å­—åˆ©ç”¨H(key)å’Œå¤„ç†å†²çªçš„å‡½æ•°æ˜ å°„åˆ°æœ‰é™çš„è¿ç»­åœ°å€â€”â€”hashè¡¨ï¼ˆæ•£åˆ—ï¼‰ Hashå‡½æ•°çš„æ„é€ æ–¹æ³•ï¼š ç›´æ¥å®šå€æ³•ï¼ˆx) æ•°å­—åˆ†ææ³•/å¹³æ–¹å–ä¸­æ³• æŠ˜å å‘ï¼šç§»ä½å åŠ ï¼Œé—´ç•Œå åŠ  é™¤ç•™ä½™æ•°æ³• éšæœºæ•°æ³• â€¦ å¤„ç†å†²çªçš„æ–¹æ³•ï¼šs å¼€æ”¾å®šå€æ³• çº¿æ€§æ¢æµ‹å†æ•£åˆ—+1ï¼Œ+2ï¼Œâ€¦ å¹³æ–¹æ¢æµ‹å†æ•£åˆ—+1,-1,+4,-4 ä¼ªéšæœºæ¢æµ‹å†æ•£åˆ— é“¾åœ°å€æ³•ï¼šå…³é”®å­—ä¸ºåŒä¹‰è¯çš„çš„å„ä¸ªå…ƒç´ å­˜å‚¨åœ¨çº¿æ€§é“¾è¡¨ä¸­ å†å“ˆå¸Œæ³•ï¼š$H_i=RH_i(key),i=1,2,..k$ä¸æ˜“äº§ç”Ÿèšé›†ï¼Œä½†ä¼šå¢åŠ è®¡ç®—çš„æ—¶é—´ å»ºç«‹å…¬å…±æº¢å‡ºåŒºåŸŸï¼šå‘ç”Ÿå†²çªéƒ½å¡«å…¥æº¢å‡ºè¡¨ â€‹ äºŒæ¬¡èšé›†ï¼šåœ¨å¤„ç†åŒä¹‰è¯å†²çªçš„è¿‡ç¨‹ä¸­åˆæ·»åŠ äº†éåŒä¹‰è¯çš„å†²çªçš„ç°è±¡ Hashè¡¨çš„æŸ¥æ‰¾ç®—æ³•æ ¹æ®Hashå‡½æ•°ä»¥åŠå†²çªå¤„ç†æ–¹æ³•ç¡®å®š æŸ¥æ‰¾çš„ASLï¼šåˆ†æˆåŠŸä¸ä¸æˆåŠŸè®¡ç®—ï¼Œæ—¶é—´å¤æ‚åº¦ä¸ºæœªçŸ¥ è£…å¡«å› å­$\\alpha=$è®°å½•æ•°/Hashè¡¨è¡¨é•¿ é€šå¸¸Hashè¡¨é•¿må’Œé™¤ç•™ä½™æ•°æ³•çš„pçš„å…³ç³»ï¼š p&lt;=m,ä¸”pä¸ºç´ æ•°æˆ–æœ€å°ä¸åŒ…å«å°äº20çš„è´¨å› å­çš„åˆæ•°ã€‚","categories":[{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://sn1987a-1.github.io/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}],"tags":[{"name":"ä¸“ä¸šè¯¾","slug":"ä¸“ä¸šè¯¾","permalink":"http://sn1987a-1.github.io/tags/%E4%B8%93%E4%B8%9A%E8%AF%BE/"}]},{"title":"å›¾è®ºæœŸæœ«å¤ä¹ ","slug":"å›¾è®º","date":"2022-01-05T15:42:30.000Z","updated":"2022-02-26T07:11:20.781Z","comments":true,"path":"posts/12532.html","link":"","permalink":"http://sn1987a-1.github.io/posts/12532.html","excerpt":"","text":"å›¾è®ºå¤ä¹ æœªå®Œæˆâ€”â€”ä¸æƒ³å†™äº† å›¾çš„åŸºæœ¬æ¦‚å¿µ é˜¶ï¼šå›¾Gä¸­é¡¶ç‚¹çš„ä¸ªæ•°$\\nu (G)=|V(G)|$ï¼ˆç®€è®°ä¸º$\\nu,V$ï¼‰ $\\epsilon (G)=|E(G)|$ï¼ˆç®€è®°ä¸º$\\epsilon ,E$ï¼‰ æ— é™å›¾ï¼š$\\nu(G)+\\epsilon (G)=+\\infty$ï¼Œå¦åˆ™æˆä¸ºæœ‰é™å›¾ å…³è”/ç›¸é‚»/é‚»é¡¶ï¼š$\\psi (e)=\\{u,v\\}$ é‡è¾¹/ç¯ ç®€å•å›¾ï¼šæ— ç¯æ— é‡è¾¹ å®Œå…¨å›¾ äºŒåˆ†å›¾ å®Œå…¨äºŒåˆ†å›¾ é›¶å›¾ æ˜Ÿå›¾ åº¦æ•°$deg(\\nu)=d_1(\\nu)+2\\times l(\\nu)$ æœ€å¤§/æœ€å°åº¦æ•°$\\delta (G)=min_{\\nu \\in V(G)},\\Delta (G)=max_{\\nu\\in V(G)}$ æ— å‘å›¾$\\sum_{\\nu\\in V(G)}{deg(\\nu)=2\\epsilon(G)}$ ç»™å®šå›¾Gï¼ŒGä¸­åº¦æ•°ä¸ºå¥‡æ•°çš„é¡¶ç‚¹ä¸ªæ•°ä¸ºå¶æ•° çœŸå­å›¾ï¼Œç”Ÿæˆå­å›¾ï¼ˆV(H)=V(G)ï¼‰ï¼Œé¡¶ç‚¹å¯¼å‡ºå­å›¾ï¼Œè¾¹å¯¼å‡ºå­å›¾ è¡¥å›¾ï¼Œè¾¹å›¾ï¼šè¾¹å›¾çš„è¾¹å¯¹åº”åŸå›¾çš„é¡¶ç‚¹ï¼Œé¡¶ç‚¹å¯¹åº”åŸå›¾çš„è¾¹ å¹¶ï¼Œäº¤ ç§¯ï¼š$G\\times H=(Vâ€™,Eâ€™)$,è¾¹é›†åˆåˆ†ä¸ºä¸‰ç±»ï¼š ä¸¤ä¸ªé¡¶ç‚¹åœ¨çš„ä¸¤ä¸ªåˆ†é‡åœ¨åŸå›¾ä¸­å‡ç›¸é‚» æœ‰ä¸€ä¸ªåˆ†é‡åœ¨åŸå›¾ä¸­ç›¸é‚»ï¼Œå¦å¤–ä¸€ä¸ªåˆ†é‡ä¸ºåŒä¸€ä¸ªé¡¶ç‚¹ è·¯å¾„/è¡Œè¿¹/è½¨é“/å›è·¯/åœˆ è¿é€š/ä¸è¿é€šï¼šè¿é€šå­˜åœ¨è·ç¦» å›¾çš„åŒæ„ï¼šå…ƒç´ ä¹‹é—´çš„äºŒå…ƒå…³ç³»å®Œå…¨ç›¸åŒ UlamçŒœæƒ³ï¼šGä¸Hå…¨ç­‰ ç­‰ä»·äº å¯¹ä»»ä½•$\\nu \\in V(G),G-\\nu=V-\\nu$ æœ‰å‘å›¾Dï¼š$D=(V(D),E(D),\\psi _D)$ $\\sum_{\\nu\\in V(G)}{deg^-(\\nu)}(å…¥åº¦)=\\sum_{\\nu\\in V(G)}{deg^+(\\nu)}(å‡ºåº¦)=\\epsilon(G)$ å®šç†ï¼šGä¸ºäºŒåˆ†å›¾å½“ä¸”ä»…å½“Gä¸­æ— å¥‡åœˆ æœ€é•¿è½¨é“ åè¯ä¾‹ï¼šè‹¥Gä¸ºç®€å•å›¾ï¼Œ$\\delta (G)&gt;=2$ï¼Œåˆ™Gä¸­å¿…å«åœˆ â€‹ è‹¥Gä¸ºç®€å•å›¾ï¼Œ$\\delta (G)&gt;=3$ï¼Œåˆ™Gä¸­å¿…å«æœ‰å¶åœˆ æœ€çŸ­è·¯å¾„é—®é¢˜$\\omega (P_0(u,v))$â€”â€”Dijkstraç®—æ³• â€‹ è¯æ˜ç•¥ã€‚ ç±»ä¼¼æœ€çŸ­è·¯å¾„çš„ç›¸å…³æ€è·¯â€”â€”å¦‚å–ç”Ÿæˆå­å›¾æœ€å¤§è¾¹æ•°ï¼š ä»»ç»™æ— å‘å›¾Gï¼Œå­˜åœ¨Hä¸ºGçš„ç”Ÿæˆå­å›¾ï¼Œæ»¡è¶³ï¼š Hæ˜¯äºŒåˆ†å›¾ ä»»ç»™$u\\in V(G)=V(H),æœ‰d_H(u)&gt;=d_G(u)/2$ å–Hä¸ºè¾¹æ•°æœ€å¤§çš„äºŒåˆ†å›¾ï¼Œå‡è®¾ä¸æ»¡è¶³æ¡ä»¶2 æ ‘åŸºæœ¬æ¦‚å¿µ: æ ‘å¶/åˆ†æ”¯ç‚¹ï¼ˆæ ‘æï¼‰ æ£®æ—/å¹³å‡¡æ ‘ ä»¥ä¸‹å‘½é¢˜ç­‰ä»· å›¾çš„è¿é€šæ€§å¹³é¢å›¾åŒ¹é…ç†è®ºEulerå›¾å’ŒHamiltonå›¾å›¾çš„ç€è‰²æœ‰å‘å›¾ç½‘ç»œæµç†è®ºå›¾çŸ©é˜µå’Œå›¾ç©ºé—´","categories":[{"name":"å›¾è®º","slug":"å›¾è®º","permalink":"http://sn1987a-1.github.io/categories/%E5%9B%BE%E8%AE%BA/"}],"tags":[{"name":"ä¸“ä¸šè¯¾","slug":"ä¸“ä¸šè¯¾","permalink":"http://sn1987a-1.github.io/tags/%E4%B8%93%E4%B8%9A%E8%AF%BE/"},{"name":"å›¾è®º","slug":"å›¾è®º","permalink":"http://sn1987a-1.github.io/tags/%E5%9B%BE%E8%AE%BA/"}]},{"title":"å›¾è®ºè¡¥å……å†…å®¹","slug":"å›¾è®ºè¡¥å……","date":"2021-12-11T12:12:20.000Z","updated":"2023-09-23T13:14:57.702Z","comments":true,"path":"posts/15331.html","link":"","permalink":"http://sn1987a-1.github.io/posts/15331.html","excerpt":"","text":"å›¾è®ºè¡¥å……å†…å®¹å›¾è®ºçš„åŸºæœ¬çŸ¥è¯†æ±‡æ€»å·²ä»¥PDFå½¢å¼ä¸Šä¼ è‡³ç§‘å¤§ä¸ªäººä¸»é¡µé“¾æ¥ï¼Œæ­¤éƒ¨åˆ†è¡¥å……å†…å®¹ä¸»è¦è®°å½•å›¾è®ºåœ¨å®é™…ç®—æ³•é—®é¢˜æ–¹é¢çš„çŸ¥è¯†å­¦ä¹ ï¼Œéƒ¨åˆ†å†…å®¹æ¥æºäºç½‘ç»œã€‚ è®¡ç®—å¤æ‚æ€§é—®é¢˜Pé—®é¢˜ã€NPé—®é¢˜ã€ä¸å¯åˆ¤å®šé—®é¢˜Pé—®é¢˜ï¼šèƒ½å¤Ÿåœ¨å¤šé¡¹å¼æ—¶é—´å†…å¯ç”¨ç®—æ³•æ±‚è§£çš„é—®é¢˜ã€‚ä¸¾ä¾‹ï¼šæ‰¾åˆ°Eulerå›è·¯NPé—®é¢˜ï¼šéç¡®å®šå‹å¤šé¡¹å¼æ—¶é—´ï¼ˆnondeterministic polynomial-timeï¼‰é—®é¢˜ï¼ŒæŒ‡ä¸ç¡®å®šæ˜¯å¦å­˜åœ¨å¤šé¡¹å¼æ—¶é—´çš„æ±‚è§£ç®—æ³•ï¼Œä½†å¯ä»¥åœ¨å¤šé¡¹å¼æ—¶é—´å†…éªŒè¯ä¸€ä¸ªçŒœæµ‹è§£çš„æ­£ç¡®æ€§çš„é—®é¢˜ã€‚ä¸¾ä¾‹ï¼šæ‰¾Hamiltonå›è·¯ï¼ˆå®é™…ä¸Šæ˜¯NPCé—®é¢˜ï¼Œå°šä¸”æœªçŸ¥æœ‰é™æ€§ç®—æ³•ï¼‰ã€‚ä¸å¯åˆ¤å®šé—®é¢˜(undecidable problem)ï¼šâ€ä¸å¯èƒ½â€œè§£å‡ºçš„é—®é¢˜ã€‚ä¸¾ä¾‹ï¼šè®©Cç¼–è¯‘å™¨æ‰¾å‡ºæ‰€æœ‰çš„è¯­æ³•é”™è¯¯å’Œæ— é™å¾ªç¯ã€‚ ä¸NPç›¸å…³çš„é—®é¢˜æœ‰Pï¼ŒNPï¼ŒNP Hard ï¼ŒNPCé—®é¢˜ï¼Œå…¶ä¸­NP Hard ä¸NPCé—®é¢˜çš„å…·ä½“æè¿°ä¸ºï¼š NP hardé—®é¢˜ï¼šNon-deterministic Polynomial hard problem(NPH)é—®é¢˜ï¼Œå¦‚æœæ‰€æœ‰NPé—®é¢˜å¯åœ¨å¤šé¡¹å¼æ—¶é—´å†…è½¬åŒ–ï¼ˆå½’çº¦ï¼Œæ„æ€æ˜¯è§£å†³äº†åè€…ä¹Ÿå°±ç›¸åº”çš„è§£å†³äº†å‰è€…ï¼‰æˆæŸä¸ªé—®é¢˜ï¼Œåˆ™è¯¥é—®é¢˜ç§°ä¸ºNPéš¾é—®é¢˜ã€‚è¿™é‡Œè§„çº¦çš„æ„æ€æ˜¯å°†ä¸€ä¸ªç‰¹æ®Šé—®é¢˜ä¸€èˆ¬åŒ–ï¼Œå³å°†åŸé—®é¢˜æ¨å¹¿ä¸ºä¸€ä¸ªæœ€ä¸€èˆ¬çš„ã€æœ€æœ‰æ¦‚æ‹¬æ€§ã€ä¹Ÿæ›´éš¾çš„ã€è®¡ç®—å¤æ‚åº¦æ›´é«˜çš„é—®é¢˜ï¼Œè¿™ä¸ªé—®é¢˜å…·æœ‰æœ€é«˜çš„è®¡ç®—å¤æ‚åº¦ï¼Œå¦‚æœè¿™ä¸ªæœ€ä¸€èˆ¬çš„é—®é¢˜ä¹Ÿèƒ½æœ‰å¤šé¡¹å¼æ—¶é—´æ±‚è§£ç®—æ³•ï¼Œé‚£ä¹ˆé‚£äº›ç‰¹æ®Šçš„åŸé—®é¢˜ä¹Ÿèƒ½æœ‰å¤šé¡¹å¼æ—¶é—´æ±‚è§£ç®—æ³•ã€‚è§£å†³äº†è¿™ä¸ªNP hardé—®é¢˜ï¼Œæ‰€æœ‰NPé—®é¢˜éƒ½èƒ½å¤Ÿè¢«è§£å†³äº†ã€‚ NP hardé—®é¢˜ä¸ä¸€å®šæ˜¯NPé—®é¢˜ï¼Œæœ‰å¯èƒ½æ˜¯ä¸å¯åˆ¤å®šé—®é¢˜ã€‚è¿™æ—¶å€™è¯´æ˜åŸé—®é¢˜ä¹Ÿæ˜¯ä¸å¯åˆ¤å®šçš„ã€‚ NPCé—®é¢˜ï¼šNon-deterministic Polynomial complete problem ï¼Œå¦‚æœæ‰€æœ‰NPé—®é¢˜å¯åœ¨å¤šé¡¹å¼æ—¶é—´å†…å½’çº¦æˆæŸä¸ªNPé—®é¢˜ï¼Œåˆ™è¯¥NPé—®é¢˜ç§°ä¸ºNPå®Œå…¨é—®é¢˜ã€‚NPCåŒ…å«äº†NPä¸­æœ€éš¾çš„é—®é¢˜ã€‚è§£å†³äº†è¿™ä¸ªNPCé—®é¢˜ã€‚æ‰€æœ‰NPé—®é¢˜éƒ½èƒ½å¤Ÿè¢«è§£å†³äº†ã€‚ NPCé—®é¢˜ç›¸å½“å¹¿æ³›ï¼ŒåŒ…æ‹¬æ¥è‡ªæ“ä½œç³»ç»Ÿï¼ˆè°ƒåº¦å’Œå®‰å…¨ï¼‰ã€æ•°æ®åº“ç³»ç»Ÿã€è¿ç­¹å­¦ã€é€»è¾‘å­¦ã€ç‰¹åˆ«æ˜¯å›¾è®ºç­‰ä¸åŒé¢†åŸŸçš„é—®é¢˜ã€‚å¯æ»¡è¶³æ€§é—®é¢˜ã€å“ˆå¯†é¡¿åœˆé—®é¢˜ã€å·¡å›å”®è´§å‘˜é—®é¢˜ã€æœ€é•¿è·¯å¾„é—®é¢˜éƒ½æ˜¯NPCé—®é¢˜ã€‚ è£…ç®±(bin packing)é—®é¢˜ã€èƒŒåŒ…(knapsack)é—®é¢˜ã€å›¾çš„ç€è‰²(graph coloring)é—®é¢˜ä»¥åŠå›¢(clique)çš„é—®é¢˜éƒ½æ˜¯è‘—åçš„NPCé—®é¢˜ã€‚NPCé—®é¢˜ç›¸å½“å¹¿æ³›ï¼ŒåŒ…æ‹¬æ¥è‡ªæ“ä½œç³»ç»Ÿï¼ˆè°ƒåº¦å’Œå®‰å…¨ï¼‰ã€æ•°æ®åº“ç³»ç»Ÿã€è¿ç­¹å­¦ã€é€»è¾‘å­¦ã€ç‰¹åˆ«æ˜¯å›¾è®ºç­‰ä¸åŒé¢†åŸŸçš„é—®é¢˜ã€‚ èƒŒåŒ…é—®é¢˜(Knapsack problem)æ˜¯ä¸€ç§ç»„åˆä¼˜åŒ–çš„NPå®Œå…¨é—®é¢˜ã€‚é—®é¢˜å¯ä»¥æè¿°ä¸ºï¼šç»™å®šä¸€ç»„ç‰©å“ï¼Œæ¯ç§ç‰©å“éƒ½æœ‰è‡ªå·±çš„é‡é‡å’Œä»·æ ¼ï¼Œåœ¨é™å®šçš„æ€»é‡é‡å†…ï¼Œæˆ‘ä»¬å¦‚ä½•é€‰æ‹©ï¼Œæ‰èƒ½ä½¿å¾—ç‰©å“çš„æ€»ä»·æ ¼æœ€é«˜ã€‚é—®é¢˜çš„åç§°æ¥æºäºå¦‚ä½•é€‰æ‹©æœ€åˆé€‚çš„ç‰©å“æ”¾ç½®äºç»™å®šèƒŒåŒ…ä¸­ã€‚ç›¸ä¼¼é—®é¢˜ç»å¸¸å‡ºç°åœ¨å•†ä¸šã€ç»„åˆæ•°å­¦ï¼Œè®¡ç®—å¤æ‚æ€§ç†è®ºã€å¯†ç å­¦å’Œåº”ç”¨æ•°å­¦ç­‰é¢†åŸŸä¸­ã€‚ä¹Ÿå¯ä»¥å°†èƒŒåŒ…é—®é¢˜æè¿°ä¸ºå†³å®šæ€§é—®é¢˜ï¼Œå³åœ¨æ€»é‡é‡ä¸è¶…è¿‡Wçš„å‰æä¸‹ï¼Œæ€»ä»·å€¼æ˜¯å¦èƒ½è¾¾åˆ°Vï¼Ÿå®ƒæ˜¯åœ¨1978å¹´ç”±Merkelå’ŒHellmanæå‡ºçš„ã€‚èƒŒåŒ…é—®é¢˜å·²ç»ç ”ç©¶äº†ä¸€ä¸ªå¤šä¸–çºªï¼Œæ—©æœŸçš„ä½œå“å¯è¿½æº¯åˆ°1897å¹´æ•°å­¦å®¶æ‰˜æ¯”äºšæ–¯Â·ä¸¹é½æ ¼ï¼ˆTobias Dantzigï¼Œ1884-1956ï¼‰çš„æ—©æœŸä½œå“ ï¼Œå¹¶æŒ‡çš„æ˜¯åŒ…è£…ä½ æœ€æœ‰ä»·å€¼æˆ–æœ‰ç”¨çš„ç‰©å“è€Œä¸ä¼šè¶…è½½ä½ çš„è¡Œæçš„å¸¸è§é—®é¢˜ã€‚ NPCç®—æ³•çš„å¤æ‚åº¦æ›´å€¾å‘äº$O(e^n)$,NP Hard ç®—æ³•çš„æ—¶é—´å¤æ‚åº¦ç”šè‡³å¯èƒ½è¾¾åˆ°$O(n^n)$. åœ¨æœ¬è¯¾ç¨‹é‡Œå‡ºç°çš„NPCé—®é¢˜ï¼š å›¾ç€è‰²ï¼ˆè¾¹/é¡¶ç‚¹/é¢ç€è‰²ï¼‰ Hamiltonåœˆç®—æ³• â€¦? éšæœºæ¸¸èµ°Random Walk éšæœºæ¸¸èµ°ï¼ˆè‹±è¯­ï¼šRandom Walkï¼Œç¼©å†™ä¸º RWï¼‰ï¼Œæ˜¯ä¸€ç§æ•°å­¦ç»Ÿè®¡æ¨¡å‹ï¼Œå®ƒæ˜¯ä¸€è¿ä¸²çš„è½¨è¿¹æ‰€ç»„æˆï¼Œå…¶ä¸­æ¯ä¸€æ¬¡éƒ½æ˜¯éšæœºçš„ã€‚[1][2]å®ƒèƒ½ç”¨æ¥è¡¨ç¤ºä¸è§„åˆ™çš„å˜åŠ¨å½¢å¼ï¼Œå¦‚åŒä¸€ä¸ªäººé…’åä¹±æ­¥ï¼Œæ‰€å½¢æˆçš„éšæœºè¿‡ç¨‹è®°å½•ã€‚1905å¹´ï¼Œç”±å¡å°”Â·çš®å°”é€Šé¦–æ¬¡æå‡ºã€‚ â€”â€”æ¥è‡ªç»´åŸºç™¾ç§‘ é éšæœºæ¸¸èµ°è§£å‡ºæ¥äº†txçš„è‡ªå®šä¹‰é˜´é—´ä¸€ç¬”ç”»çº¢åŒ… â€”â€”æ¥è‡ªç¾¤å‹ ç®—æ³•æ€æƒ³ï¼š è¯¥ç®—æ³•è¦å®ç°çš„æ˜¯æœç´¢ï¼Œä»èµ·å§‹ç‚¹så¼€å§‹æ‰¾åˆ°ç›®çš„åœ°tã€‚ ç»™å®šä¸€ä¸ªå›¾ï¼Œä»èµ·ç‚¹å¼€å§‹èµ°çš„æ¯ä¸€æ­¥éƒ½è®©å…¶æœ‰ä¸€å®šçš„æ¦‚ç‡$\\alpha$è·³è½¬åˆ°å›¾ä¸­çš„ä»»æ„ä¸€ä¸ªç‚¹ä¸Šï¼Œè¿˜æœ‰$ 1-\\alpha$çš„æ¦‚ç‡ä¼šè¡Œèµ°åˆ°ä»»æ„ä¸€ä¸ªä¸è¯¥ç‚¹ç›¸è¿çš„ç‚¹ä¸Šã€‚ä¸æ–­çš„é‡å¤ä¸Šè¿°è¿‡ç¨‹ï¼Œç›´åˆ°æ‰¾åˆ°ç›®çš„åœ°ä¸­ã€‚ æ­¥éª¤ å°†å®é™…é—®é¢˜æŠ½è±¡ä¸ºå›¾çš„å½¢å¼ï¼Œå¹¶ç”¨ä¸´æ¥è¡¨ã€é‚»æ¥çŸ©é˜µç­‰å­˜å›¾æ–¹å¼å°†å›¾å­˜å‚¨åœ¨è®¡ç®—æœºä¸­ï¼› ç”¨ä¸€ä¸ªå˜é‡è®°å½•å½“å‰æ‰€å¤„çš„ä½ç½®ï¼ˆå›¾ä¸­ç‚¹çš„æ ‡å·ï¼‰ï¼Œæ¯æ¬¡éšæœºä¸€ä¸ª[0, 1]ä¹‹é—´çš„æ•°ï¼Œè‹¥å…¶å°äºç­‰äºéšæœºè·³è·ƒæ¦‚ç‡$\\alpha $åˆ™éšæœºä¸€ä¸ª[1, n]çš„æ•°å­—å¹¶è·³è½¬ï¼Œå¦åˆ™éšæœºä¸€ä¸ª$x,x\\in S$ï¼Œå…¶ä¸­Sä¸ºä¸å½“å‰ç‚¹ç›¸è¿çš„ç‚¹çš„é›†åˆï¼› ä¸æ–­é‡å¤ç¬¬äºŒæ­¥å¹¶è®°å½•è·¯å¾„ï¼Œç›´åˆ°æ‰¾åˆ°ç›®çš„åœ°t. è¯¥ç®—æ³•çš„æ€æƒ³ä¹Ÿè¢«åº”ç”¨åˆ°äº†PageRankç®—æ³•ä¸­ï¼Œä½œä¸ºGoogleç­‰æœç´¢å¼•æ“çš„ç½‘é¡µæ£€ç´¢ç®—æ³•ã€‚ï¼ˆPageRankä¸­å¿ƒæ€§ç®—æ³•çš„æœ¬è´¨å°±æ˜¯éšæœºæ¸¸èµ°ï¼ˆè¯¦è§è¯¾æœ¬ä¸­å¿ƒå‹ç®—æ³•éƒ¨åˆ†ï¼Œè€ƒè¯•ä¸è€ƒï¼‰ã€‚","categories":[{"name":"å›¾è®º","slug":"å›¾è®º","permalink":"http://sn1987a-1.github.io/categories/%E5%9B%BE%E8%AE%BA/"}],"tags":[{"name":"ä¸“ä¸šè¯¾","slug":"ä¸“ä¸šè¯¾","permalink":"http://sn1987a-1.github.io/tags/%E4%B8%93%E4%B8%9A%E8%AF%BE/"}]},{"title":"HUFFMAM Tree","slug":"11-11","date":"2021-11-11T11:46:11.000Z","updated":"2023-09-23T13:16:23.062Z","comments":true,"path":"posts/1120.html","link":"","permalink":"http://sn1987a-1.github.io/posts/1120.html","excerpt":"","text":"Huffman ç¼–ç è§£å‹ç¼©å…³äºHuffmanç¼–ç çš„çŸ¥è¯†,åœ¨ä¸Šä¸ªå­¦æœŸæ•°æ®ç»“æ„å·²ç»å­¦è¿‡,ä½œä¸ºè¾ƒä¸ºå¤æ‚çš„ä¸€æ¬¡å®éªŒè€—è´¹äº†ä¸å°‘æ—¶é—´,å¯è¯´å®è¯,ä¸Šä¸ªå­¦æœŸåœ¨æ•°æ®ç»“æ„æŠ•å…¥çš„ç»å†ç¡®å®ä¸ç®—å¤§,æœ€ç»ˆçš„æˆç»©ä¹Ÿç›¸å½“ä¸ç†æƒ³,ä½†è¿™ä¸ªå­¦æœŸè¿˜å¾—é‡æ–°å­¦æ•°æ®ç»“æ„(ä¿¡è®¡æ•°æ®ç»“æ„ä¸èƒ½äº’è®¤å°±ç¦»è°±orz),åŒæ ·ç±»å‹çš„å®éªŒ,ä¸åŒçš„å¿ƒå¢ƒ ,ä¸åŒçš„è¦æ±‚,åªæ±‚è¦ä¸€ä¸ªå¥½ä¸€ç‚¹ç‚¹çš„åˆ†æ•°å•¦ å¤§è‡´å®éªŒè¦æ±‚åŸºäºHuffmanç¼–ç æ¥å®ç°å‹ç¼©å™¨å’Œç¼–ç å™¨,ä½¿å…¶å¯ä»¥å¯¹ä»»æ„æ–‡ä»¶è¿›è¡Œè§£å‹ç¼©æ“ä½œ. å®ç°æ–¹æ³•:å‘½ä»¤è¡Œæ‰§è¡Œ/GUIç•Œé¢(è¿˜ä¸ä¼šâ€¦)/è¿è¡Œç¨‹åºäº¤äº’ç•Œé¢ æœ¬å®éªŒçš„æµ‹è¯•æ•°æ®:æ–‡ä»¶åŒ…æ‹¬:.txt .png .wav .mp4 .zip","categories":[{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://sn1987a-1.github.io/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}],"tags":[{"name":"ä¸“ä¸šè¯¾","slug":"ä¸“ä¸šè¯¾","permalink":"http://sn1987a-1.github.io/tags/%E4%B8%93%E4%B8%9A%E8%AF%BE/"}]},{"title":"æ¨¡æ‹Ÿä¸æ•°å­—ç”µè·¯æœŸä¸­å¤ä¹ ","slug":"æ¨¡æ‹Ÿä¸æ•°å­—ç”µè·¯å¤ä¹ ","date":"2021-11-05T15:42:30.000Z","updated":"2023-09-23T13:15:11.002Z","comments":true,"path":"posts/15234.html","link":"","permalink":"http://sn1987a-1.github.io/posts/15234.html","excerpt":"","text":"æ¨¡æ‹Ÿä¸æ•°å­—ç”µè·¯[TOC] 2022.1.15 æ¨¡æ‹Ÿä¸æ•°å­—ç”µè·¯æœŸæœ«è€ƒè¯•2021.11.11æœŸä¸­è€ƒè¯•ä¸»è¦å†…å®¹ï¼š æ•°å­—é€»è¾‘æ¦‚è®º: æ•°å€¼è½¬æ¢ äºŒè¿›åˆ¶æ•°çš„ç®—æœ¯è¿ç®— é€»è¾‘ä»£æ•°&amp;HDLåŸºç¡€ åæ¼”è§„åˆ™ å¯¹å¶è§„åˆ™ æœ€å¤§é¡¹/æœ€å°é¡¹ è¡¨è¾¾å¼åŒ–ç®€ ç›´æ¥åŒ–ç®€ å¡è¯ºå›¾ é€»è¾‘å‡½æ•°è¡¨ç¤ºæ–¹æ³•ä¹‹é—´çš„è½¬æ¢ çœŸå€¼è¡¨ è¡¨è¾¾å¼ é€»è¾‘å›¾ æ³¢å½¢å›¾ é€»è¾‘é—¨ç”µè·¯ ç»„åˆé€»è¾‘ç”µè·¯/PLDâœ¨ é”å­˜å™¨å’Œè§¦å‘å™¨âœ¨ æ—¶åºé€»è¾‘ç”µè·¯ï¼ˆä»…åŒ…å«åŒæ­¥æ—¶åºç”µè·¯ï¼‰âœ¨ ä¿¡å·â€”â€”æ•°å­—éƒ¨åˆ†ï¼›å‘¨æœŸæ€§ï¼›å ç©ºæ¯”ï¼šé«˜ç”µå¹³å å‘¨æœŸçš„ç™¾åˆ†æ¯” è¿›åˆ¶è¿›åˆ¶ï¼šBinary Octal Hexadecimalï¼ˆ0xï¼‰äºŒè¿›åˆ¶è½¬æ¢ï¼šâ€œè¯¯å·®ä¸å¤§äº$2^{-n}$â€ &lt;=&gt; â€œç²¾ç¡®åˆ°å°æ•°ç‚¹ç¬¬nä½â€ ç¬¬nä½â€œå››èˆäº”å…¥â€å³å¯ äºŒè¿›åˆ¶çš„ç®—æœ¯è¿ç®—ï¼šè¡¥ç =åŸç å–å+1ï¼›è¡¥ç è¡¨ç¤ºèŒƒå›´$-2^{n-1}~2^{n-1}-1$ è¡¥ç è½¬åŸç ï¼šä»å³å¾€å·¦æ‰¾åˆ°ç¬¬ä¸€ä¸ªâ€˜1â€™ï¼Œå°†è¿™ä¸ª1ä¹‹å‰çš„å–åï¼Œè¯¥æ•°å­—å’Œä¹‹åçš„ä¿æŒåŸå€¼å³å¯ã€‚ (X+Y)_è¡¥=(X)_è¡¥+(Y)_è¡¥ (X-Y)_è¡¥=(X)_è¡¥-\\overline{(Y)_è¡¥}+1æº¢å‡ºï¼šè¿ç®—ç»“æœè¶…å‡ºè¡¥ç çš„è¡¨ç¤ºèŒƒå›´ â€‹ å‡ºç°åœºåˆï¼šåŒå·ç›¸åŠ ï¼Œå¼‚å·ç›¸å‡â€”â€”â€”&gt;åˆ¤æ–­ç»“æœæ˜¯å¦æ­£ç¡®ï¼ˆæ˜¯å¦æº¢å‡ºï¼‰ï¼šåˆ¤æ–­è®¡ç®—è¿‡ç¨‹ä¸­ç¬¦å·ä½å’Œæ¬¡é«˜ä½çš„è¿›ä½æƒ…å†µï¼Œå½“ä¸”ä»…å½“ç¬¦å·ä½æœ‰è¿›ä½ä¸”æ¬¡é«˜ä½æ— è¿›ä½æ—¶è®¡ç®—ç»“æœæº¢å‡ºã€‚ æº¢å‡ºè§£å†³æ–¹æ¡ˆâ€”-ç¬¦å·æ‹“å±•ï¼šé€šè¿‡åˆ©ç”¨ä¸¤ä¸ªæˆ–å¤šä¸ªç¬¦å·ä½ï¼Œåˆå§‹ç»Ÿä¸€ç½®0æˆ–1ï¼Œæœ€ç»ˆç»“æœçœ‹ç¬¬ä¸€ä½çš„çŠ¶æ€ã€‚ BCDç ï¼ˆæ— ç‰¹æ®Šè¯´æ˜BCDç å‡æŒ‡8421ç ï¼‰æœ‰æƒç ï¼š8421ç ï¼Œ5421ç ï¼Œ2421ç ï¼ˆæ•°å­—ä»£è¡¨å„ä½çš„æƒé‡ï¼‰ æ— æƒç ï¼šä½™3ç ï¼Œä½™3å¾ªç¯ç  ä½™3å¾ªç¯ç ï¼šï¼ˆ0~9ï¼‰ æ•°å€¼ 0 1 2 3 4 5 6 7 8 9 ä½™3å¾ªç¯ç  0010 0110 0111 0101 0100 1100 1101 1111 1110 1010 æ ¼é›·ç ç¼–ç é¡ºåºä¾æ¬¡å˜åŒ–æ—¶ï¼Œç›¸é‚»ä»£ç æœ‰ä¸”ä»…æœ‰ä¸€ä½ä¸åŒï¼Œæœ€å¤§å’Œæœ€å°ä¹‹é—´ä¹Ÿå·®ä¸€ä½ï¼Œä¹Ÿç§°å¾ªç¯ç ï¼ˆä½™3å¾ªç¯ç ä¹Ÿæ»¡è¶³è¯¥æ¡ä»¶ï¼‰ï¼ˆ0~15ï¼‰ æ ¼é›·ç â€”â€”&gt;äºŒè¿›åˆ¶ç è½¬åŒ–ï¼šä»æœ€é«˜ä½åˆ°æœ€ä½ä½ä¾æ¬¡ç›¸åŠ  æ•°å€¼ 0 1 2 3 4 5 6 7 8 9 A B C D E F æ ¼é›·ç  0000 0001 0011 0010 0110 0111 0101 0100 1100 1101 1111 1110 1010 1011 1001 1000 äºŒè¿›åˆ¶ç  0000 0001 0010 0011 0100 0101 0110 0111 1000 1001 1010 1011 1100 1101 1110 1111 è¿›åˆ¶è½¬æ¢ï¼š ä»»æ„è¿›åˆ¶-&gt;åè¿›åˆ¶ï¼šæŒ‰ä½æƒå±•å¼€åç›¸åŠ  (N)_R=\\sum_{i=-m}^{n-1}k_i*R^i â€‹ 2.åè¿›åˆ¶-&gt;ä»»æ„è¿›åˆ¶ï¼š â€‹ æ•´æ•°éƒ¨åˆ†ï¼šè¾—è½¬é™¤åŸºå–ä½™ï¼Œå…ˆå¾—è¾ƒä½æœ‰æ•ˆä½ â€‹ å°æ•°éƒ¨åˆ†ï¼šè¾—è½¬ä¹˜ç§¯å–æ•´ï¼Œå…ˆå¾—æœ€é«˜æœ‰æ•ˆä½ é€»è¾‘ä»£æ•°åŸºæœ¬å®šå¾‹ï¼š äº¤æ¢å¾‹ A B=B A; A+B=B+A; ç»“åˆå¾‹ A(BC)=(AB)C; A+(B+C)=(A+B)+C; åˆ†é…å¾‹ A(B+C)=AB+AC; A+BC=(A+B)(A+C); å¸æ”¶å¾‹ A+A B=A; A(A+B)=A; åæ¼”å¾‹ $\\overline{A+B}=\\overline {A}*\\overline {B}$ ; $\\overline{AB}=\\overline{A}+\\overline{B};$ ä»£å…¥è§„åˆ™:åœ¨ä»»ä¸€é€»è¾‘æ’ç­‰å¼ä¸­,è‹¥ä»¥ä¸€ä¸ªé€»è¾‘è¡¨è¾¾å¼ä»£æ›¿æ’ç­‰å¼ä¸¤è¾¹æ‰€æœ‰å‡ºç°çš„æŸä¸€å˜é‡,åˆ™æ‰€å¾—è¡¨è¾¾å¼ä¾ç„¶æˆç«‹.åˆ©ç”¨è¯¥ç»“è®ºå¯ä»¥æŠŠä¸Šè¿°å®šå¾‹æ¨å¹¿åˆ°nå…ƒçš„æƒ…å†µ,å³åæ¼”å¾‹å¯ä»¥å†™æˆ: \\overline{A_1*A_2*...*A_n}=\\overline{A_1}+\\overline{A_2}+...+\\overline{A_n} \\overline{A_1+A_2+...+A_n}=\\overline{A_1}*\\overline{A_2}*...*\\overline{A_n}åæ¼”å’Œå¯¹å¶åæ¼”è§„åˆ™:å¯¹äºä»»æ„è¡¨è¾¾å¼Y,å°†æ‰€æœ‰è¡¨è¾¾å¼ä¸­çš„â€™*â€™å’Œâ€™+â€™äº’æ¢,å°†æ‰€æœ‰çš„â€™0â€™ä¸â€™1â€™äº’æ¢,æŠŠé€»è¾‘å˜é‡å–å. å¯¹å¶è§„åˆ™:å¯¹äºä»»æ„è¡¨è¾¾å¼Y,å°†æ‰€æœ‰è¡¨è¾¾å¼ä¸­çš„â€™*â€™å’Œâ€™+â€™äº’æ¢,ä½†ä¸æ”¹å˜æ‰€æœ‰çš„â€™0â€™ä¸â€™1â€™äº’æ¢å’Œé€»è¾‘å˜é‡. åˆ©ç”¨å¯¹å¶è§„åˆ™å¯ä»¥å¯¹ä¸Šè¿°åŸºæœ¬å®šå¾‹è¿›è¡Œæ‹“å±•. é€»è¾‘è¡¨è¾¾å¼å¯¹äºä¸€ä¸ªé€»è¾‘å‡½æ•°,æœ‰å¤šä¸ªé€»è¾‘è¡¨è¾¾å¼:(ä¸‹ä»¥/AB+A/Cä¸ºä¾‹) ä¸æˆ–å¼â€”â€”-$\\overline {AB}+A\\overline C;$ æˆ–ä¸å¼â€”â€”â€”$(A+\\overline B)*(\\overline A+C)$ ä¸é-ä¸éå¼â€”â€”â€”$\\overline {\\overline{\\overline AB}\\ \\ \\overline {A\\overline C}}$â€”â€”â€”â€”-æœ€ç®€ä¸æˆ–å¼æ±‚ä¸¤æ¬¡å æˆ–é-æˆ–éå¼â€”â€”â€”$\\overline {(\\overline A+B)+(\\overline A+\\overline C)}$â€”â€”â€”æœ€ç®€æˆ–ä¸å¼æ±‚ä¸¤æ¬¡å ä¸æˆ–éå¼â€”â€”â€”$\\overline {\\overline A\\ \\overline B+AC}$â€”â€”â€”â€”â€”å…ˆæ±‚/Yçš„æœ€ç®€ä¸æˆ–å¼,ç„¶åæ±‚å æœ€å°é¡¹ä¸æœ€å¤§é¡¹æœ€å°é¡¹:åŒ…å«å…¨éƒ¨è¾“å…¥å˜é‡çš„ä¹˜ç§¯é¡¹,æ¯ä¸ªå˜é‡å‡ä»¥è‡ªèº«å˜é‡æˆ–åå˜é‡å‡ºç°ä¸€æ¬¡.å¯¹äºnå˜é‡é€»è¾‘å‡½æ•°,å…±æœ‰2^nä¸ªæœ€å°é¡¹,è®°ä¸ºmi,å…¶ä¸­iä¸ºæœ€å°é¡¹çš„ç¼–å·[1]. [1]ç¼–å·:ç¼–å·æ–¹æ³•:åŸå˜é‡å’Œåå˜é‡åˆ†åˆ«å¸¦è¡¨1å’Œ0,å¸¦å…¥é€»è¾‘è¡¨è¾¾å¼å¾—åˆ°çš„äºŒè¿›åˆ¶æ•°å¯¹åº”çš„åè¿›åˆ¶æ•°è®°ä¸ºç¼–å·i. å¯¹äºä»»æ„ä¸€ä¸ªæœ€å°é¡¹,æœ‰ä¸”ä»…æœ‰ä¸€ç»„å˜é‡ä½¿å¾—mi=1æˆç«‹,ä¸”å¯¹äºä¸åŒçš„i,å¯¹åº”ä¸åŒçš„å˜é‡; å…¨ä½“æœ€å°é¡¹çš„å¹¶æ’ç­‰äº1; ä»»æ„ä¸¤ä¸ªæœ€å°é¡¹çš„äº¤æ’ç­‰äº0; æœ€å¤§é¡¹:åŒ…å«å…¨éƒ¨è¾“å…¥å˜é‡çš„æˆ–é¡¹,æ¯ä¸ªå˜é‡å‡ä»¥è‡ªèº«å˜é‡æˆ–åå˜é‡å‡ºç°ä¸€æ¬¡.å¯¹äºnå˜é‡é€»è¾‘å‡½æ•°,å…±æœ‰2^nä¸ªæœ€å¤§é¡¹,è®°ä¸ºMi,å…¶ä¸­iä¸ºæœ€å¤§é¡¹çš„ç¼–å·[2]. [2]ç¼–å·:ç¼–å·æ–¹æ³•:åŸå˜é‡å’Œåå˜é‡åˆ†åˆ«å¸¦è¡¨1å’Œ0,å¸¦å…¥é€»è¾‘è¡¨è¾¾å¼å¾—åˆ°çš„äºŒè¿›åˆ¶æ•°å–åå¯¹åº”çš„åè¿›åˆ¶æ•°è®°ä¸ºç¼–å·i. æ€§è´¨å¯ä»¥å’Œæœ€å°é¡¹ç±»ä¼¼ æœ€å¤§é¡¹å’Œæœ€å°é¡¹çš„å…³ç³»: \\overline{M_i}=m_i; M_i=\\overline{m_i}å¡è¯ºå›¾å¡è¯ºå›¾é€šå¸¸ç”¨åœ¨é€»è¾‘å˜é‡åœ¨5ä»¥å†…çš„æƒ…å†µ. å¡è¯ºå›¾ç‰©ç†ä¸Šç›¸é‚»çš„é€»è¾‘å˜é‡åœ¨é€»è¾‘ä¸Šç›¸é‚»(ä¸Šä¸‹ç›¸é‚»,å·¦å³ç›¸é‚»,,å¾ªç¯ç›¸é‚»,å¯¹è§’ä¸ç›¸é‚»)â€”â€”-å¾ªç¯ç  æ— å…³é¡¹x:ä¸å…è®¸æˆ–ä¸å¯èƒ½å‡ºç°çš„æœ€å°é¡¹/å¯¹åº”çš„å‡½æ•°å€¼æ˜¯ä»»æ„å€¼. å¡è¯ºå›¾åŒ–ç®€é€»è¾‘è¡¨è¾¾å¼ è§„èŒƒä½œå›¾ï¼š 00 01 11 10é¡ºåº æ³¨æ˜å„ä¸ªé€»è¾‘å˜é‡åç§° ç”»åœˆæ ‡è®°â€”-å†™å¯¹åº”è¡¨è¾¾å¼ æœ€ç®€æˆ–ä¸å¼â€”â€”åœˆ0å–å åœˆ0å–ååä¸ä¸€å®šæ˜¯åŸé—®é¢˜çš„æœ€ç®€ä¸æˆ–å¼.(?) é€»è¾‘é—¨ç”µè·¯PMOS:é«˜ç”µå¹³ä¸å¯¼é€š,ä½ç”µå¹³å¯¼é€š.ä¸èƒ½æ¥åœ° NMOS:é«˜ç”µå¹³å¯¼é€š,ä½ç”µå¹³ä¸å¯¼é€š,ä¸èƒ½æ¥é«˜ç”µå¹³ éé—¨:2ä¸ªCMOS;ä¸éé—¨/æˆ–éé—¨:4ä¸ªCMOS;ä¸é—¨/æˆ–é—¨:6ä¸ªCOMS ç»„åˆé€»è¾‘ç”µè·¯å®šä¹‰:å¯¹äºä¸€ä¸ªé€»è¾‘ç”µè·¯,åœ¨ä»»ä½•ä¸€ä¸ªæ—¶åˆ»çš„è¾“å‡ºçŠ¶æ€åªä¸è¾“å…¥çŠ¶æ€æœ‰å…³,ä¸ç”µè·¯è‡ªèº«çŠ¶æ€æ— å…³. ç”µè·¯åŠŸèƒ½åˆ†ææ€è·¯: æ ¹æ®è¾“å…¥è¾“å‡ºå†™å‡ºå„çº§é€»è¾‘è¡¨è¾¾å¼,ç›´åˆ°è¾“å…¥å’Œè¾“å‡ºä¿¡å·çš„é€»è¾‘è¡¨è¾¾å¼; å°†å„ä¸ªé€»è¾‘è¡¨è¾¾å¼åŒ–ç®€å’Œå˜æ¢å¾—åˆ°æœ€ç®€è¡¨è¾¾å¼; æ ¹æ®è¡¨è¾¾å¼åˆ—å‡ºçœŸå€¼è¡¨; æ ¹æ®çœŸå€¼è¡¨å’Œæœ€ç®€é€»è¾‘è¡¨è¾¾å¼å¯¹ç»„åˆé€»è¾‘ç”µè·¯è¿›è¡Œåˆ†æ,æœ€åç¡®å®šå…¶åŠŸèƒ½. ç»„åˆé€»è¾‘ç”µè·¯è®¾è®¡è¿‡ç¨‹ æ˜ç¡®å®é™…é—®é¢˜çš„é€»è¾‘åŠŸèƒ½,ç¡®å®šè¾“å…¥è¾“å‡ºå’Œè¡¨ç¤ºç¬¦å·; æ ¹æ®å¯¹ç”µè·¯é€»è¾‘åŠŸèƒ½çš„è¦æ±‚å†™å‡ºçœŸå€¼è¡¨; åˆ©ç”¨çœŸå€¼è¡¨å¾—å‡ºé€»è¾‘è¡¨è¾¾å¼å¹¶è¿›ç¨‹åŒ–ç®€å˜æ¢;(å¡è¯ºå›¾) åˆ©ç”¨å¾—åˆ°çš„é€»è¾‘è¡¨è¾¾å¼ç”»å‡ºç”µè·¯å›¾. ç”»æ³¢å½¢å›¾è¦ç‚¹: ç”»å‡ºåŸé¢˜çš„æ³¢å½¢,ç”»å‡ºæ—¶é’Ÿä¿¡å·çš„è¾¹ç¼˜çš„è™šçº¿â€¦ å…¸å‹ç»„åˆé€»è¾‘ç”µè·¯ç¼–ç å™¨ä¼˜å…ˆç¼–ç å™¨CD4532: 8ä¿¡å·è¾“å…¥3ä¿¡å·è¾“å‡º; è¾“å…¥è¾“å‡ºå‡ä»¥é«˜ç”µå¹³æœ‰æ•ˆ; EI/EO:è¾“å…¥/è¾“å‡ºä½¿èƒ½ç«¯,å‡é«˜ç”µå¹³æœ‰æ•ˆ,å¦åˆ™è¾“å‡ºç«¯å‡ä¸ºä½ç”µå¹³,EIä¸ºä½ç”µå¹³æ—¶GS,EOå¿…å®šæ˜¯ä½ç”µå¹³, EIæ˜¯1ä¸”è¾“å…¥å‡ä¸ºä½ç”µå¹³æ—¶EOè¾“å‡ºä¸º1,å¯ä»¥ç”¨äºè¿æ¥ä¸‹ä¸€ç¼–ç å™¨çš„ä½¿èƒ½è¾“å…¥ç«¯```````````` ; GS:ç¼–ç å·¥ä½œçŠ¶æ€:EIæ˜¯ä¸€ä¸”è‡³å°‘æœ‰ä¸€ä¸ªé«˜ç”µå¹³è¾“å…¥(è¡¨æ˜æ­£åœ¨å·¥ä½œ)æ—¶ä¸º1; ä¼˜å…ˆçº§:I7&gt;I6&gt;â€¦&gt;I0. è¯‘ç å™¨74x138/74x139 è¾“å…¥è¾“å‡ºä½ç”µå¹³æœ‰æ•ˆ E_3é«˜ç”µå¹³æœ‰æ•ˆ æ•°æ®åˆ†é…å™¨æ•°æ®é€‰æ‹©å™¨æ•°å€¼æ¯”è¾ƒå™¨åŸºæœ¬ç®—æœ¯ç”µè·¯ åŠåŠ å™¨ å…¨åŠ å™¨ å¤šä½æ•°åŠ æ³•å™¨(ä¸²è¡Œè¿›ä½åŠ æ³•å™¨/è¶…å‰è¿›ä½åŠ æ³•å™¨) PLDåˆ†ç±» PROM æˆ–é˜µåˆ—å¯ç¼–ç¨‹é€»è¾‘ PLA ä¸æˆ–é˜µåˆ—å‡å¯ç¼–ç¨‹é€»è¾‘ PALä¸é˜µåˆ—å¯ç¼–ç¨‹é€»è¾‘ é”å­˜å™¨å’Œè§¦å‘å™¨ç»†èŠ‚: ç›¸å¯¹äºé”å­˜å™¨,è§¦å‘å™¨çš„ä¸åŒåœ¨äºæ²¿æ—¶é’Ÿè¾¹æ²¿è§¦å‘ ç”»å›¾æ—¶æ—¶é’Ÿä¿¡å·å°ä¸‰è§’;ä¸Šå‡æ²¿ä¸€èˆ¬ç”¨CPè¡¨ç¤º;ä¸‹é™æ²¿/CP;æœ‰åœ†åœˆé€šå¸¸è¡¨ç¤ºä¸‹é™æ²¿è§¦å‘. æ¿€åŠ±æ–¹ç¨‹: SR ff:Q^{n+1}=S+\\overline RQ^n(SR=0) Dff: Q^{n+1}=D JKff:Q^{n+1}=J\\overline {Q^n}+\\overline KQ^næ—¶åºé€»è¾‘ç”µè·¯æ—¶åºé€»è¾‘ç”µè·¯åˆ†æMealyå‹:è¾“å‡ºæ˜¯å½“å‰çŠ¶æ€å’Œè¾“å…¥çš„å‡½æ•° Mooreå‹:è¾“å‡ºæ˜¯å½“å‰çŠ¶æ€çš„å‡½æ•° åˆ†ææ€è·¯ æ ¹æ®é€»è¾‘å›¾å†™å‡ºé€»è¾‘æ–¹ç¨‹ è¾“å‡ºæ–¹ç¨‹(åˆ¤æ–­Mealy/Moore) æ¿€åŠ±æ–¹ç¨‹:æ¯ä¸ªè§¦å‘å™¨çš„è¾“å…¥é©±åŠ¨æ–¹ç¨‹(J/K=â€¦) çŠ¶æ€æ–¹ç¨‹:æ¿€åŠ±æ–¹ç¨‹ä»£å…¥è§¦å‘å™¨çš„ç‰¹å¾æ–¹ç¨‹å¾—åˆ°(Q(n-1)=â€¦) åˆ—å‡ºçŠ¶æ€è¡¨_æ ¹æ®mealy/mooreå‹ç”»å‡ºå¯¹åº”çš„è¡¨â€”â€”-&gt;ç”»å‡ºçŠ¶æ€å›¾(å›¾ä¾‹!)/æ—¶åºå›¾ æœ€åç¡®å®šç”µè·¯çš„é€»è¾‘åŠŸèƒ½ æ—¶åºé€»è¾‘ç”µè·¯è®¾è®¡ ç»™å®šé€»è¾‘åŠŸèƒ½çš„è¦æ±‚ï¼ˆæ–‡å­—æè¿°æˆ–è€…æ˜¯æ³¢å½¢å›¾ï¼‰ï¼Œ æ±‚ç›¸åº”çš„é€»è¾‘ç”µè·¯ è®¾è®¡çš„ä¸€èˆ¬æ­¥éª¤ å»ºç«‹åŸå§‹çŠ¶æ€å›¾ï¼ˆçŠ¶æ€å¯ä»¥ç”¨æ˜“æ‡‚æˆ–æ˜“å†™çš„æ–¹å¼è¡¨ç¤ºï¼‰å’ŒåŸå§‹çŠ¶æ€è¡¨ çŠ¶æ€åŒ–ç®€ï¼ˆåœ¨é¢å¯¹åŒè¾“å…¥å¾—åˆ°åŒè¾“å‡ºå’ŒåŒæ¬¡æ€NSçš„ç° Q æ€æ˜¯ç­‰ä»·çš„) çŠ¶æ€ç¼–ç  æ±‚çŠ¶æ€æ–¹ç¨‹å’Œè¾“å‡ºæ–¹ç¨‹ æ£€æŸ¥è‡ªå¯åŠ¨ é€‰æ‹©è§¦å‘å™¨ç±»å‹ï¼Œæ±‚æ¿€åŠ±æ–¹ç¨‹ï¼ˆæ¿€åŠ±è¡¨æˆ–å…¶ä»–æ–¹æ³•ï¼‰ ç”»å‡ºé€»è¾‘å›¾ å°½é‡è¦æ±‚è‡ªå·±è®¾è®¡åŒæ­¥æ—¶åºç”µè·¯ï¼Œå› ä¸ºåé¢åœ¨å†™verilogçš„æ—¶å€™ä¸€èˆ¬éƒ½ç”¨ç»Ÿä¸€çš„æ—¶é’Ÿ å¦å¤–å¼‚æ­¥æ—¶åºç”µè·¯è¾“å‡ºä¿¡å·è´¨é‡å·®ï¼Œå·¥ä½œé€Ÿåº¦ä½ ä»¥ä¸Šå†…å®¹ä¸ºæœŸä¸­è€ƒè¯•ä¸»è¦å†…å®¹ï¼Œå…¶ä¸­çš„é€»è¾‘ç”µè·¯åˆ†æå’Œè®¾è®¡çš„é‡éš¾ç‚¹åœ¨æœŸæœ«è€ƒè¯•ä¸­ä»ä¼šæ¶‰åŠ æœŸæœ«è€ƒè¯•é¢å¤–çš„å†…å®¹ï¼š æ•°å­—ç³»ç»Ÿè®¾è®¡ æ•°å­—ç³»ç»Ÿç»“æ„ ç®—æœ¯é€»è¾‘å•å…ƒ å¯„å­˜å™¨ä¼ é€ å…·ä½“é—®é¢˜æ±‚è§£ï¼šæœ€å¤§å€¼/æ’åº/ä¹˜æ³•ç”µè·¯ Verilog HDL Timing Analysis &amp; Synchronization å­˜å‚¨å™¨ï¼ŒPLDï¼ŒListProcessor äºŒæç®¡ ä¸‰æç®¡ åŸºæœ¬æ”¾å¤§ç”µè·¯ é›†æˆè¿æ”¾ é€»è¾‘é—¨ç”µè·¯ ADCå’ŒDAC Verilog HDL/FSMå¸¸é‡è¡¨ç¤ºå½¢å¼ï¼š æ•´æ•°å‹&lt;+/-&gt;&lt;ä½å®½&gt;â€™&lt;åŸºæ•°ç¬¦å·(D/d,B/b,O/o,H/h)&gt;&lt;æ•°å€¼&gt; å®æ•°å‹ï¼š1Â·ç§‘å­¦è®¡æ•°æ³• 2Â·åè¿›åˆ¶è®¡æ•°æ³• ç¬¦å·å¸¸é‡å®šä¹‰ parameter æ•°æ®å˜é‡ç±»å‹ï¼š net(wire) register(reg) å®šä¹‰æ ¼å¼ï¼š wire/reg [MSB/LSB] r1,r2,... èµ‹å€¼è¯­å¥ï¼šè¿ç»­èµ‹å€¼è¯­å¥assignï¼›è¿‡ç¨‹å—èµ‹å€¼inital/always å¸¸ç”¨è¯­æ³•ï¼ˆè¿‡ç¨‹å—èµ‹å€¼å†…ï¼‰case/if else/begin end æ¨¡å—å®ä¾‹åŒ–1.ä½ç½®æ˜ å°„modulename M(A,B,C)ï¼›2.åç§°æ˜ å°„modulename M(.A(a),.C(c),.B(b))â€”â€”ä¸å¯æ··ç”¨ è¿ç®—ç¬¦ ç®—æœ¯è¿ç®—ç¬¦ é€ä½è®¡ç®— å…³ç³»è¿ç®—ç¬¦ ä½è¿ç®—ç¬¦ï¼š~ ,&amp;,^ , | , ^~ / ~^ï¼ˆåŒæˆ–ï¼‰ é€»è¾‘è¿ç®—ç¬¦ï¼š&amp;&amp;ï¼Œï¼ï¼Œ|| ä½æ‹¼æ¥ç¬¦ï¼š{, , } {n{}} ç§»ä½è¿ç®—ç¬¦ï¼š&gt;&gt;,&lt;&lt;,&gt;&gt;&gt;(ç®—æ•°å³ç§») ç¼©ä½è¿ç®—ç¬¦ï¼ˆå•ç›®è¿ç®—ç¬¦ï¼‰ï¼š&amp;ï¼Œ~&amp;ï¼Œ| ï¼Œ~|ï¼Œ^, ^~, ~ ^ æ¡ä»¶è¿ç®—ç¬¦ï¼šï¼Ÿï¼š è¿ç®—ç¬¦ä¼˜å…ˆçº§= = module (input i,output o,inout io); wire ...; parameter M=...; reg [M:m]...; assign ...; modulename name(i,o); initial begin ...; end always @(...) begin if ...; else ...; case (æ•æ„Ÿè¡¨è¾¾å¼) 1:...; 2:...; ... default:...; endcase end endmodule ä½¿ç”¨if/caseè¯­å¥æ—¶åº”è¯¥é¿å…å‡ºç°é”å­˜å™¨ã€‚ ç»„åˆé€»è¾‘ï¼šé˜»å¡èµ‹å€¼ï¼ˆblockingï¼‰ ï¼šâ€˜=â€™å—å†…èµ‹å€¼è¯­å¥é¡ºåºæ‰§è¡Œ æ—¶åºé€»è¾‘ï¼šéé˜»å¡èµ‹å€¼ï¼ˆnon-lockingï¼‰ï¼šâ€˜&lt;=â€™å—å†…èµ‹å€¼è¯­å¥å¹¶å‘è¿›è¡Œ FSM ä¸€æ®µå¼/ä¸¤æ®µå¼/ä¸‰æ®µå¼ CSï¼šç°æ€ï¼›NSï¼šæ¬¡æ€ï¼›OUTï¼šè¾“å‡º ä¸¤æ®µå¼ï¼šä¸€ä¸ªæ—¶åºè¿‡ç¨‹æè¿°CSï¼Œå¦ä¸€ä¸ªç»„åˆæè¿°NSå’ŒOUT ä¸‰æ®µå¼ï¼šä¸¤ä¸ªæ—¶åºæè¿°CSå’ŒOUTï¼Œä¸€ä¸ªç»„åˆè¿‡ç¨‹æè¿°NS æ—¶åºé€»è¾‘ç”µè·¯2å¯„å­˜å™¨å¯„å­˜å™¨æ˜¯è‹¥å¹²å…·æœ‰ç›¸åŒå¤–è§‚ç”µè·¯ç»“æ„çš„å…±äº«æ—¶é’Ÿå’Œæ§åˆ¶ä¿¡å·çš„è§¦å‘å™¨ æ™®é€šå¯„å­˜å™¨/ç§»ä½å¯„å­˜å™¨ 74x194:åŒå‘é€šç”¨ç§»ä½å¯„å­˜å™¨ åŠŸèƒ½è¡¨ï¼š ä¸æ·»åŠ å…¶ä»–é€»è¾‘é—¨å³å¯å®ç°ä½æ‹“å±• åº”ç”¨ï¼šå®ç°åºåˆ—æ£€æµ‹ è®¡æ•°å™¨ç´¯è®¡æ—¶é’Ÿè„‰å†²æ¬¡æ•°ï¼Œå¯ä»¥ç”¨æ¥åˆ†é¢‘ï¼Œå®šæ—¶ï¼Œäº§ç”ŸèŠ‚æ‹è„‰å†² æ¨¡ï¼šå¾ªç¯éå†çš„æœ‰æ•ˆçŠ¶æ€æ•° å¼‚æ­¥é€’å¢è®¡æ•°å™¨ï¼šç”µè·¯ç®€å•ï¼Œæ˜“äºæ‹“å±•ï¼Œä½†å·¥ä½œæ•ˆç‡ä½ï¼Œä¸é€‚ç”¨ åŒæ­¥é€’å¢è®¡æ•°å™¨ï¼š 74x161 74x160:æ¨¡10è®¡æ•°å™¨ï¼Œä¸74x161ç›¸ä¼¼ ä»»æ„è¿›åˆ¶è®¡æ•°å™¨æ„æˆ â€¢ç”¨Nè¿›åˆ¶è®¡æ•°å™¨æ„æˆ M è¿›åˆ¶è®¡æ•°å™¨ â€¢è‹¥ M &lt; N ï¼Œå¯åœ¨è®¡æ•°è¿‡ç¨‹ä¸­è®¾æ³•è·³è¿‡ N-M ä¸ªå¤šä½™çŠ¶æ€ â€‹ â€“åé¦ˆæ¸…é›¶æ³•ï¼Œç®€ç§°æ¸…é›¶æ³• â€‹ â€“åé¦ˆç½®æ•°æ³•ï¼Œç®€ç§°ç½®æ•°æ³• â€¢è‹¥ M &gt; N ï¼Œç”¨å¤šç‰‡ N è¿›åˆ¶è®¡æ•°å™¨çº§è¿ï¼Œé…åˆæ¸…é›¶ / ç½®æ•°æ³•æ„æˆ è¦æ³¨æ„åŒæ­¥æ¸…é›¶å’Œå¼‚æ­¥æ¸…é›¶æ¸…é›¶æ—¶çš„æ•°å€¼æ˜¯ä¸ä¸€è‡´çš„ï¼Œé€šå¸¸åŒæ­¥+1=å¼‚æ­¥ï¼Œç½®æ•°åŒç†â€”â€”å¯ä»¥ç”»çŠ¶æ€å›¾ï¼Œå¼‚æ­¥çš„ä¸´ç•ŒçŠ¶æ€å¯ä»¥ç”»è™šçº¿ ç”¨ç§»ä½å¯„å­˜å™¨å®ç°è®¡æ•°å™¨ï¼Œå¦‚ç¯å½¢è®¡æ•°å™¨ï¼šå°†ä¸²è¡Œè¾“å…¥ä¸ä¸²è¡Œè¾“å‡ºç›´æ¥ç›¸è¿ï¼Œè®¡æ•°çŠ¶æ€ç­‰äºå¯„å­˜å™¨çš„ä½æ•°ã€‚ æ‰­ç¯å‹è®¡æ•°å™¨ï¼šçº¦ç¿°å­™è®¡æ•°å™¨ï¼Œè®¡æ•°çŠ¶æ€æ˜¯ç¯å½¢è®¡æ•°å™¨çš„2å€ æœ‰æ•ˆå¾ªç¯ï¼šæ¯æ¬¡çŠ¶æ€è½¬æ¢åªæ›´æ”¹ä¸€ä½ æ•°å­—ç³»ç»Ÿå¼€å…³å»æŠ–åŠ¨ æ•°å­—ç³»ç»Ÿç»„æˆï¼šData Path+Control Unit å®ä¾‹ï¼šæ—¶åºäºŒè¿›åˆ¶ä¹˜æ³•å™¨ï¼Œæ±‚æœ€å¤§å€¼ï¼Œæ’åº","categories":[{"name":"æ•°å­—ç”µè·¯","slug":"æ•°å­—ç”µè·¯","permalink":"http://sn1987a-1.github.io/categories/%E6%95%B0%E5%AD%97%E7%94%B5%E8%B7%AF/"}],"tags":[{"name":"ä¸“ä¸šè¯¾","slug":"ä¸“ä¸šè¯¾","permalink":"http://sn1987a-1.github.io/tags/%E4%B8%93%E4%B8%9A%E8%AF%BE/"}]},{"title":"çº¿æ€§ç­›","slug":"Algorithm","date":"2021-10-24T15:43:35.000Z","updated":"2023-09-23T13:16:30.242Z","comments":true,"path":"posts/15547.html","link":"","permalink":"http://sn1987a-1.github.io/posts/15547.html","excerpt":"","text":"çº¿æ€§ç­›çš„ç†è§£å’Œåº”ç”¨æœ€è¿‘åœ¨å‡†å¤‡ç›¸å…³ç®—æ³•ç«èµ›ï¼Œæ­£å¥½ç­é‡Œæœ‰å†™åšå®¢çš„æ´»åŠ¨ï¼Œå°±åœ¨æ­¤è®°å½•ä¸‹è‡ªå·±èœä¸æˆå£°å­¦ä¹ çš„è¿‡ç¨‹ã€‚&gt;v&lt; ä¸ºç®—å‡ºå°äºç­‰äºnçš„ç´ æ•°çš„ä¸ªæ•°ï¼Œè¾ƒè‡ªç„¶ä¹Ÿæ˜¯æœ€æš´åŠ›çš„çš„æ–¹æ³•ä¾¿æ˜¯å¯¹æ¯ä¸ªå°äºnçš„æ­£æ•´æ•°è¿›è¡Œåˆ¤å®šï¼Œè¿™æ ·çš„æ–¹æ³•æ˜¾ç„¶è¾¾åˆ°æœ€ä¼˜çš„å¤æ‚åº¦ï¼Œæš´åŠ›ç¡¬è§£çš„ç»“æœæ— ç–‘æ˜¯æœ€ç»ˆå–œæâ€œTime Limit Exceededâ€ã€‚ ä¸ºæé«˜ç®—æ³•æ•ˆç‡ï¼Œå°±è¦å¼•å…¥â€œç­›â€çš„æ€æƒ³â€”â€”ä¸»è¦æ€æƒ³æ˜¯ï¼šæˆ‘ä»¬é€‰å‡ºä¸€ä¸ªæ•°næ—¶æ— è®ºnæ˜¯ç´ æ•°è¿˜æ˜¯åˆæ•°ï¼Œ2n,3n,..éƒ½æ˜¯åˆæ•°ï¼Œæˆ‘ä»¬æ— éœ€å¯¹è¿™ç±»æ•°è¿›è¡Œæ˜¯å¦ä¸ºç´ æ•°çš„åˆ¤æ–­ã€‚ Eratosthenes ç­›æ³• ï¼ˆåŸƒæ‹‰æ‰˜æ–¯ç‰¹å°¼ç­›æ³•ï¼Œç®€ç§°åŸƒæ°ç­›ï¼‰åŸƒæ°ç­›ç®—æ³•çš„ä¸»è¦æ€æƒ³æ˜¯ï¼šå¦‚æœæˆ‘ä»¬ä»å°åˆ°å¤§è€ƒè™‘æ¯ä¸ªæ•°ï¼Œç„¶ååŒæ—¶æŠŠå½“å‰è¿™ä¸ªæ•°çš„æ‰€æœ‰ï¼ˆæ¯”è‡ªå·±å¤§çš„ï¼‰å€æ•°è®°ä¸ºåˆæ•°ï¼Œé‚£ä¹ˆè¿è¡Œç»“æŸçš„æ—¶å€™æ²¡æœ‰è¢«æ ‡è®°çš„æ•°å°±æ˜¯ç´ æ•°äº†ã€‚å…·ä½“ç®—æ³•å¦‚ä¸‹ï¼š int Eratosthenes(int n) { int p = 0; for (int i = 0; i &lt;= n; ++i) is_prime[i] = 1; is_prime[0] = is_prime[1] = 0; for (int i = 2; i &lt;= n; ++i) { if (is_prime[i]) { prime[p++] = i; // prime[p]æ˜¯i,åç½®è‡ªå¢è¿ç®—ä»£è¡¨å½“å‰ç´ æ•°æ•°é‡ for (int j = i * i; j &lt;= n; j += i) // å› ä¸ºä» 2 åˆ° i - 1 çš„å€æ•°æˆ‘ä»¬ä¹‹å‰ç­›è¿‡äº†ï¼Œè¿™é‡Œç›´æ¥ä» i // çš„å€æ•°å¼€å§‹ï¼Œæé«˜äº†è¿è¡Œé€Ÿåº¦ is_prime[j] = 0; //æ˜¯içš„å€æ•°çš„å‡ä¸æ˜¯ç´ æ•° } } return p; } åŸƒæ°ç­›é€šå¸¸å¯ä»¥ç§°ä¸ºæ™®é€šç­›ï¼Œç»“æ„æ¯”è¾ƒç®€å•ï¼Œä¹Ÿæ¯”è¾ƒå®¹æ˜“ç†è§£ï¼Œå…¶æ ¸å¿ƒå°±æ˜¯å¯¹æ‰¾åˆ°çš„ç´ æ•°çš„å€æ•°é€šè¿‡ä¸€æ¬¡å¾ªç¯è¿›è¡Œæ ‡è®°ï¼Œè™½ç„¶è¦é¢å¤–å ç”¨O(n)çš„å†…å­˜ç©ºé—´ä¿å­˜æ ‡è®°ï¼Œä½†éå¸¸é«˜æ•ˆåœ°å‡å°‘äº†ç¨‹åºå¤æ‚åº¦ã€‚ æˆ‘ä»¬åº”è¯¥æ³¨æ„åˆ°ï¼ŒåŸƒæ°ç­›åœ¨å¯¹æ•°å­—è¿›è¡Œæ ‡è®°ç­›é€‰æ—¶ï¼Œå­˜åœ¨é‡å¤ç­›é€‰ï¼Œæ¯”å¦‚6æ—¢å¯ä»¥è¢«2ç­›æ‰ï¼Œåˆå¯ä»¥è¢«3ç­›æ‰ã€‚åŸå› ï¼šä»»æ„ä¸€ä¸ªæ•´æ•°å¯ä»¥å†™æˆä¸€äº›ç´ æ•°çš„ä¹˜ç§¯ n=p1^ip2^jp3^kå…¶ä¸­p1&lt;p2&lt;p3ï¼Œè¿™æ ·è¿™ä¸ªæ•°nèƒ½è¢«p1,p2å’Œp3ç­›æ‰,åå¤è¢«æ ‡è®°ï¼Œå°¤å…¶åœ¨næ¯”è¾ƒå¤§çš„æ—¶å€™ï¼Œnå¯èƒ½æœ‰ç›¸å½“å¤šä¸ªç´ å› å­ï¼Œè¢«å¤šæ¬¡æ ‡è®°ï¼Œæ˜¾ç„¶æµªè´¹äº†æ—¶é—´ã€‚ Eulerç­›æ³•(çº¿æ€§ç­›)åŸºäºæ™®é€šç­›çš„ä¸è¶³ä¹‹å¤„ï¼ŒEulerå¯¹å…¶åšå‡ºäº†ä¿®æ”¹â€”â€”ç›´è§‚åœ°æ¥è¯´ï¼Œå½“æˆ‘ä»¬ç”¨åŸƒæ°ç­›æ³•å¯¹ä¸€ä¸ªç´ æ•°çš„nå€è¿›è¡Œç­›é€‰æ—¶ï¼Œè‹¥æ­£åœ¨è¢«æ ‡è®°çš„è¿™ä¸ªå€æ•°å·²ç»è¶³å¤Ÿå¤§ï¼Œå¤§åˆ°è¶…è¿‡ä¸€ç‰¹å®šçš„æ•°å­—åï¼Œé‚£è¿™ä¸ªæ•°ä¸€å®šæœ‰æ›´å¤§çš„ç´ å› å­ï¼Œèƒ½åœ¨åç»­è¿‡ç¨‹ä¸­å†æ¬¡è¢«æ ‡è®°ï¼Œæ­¤æ—¶å°±å¯ä»¥åœæ­¢å¾ªç¯ï¼Œç®—æ³•ç»§ç»­å¯¹ä¸‹ä¸€ä¸ªæœªæ ‡è®°çš„æ•°è¿›è¡Œæ˜¯å¦ä¸ºç´ æ•°çš„åˆ¤æ–­ã€‚ é€šè¿‡è§‚å¯Ÿä¸éš¾å‘ç°ï¼Œè‹¥å½“å‰æ­£åœ¨å¤„ç†nçš„iå€æ•°inï¼Œièƒ½æ•´é™¤nï¼Œé‚£ä¹ˆiä¸ä¸‹ä¸€ä¸ªè¦è¿›è¡Œç­›é€‰çš„æ•°çš„ä¹˜ç§¯è¿™ä¸ªåˆæ•°è‚¯å®šä¼šè¢«nä¹˜ä»¥æŸä¸ªæ•°æå‰ç­›æ‰ã€‚å› æ­¤è¿™é‡Œçš„iä¾¿æ˜¯æˆ‘ä»¬è¦æ‰¾çš„â€œç‰¹å®šçš„æ•°å­—â€ï¼Œåˆ©ç”¨è¿™ä¸€æ•°å­—æå‰breakæ‰å¾ªç¯ï¼Œå¯ä»¥ä½¿å¾—æ¯ä¸ªæ•°å­—å‡è¢«ç­›é€‰ä¸€æ¬¡ï¼Œå°†æ—¶é—´å¤æ‚åº¦é™åˆ°æœ€ä½ï¼Œè¿™ä¹Ÿå°±æ˜¯Eulerç­›çš„ç®—æ³•æ€æƒ³ï¼Œå®ç°ä»£ç å¦‚ä¸‹æ‰€ç¤ºã€‚ void init() { phi[1] = 1; for (int i = 2; i &lt; MAXN; ++i) { if (!vis[i]) { phi[i] = i - 1; pri[cnt++] = i; } for (int j = 0; j &lt; cnt; ++j) { if (1ll * i * pri[j] &gt;= MAXN) break; vis[i * pri[j]] = 1; if (i % pri[j]) { phi[i * pri[j]] = phi[i] * (pri[j] - 1); } else { // i % pri[j] == 0 // æ¢è¨€ä¹‹ï¼Œi ä¹‹å‰è¢« pri[j] ç­›è¿‡äº† // ç”±äº pri é‡Œé¢è´¨æ•°æ˜¯ä»å°åˆ°å¤§çš„ï¼Œæ‰€ä»¥ i ä¹˜ä¸Šå…¶ä»–çš„è´¨æ•°çš„ç»“æœä¸€å®šä¼šè¢« // pri[j] çš„å€æ•°ç­›æ‰ï¼Œå°±ä¸éœ€è¦åœ¨è¿™é‡Œå…ˆç­›ä¸€æ¬¡ï¼Œæ‰€ä»¥è¿™é‡Œç›´æ¥ break // æ‰å°±å¥½äº† phi[i * pri[j]] = phi[i] * pri[j]; break; } } } } å…³é”®ä¹‹å¤„åœ¨ï¼šif(i%prime[j]==0) break; è¿™å¥ä»£ç ä¿è¯äº†æ¯ä¸ªæ•°æœ€å¤šè¢«ç­›ä¸€æ¬¡ï¼Œå°†æ—¶é—´å¤æ‚åº¦é™åˆ°äº†çº¿æ€§ã€‚ è¯ï¼šprime[]æ•°ç»„ä¸­çš„ç´ æ•°æ˜¯é€’å¢çš„,å½“ièƒ½æ•´é™¤prime[j]ï¼Œé‚£ä¹ˆiprime[j+1]è¿™ä¸ªåˆæ•°è‚¯å®šä¼šè¢«prime[j]ä¹˜ä»¥æŸä¸ªæ•°ç­›æ‰ã€‚å› æ­¤ï¼Œè¿™é‡Œç›´æ¥breakæ‰ï¼Œå°†iprime[j+1]åŠä¹‹åçš„ç»™åé¢çš„æ•°å»ç­›ã€‚è¿™ç§æ–¹æ³•èƒ½ä¿è¯æ¯ä¸ªæ•°åªè¢«ç­›ä¸€éï¼Œåˆèƒ½ä¿è¯æ¯ä¸ªæ•°éƒ½è¢«ç­›åˆ°ã€‚ ä¸ºäº†æ›´å¥½çš„ç†è§£ï¼Œç”»å‡ºå‰é¢å‡ æ¬¡ç­›çš„æƒ…å†µ: ä¸€èˆ¬æ¥è¯´ï¼Œå½“ç­›é€‰èŒƒå›´nè¾ƒå°æ—¶ï¼ŒåŸƒæ°ç­›å’Œæ¬§æ°ç­›å¤æ‚åº¦è¾ƒç›¸è¿‘ï¼Œç”šè‡³åŸƒæ°ç­›è¡¨ç°æ›´å¥½ï¼Œä½†éšç€nçš„å¢å¤§ï¼Œæ¬§æ°ç­›çš„ä¼˜è¶Šæ€§ä¹Ÿé€æ¸ä½“ç°å‡ºæ¥ï¼Œå¯ä»¥è¾¾åˆ°åŸƒæ°ç­›3-4å€çš„é€Ÿåº¦ã€‚ å‚è€ƒï¼š 1.çº¿æ€§ç­›çš„ç†è§£åŠåº”ç”¨ - Rogn - åšå®¢å›­ (cnblogs.com) 2.çº¿æ€§ç­›_å†å°½åƒå¸†-CSDNåšå®¢_çº¿æ€§ç­›","categories":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://sn1987a-1.github.io/categories/%E7%AE%97%E6%B3%95/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://sn1987a-1.github.io/tags/%E7%AE%97%E6%B3%95/"}]}],"categories":[{"name":"æœºå™¨å­¦ä¹ ","slug":"æœºå™¨å­¦ä¹ ","permalink":"http://sn1987a-1.github.io/categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/"},{"name":"ç¼–è¯‘åŸç†","slug":"ç¼–è¯‘åŸç†","permalink":"http://sn1987a-1.github.io/categories/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86/"},{"name":"Golang","slug":"Golang","permalink":"http://sn1987a-1.github.io/categories/Golang/"},{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"http://sn1987a-1.github.io/categories/%E5%89%8D%E7%AB%AF/"},{"name":"HPC","slug":"HPC","permalink":"http://sn1987a-1.github.io/categories/HPC/"},{"name":"AI","slug":"AI","permalink":"http://sn1987a-1.github.io/categories/AI/"},{"name":"åŒºå—é“¾","slug":"åŒºå—é“¾","permalink":"http://sn1987a-1.github.io/categories/%E5%8C%BA%E5%9D%97%E9%93%BE/"},{"name":"ä»£æ•°ç»“æ„","slug":"ä»£æ•°ç»“æ„","permalink":"http://sn1987a-1.github.io/categories/%E4%BB%A3%E6%95%B0%E7%BB%93%E6%9E%84/"},{"name":"äººå·¥æ™ºèƒ½","slug":"äººå·¥æ™ºèƒ½","permalink":"http://sn1987a-1.github.io/categories/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD/"},{"name":"CSII","slug":"CSII","permalink":"http://sn1987a-1.github.io/categories/CSII/"},{"name":"OS","slug":"OS","permalink":"http://sn1987a-1.github.io/categories/OS/"},{"name":"git","slug":"git","permalink":"http://sn1987a-1.github.io/categories/git/"},{"name":"WSL2","slug":"WSL2","permalink":"http://sn1987a-1.github.io/categories/WSL2/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://sn1987a-1.github.io/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"},{"name":"å›¾è®º","slug":"å›¾è®º","permalink":"http://sn1987a-1.github.io/categories/%E5%9B%BE%E8%AE%BA/"},{"name":"æ•°å­—ç”µè·¯","slug":"æ•°å­—ç”µè·¯","permalink":"http://sn1987a-1.github.io/categories/%E6%95%B0%E5%AD%97%E7%94%B5%E8%B7%AF/"},{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://sn1987a-1.github.io/categories/%E7%AE%97%E6%B3%95/"}],"tags":[{"name":"ä¸“ä¸šè¯¾","slug":"ä¸“ä¸šè¯¾","permalink":"http://sn1987a-1.github.io/tags/%E4%B8%93%E4%B8%9A%E8%AF%BE/"},{"name":"Gin","slug":"Gin","permalink":"http://sn1987a-1.github.io/tags/Gin/"},{"name":"Vue","slug":"Vue","permalink":"http://sn1987a-1.github.io/tags/Vue/"},{"name":"å¹¶è¡Œæ•°æ®ç»“æ„","slug":"å¹¶è¡Œæ•°æ®ç»“æ„","permalink":"http://sn1987a-1.github.io/tags/%E5%B9%B6%E8%A1%8C%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"},{"name":"CGO","slug":"CGO","permalink":"http://sn1987a-1.github.io/tags/CGO/"},{"name":"Go","slug":"Go","permalink":"http://sn1987a-1.github.io/tags/Go/"},{"name":"chatbot","slug":"chatbot","permalink":"http://sn1987a-1.github.io/tags/chatbot/"},{"name":"WSL2","slug":"WSL2","permalink":"http://sn1987a-1.github.io/tags/WSL2/"},{"name":"å›¾è®º","slug":"å›¾è®º","permalink":"http://sn1987a-1.github.io/tags/%E5%9B%BE%E8%AE%BA/"},{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://sn1987a-1.github.io/tags/%E7%AE%97%E6%B3%95/"}]}