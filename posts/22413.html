<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Knowledge Framework of OS PART II CH3 | SN1987A</title><meta name="keywords" content="专业课,OS,note"><meta name="author" content="SN1987A"><meta name="copyright" content="SN1987A"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Part IIProcess Concept &amp; OperationsConcepts of Process the building of processing   Pre-processor:like #define,#include —-try “gcc -E hello.c” Compiler and Optimizer compiler:Syntax checking and a">
<meta property="og:type" content="article">
<meta property="og:title" content="Knowledge Framework of OS PART II CH3">
<meta property="og:url" content="http://sn1987a-1.github.io/posts/22413.html">
<meta property="og:site_name" content="SN1987A">
<meta property="og:description" content="Part IIProcess Concept &amp; OperationsConcepts of Process the building of processing   Pre-processor:like #define,#include —-try “gcc -E hello.c” Compiler and Optimizer compiler:Syntax checking and a">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://user-images.githubusercontent.com/74918703/155833614-94542aa5-0d30-4691-95d6-9d35a95eaa6a.png">
<meta property="article:published_time" content="2022-03-07T07:35:11.000Z">
<meta property="article:modified_time" content="2022-05-28T05:51:03.011Z">
<meta property="article:author" content="SN1987A">
<meta property="article:tag" content="专业课">
<meta property="article:tag" content="OS">
<meta property="article:tag" content="note">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://user-images.githubusercontent.com/74918703/155833614-94542aa5-0d30-4691-95d6-9d35a95eaa6a.png"><link rel="shortcut icon" href="https://user-images.githubusercontent.com/74918703/157878087-7f268ec6-e86a-4e5f-be80-4846ee8d644c.png"><link rel="canonical" href="http://sn1987a-1.github.io/posts/22413"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: {"limitDay":365,"position":"top","messagePrev":"一年之内的产物","messageNext":"技术可能存在过期"},
  highlight: {"plugin":"prismjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":200},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":50,"languages":{"author":"作者: SN1987A","link":"链接: ","source":"来源: SN1987A","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.bootcss.com/jquery/3.1.1/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: true,
  islazyload: true,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Knowledge Framework of OS PART II CH3',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-05-28 13:51:03'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if (GLOBAL_CONFIG_SITE.isHome && /iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    document.addEventListener('pjax:complete', detectApple)})(window)</script><link defer rel="stylesheet" href="/css/customm.css" ><link defer rel="stylesheet" href="https://cdn.jsdelivr.net/gh/zhaoze-jpg/Xianqi@main/css/icon.css"><link defer rel="stylesheet" href="https://cdn.jsdelivr.net/gh/HCLonely/images@master/others/heartbeat.min.css"><link defer rel="stylesheet" href="https://cdn.jsdelivr.net/gh/zhaoze-jpg/Xianqi@main/css/background.css"><meta name="generator" content="Hexo 5.2.0">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
<link rel="alternate" href="/atom.xml" title="SN1987A" type="application/atom+xml">
</head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://user-images.githubusercontent.com/74918703/157878087-7f268ec6-e86a-4e5f-be80-4846ee8d644c.png" onerror="onerror=null;src='https://cdn.jsdelivr.net/gh/zhaoze-jpg/Xianqi@main/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">12</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">13</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">9</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-archive"></i><span> 归档</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/artitalk/"><i class="fa-fw fas fa-book"></i><span> 说说</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 时轴</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-heartbeat"></i><span> 清单</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/List/music/"><i class="fa-fw fa fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/List/gallery/"><i class="fa-fw fa fa-image"></i><span> 相册</span></a></li><li><a class="site-page child" href="/List/movies/"><i class="fa-fw fa fa-film"></i><span> 视频</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/comments/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/tools/"><i class="fa-fw fa fa-suitcase"></i><span> 百宝箱</span></a></div><div class="menus_item"><a class="site-page" href="/Windows/"><i class="fa-fw fa fa-desktop"></i><span> Windows</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于我</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://user-images.githubusercontent.com/74918703/155833614-94542aa5-0d30-4691-95d6-9d35a95eaa6a.png')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">SN1987A</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-archive"></i><span> 归档</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/artitalk/"><i class="fa-fw fas fa-book"></i><span> 说说</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 时轴</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-heartbeat"></i><span> 清单</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/List/music/"><i class="fa-fw fa fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/List/gallery/"><i class="fa-fw fa fa-image"></i><span> 相册</span></a></li><li><a class="site-page child" href="/List/movies/"><i class="fa-fw fa fa-film"></i><span> 视频</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/comments/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/tools/"><i class="fa-fw fa fa-suitcase"></i><span> 百宝箱</span></a></div><div class="menus_item"><a class="site-page" href="/Windows/"><i class="fa-fw fa fa-desktop"></i><span> Windows</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于我</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Knowledge Framework of OS PART II CH3</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-03-07T07:35:11.000Z" title="发表于 2022-03-07 15:35:11">2022-03-07</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-05-28T05:51:03.011Z" title="更新于 2022-05-28 13:51:03">2022-05-28</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/OS/">OS</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">3.7k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>23分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="Knowledge Framework of OS PART II CH3"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="Part-II"><a href="#Part-II" class="headerlink" title="Part II"></a>Part II</h1><h1 id="Process-Concept-amp-Operations"><a href="#Process-Concept-amp-Operations" class="headerlink" title="Process Concept &amp; Operations"></a>Process Concept &amp; Operations</h1><h2 id="Concepts-of-Process"><a href="#Concepts-of-Process" class="headerlink" title="Concepts of Process"></a>Concepts of Process</h2><p><strong> the building of processing </strong></p>
<ul>
<li>Pre-processor:like #define,#include —-try “gcc -E hello.c”</li>
<li>Compiler and Optimizer<ul>
<li>compiler:Syntax checking and analyzing</li>
<li>if no syntax:construct the intermediate codes</li>
<li>i.e,assembly</li>
<li>Optimizer :optimize the codes</li>
<li>check the parameter of gcc</li>
</ul>
</li>
<li>Assembler and Linker<ul>
<li>assembler assembles hello.s and generate hello.o</li>
<li>the linker puts together the objects files as well as library files</li>
</ul>
</li>
</ul>
<p>compile multiple files?</p>
<p>makefile</p>
<h2 id="What-is-a-process"><a href="#What-is-a-process" class="headerlink" title="What is a process"></a>What is a process</h2><h3 id="process-in-memory"><a href="#process-in-memory" class="headerlink" title="process in memory"></a>process in memory</h3><p>a program is a program in execution</p>
<ul>
<li>a executable file load into mermory</li>
<li>is Active</li>
<li><p>process in memory :</p>
<ul>
<li>text section:program code</li>
<li>stack</li>
<li>heap</li>
<li>data section</li>
<li>program counter </li>
<li>content of register</li>
</ul>
</li>
<li><p>process state</p>
<ul>
<li>a process executes changes states:</li>
<li>new</li>
<li>runnig</li>
<li>waiting :for I/O</li>
<li>ready—need CPU resources</li>
<li>terminated</li>
</ul>
</li>
</ul>
<p>the state diagram and the switch between</p>
<pre class="mermaid">graph LR
A[new]--admitted--&gt;B[ready]
C[wait]--I/O or event completion--&gt;B
D[running]--interrupt--&gt;B
D--I/O or event wait --&gt;C
B--scheduler dispatch--&gt;D
D--exit--&gt;E[terminated]</pre>


<h3 id="PCB—process-structure"><a href="#PCB—process-structure" class="headerlink" title="PCB—process structure"></a>PCB—process structure</h3><p><strong>How to locate /represent a process</strong></p>
<ul>
<li>PCB:process control block or task control block<ul>
<li>program state</li>
<li>program counter</li>
<li>CPU registers</li>
<li>CPU scheduling information</li>
<li>memory-management information</li>
<li>I/O status information</li>
<li>Accouting information<br>process data structure in Linux</li>
<li>represents by struct <em>task_struct</em> in C</li>
<li><linux sched.h="">

</linux></li>
</ul>
</li>
</ul>
<p>the relationship between program data&amp; PCB</p>
<p>Conclusion on “what is a process”</p>
<ol>
<li>a program in execution</li>
<li>only one process can be running on any processor at any instant</li>
<li>two processes maybe associated with one program</li>
<li>a process can be an execution environment for other codes.</li>
</ol>
<h2 id="Process-Operations"><a href="#Process-Operations" class="headerlink" title="Process Operations"></a>Process Operations</h2><p>process:all the files,memory,accouting information</p>
<p>a system must provide the mechanism for:process identification,process creation,process execution,process termination</p>
<p>some basic system calls:</p>
<p>getpid(),fork(),exec*(),wait(),exit()</p>
<h3 id="Process-identification"><a href="#Process-identification" class="headerlink" title="Process identification"></a>Process identification</h3><ul>
<li>each process was given a unique id:process ID,<strong>PID</strong></li>
<li>use <code>getpid()</code></li>
<li>#include <unistd.h></unistd.h></li>
<li>‘.’:当前目录</li>
<li>use getpid()to check a program several times:get different PID<h3 id="Process-creation"><a href="#Process-creation" class="headerlink" title="Process creation"></a>Process creation</h3></li>
<li>a process may create several new processes<ul>
<li>parent process and chidren process </li>
</ul>
</li>
<li>the first process(the kernel runs when booting up)—-<code>init</code><ul>
<li>PID=1,is running the program code “/sbin/init”</li>
<li>the first task is to create more processes</li>
</ul>
</li>
<li>tree hierarchy<ul>
<li>all the process form a tree hierarchy</li>
<li>program blossoming:command to view tree:</li>
<li>“pstree” or “pstree -A”—-for ascii-character-only on display</li>
<li>the termination can be happen at any time:the parent terminate before the children:turn a tree hierarchy to a forest(a process become a orphan)</li>
<li><strong>orphan process</strong> may make a difference…become a tree ,and when it terminate nobody will know?</li>
<li>solve orphan process:re-parent operation</li>
<li>the relationship between parent and children<ul>
<li>resource sharing options:all/subset/no</li>
<li>execution options:execute concurrently/parent wait for children</li>
<li>address space options:a duplicate of parent/a new program loaded into it</li>
</ul>
</li>
</ul>
</li>
<li>to create :system call <code>fork()</code><ul>
<li><code>printf(...getpid()..);fork;print(...getpid());</code>:you will get three result(like 1234,1234,1235,not always cPID=pPID+1)</li>
<li>the last print executed twice</li>
<li>the fork():the parent and children executes the same codes,but not the same start:<strong>the children starts where the fork()is returned</strong>,the result of fork()will not loaded into children.</li>
<li>the parent process will run first,using the same files like program  counter and I/O devices<h3 id="program-execution"><a href="#program-execution" class="headerlink" title="program execution"></a>program execution</h3></li>
</ul>
</li>
<li>fork( ) can only duplicate and run the same program——-use <strong>exec( )</strong></li>
<li>execl( ) : a member of the exec() system call family(the family has 6 members),as an example<ul>
<li>example: …. execl(“/bin/ls”,”/bin/ls”,NULL);…. it means “ls”/or … execl(“/bin/ls”,”bin/ls”,”-l”,NULL)</li>
<li>$1^{st}$ argument:the program name</li>
<li>$2^{st}$ argument:the first argument to the program </li>
<li>$3^{rd}$ argument:the second argument to the program</li>
<li>$4^{th}$ argument:indicate the end of list of arguments</li>
</ul>
</li>
</ul>
<ul>
<li><strong>the word after this function will not be executed anyway——-no new process will be created and the PCB will not change ,but the code will be replaced,it will run till meeting “exit()”,and will not return the former program ,losing many data as well</strong></li>
<li>note:  fork() vs exec()</li>
<li><strong>fork()+exec()=?—</strong>(duplicate and then replace,the children will use exit(-1)to terminate)— write a system( ) library call——it will cause problem:the parents will first termination(actually cannot predict which will execute) </li>
<li>fork()+exec() is not enough ,use system call <strong>fork()+exec()+wait()</strong>: “<strong>suspend</strong> the executions of parent process挂起父进程””<strong>wake</strong> the parent up after the childern is terminated唤醒”</li>
</ul>
<p><strong>about wait()</strong></p>
<ul>
<li>when to wake up: when <strong>one of the child</strong> processes changes from running to terminated</li>
<li>does not suspend the calling process</li>
<li>wait():usage: wait(NULL),has many cases while using <ul>
<li>case 1:the wait()system  can suspend the calling parent process</li>
<li>case 2: the parent will not suspend if there is no child  process or there no running child process(still need time)</li>
</ul>
</li>
<li>more powerful wait?needs to <strong>wait for a particular  child or detect child status changing(wait()can only waits for ant of the child and detect the status termination only)</strong><ul>
<li>waitpid()—-read the man pages.</li>
<li>program termination</li>
</ul>
</li>
</ul>
<h3 id="make-a-summary"><a href="#make-a-summary" class="headerlink" title="make a summary"></a>make a summary</h3><p>a process is created by <strong>cloning</strong></p>
<ul>
<li>fork() :cloning is copying</li>
<li>exec()</li>
<li>wait()&amp;waitpid()</li>
</ul>
<p>the program exection is fundamental ,but not trivial:process is the place that hots a program and run it,and the exec*()changed the program the process is running,a process can run more than a program</p>
<h2 id="From-Kernel-Perspcetive"><a href="#From-Kernel-Perspcetive" class="headerlink" title="From Kernel Perspcetive"></a>From Kernel Perspcetive</h2><h3 id="dual-mode"><a href="#dual-mode" class="headerlink" title="dual mode"></a>dual mode</h3><p><strong>kernel-space &amp; user-space</strong>:</p>
<div class="table-container">
<table>
<thead>
<tr>
<th></th>
<th style="text-align:center">kernel-space</th>
<th>user-space</th>
</tr>
</thead>
<tbody>
<tr>
<td>stored what</td>
<td style="text-align:center">kernel data structure,kernel program,driven devices</td>
<td>process memory,program code of the porcess</td>
</tr>
<tr>
<td>accessed by whom</td>
<td style="text-align:center">kernel code</td>
<td>user  program &amp; kernel code</td>
</tr>
</tbody>
</table>
</div>
<p>a program will switch its execution from user mode and kernel mode</p>
<p>(example : getpid() need to execute system call)</p>
<p><strong>user time &amp; system time</strong></p>
<p>user time : time spend on codes in user-space memory</p>
<p>system time : time spend on codes in kernel-space memory</p>
<p>total tunning time:user time + kernel time</p>
<p>use tool: time(<code>time ./filename</code>): total/user/sys time</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="C:\Users\李\AppData\Roaming\Typora\typora-user-images\image-20220314142402862.png" alt="image-20220314142402862" style="zoom:67%;"></p>
<h3 id="the-system-call"><a href="#the-system-call" class="headerlink" title="the system call"></a>the system call</h3><h4 id="fork"><a href="#fork" class="headerlink" title="fork()"></a>fork()</h4><p>fork behaved like cell division </p>
<p>it create the child process by “cloning” form the parent process,including:</p>
<ul>
<li>program counter :CPU register ，that is why they both execute from the same line of code after fork() returns</li>
<li>Program code</li>
<li>memeory</li>
<li>opened files(kernel’s internal)</li>
</ul>
<p>does not clone:</p>
<ul>
<li>PID</li>
<li>return value of fork()</li>
<li>parent process</li>
<li>running time:just created ,is 0</li>
</ul>
<p>action: the start—kernel-space update—user-mode update —-finish</p>
<p>kernel-space updates: </p>
<ul>
<li>the running time will reset to 0</li>
<li>update pid</li>
<li>the paretnt will have a new child and the child will have a pointer to its parent.</li>
</ul>
<p>user -space update: copying…</p>
<blockquote>
<p>array of opened files :</p>
<p>array index:</p>
<p>0— standard of input stream :file *stdin</p>
<p>1— standard of output stream :file *stdout</p>
<p>2— standard error stream:file *stderr</p>
<p>3/beyond— storing the file you opened,e.g,fopen(),open,etc</p>
</blockquote>
<p>that’s why the parents process shares the same terminal output system with the child process</p>
<h4 id="exec"><a href="#exec" class="headerlink" title="exec*()"></a>exec*()</h4><p>action:start,end</p>
<p>process itself does not change</p>
<p>user-space memory: local veriable,dynamically-allocated memory will be cleared,and the global variable will reset based on new code,code + constant will changed to new program code</p>
<h4 id="wait-amp-exit"><a href="#wait-amp-exit" class="headerlink" title="(**)wait() \&amp;exit()"></a>(**)wait() \&amp;exit()</h4><p>exit()——child side : not really remove the child process ,remain the entry of the child in the process table(template state)</p>
<p>The child is now called zombie. Its storage in the kernel-space memory is kept to a minimum The PID (1235 in this example) and process structure are owned by the child.</p>
<p>wake up the parent: The kernel notifies the parent of the child process about the termination of its child. The notification is a signal called <strong>SIGCHLD</strong>.</p>
<p>signal:</p>
<p>• What is signal? – A software interrupt – It takes steps as in the hardware interrupt</p>
<p> • Two kinds of signals – Generated from user space </p>
<p>• Ctrl+C, kill() system call, etc. – Generated from kernel and CPU </p>
<p>• Segmentation fault (SIGSEGV), Floating point exception (SIGFPE), child process termination (SIGCHLD), etc. </p>
<p>• Signal is very hard to master, will be skipped in this course – Reference: Advanced Programming Environment in UNIX – Linux manpage</p>
<p>summary <strong>exit()</strong></p>
<p>Step (1) Clean up most of the allocated kernel-space memory. </p>
<p>Step (2) Clean up all user-space memory. </p>
<p>Step (3) Notify the parent with SIGCHLD</p>
<p>Although the child is still in the system, it is no longer running. There is no program code!!! It turns into a mindless zombie…</p>
<p>wait()——parent side: see the SIGCHLD signal and handle it.</p>
<p>The kernel sets a signal handling routine (and it is a function pointer) to the process. That signal handling routine will be executed when SIGCHLD comes.</p>
<p>By default, every process does not respond to the SIGCHLD signal (the signal handlers are set only when wait() is called). </p>
<p>When SIGCHLD comes, the signal handling routine is invoked! </p>
<p>Note: since the parent is still inside the system call, instead of the original program code, the parent process is still blocked in some sense…</p>
<p><strong>Default Handling of SIGCHLD</strong> </p>
<ol>
<li>Accept and remove the SIGCHLD; </li>
<li>Destroy the child process that sends her the signal.</li>
</ol>
<p><strong>case 2-</strong>—the wait() is called after the child already termintated,which is safe</p>
<p>in case 2,the SIGCHlD is also sent to parent before,and when the wait() is called ,it can return and kill the child process completely.</p>
<p>short summary of <strong>exit() &amp;wait()</strong></p>
<ul>
<li><p>A process is turned into a zombie when… </p>
<ul>
<li>The process calls exit(). </li>
<li>The process returns from main(). </li>
<li>The process terminates abnormally. <ul>
<li>You know, the kernel knows that the process is terminated abnormally. Hence, the kernel invokes exit() by itself.</li>
</ul>
</li>
</ul>
</li>
<li><p>Remember why exec*() does not return to its calling process in previous example…</p>
</li>
<li>wait() is to reap zombie child processes <ul>
<li>You should never leave any zombies in the system. </li>
</ul>
</li>
<li>Linux will label zombie processes as <code>&lt;defunct&gt;</code>. <ul>
<li>To look for them:<code>ps aux | grep defunct</code> </li>
</ul>
</li>
<li>Learn waitpid() by yourself…?</li>
</ul>
<p>If a orphan does not have a parent wait() when terminate—may init a new parent .</p>
<p>the role of wait() in the OS:</p>
<p>Why calling wait() is important – It is not about process execution/suspension… – It is about system resource management. </p>
<p>Think about it: – A zombie takes up a PID; – The total number of PIDs are limited; • Read the limit: “cat /proc/sys/kernel/pid_max” – What will happen if we don’t clean up the zombies?</p>
<h2 id="summary"><a href="#summary" class="headerlink" title="summary"></a>summary</h2><p>concepts:</p>
<ul>
<li>process data &amp; memoty</li>
<li>PCB+ user-space mermory</li>
</ul>
<p>operations</p>
<ul>
<li>fork()</li>
<li>exec*()</li>
<li>wait()+exit()——come together , calling wait() is imporrtant</li>
<li>so..what is the kernel  doing?…</li>
</ul>
<h1 id="Threads"><a href="#Threads" class="headerlink" title="Threads"></a>Threads</h1><h2 id="Thread"><a href="#Thread" class="headerlink" title="Thread"></a>Thread</h2><h3 id="Motivation-of-Multi-Threading-and-Concepts"><a href="#Motivation-of-Multi-Threading-and-Concepts" class="headerlink" title="Motivation of Multi-Threading and Concepts"></a>Motivation of Multi-Threading and Concepts</h3><p>Thread concepts:why use , structure in memory, benefits and challenge, thread models</p>
<p>Progreamming :Basic programming;implicit threading</p>
<p>motivation: </p>
<ul>
<li>application side:most software applications are multithreaded,each application is implemented as a process with several threads of control.(web browser or wiord processor)<ul>
<li>still remember what kind of data are include in a process:</li>
<li>text data,statck,heap inuser-space memory</li>
<li>PCB in kernel-space memory</li>
</ul>
</li>
<li>system side:modern computers usually contain multicores,but each processor can run only one process ata time,so to improve the efficiency:<ul>
<li>assign one task to each core</li>
<li>real parallelism</li>
<li>the process cannot visit another process’s data and memory</li>
</ul>
</li>
</ul>
<p><strong>concurrency vs. parallelism</strong></p>
<h3 id="internals"><a href="#internals" class="headerlink" title="internals"></a>internals</h3><p>Code: </p>
<ul>
<li>all the threads use the same code.</li>
<li>a thread starts with onr specfic function——named it the thread function</li>
<li>a thread function can invoke other functions or system calls</li>
<li>a thread could never return to the caller of the thread function</li>
</ul>
<p>Global variables:</p>
<ul>
<li>all thread share the same global variable zone and the same dynamically allocated memory</li>
<li>all thread can read from and write to</li>
</ul>
<p>Local variables:</p>
<ul>
<li>each therad has its own memory range for local variable</li>
<li>so the stack is a private zone</li>
</ul>
<h3 id="Benefits"><a href="#Benefits" class="headerlink" title="Benefits"></a>Benefits</h3><ul>
<li>allow an application to do parallel tasks simulaneously</li>
<li>ease in data sharing</li>
<li>peocess share resources via shared memory or message passing</li>
<li>Economy<ul>
<li>allocation memory and resources for process creations is costly ,dozens of time tha creation threads…</li>
<li>context-switch between processes is also costly,several times of slower</li>
</ul>
</li>
<li>Scalablilty: thread may be running in parallel on different cores</li>
</ul>
<h3 id="programming-challenges"><a href="#programming-challenges" class="headerlink" title="programming challenges"></a>programming challenges</h3><ul>
<li>indentifying tasks: divide seperate and concurrent tasks</li>
<li>balance: tasks should perform equal work of equal value</li>
<li>data splitting: data must be divided to run on seperate cores</li>
<li>tdata dependency:synchronization is needed</li>
<li>testing and debugging </li>
</ul>
<h2 id="Thread-models"><a href="#Thread-models" class="headerlink" title="Thread models"></a>Thread models</h2><p>thread should include :</p>
<ul>
<li>data/resources in user-space memory</li>
<li>structure in kernel</li>
</ul>
<p>provide thread support:</p>
<ul>
<li>user thread: implement in user space</li>
<li>kernel thread: supported and managed by kernel</li>
</ul>
<p>1.<strong>many-to-one models</strong> :(many in user space and one in kernel)</p>
<ul>
<li>all the threads are mapped to one process structure in the kernel</li>
<li>easy for the kernel to implement </li>
<li>drawback:when a blocking system call is called ,all the thread will be <strong>blocked</strong></li>
<li>old UNIX &amp; green thread </li>
</ul>
<p>2.<strong>one-to-one</strong></p>
<ul>
<li>each thread is mapped to one process structure in the kernel</li>
<li>a high degree of <strong>concurrency</strong></li>
<li>drawback: cannot create too many threads as it is restricted by the size of the kernel memory</li>
<li>most Linux and Windows</li>
</ul>
<p>a process ,without multi-threading,is actually one thread for the scheduler.(when the schduler interets in process / thread)</p>
<p>3.<strong>many-to-many model</strong></p>
<ul>
<li>avoid drawbacks in many-to-one and one-to-one——cannot be blocked , have a high degree of concurrency</li>
<li>but most OS does not use man-to-many model(the drawback of one-to-one is not fatal)</li>
</ul>
<h2 id="Basic-Programming"><a href="#Basic-Programming" class="headerlink" title="Basic Programming"></a>Basic Programming</h2><p>Thread library——-provide the programmer with an API for creating and managing threads.</p>
<p>three main library threadings:</p>
<ul>
<li>POSIX Pthreads(user level or kernel level)</li>
<li>Windows (kernel level)</li>
<li>Java(implements using Windows API or Pthreads)</li>
</ul>
<h3 id="creating-multipule-threads"><a href="#creating-multipule-threads" class="headerlink" title="creating multipule threads"></a>creating multipule threads</h3><p>asynchronous threading </p>
<ul>
<li>parent resumes execution after creating a child </li>
<li>parent and child executes concurrency</li>
<li>each thread run independently</li>
</ul>
<p>synchronous threading</p>
<ul>
<li>fork-join strategy : parents wait for children to terminate<ul>
<li>significant data sharing</li>
</ul>
</li>
</ul>
<h3 id="Pthreads-process-is-similar-to-thread"><a href="#Pthreads-process-is-similar-to-thread" class="headerlink" title="Pthreads:  process is similar to thread"></a>Pthreads:  process is similar to thread</h3><div class="table-container">
<table>
<thead>
<tr>
<th></th>
<th>process</th>
<th>thread</th>
</tr>
</thead>
<tbody>
<tr>
<td>creation</td>
<td>fork()</td>
<td>pthread_create()</td>
</tr>
<tr>
<td>I.D. type</td>
<td>PID,an integer</td>
<td>“pthread_t”,a structure</td>
</tr>
<tr>
<td>who am i?</td>
<td>getpid()</td>
<td>pthread_self()</td>
</tr>
<tr>
<td>wait for the child termination</td>
<td>wait() or waitpid()</td>
<td>pthread_join()</td>
</tr>
<tr>
<td>terminaion</td>
<td>exit()</td>
<td>pthread_exit()</td>
</tr>
<tr>
<td>kill?</td>
<td>kill()</td>
<td>pthread_kill()</td>
</tr>
</tbody>
</table>
</div>
<p>issue 1:create thread</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
   pthread_t tid<span class="token punctuation">;</span>
	<span class="token function">pthread_create</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>tid<span class="token punctuation">,</span><span class="token constant">NULL</span><span class="token punctuation">,</span>hello<span class="token punctuation">,</span><span class="token string">"hello world"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//函数名和函数需要的参数</span>
	<span class="token function">pthread_join</span><span class="token punctuation">(</span>tid<span class="token punctuation">,</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> <span class="token operator">*</span><span class="token function">hello</span> <span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span> input<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
   <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%s"</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span>input<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">pthread_exit</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>issue 2: passing parameter: local variable can be changed —-the stack of the new thread is on the same piece of the user-space memory as the main thread,not a new process,the pthread_create only create an address to the new thread ,the address is a pointer pointing to a variable stack of the main thread.</p>
<p>issue 3:multiple threads: </p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">pthread_t tid<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">5</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
<span class="token function">pthread_create</span><span class="token punctuation">(</span>tid<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token constant">NULL</span><span class="token punctuation">,</span>xxx<span class="token punctuation">,</span>xxx<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">5</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
  <span class="token function">pthread_join</span><span class="token punctuation">(</span>tid<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>issue 4: return value—-thread termination ,<strong>passing return value.</strong></p>
<pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">void do_your_job(void *input){
   ...
   *output=.....;
pthread_exit(output);
}
...

pthread_join(tid,(void**)output);<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>other threading — windows thread or java threads.</p>
<h2 id="Implicit-Threading"><a href="#Implicit-Threading" class="headerlink" title="Implicit Threading"></a>Implicit Threading</h2><ul>
<li><p>applications are containing hundreds or even thousands of threads</p>
<ul>
<li>program correctness is more difficult with explicit threads</li>
</ul>
</li>
<li><p>how to address the programming difficulties?</p>
<ul>
<li>transfer the creation and managements of the threadings from programmers  to compliers and run-time libraries</li>
<li>implicit threading</li>
</ul>
<p>two methods</p>
<p>1.thread pools</p>
<p>2.OpenMP</p>
</li>
</ul>
<h3 id="thread-pools"><a href="#thread-pools" class="headerlink" title="!!!thread pools"></a>!!!thread pools</h3><p>problem with multithreaded servers</p>
<ul>
<li>time required to create threads,which will be discarded once completed their work</li>
<li>unlimited threads could exhaust the system resources</li>
</ul>
<p>solve:</p>
<ul>
<li>thread pool</li>
<li>idea:create a number of threads in a pool where they wait for a work</li>
<li>procedure:<ul>
<li>awaken a thread if necessary</li>
<li>returns to the pool after completion</li>
<li>wait until one becomes free if the pools cpntains no available thread</li>
</ul>
</li>
<li>advantages<ul>
<li>usually sightly faster to service a request with an existing thread than create a new thread</li>
<li>allow the number of threads in the applications to be bound to the size of the pool</li>
</ul>
</li>
</ul>
<h3 id="OpenMP"><a href="#OpenMP" class="headerlink" title="OpenMP"></a>OpenMP</h3><p>provides supports for parallel programming in shared-memory environments</p>
<p>set of compliers directives and an API for C,C++,FORTRAN</p>
<h2 id="Threading-Issues"><a href="#Threading-Issues" class="headerlink" title="Threading Issues"></a>Threading Issues</h2><h3 id="semantics-of-fork-and-exec"><a href="#semantics-of-fork-and-exec" class="headerlink" title="semantics of fork() and exec()"></a>semantics of fork() and exec()</h3><p>1.<strong>fork():some UNIX has two versions:</strong></p>
<ul>
<li>the new process duplicates all threads </li>
<li>duplicates only the thread that invokes fork()</li>
</ul>
<p>exec(): usually work as normal:</p>
<ul>
<li>replace the running process ,includind all threads</li>
</ul>
<p>2.<strong>signal handling</strong></p>
<p>signals are used in UNIX systems to notify a process that a particular event has occurred</p>
<ul>
<li>asnychronous signal and synchronous signal</li>
<li>default handler or user-defined handler</li>
</ul>
<p>where should a signal be delivered in multi-thread program?</p>
<ul>
<li>to the thread signal applies</li>
<li>all the threads</li>
<li>a certain thread</li>
<li>assign  a specific thread to receive all the signals of all the threads</li>
</ul>
<p>deliver a signal to specific thread to receive all the signals for the process</p>
<p>3.<strong>thread cancellation</strong></p>
<p>terminating a thread before it has finished</p>
<p>two genernal approaches:</p>
<ul>
<li>asynchronous cancellation terminates the target thread immediately<ul>
<li>problem:troublesome then updating data</li>
</ul>
</li>
<li>defferred cancellation:allow the target thread to periodically check if it should be cancelled(can be cancelled safely)</li>
<li>three models: asynchronous,defferred,off(disabled cancellation)</li>
<li>default : defferred</li>
</ul>
<p>4.<strong>thread-local storage</strong></p>
<p>some applications ,each threads may needs its own copy of certain data.</p>
<p>thread-local stroage:TLS</p>
<ul>
<li>TLS is visible across function invocations</li>
<li>similar to static data</li>
<li>TLS data are untique to each thread</li>
</ul>
<h2 id="summary-of-thread"><a href="#summary-of-thread" class="headerlink" title="summary of thread"></a>summary of thread</h2><ul>
<li>virtually all morden OSes support multi-threading<ul>
<li>a thread is a basic unit of the CPU utilization</li>
<li>each comprises a thread ID,a program counter,a,register set,a stack</li>
<li>all the threads within a process share code section ,data,section,other resources like openfiles and signals</li>
</ul>
</li>
<li>take great care when writing multi-threaded programs,and also—<ul>
<li>mutual exclusion</li>
<li>synchronization</li>
</ul>
</li>
</ul>
<h1 id="Process-communication-amp-Synchronization"><a href="#Process-communication-amp-Synchronization" class="headerlink" title="Process communication &amp; Synchronization"></a>Process communication &amp; Synchronization</h1><p>the processes within a system may be</p>
<ul>
<li>independent</li>
<li>cooperating</li>
</ul>
<p>any process that  shares the data is a cooperating process</p>
<h2 id="interprocess-communication-—-IPC"><a href="#interprocess-communication-—-IPC" class="headerlink" title="interprocess communication —-IPC"></a>interprocess communication —-IPC</h2><p>two models:</p>
<ul>
<li>shared memory</li>
<li>message passing</li>
</ul>
<p>IPC is used for exchanging data between processes</p>
<p>cooperating processes need IPC for exchanging data</p>
<p>two nodels：</p>
<h3 id="shared-memory"><a href="#shared-memory" class="headerlink" title="shared memory"></a>shared memory</h3><ul>
<li>establish a shared memory region,read/write to share region</li>
<li>accesses are treated as routine memory accesses</li>
<li>faster</li>
</ul>
<p><strong>producer-consumer problem</strong></p>
<p>a buffer os needed to allow processes to run concurrently</p>
<p>the requirement: </p>
<p><strong>a buffer</strong> </p>
<p>is a shared object,and is a queue </p>
<p>problem: when producer wants to put  anew item but the buffer is already full</p>
<p>solution: the producer need to suepended ,and the consumer should wake the producer up after it has dequeue an item</p>
<p>problem: when comsumer wants to dequeue an item but it is empty</p>
<p>solution:  the consumer is suspended and the producer should wake the cinsumer up…</p>
<p><strong>a producer process</strong>  </p>
<p>produces a unit of data ,and writes that a piece of data to the tail of the buffer</p>
<p><strong>a consumer process</strong></p>
<p>removes a unit of data from the head of the bounded buffer at one time</p>
<h3 id="message-passing"><a href="#message-passing" class="headerlink" title="message passing"></a>message passing</h3><p>need a message queue to exchange</p>
<p>communictating processes may reside on different computer conntected by a network</p>
<p>IPC provide : <strong>send</strong>+<strong>receive </strong></p>
<ul>
<li>exchange message </li>
<li>require kernel intervention</li>
<li>easier to implement in a distributed system</li>
</ul>
<p>if two process wish to communicate,they need:</p>
<ul>
<li>establish a communication link between</li>
<li>exchange messages via send/receive</li>
</ul>
<p>issues:</p>
<ul>
<li>naming: direct/indirect<ul>
<li>direct:<ul>
<li>opreations: send and receive</li>
<li>properties of </li>
</ul>
</li>
<li>indirect communication<ul>
<li>allow a link to be associated with at most two processes</li>
<li>allow one process at  a time to execute a receive opreation</li>
<li>allow the system to select arbitrarily the receiver ,and sender is notified who the receiver is</li>
<li>the mailbox is owned by the process (ownership may be passed)and the OS(neede a method to create ,send/receive.delete)</li>
</ul>
</li>
</ul>
</li>
<li><p>synchronization : synchronous— blocking/asynchronous— non- blocking</p>
<ul>
<li>dofferent combinations :1.when the send and the receive are blocking , we have a rendezvous between the processes; 2. other conbinations need buffering</li>
</ul>
</li>
<li><p>buffering</p>
<ul>
<li>messages reside in a temporary queue , whic can be implemented in three ways:<ul>
<li>zero capacity—no message qre queued, sender must wait for the receiver(no buffering)</li>
<li>bounded capacity — finite length of n mesages,sender must wait if link is full</li>
<li>undounded capacity - infinite length,sender never waits</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="POSIX-shared-memory"><a href="#POSIX-shared-memory" class="headerlink" title="POSIX shared memory"></a>POSIX shared memory</h3><p>POSIX shared memory is orgranized using memory-mapped file,associate the region of shared memory with a file.</p>
<p>illustrate wth the producer-consumer problem:</p>
<p><strong>producer</strong></p>
<ul>
<li>create a shared memory object<ul>
<li>shm_fd=shm_open (name,O_CREAT |O_RDWR,0666);(perminssions )</li>
</ul>
</li>
<li>configure object size<ul>
<li>ftruncate(shm_fd,SIZE);</li>
</ul>
</li>
<li>establish a memory-mapped file containing the object<ul>
<li>prtr mmap(0,SIZE,PORT_WRITE),MAP_SHARED,shm_fd,0);(changes to the shared-memory object)</li>
</ul>
</li>
</ul>
<p><strong>consumer</strong></p>
<ul>
<li>open the shared-memory obect<ul>
<li>shm_fd=shm_open(name,O_RDONLY,0666);</li>
</ul>
</li>
<li>memory map the object<ul>
<li>ptr=mmap(0,SIZE,PORT_READ,MAP_SHARED,shm_fd,0);</li>
</ul>
</li>
<li>remove the shared memory object<ul>
<li>shp_unlink(name);</li>
</ul>
</li>
</ul>
<h3 id="Sockets"><a href="#Sockets" class="headerlink" title="Sockets"></a>Sockets</h3><p>a sockets is defined as an endpointer for communication(over a network)</p>
<ul>
<li>a pair of processes employ a pair of sockets</li>
<li>a socker is indentified by an IP address and a port number</li>
<li>all ports below 1024 are used for standard services<ul>
<li>telnet server listens to port 23</li>
<li>FTP server:port 21</li>
<li>HTTP server :port 80</li>
</ul>
</li>
</ul>
<p>Socket uses a client-server architecture</p>
<ul>
<li>server waits for incoming client request by listening to a specific port</li>
<li>accepts a connection from the client socket to complete the connection</li>
</ul>
<p>all connection must be unique(establishing a new connection on the same host needs another port&gt;1024)</p>
<p>special IP address 127.0.0.1(loopback)refers to itself</p>
<h3 id="Pipes"><a href="#Pipes" class="headerlink" title="Pipes"></a>Pipes</h3><p>Pipe ia <strong>a shared memory</strong></p>
<ul>
<li>using pipes is a way to realize IPC</li>
<li>acts as a conduit two processes to communicate</li>
</ul>
<p>issues :</p>
<ul>
<li>communication: unidirectional/bidirectional</li>
<li>half/full duplex</li>
<li>must the relationship exists between the communicating processes</li>
<li>pipes used over a network</li>
</ul>
<p>two common pipes: ordinary pipes and named pipes</p>
<p><strong>ordinary pipes</strong></p>
<ul>
<li>no name  in file system</li>
<li>only used for related process(parent-child relationship)</li>
<li>unidirectional </li>
<li>ceases to exit after communication has finished</li>
<li>allow communication in standard producer-consumer style<ul>
<li>producer write to one end and the consumer reads from the other end</li>
</ul>
</li>
</ul>
<p>UNIX pipe</p>
<ul>
<li>UNIX treats a pipe as a special file (child inherits it from parent)<ul>
<li>create : pipe(int fd[]);fd[0]-read end,fd[1]-write end</li>
<li>create accesses the ordinary read(),write()system calls</li>
<li>fork() duplicates parent’s file descriptors,and parents and child use each end of the pipe</li>
</ul>
</li>
<li>pipes are anonymous </li>
</ul>
<p><strong>named pipes</strong></p>
<ul>
<li>UNIX treats as typical file:mkfifo(), open(), read (), write(),close()</li>
<li>no parent-child relaitionship is necessary(or processes must reside one the same machine)</li>
<li>several processes can use the named pipes for communication</li>
<li>continue to exist</li>
<li>communication is bidiectional(still half-duplex)</li>
</ul>
<p><a href="staff.ustc.edu.cn/~ykli/os2022">课程主页</a></p>
<p>主观题规范：逻辑/语言规范           </p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">SN1987A</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://sn1987a-1.github.io/posts/22413.html">http://sn1987a-1.github.io/posts/22413.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://sn1987a-1.github.io" target="_blank">SN1987A</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E4%B8%93%E4%B8%9A%E8%AF%BE/">专业课</a><a class="post-meta__tags" href="/tags/OS/">OS</a><a class="post-meta__tags" href="/tags/note/">note</a></div><div class="post_share"><div class="social-share" data-image="https://user-images.githubusercontent.com/74918703/155833614-94542aa5-0d30-4691-95d6-9d35a95eaa6a.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/26753.html"><img class="prev-cover" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://user-images.githubusercontent.com/74918703/155833614-94542aa5-0d30-4691-95d6-9d35a95eaa6a.png" onerror="onerror=null;src='https://cdn.jsdelivr.net/gh/zhaoze-jpg/Xianqi@main/img/friend_404.gif'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">ChatBot</div></div></a></div><div class="next-post pull-right"><a href="/posts/28913.html"><img class="next-cover" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://user-images.githubusercontent.com/74918703/155833614-94542aa5-0d30-4691-95d6-9d35a95eaa6a.png" onerror="onerror=null;src='https://cdn.jsdelivr.net/gh/zhaoze-jpg/Xianqi@main/img/friend_404.gif'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Knowledge Framework of OS PART I CH1&amp;CH2</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span> 相关推荐</span></div><div class="relatedPosts-list"><div><a href="/posts/28913.html" title="Knowledge Framework of OS PART I CH1&CH2"><img class="cover" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://user-images.githubusercontent.com/74918703/155833614-94542aa5-0d30-4691-95d6-9d35a95eaa6a.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-02-28</div><div class="title">Knowledge Framework of OS PART I CH1&CH2</div></div></a></div><div><a href="/posts/1120.html" title="数据结构实验设计2_HUFFMAM Tree"><img class="cover" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://user-images.githubusercontent.com/74918703/155833614-94542aa5-0d30-4691-95d6-9d35a95eaa6a.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-11-11</div><div class="title">数据结构实验设计2_HUFFMAM Tree</div></div></a></div><div><a href="/posts/131000.html" title="2021数据结构复习"><img class="cover" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://user-images.githubusercontent.com/74918703/155833471-10c2dd15-9579-4516-a86b-539be619066d.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-01-11</div><div class="title">2021数据结构复习</div></div></a></div><div><a href="/posts/26753.html" title="ChatBot"><img class="cover" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://user-images.githubusercontent.com/74918703/155833614-94542aa5-0d30-4691-95d6-9d35a95eaa6a.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-04-26</div><div class="title">ChatBot</div></div></a></div><div><a href="/posts/12532.html" title="图论期末复习"><img class="cover" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://user-images.githubusercontent.com/74918703/155833614-94542aa5-0d30-4691-95d6-9d35a95eaa6a.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-01-05</div><div class="title">图论期末复习</div></div></a></div><div><a href="/posts/15331.html" title="图论补充内容"><img class="cover" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://user-images.githubusercontent.com/74918703/155833437-e99359b1-1d73-4f54-8782-0401dae0d62d.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-12-11</div><div class="title">图论补充内容</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://user-images.githubusercontent.com/74918703/157878087-7f268ec6-e86a-4e5f-be80-4846ee8d644c.png" onerror="this.onerror=null;this.src='https://cdn.jsdelivr.net/gh/zhaoze-jpg/Xianqi@main/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">SN1987A</div><div class="author-info__description">Learn not and know not.</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">12</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">标签</div><div class="length-num">13</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">分类</div><div class="length-num">9</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="http://home.ustc.edu.cn/~lay_sn1987a/"><i class="fab fa-home"></i><span>个人主页</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/sn1987a-1/" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="tencent://AddContact/?fromId=45&amp;fromSubId=1&amp;subcmd=all&amp;uin=945093063&amp;website=www.qtxml.cn" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>公告</span></div><div class="announcement_content">我希望正在读这句话的人永远开心 contract me----mail lay_sn1987a@mail.ustc.edu.cn</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Part-II"><span class="toc-number">1.</span> <span class="toc-text">Part II</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Process-Concept-amp-Operations"><span class="toc-number">2.</span> <span class="toc-text">Process Concept &amp; Operations</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Concepts-of-Process"><span class="toc-number">2.1.</span> <span class="toc-text">Concepts of Process</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#What-is-a-process"><span class="toc-number">2.2.</span> <span class="toc-text">What is a process</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#process-in-memory"><span class="toc-number">2.2.1.</span> <span class="toc-text">process in memory</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PCB%E2%80%94process-structure"><span class="toc-number">2.2.2.</span> <span class="toc-text">PCB—process structure</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Process-Operations"><span class="toc-number">2.3.</span> <span class="toc-text">Process Operations</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Process-identification"><span class="toc-number">2.3.1.</span> <span class="toc-text">Process identification</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Process-creation"><span class="toc-number">2.3.2.</span> <span class="toc-text">Process creation</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#program-execution"><span class="toc-number">2.3.3.</span> <span class="toc-text">program execution</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#make-a-summary"><span class="toc-number">2.3.4.</span> <span class="toc-text">make a summary</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#From-Kernel-Perspcetive"><span class="toc-number">2.4.</span> <span class="toc-text">From Kernel Perspcetive</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#dual-mode"><span class="toc-number">2.4.1.</span> <span class="toc-text">dual mode</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#the-system-call"><span class="toc-number">2.4.2.</span> <span class="toc-text">the system call</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#fork"><span class="toc-number">2.4.2.1.</span> <span class="toc-text">fork()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#exec"><span class="toc-number">2.4.2.2.</span> <span class="toc-text">exec*()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#wait-amp-exit"><span class="toc-number">2.4.2.3.</span> <span class="toc-text">(**)wait() \&amp;exit()</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#summary"><span class="toc-number">2.5.</span> <span class="toc-text">summary</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Threads"><span class="toc-number">3.</span> <span class="toc-text">Threads</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Thread"><span class="toc-number">3.1.</span> <span class="toc-text">Thread</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Motivation-of-Multi-Threading-and-Concepts"><span class="toc-number">3.1.1.</span> <span class="toc-text">Motivation of Multi-Threading and Concepts</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#internals"><span class="toc-number">3.1.2.</span> <span class="toc-text">internals</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Benefits"><span class="toc-number">3.1.3.</span> <span class="toc-text">Benefits</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#programming-challenges"><span class="toc-number">3.1.4.</span> <span class="toc-text">programming challenges</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Thread-models"><span class="toc-number">3.2.</span> <span class="toc-text">Thread models</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Basic-Programming"><span class="toc-number">3.3.</span> <span class="toc-text">Basic Programming</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#creating-multipule-threads"><span class="toc-number">3.3.1.</span> <span class="toc-text">creating multipule threads</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Pthreads-process-is-similar-to-thread"><span class="toc-number">3.3.2.</span> <span class="toc-text">Pthreads:  process is similar to thread</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Implicit-Threading"><span class="toc-number">3.4.</span> <span class="toc-text">Implicit Threading</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#thread-pools"><span class="toc-number">3.4.1.</span> <span class="toc-text">!!!thread pools</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#OpenMP"><span class="toc-number">3.4.2.</span> <span class="toc-text">OpenMP</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Threading-Issues"><span class="toc-number">3.5.</span> <span class="toc-text">Threading Issues</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#semantics-of-fork-and-exec"><span class="toc-number">3.5.1.</span> <span class="toc-text">semantics of fork() and exec()</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#summary-of-thread"><span class="toc-number">3.6.</span> <span class="toc-text">summary of thread</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Process-communication-amp-Synchronization"><span class="toc-number">4.</span> <span class="toc-text">Process communication &amp; Synchronization</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#interprocess-communication-%E2%80%94-IPC"><span class="toc-number">4.1.</span> <span class="toc-text">interprocess communication —-IPC</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#shared-memory"><span class="toc-number">4.1.1.</span> <span class="toc-text">shared memory</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#message-passing"><span class="toc-number">4.1.2.</span> <span class="toc-text">message passing</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#POSIX-shared-memory"><span class="toc-number">4.1.3.</span> <span class="toc-text">POSIX shared memory</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Sockets"><span class="toc-number">4.1.4.</span> <span class="toc-text">Sockets</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Pipes"><span class="toc-number">4.1.5.</span> <span class="toc-text">Pipes</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/posts/156324.html" title="程序设计II大作业--chatbot"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://user-images.githubusercontent.com/74918703/155833471-10c2dd15-9579-4516-a86b-539be619066d.png" onerror="this.onerror=null;this.src='https://cdn.jsdelivr.net/gh/zhaoze-jpg/Xianqi@main/img/friend_404.gif'" alt="程序设计II大作业--chatbot"/></a><div class="content"><a class="title" href="/posts/156324.html" title="程序设计II大作业--chatbot">程序设计II大作业--chatbot</a><time datetime="2022-05-17T15:12:20.000Z" title="发表于 2022-05-17 23:12:20">2022-05-17</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/26753.html" title="ChatBot"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://user-images.githubusercontent.com/74918703/155833614-94542aa5-0d30-4691-95d6-9d35a95eaa6a.png" onerror="this.onerror=null;this.src='https://cdn.jsdelivr.net/gh/zhaoze-jpg/Xianqi@main/img/friend_404.gif'" alt="ChatBot"/></a><div class="content"><a class="title" href="/posts/26753.html" title="ChatBot">ChatBot</a><time datetime="2022-04-26T07:35:11.000Z" title="发表于 2022-04-26 15:35:11">2022-04-26</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/22413.html" title="Knowledge Framework of OS PART II CH3"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://user-images.githubusercontent.com/74918703/155833614-94542aa5-0d30-4691-95d6-9d35a95eaa6a.png" onerror="this.onerror=null;this.src='https://cdn.jsdelivr.net/gh/zhaoze-jpg/Xianqi@main/img/friend_404.gif'" alt="Knowledge Framework of OS PART II CH3"/></a><div class="content"><a class="title" href="/posts/22413.html" title="Knowledge Framework of OS PART II CH3">Knowledge Framework of OS PART II CH3</a><time datetime="2022-03-07T07:35:11.000Z" title="发表于 2022-03-07 15:35:11">2022-03-07</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/28913.html" title="Knowledge Framework of OS PART I CH1&amp;CH2"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://user-images.githubusercontent.com/74918703/155833614-94542aa5-0d30-4691-95d6-9d35a95eaa6a.png" onerror="this.onerror=null;this.src='https://cdn.jsdelivr.net/gh/zhaoze-jpg/Xianqi@main/img/friend_404.gif'" alt="Knowledge Framework of OS PART I CH1&amp;CH2"/></a><div class="content"><a class="title" href="/posts/28913.html" title="Knowledge Framework of OS PART I CH1&amp;CH2">Knowledge Framework of OS PART I CH1&amp;CH2</a><time datetime="2022-02-28T14:52:11.000Z" title="发表于 2022-02-28 22:52:11">2022-02-28</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/15203.html" title="以git-ftp为主的学习记录"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://user-images.githubusercontent.com/74918703/155833584-1eba0e4e-2d29-48a6-a5a2-c04cc982b0ec.png" onerror="this.onerror=null;this.src='https://cdn.jsdelivr.net/gh/zhaoze-jpg/Xianqi@main/img/friend_404.gif'" alt="以git-ftp为主的学习记录"/></a><div class="content"><a class="title" href="/posts/15203.html" title="以git-ftp为主的学习记录">以git-ftp为主的学习记录</a><time datetime="2022-02-27T07:46:11.000Z" title="发表于 2022-02-27 15:46:11">2022-02-27</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2021 - 2023  <i id="heartbeat" class="fa fas fa-heartbeat"></i> SN1987A</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div><script type="text/javascript" id="maid-script" src="https://unpkg.com/mermaid@undefined/dist/mermaid.min.js?v=undefined"></script><script>if (window.mermaid) {
  var options = JSON.parse(document.getElementById('maid-script').getAttribute('mermaidoptioins'));
  mermaid.initialize(options);
}
</script><head><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/HCLonely/images@master/others/heartbeat.min.css"></head></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="https://cdn.jsdelivr.net/gh/zhaoze-jpg/Xianqi@main/js/utils.js"></script><script src="https://cdn.jsdelivr.net/gh/zhaoze-jpg/Xianqi@main/js/main.js"></script><script src="https://cdn.jsdelivr.net/gh/zhaoze-jpg/Xianqi@main/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script src="https://cdn.jsdelivr.net/gh/zhaoze-jpg/Xianqi@main/js/search/local-search.js"></script><script>var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',preloader.endLoading())</script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [ ['$','$'], ["\\(","\\)"]],
      tags: 'ams'
    },
    chtml: {
      scale: 1.2
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, ''],
        insertScript: [200, () => {
          document.querySelectorAll('mjx-container:not\([display]\)').forEach(node => {
            const target = node.parentNode
            if (target.nodeName.toLowerCase() === 'li') {
              target.parentNode.classList.add('has-jax')
            } else {
              target.classList.add('has-jax')
            }
          });
        }, '', false]
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typeset()
}</script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css"><script src="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.css"><script>(() => {
  document.querySelectorAll('#article-container span.katex-display').forEach(item => {
    btf.wrap(item, 'div', { class: 'katex-wrap'})
  })
})()</script><script>if (document.getElementsByClassName('mermaid').length) {
  if (window.mermaidJsLoad) mermaid.init()
  else {
    getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(() => {
      window.mermaidJsLoad = true
      mermaid.initialize({
        theme: 'default',
      })
      true && mermaid.init()
    })
  }
}</script><script>function loadValine () {
  function initValine () {
    const valine = new Valine(Object.assign({
      el: '#vcomment',
      appId: '',
      appKey: '',
      placeholder: 'haven't done！',
      avatar: 'monsterid',
      meta: 'nick,mail,link'.split(','),
      pageSize: '10',
      lang: 'zh-CN',
      recordIP: false,
      serverURLs: '',
      emojiCDN: '',
      emojiMaps: "",
      enableQQ: false,
      path: window.location.pathname,
      requiredFields: ["nick,mail"],
      visitor: false
    }, null))
  }

  if (typeof Valine === 'function') initValine() 
  else getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js').then(initValine)
}

if ('Valine' === 'Valine' || !true) {
  if (true) btf.loadComment(document.getElementById('vcomment'),loadValine)
  else setTimeout(loadValine, 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script></div><script defer id="dsq-count-scr" src="//xianqi.disqus.com/count.js" async></script><script defer type="text/javascript" src="https://cdn.jsdelivr.net/gh/zhaoze-jpg/Xianqi@main/js/sakura.js"></script><script defer type="text/javascript" src="https://cdn.jsdelivr.net/gh/zhaoze-jpg/Xianqi@main/js/animate.js"></script><div class="aplayer no-destroy" data-id="1776127550" data-server="tencent" data-type="playlist" data-fixed="true" data-mini="true" data-listFolded="false" data-order="random" data-preload="auto" data-autoplay="true" muted></div><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/fireworks.min.js"></script><script defer="defer" id="fluttering_ribbon" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-fluttering-ribbon.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = false;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors = [
  'title',
  '#config-diff',
  '#body-wrap',
  '#rightside-config-hide',
  '#rightside-config-show',
  '.js-pjax'
]

if (false) {
  pjaxSelectors.unshift('meta[property="og:image"]', 'meta[property="og:title"]', 'meta[property="og:url"]')
}

var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {

  // removeEventListener scroll 
  window.removeEventListener('scroll', window.tocScrollFn)
  window.removeEventListener('scroll', scrollCollect)

  typeof preloader === 'object' && preloader.initLoading()
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof chatBtnFn === 'function' && chatBtnFn()
  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // Analytics
  if (false) {
    MtaH5.pgv()
  }

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()

  typeof preloader === 'object' && preloader.endLoading()
})

document.addEventListener('pjax:error', (e) => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"model":{"jsonPath":"/live2dw/assets/koharu.model.json"},"display":{"position":"left","width":150,"height":300},"mobile":{"show":true},"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body></html>